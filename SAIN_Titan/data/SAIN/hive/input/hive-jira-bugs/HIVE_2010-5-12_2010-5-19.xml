<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:15:50 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2010-5-12+AND+created+%3C%3D+2010-5-19+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="9" total="9"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-1342] Predicate push down get error result when sub-queries have the same alias name </title>
                <link>https://issues.apache.org/jira/browse/HIVE-1342</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Query is over-optimized by PPD when sub-queries have the same alias name, see the query:&lt;/p&gt;

&lt;p&gt;-------------------------------&lt;br/&gt;
create table if not exists dm_fact_buyer_prd_info_d (&lt;br/&gt;
		category_id string&lt;br/&gt;
		,gmv_trade_num  int&lt;br/&gt;
		,user_id    int&lt;br/&gt;
		)&lt;br/&gt;
PARTITIONED BY (ds int);&lt;/p&gt;

&lt;p&gt;set hive.optimize.ppd=true;&lt;br/&gt;
set hive.map.aggr=true;&lt;/p&gt;

&lt;p&gt;explain select category_id1,category_id2,assoc_idx&lt;br/&gt;
from (&lt;br/&gt;
		select &lt;br/&gt;
			category_id1&lt;br/&gt;
			, category_id2&lt;br/&gt;
			, count(distinct user_id) as assoc_idx&lt;br/&gt;
		from (&lt;br/&gt;
			select &lt;br/&gt;
				t1.category_id as category_id1&lt;br/&gt;
				, t2.category_id as category_id2&lt;br/&gt;
				, t1.user_id&lt;br/&gt;
			from (&lt;br/&gt;
				select category_id, user_id&lt;br/&gt;
				from dm_fact_buyer_prd_info_d&lt;br/&gt;
				group by category_id, user_id ) t1&lt;br/&gt;
			join (&lt;br/&gt;
				select category_id, user_id&lt;br/&gt;
				from dm_fact_buyer_prd_info_d&lt;br/&gt;
				group by category_id, user_id ) t2 on t1.user_id=t2.user_id &lt;br/&gt;
			) t1&lt;br/&gt;
			group by category_id1, category_id2 ) t_o&lt;br/&gt;
			where category_id1 &amp;lt;&amp;gt; category_id2&lt;br/&gt;
			and assoc_idx &amp;gt; 2;&lt;/p&gt;

&lt;p&gt;-----------------------------&lt;br/&gt;
The query above will fail when execute, throwing exception: &quot;can not cast UDFOpNotEqual(Text, IntWritable) to UDFOpNotEqual(Text, Text)&quot;. &lt;/p&gt;

&lt;p&gt;I explained the query and the execute plan looks really wired ( only Stage-1, see the highlighted predicate):&lt;/p&gt;

&lt;p&gt;-------------------------------&lt;br/&gt;
Stage: Stage-1&lt;br/&gt;
    Map Reduce&lt;br/&gt;
      Alias -&amp;gt; Map Operator Tree:&lt;br/&gt;
        t_o:t1:t1:dm_fact_buyer_prd_info_d &lt;br/&gt;
          TableScan&lt;br/&gt;
            alias: dm_fact_buyer_prd_info_d&lt;br/&gt;
            Filter Operator&lt;br/&gt;
              predicate:&lt;br/&gt;
                  expr: &lt;b&gt;(category_id &amp;lt;&amp;gt; user_id)&lt;/b&gt;&lt;br/&gt;
                  type: boolean&lt;br/&gt;
              Select Operator&lt;br/&gt;
                expressions:&lt;br/&gt;
                      expr: category_id&lt;br/&gt;
                      type: string&lt;br/&gt;
                      expr: user_id&lt;br/&gt;
                      type: bigint&lt;br/&gt;
                outputColumnNames: category_id, user_id&lt;br/&gt;
                Group By Operator&lt;br/&gt;
                  keys:&lt;br/&gt;
                        expr: category_id&lt;br/&gt;
                        type: string&lt;br/&gt;
                        expr: user_id&lt;br/&gt;
                        type: bigint&lt;br/&gt;
                  mode: hash&lt;br/&gt;
                  outputColumnNames: _col0, _col1&lt;br/&gt;
                  Reduce Output Operator&lt;br/&gt;
                    key expressions:&lt;br/&gt;
                          expr: _col0&lt;br/&gt;
                          type: string&lt;br/&gt;
                          expr: _col1&lt;br/&gt;
                          type: bigint&lt;br/&gt;
                    sort order: ++&lt;br/&gt;
                    Map-reduce partition columns:&lt;br/&gt;
                          expr: _col0&lt;br/&gt;
                          type: string&lt;br/&gt;
                          expr: _col1&lt;br/&gt;
                          type: bigint&lt;br/&gt;
                    tag: -1&lt;br/&gt;
      Reduce Operator Tree:&lt;br/&gt;
        Group By Operator&lt;br/&gt;
          keys:&lt;br/&gt;
                expr: KEY._col0&lt;br/&gt;
                type: string&lt;br/&gt;
                expr: KEY._col1&lt;br/&gt;
                type: bigint&lt;br/&gt;
          mode: mergepartial&lt;br/&gt;
          outputColumnNames: _col0, _col1&lt;br/&gt;
          Select Operator&lt;br/&gt;
            expressions:&lt;br/&gt;
                  expr: _col0&lt;br/&gt;
                  type: string&lt;br/&gt;
                  expr: _col1&lt;br/&gt;
                  type: bigint&lt;br/&gt;
            outputColumnNames: _col0, _col1&lt;br/&gt;
            File Output Operator&lt;br/&gt;
              compressed: true&lt;br/&gt;
              GlobalTableId: 0&lt;br/&gt;
              table:&lt;br/&gt;
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat&lt;br/&gt;
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat&lt;br/&gt;
 ----------------------------------&lt;/p&gt;

&lt;p&gt;If disabling predicate push down (set hive.optimize.ppd=true), the error is gone; I tried disabling map side aggregate, the error is gone,too. &lt;/p&gt;

&lt;p&gt;&lt;b&gt;Changing the alias of subquery &apos;t1&apos; (either the inner one or the join result), the bug disappears, too.&lt;/b&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12464329">HIVE-1342</key>
            <summary>Predicate push down get error result when sub-queries have the same alias name </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="charleschen">Charles Chen</assignee>
                                    <reporter username="tedxu">Ted Xu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 May 2010 08:41:06 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:06 +0000</updated>
                            <resolved>Wed, 31 Aug 2011 23:46:24 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12881128" author="tedxu" created="Tue, 22 Jun 2010 08:34:00 +0000"  >&lt;p&gt;I think PPD is unnecessarily resolving table aliases when encountered CommonJoinOperator. &lt;br/&gt;
I attached a patch fixing it. Please have a review.&lt;/p&gt;</comment>
                            <comment id="12882203" author="he yongqiang" created="Thu, 24 Jun 2010 16:15:29 +0000"  >&lt;p&gt;It maybe better if we throw an error message when we see duplicate alias name.&lt;/p&gt;</comment>
                            <comment id="12882236" author="jvs" created="Thu, 24 Jun 2010 17:36:16 +0000"  >&lt;p&gt;Commentary on duplicate aliases in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1395&quot; title=&quot;Table aliases are ambiguous&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1395&quot;&gt;&lt;del&gt;HIVE-1395&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12883356" author="jvs" created="Mon, 28 Jun 2010 23:52:32 +0000"  >&lt;p&gt;Hi Ted,&lt;/p&gt;

&lt;p&gt;I don&apos;t think this patch is general enough.  To really fix the problem, it will be necessary to dig into it deeper and find out where we are currently using unscoped aliases (e.g. t2) where we should instead be using scoped aliases (e.g. t_o:t1:t2:dm_fact_buyer_prd_info_d).  I suspect that if you get to the root of the problem, the fix will take care of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1395&quot; title=&quot;Table aliases are ambiguous&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1395&quot;&gt;&lt;del&gt;HIVE-1395&lt;/del&gt;&lt;/a&gt; too.&lt;/p&gt;

&lt;p&gt;Also, when submitting a patch, please run diff from the hive trunk directory (not from a subdirectory such as ql).&lt;/p&gt;</comment>
                            <comment id="12883421" author="tedxu" created="Tue, 29 Jun 2010 05:55:05 +0000"  >&lt;p&gt;Hi John,&lt;/p&gt;

&lt;p&gt;Thank you for reviewing the patch. I updated the patch to solve &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1395&quot; title=&quot;Table aliases are ambiguous&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1395&quot;&gt;&lt;del&gt;HIVE-1395&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I dig into the code and find that the same alias in different subqueries can be ambiguous only if PPD is parsing CommonJoinOperator, so I just add some special case in PPD for CommonJoinOperator.&lt;/p&gt;

&lt;p&gt;As you mentioned above, adding namespace to RowResolver or OpParseContext can also fix it, but I think we better keep their implementation simple.&lt;/p&gt;</comment>
                            <comment id="12884796" author="jvs" created="Fri, 2 Jul 2010 20:16:27 +0000"  >&lt;p&gt;Hmmm....I looked into this one some more.  Let me summarize what I found.&lt;/p&gt;

&lt;p&gt;On trunk as it is today (without this patch), predicate pushdown does not (in general) get optimized when we have a nested select with a join.  For example:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain
SELECT * FROM (
    SELECT a.foo as foo1, b.foo as foo2, a.bar
    FROM pokes a LEFT OUTER JOIN pokes2 b
    ON a.foo=b.foo) z
WHERE bar=3;

...

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        z:a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
                    expr: bar
                    type: string
        z:b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col2
                  type: int
                  expr: _col1
                  type: string
            outputColumnNames: _col0, _col1, _col2
            Filter Operator
              predicate:
                  expr: (_col2 = 3)
                  type: boolean
              Select Operator
                expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: int
                      expr: _col2
                      type: string
                outputColumnNames: _col0, _col1, _col2
                File Output Operator
                  compressed: false
                  GlobalTableId: 0
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, it does kick in (sometimes correctly, sometimes incorrectly) in the special case where aliases are reused.  For example, it happens to work correctly for a query like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain
SELECT * FROM (
    SELECT a.foo as foo1, b.foo as foo2, a.bar
    FROM pokes a LEFT OUTER JOIN pokes2 b
    ON a.foo=b.foo) a
WHERE a.bar=3;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But in cases like the original ones in the bug reports, it gets applied incorrectly.&lt;/p&gt;

&lt;p&gt;Ted&apos;s patch attempts to limit the damage by uniformly preventing the optimization from applying for the pattern of nested select over join (regardless of whether aliases have been reused).&lt;/p&gt;

&lt;p&gt;If this is the best we can do for 0.6, then we&apos;ll have to live with that and then open another issue for correcting the real problem so that we can get full optimization (particularly for views).&lt;/p&gt;

&lt;p&gt;I don&apos;t think it&apos;s a question of keeping the implementation simple; the patch as is does not fix the optimization, it just disables it.&lt;/p&gt;</comment>
                            <comment id="12885101" author="tedxu" created="Mon, 5 Jul 2010 04:08:44 +0000"  >&lt;p&gt;The patch is not simply disables PPD, when encountered the special case (nested select over join) . It prevents replicated table resolve.&lt;/p&gt;

&lt;p&gt;I tried the query above and it seems fine with the patch, that is, the predicate can be pushed into the subquery. The explain result is shown below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;STAGE PLANS:

  Stage: Stage-1
    Map Reduce

      Alias -&amp;gt; Map Operator Tree:

        z:a 

          TableScan

            alias: a

            Reduce Output Operator

              key expressions:

                    expr: foo

                    type: string

              sort order: +

              Map-reduce partition columns:

                    expr: foo

                    type: string

              tag: 0

              value expressions:

                    expr: foo

                    type: string

                    expr: bar

                    type: string

        z:b 

          TableScan

            alias: b

            Filter Operator

              predicate:

                  expr: (UDFToDouble(foo) = UDFToDouble(3))

                  type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;

              Reduce Output Operator

                key expressions:

                      expr: foo

                      type: string

                sort order: +

                Map-reduce partition columns:

                      expr: foo

                      type: string

                tag: 1

                value expressions:

                      expr: foo

                      type: string

      Reduce Operator Tree:

        Join Operator

          condition map:

               Left Outer Join0 to 1

          condition expressions:

            0 {VALUE._col0} {VALUE._col1}

            1 {VALUE._col0}

          outputColumnNames: _col0, _col1, _col2

          Select Operator

            expressions:

                  expr: _col0

                  type: string

                  expr: _col2

                  type: string

                  expr: _col1

                  type: string

            outputColumnNames: _col0, _col1, _col2

            Filter Operator

              predicate:

                  expr: (UDFToDouble(_col2) = UDFToDouble(3))

                  type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;

              Select Operator

                expressions:

                      expr: _col0

                      type: string

                      expr: _col1

                      type: string

                      expr: _col2

                      type: string

                outputColumnNames: _col0, _col1, _col2

                File Output Operator

                  compressed: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;

                  GlobalTableId: 0

                  table:

                      input format: org.apache.hadoop.mapred.TextInputFormat

                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat



  Stage: Stage-0
    Fetch Operator

      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the reason why trunk version cannot push predicate into the subquery is that it did a replicated table resolve therefore can&apos;t find any table suitable for that predicate, not disabling PPD purposely.&lt;/p&gt;</comment>
                            <comment id="12910336" author="jvs" created="Thu, 16 Sep 2010 21:47:57 +0000"  >&lt;p&gt;Finallly got back to this one.  Let me provide some specific examples to better explain what I wrote.&lt;/p&gt;

&lt;p&gt;First, latest trunk without any patch.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-- Q1.trunk:  Without a nested select, the plan is correct for this query.
-- (we&apos;re not allowed to push filter down into null-generating side of outer join)
hive&amp;gt; explain
    &amp;gt; SELECT a.foo as foo1, b.foo as foo2, b.bar
    &amp;gt; FROM pokes a LEFT OUTER JOIN pokes2 b
    &amp;gt; ON a.foo=b.foo
    &amp;gt; WHERE b.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) bar))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL b) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
        b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
                    expr: bar
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0}
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col4, _col5
          Filter Operator
            predicate:
                expr: (_col5 = 3)
                type: boolean
            Select Operator
              expressions:
                    expr: _col0
                    type: int
                    expr: _col4
                    type: int
                    expr: _col5
                    type: string
              outputColumnNames: _col0, _col1, _col2
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

-- Q2.trunk:  For this equivalent query written using a nested select, the plan is incorrect.
-- (filter got pushed down when it shouldn&apos;t; note that in the wrapping select, a.bar should resolve to b.bar in the nested select)
hive&amp;gt; explain
    &amp;gt; SELECT * FROM
    &amp;gt;     (SELECT a.foo as foo1, b.foo as foo2, b.bar
    &amp;gt;     FROM pokes a LEFT OUTER JOIN pokes2 b
    &amp;gt;     ON a.foo=b.foo) a
    &amp;gt; WHERE a.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) bar))))) a)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL a) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a:a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
        a:b 
          TableScan
            alias: b
            Filter Operator
              predicate:
                  expr: (bar = 3)
                  type: boolean
              Reduce Output Operator
                key expressions:
                      expr: foo
                      type: int
                sort order: +
                Map-reduce partition columns:
                      expr: foo
                      type: int
                tag: 1
                value expressions:
                      expr: foo
                      type: int
                      expr: bar
                      type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0}
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col4, _col5
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col4
                  type: int
                  expr: _col5
                  type: string
            outputColumnNames: _col0, _col1, _col2
            Filter Operator
              predicate:
                  expr: (_col2 = 3)
                  type: boolean
              Select Operator
                expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: int
                      expr: _col2
                      type: string
                outputColumnNames: _col0, _col1, _col2
                File Output Operator
                  compressed: false
                  GlobalTableId: 0
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

-- Q3.trunk:  However, for this semantically different case, the plan is correct.
-- (we&apos;re allowed to push the filter down for an inner join)
hive&amp;gt; 
    &amp;gt; explain
    &amp;gt; SELECT * FROM
    &amp;gt;     (SELECT a.foo as foo1, b.foo as foo2, a.bar
    &amp;gt;     FROM pokes a JOIN pokes2 b
    &amp;gt;     ON a.foo=b.foo) a
    &amp;gt; WHERE a.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) bar))))) a)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL a) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a:a 
          TableScan
            alias: a
            Filter Operator
              predicate:
                  expr: (bar = 3)
                  type: boolean
              Reduce Output Operator
                key expressions:
                      expr: foo
                      type: int
                sort order: +
                Map-reduce partition columns:
                      expr: foo
                      type: int
                tag: 0
                value expressions:
                      expr: foo
                      type: int
                      expr: bar
                      type: string
        a:b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col4
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col4
                  type: int
                  expr: _col1
                  type: string
            outputColumnNames: _col0, _col1, _col2
            Filter Operator
              predicate:
                  expr: (_col2 = 3)
                  type: boolean
              Select Operator
                expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: int
                      expr: _col2
                      type: string
                outputColumnNames: _col0, _col1, _col2
                File Output Operator
                  compressed: false
                  GlobalTableId: 0
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, repeating Q1/Q2/Q3 with the patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
-- Q1.patch:  this plan is good
-- (same result as Q1.trunk, as expected)
hive&amp;gt; explain
    &amp;gt; SELECT a.foo as foo1, b.foo as foo2, b.bar
    &amp;gt; FROM pokes a LEFT OUTER JOIN pokes2 b
    &amp;gt; ON a.foo=b.foo
    &amp;gt; WHERE b.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) bar))) (TOK_WHERE (= (. (TOK_TABLE_OR_COL b) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
        b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
                    expr: bar
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0}
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col4, _col5
          Filter Operator
            predicate:
                expr: (_col5 = 3)
                type: boolean
            Select Operator
              expressions:
                    expr: _col0
                    type: int
                    expr: _col4
                    type: int
                    expr: _col5
                    type: string
              outputColumnNames: _col0, _col1, _col2
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

-- Q2.patch:  this time, the plan is good (no pushdown)
-- (the patch fixes the bug exhibited on trunk)
hive&amp;gt; explain
    &amp;gt; SELECT * FROM
    &amp;gt;     (SELECT a.foo as foo1, b.foo as foo2, b.bar
    &amp;gt;     FROM pokes a LEFT OUTER JOIN pokes2 b
    &amp;gt;     ON a.foo=b.foo) a
    &amp;gt; WHERE a.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_LEFTOUTERJOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) bar))))) a)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL a) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a:a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
        a:b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
                    expr: bar
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          condition expressions:
            0 {VALUE._col0}
            1 {VALUE._col0} {VALUE._col1}
          handleSkewJoin: false
          outputColumnNames: _col0, _col4, _col5
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col4
                  type: int
                  expr: _col5
                  type: string
            outputColumnNames: _col0, _col1, _col2
            Filter Operator
              predicate:
                  expr: (_col2 = 3)
                  type: boolean
              Select Operator
                expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: int
                      expr: _col2
                      type: string
                outputColumnNames: _col0, _col1, _col2
                File Output Operator
                  compressed: false
                  GlobalTableId: 0
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

-- Q3.patch:  whoops, now the plan is valid but suboptimal since the filter pushdown did not happen
-- (whereas it did with trunk)
hive&amp;gt; explain
    &amp;gt; SELECT * FROM
    &amp;gt;     (SELECT a.foo as foo1, b.foo as foo2, a.bar
    &amp;gt;     FROM pokes a JOIN pokes2 b
    &amp;gt;     ON a.foo=b.foo) a
    &amp;gt; WHERE a.bar=3;
OK
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF pokes a) (TOK_TABREF pokes2 b) (= (. (TOK_TABLE_OR_COL a) foo) (. (TOK_TABLE_OR_COL b) foo)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) foo) foo1) (TOK_SELEXPR (. (TOK_TABLE_OR_COL b) foo) foo2) (TOK_SELEXPR (. (TOK_TABLE_OR_COL a) bar))))) a)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL a) bar) 3))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        a:a 
          TableScan
            alias: a
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 0
              value expressions:
                    expr: foo
                    type: int
                    expr: bar
                    type: string
        a:b 
          TableScan
            alias: b
            Reduce Output Operator
              key expressions:
                    expr: foo
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: foo
                    type: int
              tag: 1
              value expressions:
                    expr: foo
                    type: int
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          condition expressions:
            0 {VALUE._col0} {VALUE._col1}
            1 {VALUE._col0}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col4
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col4
                  type: int
                  expr: _col1
                  type: string
            outputColumnNames: _col0, _col1, _col2
            Filter Operator
              predicate:
                  expr: (_col2 = 3)
                  type: boolean
              Select Operator
                expressions:
                      expr: _col0
                      type: int
                      expr: _col1
                      type: int
                      expr: _col2
                      type: string
                outputColumnNames: _col0, _col1, _col2
                File Output Operator
                  compressed: false
                  GlobalTableId: 0
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, we need a patch which takes care of Q2 while not causing a plan optimality regression for Q3.&lt;/p&gt;</comment>
                            <comment id="12910339" author="jvs" created="Thu, 16 Sep 2010 21:49:28 +0000"  >&lt;p&gt;For easy copy/paste into CLI, here are the three queries by themselves.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-- Q1
explain
SELECT a.foo as foo1, b.foo as foo2, b.bar
FROM pokes a LEFT OUTER JOIN pokes2 b
ON a.foo=b.foo
WHERE b.bar=3;

-- Q2
explain
SELECT * FROM
    (SELECT a.foo as foo1, b.foo as foo2, b.bar
    FROM pokes a LEFT OUTER JOIN pokes2 b
    ON a.foo=b.foo) a
WHERE a.bar=3;

-- Q3
explain
SELECT * FROM
    (SELECT a.foo as foo1, b.foo as foo2, a.bar
    FROM pokes a JOIN pokes2 b
    ON a.foo=b.foo) a
WHERE a.bar=3;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13081346" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 00:54:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1155166 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1329/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13081789" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 17:43:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-09 17:42:48.808459)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1155166 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1329/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13083964" author="jiraposter@reviews.apache.org" created="Fri, 12 Aug 2011 06:14:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-12 06:14:21.523742)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fixed incorrectly pushed predicates&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1156940 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1329/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13083977" author="jiraposter@reviews.apache.org" created="Fri, 12 Aug 2011 06:36:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-12 06:35:45.599414)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix null pointer when there are no pruning filters&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1156940 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1329/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13085393" author="charleschen" created="Mon, 15 Aug 2011 22:31:12 +0000"  >&lt;p&gt;It turns out that in addition to the incorrect behavior of the PPD optimization with multiple aliases in John&apos;s testcases, the semantic analyzer populated the column expression map of a select operator incorrectly when processing the group by operation, which resulted in the PPD getting confused and switching the columns. (see &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;v4.patch)&lt;/p&gt;</comment>
                            <comment id="13085394" author="jiraposter@reviews.apache.org" created="Mon, 15 Aug 2011 22:31:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-15 22:31:14.344074)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fixed incorrect colexprmap when processing group by&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; title=&quot;Predicate push down get error result when sub-queries have the same alias name &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1342&quot;&gt;&lt;del&gt;HIVE-1342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/a&gt; 1157999 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1157999 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias1.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias1.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias2.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_repeated_alias2.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias1.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias1.q.out&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias2.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_repeated_alias2.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1329/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1329/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13086069" author="charleschen" created="Wed, 17 Aug 2011 00:56:40 +0000"  >&lt;p&gt;Split into &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2382&quot; title=&quot;Invalid predicate pushdown from incorrect column expression map for select operator generated by GROUP BY operation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2382&quot;&gt;&lt;del&gt;HIVE-2382&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2383&quot; title=&quot;Incorrect alias filtering for predicate pushdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2383&quot;&gt;&lt;del&gt;HIVE-2383&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13095000" author="jvs" created="Wed, 31 Aug 2011 23:46:24 +0000"  >&lt;p&gt;Fixed by committing sub-issues (not the patches attached to this issue).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12498567">HIVE-1989</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12519059">HIVE-2382</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12519060">HIVE-2383</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489788" name="HIVE-1342v1.patch" size="15819" author="charleschen" created="Tue, 9 Aug 2011 00:53:05 +0000"/>
                            <attachment id="12490224" name="HIVE-1342v2.patch" size="14890" author="charleschen" created="Fri, 12 Aug 2011 06:15:10 +0000"/>
                            <attachment id="12490225" name="HIVE-1342v3.patch" size="14942" author="charleschen" created="Fri, 12 Aug 2011 06:36:52 +0000"/>
                            <attachment id="12490481" name="HIVE-1342v4.patch" size="31147" author="charleschen" created="Mon, 15 Aug 2011 22:31:23 +0000"/>
                            <attachment id="12444281" name="cmd.hql" size="857" author="tedxu" created="Wed, 12 May 2010 08:47:41 +0000"/>
                            <attachment id="12444282" name="explain" size="10781" author="tedxu" created="Wed, 12 May 2010 08:47:41 +0000"/>
                            <attachment id="12447675" name="ppd_same_alias_1.patch" size="14051" author="tedxu" created="Tue, 22 Jun 2010 08:33:59 +0000"/>
                            <attachment id="12448276" name="ppd_same_alias_2.patch" size="17491" author="tedxu" created="Tue, 29 Jun 2010 05:55:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Jun 2010 16:15:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 21 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lenb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123023</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ppd</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1343] add an interface in RCFile to support concatenation of two files without (de)compression</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1343</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;If two files are concatenated, we need to read each record in these files and write them back to the destination file. The IO cost is mostly unavoidable due to the lack of append functionality in HDFS. However the CPU cost could be significantly reduced by avoiding compression and decompression of the files.&lt;/p&gt;

&lt;p&gt;The File Format layer should provide API that implement the block-level concatenation. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12464481">HIVE-1343</key>
            <summary>add an interface in RCFile to support concatenation of two files without (de)compression</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 May 2010 23:01:11 +0000</created>
                <updated>Thu, 24 Jul 2014 22:32:18 +0000</updated>
                            <resolved>Thu, 21 Apr 2011 00:05:05 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12867557" author="nzhang" created="Fri, 14 May 2010 16:50:00 +0000"  >&lt;p&gt;Yongqiang this patch only exposes the FileInputReader to the client and the client has to merge the file locally. This won&apos;t be scalable. What we should do is to run this merge job as a map-only job so that it can be run in parallel.&lt;/p&gt;

&lt;p&gt;Talked with Dhruba and he think it would be possible to make it a map-only job. The idea is to define a new RecordReader that does not do decompression and iterate over records. Instead it iterates over uncompressed blocks. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12497602">HIVE-1950</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12729598">HIVE-7509</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12444499" name="HIVE-1343.1.patch" size="4802" author="he yongqiang" created="Fri, 14 May 2010 15:25:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63980</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lenj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123024</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1344] error in select disinct</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1344</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt; from T a select distinct a.* where a.ds=&apos;2010-05-01&apos;;&lt;/p&gt;


&lt;p&gt;gets a error&lt;/p&gt;</description>
                <environment></environment>
        <key id="12464492">HIVE-1344</key>
            <summary>error in select disinct</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="pxiong">Pengcheng Xiong</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 May 2010 00:03:06 +0000</created>
                <updated>Thu, 12 Feb 2015 23:40:33 +0000</updated>
                            <resolved>Mon, 19 Jan 2015 18:11:01 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12867326" author="namit" created="Fri, 14 May 2010 00:03:41 +0000"  >&lt;p&gt;FAILED: Error in semantic analysis: line 1:40 Invalid Function a&lt;/p&gt;

&lt;p&gt;if T is partitioned by ds&lt;/p&gt;</comment>
                            <comment id="14282781" author="pxiong" created="Mon, 19 Jan 2015 18:05:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=namit&quot; class=&quot;user-hover&quot; rel=&quot;namit&quot;&gt;Namit Jain&lt;/a&gt;, from srcpart a select distinct a.* where a.ds=&apos;2008-04-09&apos;; now passed after patch 9194. Could you please close this one? Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12440226">HIVE-919</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12763334">HIVE-9194</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12763334">HIVE-9194</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Jan 2015 18:05:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42536</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lenr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123025</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1345] TypedBytesSerDe fails to create table with multiple columns.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1345</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Creating a table with more than one columns fails when the row format SerDe is TypedBytesSerDe. &lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; CREATE TABLE test (a STRING, b STRING) ROW FORMAT SERDE &lt;span class=&quot;code-quote&quot;&gt;&apos;org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe&apos;&lt;/span&gt;;      
Found &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe                                                       
FAILED: Error in metadata: java.lang.IndexOutOfBoundsException: Index: 1, Size: 1                                           
FAILED: Execution Error, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; code 1 from org.apache.hadoop.hive.ql.exec.DDLTask                                          
hive&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment>&lt;p&gt;JDK 6 (1.6.0_17) on Mac OSX 10.6.3, Hadoop 0.20.2, Hive 0.5.0&lt;/p&gt;</environment>
        <key id="12464572">HIVE-1345</key>
            <summary>TypedBytesSerDe fails to create table with multiple columns.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aprabhakar">Arvind Prabhakar</assignee>
                                    <reporter username="aprabhakar">Arvind Prabhakar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 May 2010 23:53:33 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:26 +0000</updated>
                            <resolved>Tue, 18 May 2010 05:49:15 +0000</resolved>
                                    <version>0.5.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                    <component>Contrib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12867801" author="aprabhakar" created="Sat, 15 May 2010 05:40:24 +0000"  >&lt;p&gt;The problem was due to incorrect parsing of the &lt;tt&gt;columnTypeProperty&lt;/tt&gt; during the initialization of &lt;tt&gt;TypedBytesSerDe&lt;/tt&gt;. This patch fixes the problem by delegating the parsing logic to the standard routine used by other SerDes - &lt;tt&gt;TypeInfoUtils.getTypeInfosFromTypeString()&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Also included in this patch is a test case that exercises this change and validates that multi-column tables can be created when using this SerDe.&lt;/p&gt;</comment>
                            <comment id="12868311" author="namit" created="Mon, 17 May 2010 17:48:32 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;will commit if the tests complete&lt;/p&gt;</comment>
                            <comment id="12868542" author="namit" created="Tue, 18 May 2010 05:49:15 +0000"  >&lt;p&gt;Committed. Thanks Arvind&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444566" name="HIVE-1345-1.patch" size="4391" author="aprabhakar" created="Sat, 15 May 2010 05:36:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 17 May 2010 17:48:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72954</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lenz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123026</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1346] Table column name changed to _col1,_col2 ..._coln when where clause used in the select quert statement</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1346</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;when where clause used in the hive query hive &lt;del&gt;ResultSetMetaData  does not give original table column name. While when where clause not used ResultSetMetaData  gives original table column names. I have used following code:&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;                        String tableName = &quot;user&quot;;&lt;br/&gt;
			String sql = &quot;select * from &quot; + tableName + &quot; where id=1&quot;;&lt;/p&gt;

&lt;p&gt;			result = stmt.executeQuery(sql);&lt;br/&gt;
			ResultSetMetaData metaData = result.getMetaData();&lt;/p&gt;

&lt;p&gt;			int columnCount = metaData.getColumnCount();&lt;br/&gt;
			for (int i = 1; i &amp;lt;= columnCount; i++) &lt;/p&gt;
{
				System.out.println(&quot;Column name: &quot; + metaData.getColumnName(i));

			}
&lt;p&gt;executing above code i got following result:-&lt;br/&gt;
Column name:_col1&lt;br/&gt;
Column name:_col2&lt;br/&gt;
while original user table columns names were (id,name).&lt;/p&gt;


</description>
                <environment>&lt;p&gt;ubuntu8.04, jdk-6,hive-0.5.0, hadoop-0.20.1&lt;/p&gt;</environment>
        <key id="12464670">HIVE-1346</key>
            <summary>Table column name changed to _col1,_col2 ..._coln when where clause used in the select quert statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="suniluiit">Sunil Kumar</assignee>
                                    <reporter username="suniluiit">Sunil Kumar</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 May 2010 11:52:40 +0000</created>
                <updated>Thu, 5 May 2011 21:12:08 +0000</updated>
                                            <version>0.5.0</version>
                    <version>0.6.0</version>
                                                    <component>Clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="12868188" author="suniluiit" created="Mon, 17 May 2010 12:07:21 +0000"  >&lt;p&gt;I have updated code in the  org.apache.hadoop.hive.ql.parse.SemanticAnalyzer java file for both server side and client side.&lt;/p&gt;</comment>
                            <comment id="12868190" author="suniluiit" created="Mon, 17 May 2010 12:09:23 +0000"  >&lt;p&gt;I have updated code in the org.apache.hadoop.hive.ql.parse.SemanticAnalyzer java file for both server side and client side. &lt;/p&gt;</comment>
                            <comment id="12868195" author="suniluiit" created="Mon, 17 May 2010 12:18:17 +0000"  >&lt;p&gt;To solve this issuse need to apply this patch  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1346&quot; title=&quot;Table column name changed to _col1,_col2 ..._coln when where clause used in the select quert statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1346&quot;&gt;HIVE-1346&lt;/a&gt;_patch.patch and    updated hive-exec-0.5.0.jar in both server side and client side&lt;/p&gt;</comment>
                            <comment id="12870855" author="namit" created="Mon, 24 May 2010 21:36:35 +0000"  >&lt;p&gt;The change looks good - can you change the comment to remove your name from it.&lt;/p&gt;</comment>
                            <comment id="12870995" author="suniluiit" created="Tue, 25 May 2010 05:12:26 +0000"  >&lt;p&gt;Hi Namit,&lt;/p&gt;

&lt;p&gt;Sure I will change and upload the new patch.&lt;/p&gt;

&lt;p&gt;Thanks and Regards.&lt;br/&gt;
Sunil Kumar&lt;br/&gt;
Extn- 2657&lt;/p&gt;

</comment>
                            <comment id="12871002" author="suniluiit" created="Tue, 25 May 2010 05:36:11 +0000"  >&lt;p&gt;Patch updated&lt;/p&gt;</comment>
                            <comment id="12871003" author="suniluiit" created="Tue, 25 May 2010 05:37:49 +0000"  >&lt;p&gt;Updated patch name removed from comment section&lt;/p&gt;</comment>
                            <comment id="12871299" author="namit" created="Tue, 25 May 2010 19:14:42 +0000"  >&lt;p&gt;The patch does not apply cleanly - can you regenerate the patch ?&lt;br/&gt;
Make sure that you do from $HIVE_TRUNK, and not $HIVE_TRUNK/ql&lt;/p&gt;</comment>
                            <comment id="12871512" author="suniluiit" created="Wed, 26 May 2010 05:48:21 +0000"  >&lt;p&gt;updated&lt;/p&gt;</comment>
                            <comment id="12872901" author="suniluiit" created="Fri, 28 May 2010 09:07:17 +0000"  >&lt;p&gt;Hi Namit,&lt;/p&gt;

&lt;p&gt; Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1346&quot; title=&quot;Table column name changed to _col1,_col2 ..._coln when where clause used in the select quert statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1346&quot;&gt;HIVE-1346&lt;/a&gt;_patch.patch ,2010-05-26 01:48 AM is now  created from $HIVE_TRUNK&lt;/p&gt;</comment>
                            <comment id="12872968" author="athusoo" created="Fri, 28 May 2010 13:25:29 +0000"  >&lt;p&gt;Hi Sunil,&lt;/p&gt;

&lt;p&gt;Have you created this patch on 0.5.0 branch or trunk? Are you  proposing that this goes into both 0.5.1 and trunk?&lt;/p&gt;</comment>
                            <comment id="12872975" author="athusoo" created="Fri, 28 May 2010 13:37:22 +0000"  >&lt;p&gt;@Namit,&lt;/p&gt;

&lt;p&gt;in what cases would colAlias ever be null. There seems to be code which checks for this around line 3314 in the trunk branch. But afaik we should always be generating a colAlias (at least the default ones). Just wanted to make sure that we are covering all the basis with this fix.&lt;/p&gt;

&lt;p&gt;Ashish&lt;/p&gt;</comment>
                            <comment id="12872984" author="suniluiit" created="Fri, 28 May 2010 13:50:29 +0000"  >&lt;p&gt;Hi Ashish,&lt;br/&gt;
I have created patch on &lt;a href=&quot;http://svn.apache.org/repos/asf/hadoop/hive/tags/release-0.5.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hadoop/hive/tags/release-0.5.0&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12968550" author="vinithra" created="Tue, 7 Dec 2010 02:31:58 +0000"  >&lt;p&gt;Can someone comment on the state of this jira: is the review pending on a modification to the patch or is the commit pending on a review? Thanks.&lt;/p&gt;</comment>
                            <comment id="12968563" author="cwsteinbach" created="Tue, 7 Dec 2010 04:05:37 +0000"  >&lt;p&gt;@Vinithra: the patch needs to be rebased to trunk and submitted for review. Another issue is that &lt;br/&gt;
this patch does not include any test output updates, which is almost certainly an oversight since this&lt;br/&gt;
change should affect the output of EXPLAIN.&lt;/p&gt;</comment>
                            <comment id="12987921" author="aprabhakar" created="Fri, 28 Jan 2011 04:04:49 +0000"  >&lt;p&gt;Updated patch with regenerated outfiles.&lt;/p&gt;</comment>
                            <comment id="12987932" author="cwsteinbach" created="Fri, 28 Jan 2011 04:33:25 +0000"  >&lt;p&gt;Review request: &lt;a href=&quot;https://reviews.apache.org/r/364/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/364/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12987933" author="cwsteinbach" created="Fri, 28 Jan 2011 04:33:40 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13029578" author="cwsteinbach" created="Thu, 5 May 2011 21:12:08 +0000"  >&lt;p&gt;Update: the original 1 line patch does not seem to address all of the problems. This needs to get reworked before it can be committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12469626" name="HIVE-1346-with-regenerated-outfiles.patch" size="833221" author="aprabhakar" created="Fri, 28 Jan 2011 04:04:49 +0000"/>
                            <attachment id="12445527" name="HIVE-1346_patch.patch" size="648" author="suniluiit" created="Wed, 26 May 2010 05:48:21 +0000"/>
                            <attachment id="12445421" name="HIVE-1346_patch.patch" size="639" author="suniluiit" created="Tue, 25 May 2010 05:37:48 +0000"/>
                            <attachment id="12444665" name="HIVE-1346_patch.patch" size="771" author="suniluiit" created="Mon, 17 May 2010 12:09:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 May 2010 21:36:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42535</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 38 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0leo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123027</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-1347] Create Pre Task hooks for Hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1347</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Create pre task hooks for hive which can modify configuration parameters or task plans. This is very useful for implementing a number of different execution policies such as&lt;/p&gt;

&lt;p&gt;1. Sending jobs that work on small data sets to a different cluster.&lt;br/&gt;
2. Sending jobs that work on archived data sets to a different cluster.&lt;/p&gt;

&lt;p&gt;etc.&lt;/p&gt;

&lt;p&gt;More details on the actual interfaces will follow soon.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12464714">HIVE-1347</key>
            <summary>Create Pre Task hooks for Hive</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 May 2010 19:14:51 +0000</created>
                <updated>Tue, 18 May 2010 19:18:37 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12868763" author="athusoo" created="Tue, 18 May 2010 18:01:38 +0000"  >&lt;p&gt;A prelimnary patch for this. Take a look at the PreTask.java interface to look at the hook interface.&lt;/p&gt;</comment>
                            <comment id="12868795" author="namit" created="Tue, 18 May 2010 19:18:37 +0000"  >&lt;p&gt;TaskRunner contains the SessionState which contains the HiveConf, from where the user info is obtained.&lt;br/&gt;
Since TaskRunner is being passed to the interface, you dont need to pass the user info explicitly&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444819" name="HIVE-1347.patch" size="7855" author="athusoo" created="Tue, 18 May 2010 18:01:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 May 2010 19:18:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0leon:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123029</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-1348] Moving inputFileChanged() from ExecMapper to where it is needed</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1348</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;inputFileChanged() is only needed for Bucketed sort merge map join. It should not be put in ExecMapper.map() where all code paths will hit this function. This function is quite expensive since JobConf look up is a hash table look up. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12464817">HIVE-1348</key>
            <summary>Moving inputFileChanged() from ExecMapper to where it is needed</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2010 17:49:12 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:32 +0000</updated>
                            <resolved>Thu, 3 Jun 2010 23:15:51 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12868946" author="he yongqiang" created="Wed, 19 May 2010 01:07:38 +0000"  >&lt;p&gt;Patch for review.&lt;/p&gt;</comment>
                            <comment id="12869224" author="nzhang" created="Wed, 19 May 2010 17:46:01 +0000"  >&lt;p&gt;Looks good in general. A few questions: &lt;br/&gt;
 1) what is the reason to change ExecMapperContext to ExecMapperLocalContext? Is the former only used in MapJoin? &lt;br/&gt;
 2) ExecMapper.memoryMXBean is made a public static member and it is only used in ExecMapperLocalContext. Is it really needed to report the memory usage there? If not necessary we can keep it as private. &lt;br/&gt;
 3) Do you need to pass ExecMapper instance to ExecMapperLocalContext? It seems it is only needed for setting the abort status. Instead of doing that, we probably should throw an exception in processMapLocalWork and the upper stream operators and eventually ExecMapper will catch that and set the abort due to the exceptions. &lt;/p&gt;
</comment>
                            <comment id="12869246" author="he yongqiang" created="Wed, 19 May 2010 18:19:24 +0000"  >&lt;p&gt;1.&lt;br/&gt;
I changed ExecMapperContext to ExecMapperLocalContext because right now it is only used for map joins. But i can revert it because &apos;ExecMapperContext &apos; is more general and can be used later for other cases.&lt;br/&gt;
2. &lt;br/&gt;
Yes. We need to use ExecMapper.memoryMXBean to report memory usage in ExecMapperLocalContext. This is because it can be used to track memory usage for mapjoin&apos;s local work. And once ExecMapper.memoryMXBean is public, it can also be used in other places.&lt;br/&gt;
3. &lt;br/&gt;
will do it.&lt;/p&gt;</comment>
                            <comment id="12869289" author="nzhang" created="Wed, 19 May 2010 19:49:14 +0000"  >&lt;p&gt;some details:&lt;/p&gt;

&lt;p&gt;1) SMBMapJoinOperator and ExecMapperContext: why not just call the function inputFileChanged() rather than maintaining another variable with the same name inputFileChanged? There is not benefit in doing that and only make it more complicated. &lt;br/&gt;
2) ExecMapper:72, execLocalContext --&amp;gt; execContext, variable name is not consistent.&lt;br/&gt;
3) MapJoin:163-167: won&apos;t these lines change the semantics of what the mapjoin operator did previously? &lt;/p&gt;</comment>
                            <comment id="12869299" author="he yongqiang" created="Wed, 19 May 2010 20:06:42 +0000"  >&lt;p&gt;1.&lt;br/&gt;
We do not want to check the conf  2 times to see if the input file has changed or not. So that&apos;s why the variable  inputFileChanged is used for.  maybe we should give a better name to &apos;inputFileChanged()&apos;  (  checkInputFileChanged() ?)&lt;br/&gt;
2.&lt;br/&gt;
i will change the variable name.&lt;br/&gt;
3.&lt;br/&gt;
No. they will not change the mapjoin behavior. Those code will only be executed one time for normal mapjoin.&lt;/p&gt;</comment>
                            <comment id="12870064" author="he yongqiang" created="Fri, 21 May 2010 17:37:10 +0000"  >&lt;p&gt;Incorporates Ning&apos;s comments. Thanks Ning.&lt;/p&gt;</comment>
                            <comment id="12870088" author="nzhang" created="Fri, 21 May 2010 18:21:27 +0000"  >&lt;p&gt;Yongqiang, I still think we should just call the function inputFileChanged() or checkInputFileChanged(). The reasons are:&lt;br/&gt;
 1) input file change could change record over record. So the only case you want to cache it is inside the processOp() itself, not cross rows. So caching the variable in ExecMapperContext doesn&apos;t make sense since it is shared across all operators and all iterations. Also making the variable inputFileChanged public and let other class change it doesn&apos;t make sense and could easily lead incorrect result. &lt;br/&gt;
 2) The only use of the variable ExecMapperContext.inputFileChanged is in SMBMapJoinOperator.procssOp() and close(). It doesn&apos;t need to be cached in ExecMapperContext (or even in a local class variable) at all IMO. Can you explain why?&lt;/p&gt;</comment>
                            <comment id="12870124" author="he yongqiang" created="Fri, 21 May 2010 19:32:11 +0000"  >&lt;p&gt;Yeah, I agree. However, the event of input file changed can only be emitted one time. If we store it in one operator, other operators may miss this event. So that&apos;s why we maintain a kind of global variable for all operators.  &lt;/p&gt;</comment>
                            <comment id="12874447" author="nzhang" created="Wed, 2 Jun 2010 06:20:03 +0000"  >&lt;p&gt;Since Yongqiang is tied up with other tasks, I&apos;m uploading a new patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1348&quot; title=&quot;Moving inputFileChanged() from ExecMapper to where it is needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1348&quot;&gt;&lt;del&gt;HIVE-1348&lt;/del&gt;&lt;/a&gt;.4.patch to simplify the ExecMapperContext and the logic to check if the input file has been changed. &lt;/p&gt;

&lt;p&gt;It differs from the previous version in the following way:&lt;/p&gt;

&lt;p&gt;1) the lastInputFile in ExecMapperContext will be only modified by resetRow() which should be called only once for each new row by the root of the operator tree &amp;#8211; ExecMapper.map(). It should not be changed by other operators throughout the operator tree. &lt;/p&gt;

&lt;p&gt;2) removed the variable inputFileChanged in ExecMapperContext and simplified the function inputFileChanged() so that it can be called by any operator in the operator tree, and can be called multiple times. &lt;/p&gt;

&lt;p&gt;3) the currentInputFile will be updated only by inputFileChanged(). If the function is not called, the variable doesn&apos;t need to be updated.&lt;/p&gt;</comment>
                            <comment id="12874646" author="he yongqiang" created="Wed, 2 Jun 2010 16:34:35 +0000"  >&lt;p&gt;Ning, thanks for updating!&lt;/p&gt;

&lt;p&gt;Overall looks good to me. Some minor comments:&lt;/p&gt;

&lt;p&gt;1. in MapjoinOperator&lt;br/&gt;
if (tag == posBigTable &amp;amp;&amp;amp; this.getExecContext().getLastInputFile() == null) {&lt;/p&gt;

&lt;p&gt;we may need to remove &quot;this.getExecContext().getLastInputFile() == null&quot; because of bucket mapjoin&lt;/p&gt;

&lt;p&gt;2. i did no see where we set the var &quot;inputFileChecked&quot; in ExecMapperContext to true.  &lt;/p&gt;</comment>
                            <comment id="12874706" author="nzhang" created="Wed, 2 Jun 2010 17:59:28 +0000"  >&lt;p&gt;Good points Yongqiang. I&apos;m uploading a new patch addressing these 2 issues. &lt;/p&gt;</comment>
                            <comment id="12874881" author="namit" created="Thu, 3 Jun 2010 00:19:37 +0000"  >&lt;p&gt;Please dont merge it yet - we may have a urgent usecase for which we might need whether input file changed or not for all combineHiveInputFormat queries.&lt;br/&gt;
I am trying to create a test, will file a jira once I have a concrete testcase&lt;/p&gt;</comment>
                            <comment id="12874948" author="nzhang" created="Thu, 3 Jun 2010 05:03:50 +0000"  >&lt;p&gt;@namit, please note that with this patch, you can call ExecMapperContext.inputFileChanged() at any operator to check if the current row is from a different file than the last row. &lt;/p&gt;</comment>
                            <comment id="12875347" author="namit" created="Thu, 3 Jun 2010 23:11:26 +0000"  >&lt;p&gt;The fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1388&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1388&lt;/a&gt; can be better insulated at CombineFileRecordReader.&lt;br/&gt;
So, there will not be any conflicts with this - will commit this one right now.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12875353" author="namit" created="Thu, 3 Jun 2010 23:15:51 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang//Ning&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12446115" name="HIVE-1348.4.patch" size="20258" author="nzhang" created="Wed, 2 Jun 2010 06:20:03 +0000"/>
                            <attachment id="12446167" name="HIVE-1348.5.patch" size="20238" author="nzhang" created="Wed, 2 Jun 2010 17:59:28 +0000"/>
                            <attachment id="12444868" name="hive-1348.1.patch" size="18716" author="he yongqiang" created="Wed, 19 May 2010 01:07:38 +0000"/>
                            <attachment id="12444969" name="hive-1348.2.patch" size="17419" author="he yongqiang" created="Wed, 19 May 2010 19:04:14 +0000"/>
                            <attachment id="12445183" name="hive-1348.3.patch" size="16459" author="he yongqiang" created="Fri, 21 May 2010 17:37:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 May 2010 01:07:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72953</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0leov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123030</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1349] Do not pull counters of non initialized jobs</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1349</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Right now hive client puts a lot of pressure on the jobtracker by pulling the counters of the job that has just been submitted and is in the process of initializing tasks.&lt;br/&gt;
While the job initialized tasks and reads the splits file it is holding the JobInProgress lock. The getCounters method acquires a JobTracker lock and waits for the JobInProgress lock. Since the read of the file can  take a couple (a couple of tens of seconds) the job tracker is effectively blocked for that period of time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12464820">HIVE-1349</key>
            <summary>Do not pull counters of non initialized jobs</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dms">Dmytro Molkov</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2010 18:40:53 +0000</created>
                <updated>Sat, 17 Dec 2011 00:04:03 +0000</updated>
                            <resolved>Wed, 19 May 2010 17:08:02 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12868818" author="dms" created="Tue, 18 May 2010 20:41:52 +0000"  >&lt;p&gt;Hey guys, take a look at the patch please.&lt;br/&gt;
When the job is created the status is PREP, it is switched to RUNNING when the setup is finished, so while the job status is PREP we are skipping the polling of counters.&lt;br/&gt;
The poll interval is also made configurable, so hive can hit jobtrackers getCounter which is not perfect less frequently.&lt;/p&gt;</comment>
                            <comment id="12868819" author="dms" created="Tue, 18 May 2010 20:43:02 +0000"  >&lt;p&gt;Submitting the patch for testing, it doesn&apos;t include a unit test with it, but I am not really sure how to test this kind of change. If you have an idea - please let me know.&lt;/p&gt;</comment>
                            <comment id="12868849" author="namit" created="Tue, 18 May 2010 21:49:52 +0000"  >&lt;p&gt;I will take a look&lt;/p&gt;</comment>
                            <comment id="12868856" author="namit" created="Tue, 18 May 2010 22:03:47 +0000"  >&lt;p&gt;Can you add the description of the new parameter: hive.exec.counters.pull.interval: in hive-default.xml ?&lt;/p&gt;</comment>
                            <comment id="12868858" author="nzhang" created="Tue, 18 May 2010 22:08:14 +0000"  >&lt;p&gt;Can you add the new hive parameter to conf/hive-default.xml as well? Other than that it looks good. &lt;/p&gt;</comment>
                            <comment id="12868908" author="dms" created="Tue, 18 May 2010 23:45:42 +0000"  >&lt;p&gt;Added the stuff to the configuration.&lt;/p&gt;</comment>
                            <comment id="12868913" author="nzhang" created="Tue, 18 May 2010 23:52:24 +0000"  >&lt;p&gt;+1. will commit after tests.&lt;/p&gt;</comment>
                            <comment id="12868944" author="nzhang" created="Wed, 19 May 2010 00:59:19 +0000"  >&lt;p&gt;This patch does not compile with hadoop 0.17. rc.getStatus() seems not available in 0.17. Can you do ant -Dhadoop.version=0.17.2.1 clean package to verify?&lt;/p&gt;</comment>
                            <comment id="12868970" author="dms" created="Wed, 19 May 2010 03:06:49 +0000"  >&lt;p&gt;Yes, agreed. I somehow thought it was building it with all the versions.&lt;br/&gt;
Is there a way to fix non hadoop-17 versions only?&lt;/p&gt;</comment>
                            <comment id="12868975" author="pauly" created="Wed, 19 May 2010 03:42:24 +0000"  >&lt;p&gt;Yes, take a look at the HadoopShims interface - there&apos;s a set of classes that implements this interface, with a a different implementation for each major Hadoop version. You can add a method to the interface that does rc.getStatus() and implement the method for the shim classes &amp;gt; 0.17. &lt;/p&gt;</comment>
                            <comment id="12868977" author="dms" created="Wed, 19 May 2010 03:47:02 +0000"  >&lt;p&gt;Thanks Paul, I just reached the same conclusion looking at shims.&lt;br/&gt;
Will try to get patch ready again soon.&lt;/p&gt;</comment>
                            <comment id="12868990" author="dms" created="Wed, 19 May 2010 04:54:54 +0000"  >&lt;p&gt;OK. Have a look at Shims implementation, does this look right?&lt;br/&gt;
I will submit for tests right away. &lt;/p&gt;</comment>
                            <comment id="12869003" author="nzhang" created="Wed, 19 May 2010 05:33:05 +0000"  >&lt;p&gt;looks good. testing now&lt;/p&gt;</comment>
                            <comment id="12869210" author="nzhang" created="Wed, 19 May 2010 17:08:02 +0000"  >&lt;p&gt;Committed. Thanks Dmytro!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444858" name="HIVE-1349.2.patch" size="3174" author="dms" created="Tue, 18 May 2010 23:45:41 +0000"/>
                            <attachment id="12444879" name="HIVE-1349.3.patch" size="8146" author="dms" created="Wed, 19 May 2010 04:54:54 +0000"/>
                            <attachment id="12444829" name="HIVE-1349.patch" size="2427" author="dms" created="Tue, 18 May 2010 20:41:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 May 2010 21:49:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lep3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123031</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-1350] hive.query.id is not unique </title>
                <link>https://issues.apache.org/jira/browse/HIVE-1350</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;if commands are executed by the same user within a second&lt;/p&gt;</description>
                <environment></environment>
        <key id="12464836">HIVE-1350</key>
            <summary>hive.query.id is not unique </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 May 2010 22:26:24 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:55 +0000</updated>
                            <resolved>Mon, 24 May 2010 20:14:08 +0000</resolved>
                                    <version>0.5.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12868884" author="jvs" created="Tue, 18 May 2010 22:52:59 +0000"  >&lt;p&gt;Random with no args is seeded by current time in millis, so when run from two different JVM&apos;s there&apos;s still a tiny chance that we can end up with the same query ID.  If we want to avoid that, we can use UUID instead:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/api/java/util/UUID.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But if we only care about uniqueness within the same JVM, then +1.&lt;/p&gt;</comment>
                            <comment id="12868916" author="cwsteinbach" created="Tue, 18 May 2010 23:54:39 +0000"  >&lt;p&gt;+1 for using UUIDs&lt;/p&gt;</comment>
                            <comment id="12868926" author="nzhang" created="Wed, 19 May 2010 00:14:11 +0000"  >&lt;p&gt;It seems like this JIRA is partly duplicate what &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1019&quot; title=&quot;java.io.FileNotFoundException: HIVE_PLAN (No such file or directory)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1019&quot;&gt;&lt;del&gt;HIVE-1019&lt;/del&gt;&lt;/a&gt; is trying to do. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1019&quot; title=&quot;java.io.FileNotFoundException: HIVE_PLAN (No such file or directory)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1019&quot;&gt;&lt;del&gt;HIVE-1019&lt;/del&gt;&lt;/a&gt; patch also uses UUID as the job ID to name the HIVE_PLAN file. But based on Zheng&apos;s comment, it will disable the resumability of failed jobs. &lt;/p&gt;

&lt;p&gt;Namit, can you take a look at the patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1019&quot; title=&quot;java.io.FileNotFoundException: HIVE_PLAN (No such file or directory)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1019&quot;&gt;&lt;del&gt;HIVE-1019&lt;/del&gt;&lt;/a&gt; particularly the newly added unit test and see if your patch passes?&lt;/p&gt;</comment>
                            <comment id="12868947" author="namit" created="Wed, 19 May 2010 01:18:09 +0000"  >&lt;p&gt;I am trying to do something simple.&lt;/p&gt;

&lt;p&gt;For the audit logs generated inside facebook, I wont to log a unique queryId - so that different map-reduce jobs can be co-related.&lt;br/&gt;
I will switch to UUIDs, but it should not affect anything&lt;/p&gt;</comment>
                            <comment id="12868951" author="namit" created="Wed, 19 May 2010 01:30:55 +0000"  >&lt;p&gt;added UUID&lt;/p&gt;</comment>
                            <comment id="12869323" author="jvs" created="Wed, 19 May 2010 20:39:30 +0000"  >&lt;p&gt;+1.  Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="12870813" author="nzhang" created="Mon, 24 May 2010 20:14:08 +0000"  >&lt;p&gt;Committed. Thanks Namit and John!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444841" name="hive.1350.1.patch" size="2568" author="namit" created="Tue, 18 May 2010 22:28:45 +0000"/>
                            <attachment id="12444870" name="hive.1350.2.patch" size="2412" author="namit" created="Wed, 19 May 2010 01:30:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 May 2010 22:52:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lepb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123032</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
