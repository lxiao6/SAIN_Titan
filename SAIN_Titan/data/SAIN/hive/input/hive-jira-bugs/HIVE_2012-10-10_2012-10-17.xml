<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:22:00 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2012-10-10+AND+created+%3C%3D+2012-10-17+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="27" total="27"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-3561] Build a full SQL-compliant parser for Hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3561</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;To build a full SQL compliant engine on Hive, we&apos;ll need a full SQL complant parser. The current Hive parser missed a lot of grammar units from standard SQL. To support full SQL there&apos;re possibly four approaches:&lt;/p&gt;

&lt;p&gt;1.Extend the existing Hive parser to support full SQL constructs. We need to modify the current Hive.g and add any missing grammar units and resolve conflicts. &lt;/p&gt;

&lt;p&gt;2.Reuse an existing open source SQL compliant parser and extend it to support Hive extensions. We may need to adapt Semantic Analyzers to the new AST structure.  &lt;/p&gt;

&lt;p&gt;3.Reuse an existing SQL compliant parser and make it co-exist with the existing Hive parser. Both parsers share the same CliDriver interface. Use a query mode configuration to switch the query mode between SQL and HQL (this is the approach we&apos;re now using in the 0.9.0 demo project)&lt;/p&gt;

&lt;p&gt;4.Reuse an existing SQL compliant parser and make it co-exist with the existing Hive parser. Use a separate xxxCliDriver interface for standard SQL.  &lt;/p&gt;


&lt;p&gt;Let&apos;s discuss which is the best approach. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12611109">HIVE-3561</key>
            <summary>Build a full SQL-compliant parser for Hive</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12607881">HIVE-3472</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shane.huang">Shane Huang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2012 02:50:31 +0000</created>
                <updated>Sun, 28 Jul 2013 05:58:40 +0000</updated>
                                            <version>0.10.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13472956" author="zhenxiao" created="Wed, 10 Oct 2012 03:03:58 +0000"  >&lt;p&gt;+1 for the first approach.&lt;/p&gt;

&lt;p&gt;HiveQL is very similar to Standard SQL, yet not exactly the same. The current Hive Parser is doing good for HiveQL.&lt;/p&gt;

&lt;p&gt;There are something missing from standardSQL, I think we could add them one by one, extending the existing parser, and maybe also add some UDFs for any missing functionality.&lt;/p&gt;</comment>
                            <comment id="13473167" author="lianhuiwang" created="Wed, 10 Oct 2012 12:06:49 +0000"  >&lt;p&gt;for the first approach,there is a problem. standardSQL can not support the HiveQL writting in historical.&lt;br/&gt;
because there is a big difference in some operators. example:join.&lt;br/&gt;
so that maybe spent a lot of time to transfering using hivesql to standardSQL.&lt;br/&gt;
in my opinion,in short time,both maybe co-exist.&lt;/p&gt;

</comment>
                            <comment id="13475092" author="gemini5201314" created="Fri, 12 Oct 2012 15:48:18 +0000"  >&lt;p&gt;why we need a full sql-compliant parser? what exactly feature we&apos;re talking about?sql-92 has some features likes Temporary tables,call level interface,Scrolling cursors etc.IMO Maybe we should discuss individual feature instead of discussing whether we need a new parser or not.&lt;/p&gt;</comment>
                            <comment id="13721883" author="appodictic" created="Sun, 28 Jul 2013 05:47:21 +0000"  >&lt;p&gt;I really do not see the big win. For the people who can write the complicated sub queries that hive can not currently do, they are usually smart enough to look in the language manual and figure out a way to re-write the query. It would be nice if every SQL construct worked, but not having full sql syntax is not a burden to most people, and supporting it all would be a burden to us.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2012 03:03:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246579</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07rtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43274</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3562] Some limit can be pushed down to map stage</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3562</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Queries with limit clause (with reasonable number), for example&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;select * from src order by key limit 10;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;makes operator tree, &lt;br/&gt;
TS-SEL-RS-EXT-LIMIT-FS&lt;/p&gt;

&lt;p&gt;But LIMIT can be partially calculated in RS, reducing size of shuffling.&lt;br/&gt;
TS-SEL-RS(TOP-N)-EXT-LIMIT-FS&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611120">HIVE-3562</key>
            <summary>Some limit can be pushed down to map stage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="navis">Navis</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2012 05:12:40 +0000</created>
                <updated>Wed, 25 Nov 2015 02:54:58 +0000</updated>
                            <resolved>Wed, 28 Aug 2013 15:02:57 +0000</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>19</watches>
                                                                <comments>
                            <comment id="13472986" author="navis" created="Wed, 10 Oct 2012 05:16:13 +0000"  >&lt;p&gt;without pushdown, &lt;br/&gt;
Map output bytes   9312&lt;br/&gt;
Map output records  500&lt;/p&gt;

&lt;p&gt;with pushdown, &lt;br/&gt;
Map output bytes    981&lt;br/&gt;
Map output records   53&lt;/p&gt;

&lt;p&gt;can be optimized further.&lt;/p&gt;</comment>
                            <comment id="13472988" author="phabricator@reviews.facebook.net" created="Wed, 10 Oct 2012 05:21:02 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-1910 Some limit can be pushed down to map stage&lt;/p&gt;

&lt;p&gt;  Queries with limit clause (with reasonable number), for example&lt;/p&gt;

&lt;p&gt;  select * from src order by key limit 10;&lt;/p&gt;

&lt;p&gt;  makes operator tree,&lt;br/&gt;
  TS-SEL-RS-EXT-LIMIT-FS&lt;/p&gt;

&lt;p&gt;  But LIMIT can be partially calculated in RS, reducing size of shuffling.&lt;br/&gt;
  TS-SEL-RS(TOP-N)-EXT-LIMIT-FS&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/14199/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/14199/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13500118" author="snarayanan" created="Mon, 19 Nov 2012 10:16:15 +0000"  >&lt;p&gt;I&apos;m interested in this particular optimization. Let&apos;s say the table src have N rows and we&apos;re interested in top-K. If the rows in T are in almost descending order and we&apos;re interested in ascending Top-K (this is very likely when ordering by timestamps), then the number of memcopies will be N * K. See code fragment:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isTopN(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] key) {
+      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; index = Arrays.binarySearch(keys, key, C);
+      index = index &amp;lt; 0 ? -index -1 : index;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (index &amp;gt;= keys.length - 1) {
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+      }
+      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.arraycopy(keys, index, keys, index + 1, keys.length - index - 1);
+      keys[index] = Arrays.copyOf(key, key.length);
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You could use a linked list, but binary search is not an option in that case.&lt;/p&gt;

&lt;p&gt;An alternate approach to the problem is to use a combination of Hive and Hadoop changes.&lt;/p&gt;

&lt;p&gt;Hadoop change:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;New parameter map.sort.limitrecords which determines how many records each mapper in a job will send to every reducer&lt;/li&gt;
	&lt;li&gt;When writing out local files after sorting, map-task stops after map.sort.limitrecords records for each reducer&lt;/li&gt;
	&lt;li&gt;Effectively, each mapper sends out its top-K records&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Hive change:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Determining when the Top-K optimization is applicable and setting K in ReduceSinkDesc&lt;/li&gt;
	&lt;li&gt;Passing the K value along to MapredWork&lt;/li&gt;
	&lt;li&gt;ExecDriver sets map.sort.limitrecords before executing the job corresponding to the MapredWork&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This change will reduce the amount of I/O that happens on the map-side (writing only 10 rows per reducer as opposed to entire table) and can have a big effect on performance. Furthermore, it is possible to make the sort on the mapper side a top-k sort which can further improve performance - but the deep pocket is really the I/O savings. In my experiments, I see a 5x performance improvement for such queries.&lt;/p&gt;</comment>
                            <comment id="13500165" author="snarayanan" created="Mon, 19 Nov 2012 11:34:25 +0000"  >&lt;p&gt;Apologies, you can use a heap to maintain a top-k as opposed to an array or a linked list. &lt;/p&gt;

&lt;p&gt;You may also want to consider the case where the top-k do not fit in memory. One possibility would be to employ this optimization only if K is less than some threshold.&lt;/p&gt;

&lt;p&gt;This approach has the advantage that it is a Hive-only change and does not depend on a Hadoop change. That is a pretty big plus.&lt;/p&gt;</comment>
                            <comment id="13511402" author="namit" created="Thu, 6 Dec 2012 14:12:51 +0000"  >&lt;p&gt;I think it would be simple to keep it a hive only change.&lt;br/&gt;
I agree that Hadoop change is more general, but it may be painful/time-consuming to backport.&lt;br/&gt;
In most of the cases, k would be small, and it makes perfect sense to put a limit on k, as you suggested above.&lt;/p&gt;

&lt;p&gt;What do you think ?&lt;br/&gt;
Should we go with the hive-only change ?&lt;/p&gt;</comment>
                            <comment id="13511418" author="snarayanan" created="Thu, 6 Dec 2012 14:34:39 +0000"  >&lt;p&gt;Hive-only change is fine. A heap-based isTopN() implementation will be good.&lt;/p&gt;</comment>
                            <comment id="13511434" author="namit" created="Thu, 6 Dec 2012 14:57:55 +0000"  >&lt;p&gt;Cool, can you also review ?&lt;br/&gt;
I will start reviewing too.&lt;/p&gt;</comment>
                            <comment id="13511441" author="namit" created="Thu, 6 Dec 2012 15:08:35 +0000"  >&lt;p&gt;comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13511442" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 15:09:08 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  As per jira comments, can you add a new parameter for the limit on k ?&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:73 Instead of checking for instanceof, can you add a method in Operator() - something like&lt;br/&gt;
  canLimitBePushed() with a lot of comments, and then the above operators can have this to true.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:358  Can you add a heap based implementation as suggested in jira ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:86 Can you add lot of comments here - when is this set ?&lt;br/&gt;
  what queries will it benefit etc. ?&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:460 add these in hive-default.xml.template&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:7 can you add another positive/negative test ?&lt;/p&gt;

&lt;p&gt;  explain select value, sum(key) from src group by value limit 10;&lt;/p&gt;

&lt;p&gt;  The limit should be used in the 2nd MR job if u r inserting into a table.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:10 For the 2 negative queries, can you insert into a table also -&lt;br/&gt;
  then the optm. should help&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13511477" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 15:55:08 +0000"  >&lt;p&gt;tarball has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Not sure if I&apos;m following the right protocol here. Marking this as &quot;Request Changes&quot; per my comments.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:460 Minor suggestion, feel free to ignore &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Prefer parameter name  &quot;hive.limit.twophase.enable&quot;.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:129 Why not limit 0 (unless hive optimizes those away)?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:305 Is this variable not used at all?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:323 This code seems error prone. It has a side effect that&apos;s difficult to understand - it is not obvious that the caller must wipe out value before the next row is processed. Any particular reason we&apos;re caching it at all?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:346 If o1 and o2 are null, shouldn&apos;t this return 0?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1910&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13511482" author="snarayanan" created="Thu, 6 Dec 2012 16:00:39 +0000"  >&lt;p&gt;Added my comments to Phabricator. I&apos;m new to these tools and the process. So, please forgive any mistakes on my part. &lt;/p&gt;

&lt;p&gt;Good stuff, Navis!&lt;/p&gt;</comment>
                            <comment id="13527685" author="navis" created="Mon, 10 Dec 2012 02:14:13 +0000"  >&lt;p&gt;I just wanted to start small not affecting flow over operators but.. ok, I&apos;ll do it.&lt;/p&gt;</comment>
                            <comment id="13527759" author="phabricator@reviews.facebook.net" created="Mon, 10 Dec 2012 08:03:19 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;br/&gt;
Reviewers: JIRA, tarball&lt;/p&gt;

&lt;p&gt;  Addressed some comments (submitting for fail-fast review)&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13527803" author="phabricator@reviews.facebook.net" created="Mon, 10 Dec 2012 09:43:20 +0000"  >&lt;p&gt;tarball has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  conf/hive-default.xml.template:1407 Why is optimization disabled by default? This is good stuff and should be switched on!&lt;br/&gt;
  conf/hive-default.xml.template:1413 10 million seems like a really large threshold. Maybe in the 50k range?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:378 The current implementation doesn&apos;t look like a heap to me. Why not simply use java.util.PriorityQueue?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:383 Shouldn&apos;t nulls be equal to each other?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:379 Better name? TopNHeap?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1910&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13528572" author="phabricator@reviews.facebook.net" created="Tue, 11 Dec 2012 01:27:20 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Is this right direction?&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  conf/hive-default.xml.template:1407 It&apos;s like a convention. When this patch is believed to be fully stable, it&apos;ll be so.&lt;br/&gt;
  conf/hive-default.xml.template:1413 It&apos;s size of memory, not number of rows. 10M seemed to be conservative enough.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:378 I just wanted to keep it compact as is possible because this can be used with map aggregation. I&apos;m thinking of interface which can be implemented by user and configured to be used for this.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:383 In RS, o2 is the key and cannot be null and also, making this class support null key needs some more works. I just ignored that case but yes, some comments could be useful at the least.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1910&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13533636" author="namit" created="Mon, 17 Dec 2012 04:22:03 +0000"  >&lt;p&gt;comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13533638" author="phabricator@reviews.facebook.net" created="Mon, 17 Dec 2012 04:24:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  The general direction looks OK&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:79 TODO&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:45 spelling: operator&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:79 Followup: add a new method in Operator.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:26 Looks like this optimization should also help if the limit is in a sub-query:&lt;br/&gt;
  Can you add a test ?&lt;/p&gt;

&lt;p&gt;  something like:&lt;/p&gt;

&lt;p&gt;  select ..  from&lt;br/&gt;
  (select key, count(1) from src group by key order by key limit 2) subq&lt;br/&gt;
  join&lt;br/&gt;
  (select key, count(1) from src group by key order by key limit 2) subq2 ..&lt;/p&gt;


&lt;p&gt;  The optimization should be applied to both the sub-queries&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1910&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13542639" author="phabricator@reviews.facebook.net" created="Thu, 3 Jan 2013 01:22:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;br/&gt;
Reviewers: JIRA, tarball&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;br/&gt;
  Prevent multi-GBY single-RS case&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13542689" author="snarayanan" created="Thu, 3 Jan 2013 03:43:41 +0000"  >&lt;p&gt;Looks good to me. +1&lt;/p&gt;</comment>
                            <comment id="13542690" author="phabricator@reviews.facebook.net" created="Thu, 3 Jan 2013 03:44:11 +0000"  >&lt;p&gt;tarball has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Looks good to me. +1&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13546643" author="phabricator@reviews.facebook.net" created="Tue, 8 Jan 2013 06:16:12 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  conf/hive-default.xml.template:1434 Can you add more details here - a example query would really help ?&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:16 What is so special about 40 ?&lt;/p&gt;

&lt;p&gt;  set hive.limit.pushdown.heap.threshold explicitly at the beginning of the test, makes the&lt;br/&gt;
  test easier to maintain in the long run.&lt;/p&gt;

&lt;p&gt;  ql/src/test/queries/clientpositive/limit_pushdown.q:34 What is the difference between this and line 3 ?&lt;/p&gt;

&lt;p&gt;  ql/src/test/queries/clientpositive/limit_pushdown.q:10 I think this plan is not correct.&lt;/p&gt;

&lt;p&gt;  Let us say, the values are&lt;br/&gt;
  v1&lt;br/&gt;
  v2&lt;br/&gt;
  ..&lt;br/&gt;
  v10&lt;br/&gt;
  v11&lt;br/&gt;
  v12&lt;br/&gt;
  ..&lt;br/&gt;
  v20&lt;/p&gt;

&lt;p&gt;  The first mapper does not have v8-10, so it emits v1-v7, v11-v13&lt;br/&gt;
  The second mapper contains data for all values, but it only emits v1-v10&lt;/p&gt;

&lt;p&gt;  Since it does not involves a order by, it is possible that the data for v11 will get picked up, which does not contain data from the second mapper. If you are pushing the limit up, you should create an additional MR job which orders the rows - in the above example, making sure that only v1-v10 are picked up.&lt;/p&gt;

&lt;p&gt;  Am I missing something here ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13546648" author="namit" created="Tue, 8 Jan 2013 06:28:41 +0000"  >&lt;p&gt;comments&lt;/p&gt;</comment>
                            <comment id="13546649" author="phabricator@reviews.facebook.net" created="Tue, 8 Jan 2013 06:30:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:75 remove the TODO&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:51 There is no test where the limit is &amp;gt; hive.limit.pushdown.heap.threshold.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:87 Do you want to compare the threshold with the actual limit here ?&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13546661" author="phabricator@reviews.facebook.net" created="Tue, 8 Jan 2013 06:56:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Sorry, my earlier comments were assuming that the threshold is for number of rows&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:483 Coming to a earlier comment from Sivaramakrishnan Narayanan, would it be simpler if this was the number of rows ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:414 Define 40 as a constant somewhere&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13546703" author="phabricator@reviews.facebook.net" created="Tue, 8 Jan 2013 08:42:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  I thought about it, even with group bys, my question is still valid.&lt;br/&gt;
  I think, there is a bug.&lt;/p&gt;

&lt;p&gt;  Do you think it would be simpler to allocate a heap with (upto) topN entries instead - throw&lt;br/&gt;
  the memory threshold out. If limit &amp;lt; threshold, use this optimization, otherwise just ignore this&lt;br/&gt;
  optimization.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:441 Isn&apos;t there a bug here ?&lt;/p&gt;

&lt;p&gt;  You are using keyValues last entry to figure out whether it needs to be expanded or not.&lt;br/&gt;
  It may have an issue at the boundary - say entry 40th when a legit. entry is found.&lt;br/&gt;
  It might be simpler to pass the fact whether the entry was found or not.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:468 This is not true if an entry is being inserted in between.&lt;br/&gt;
  I mean, if topN is 100, and we already have 100 entries.&lt;/p&gt;

&lt;p&gt;  If we are inserting 50th entry, we should not be increasing usage&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13546822" author="phabricator@reviews.facebook.net" created="Tue, 8 Jan 2013 12:14:12 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  I think I&apos;m wrong about GBY cases. Should be fixed definitely (in next week, maybe).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13563464" author="phabricator@reviews.facebook.net" created="Sat, 26 Jan 2013 12:07:11 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  I&apos;m also confusing about GBY cases. I mean group by query with &quot;no ordering&quot; clause, for example,&lt;/p&gt;

&lt;p&gt;  select key,count(value) from src group by key limit 10;&lt;/p&gt;

&lt;p&gt;  I think top-K is still applicable. If key is ranged from K1 to K100, all values for K1~K10 from any mapper are transferred to reducer, which makes valid result. Isn&apos;t it?&lt;/p&gt;

&lt;p&gt;  And for changing threshold from memory to row count, map aggregation would be a good example, which is using memory percent. I also think current implementation is too clumsy, but general direction is right.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13613611" author="phabricator@reviews.facebook.net" created="Tue, 26 Mar 2013 08:25:14 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  1. Used Heap for ORDER BY and Map for GROUP BY&lt;br/&gt;
  2. Added tests for spill/break&lt;br/&gt;
  3. Changed to use percentage for memory threshold&lt;/p&gt;

&lt;p&gt;Reviewers: tarball, JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=24861&amp;amp;id=30483#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=24861&amp;amp;id=30483#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHashForGBY.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13619381" author="navis" created="Tue, 2 Apr 2013 00:48:56 +0000"  >&lt;p&gt;Passed all tests&lt;/p&gt;</comment>
                            <comment id="13640368" author="namit" created="Wed, 24 Apr 2013 12:12:53 +0000"  >&lt;p&gt;can you refresh ?&lt;/p&gt;</comment>
                            <comment id="13642489" author="phabricator@reviews.facebook.net" created="Fri, 26 Apr 2013 01:38:13 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Refactoring &amp;amp; bug fix&lt;/p&gt;

&lt;p&gt;Reviewers: tarball, JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=30483&amp;amp;id=32943#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=30483&amp;amp;id=32943#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/join_vc.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/join_vc.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13668536" author="gopalv" created="Tue, 28 May 2013 18:33:35 +0000"  >&lt;p&gt;I have implemented a similar fix as a Combiner in MR (LimitNKeys and LimitNValues) instead of using a hash/heap in-memory.&lt;/p&gt;

&lt;p&gt;This seems to be a lot more memory friendly since it doesn&apos;t need any extra memory, but it doesn&apos;t help the speed of the sort operations as the data size reduction is post-sort.&lt;/p&gt;

&lt;p&gt;And since it works for any writable, it only needs a simple single class implementation (no comparators within the combiner).&lt;/p&gt;

&lt;p&gt;The combiner is only run if there are multiple spills, but if the combiner can be forced by setting &quot;min.num.spills.for.combine&quot; = 0, then we can set a top-k (unique keys/values) selection sort via &quot;map.sort.class&quot; config instead of the default QuickSort impl, without any change to the hadoop core at all.&lt;/p&gt;</comment>
                            <comment id="13738847" author="ashutoshc" created="Tue, 13 Aug 2013 21:19:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gopalv&quot; class=&quot;user-hover&quot; rel=&quot;gopalv&quot;&gt;Gopal V&lt;/a&gt; Your approach sounds interesting, lot less intrusive and memory friendly indeed. If you still have a patch around this, would you like to post it?&lt;/p&gt;</comment>
                            <comment id="13739324" author="hiveqa" created="Wed, 14 Aug 2013 07:06:39 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 no tests executed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12580643/HIVE-3562.D5967.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12580643/HIVE-3562.D5967.5.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/429/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/429/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/429/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/429/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Tests failed with: NonZeroExitCodeException: Command &apos;bash /data/hive-ptest/working/scratch/source-prep.sh&apos; failed with exit status 1 and output &apos;+ [[ -n &apos;&apos; ]]
+ export &apos;ANT_OPTS=-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ ANT_OPTS=&apos;-Xmx1g -XX:MaxPermSize=256m -Dhttp.proxyHost=localhost -Dhttp.proxyPort=3128&apos;
+ cd /data/hive-ptest/working/
+ tee /data/hive-ptest/logs/PreCommit-HIVE-Build-429/source-prep.txt
+ mkdir -p maven ivy
+ [[ svn = \s\v\n ]]
+ [[ -n &apos;&apos; ]]
+ [[ -d apache-svn-trunk-source ]]
+ [[ ! -d apache-svn-trunk-source/.svn ]]
+ [[ ! -d apache-svn-trunk-source ]]
+ cd apache-svn-trunk-source
+ svn revert -R .
Reverted &apos;serde/src/java/org/apache/hadoop/hive/serde2/ColumnProjectionUtils.java&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join2.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input2.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join3.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input3.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join4.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input4.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join5.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input5.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join6.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input_testxpath2.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input6.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join7.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input7.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input_testsequencefile.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input8.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join8.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/union.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input9.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/udf1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/udf4.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input_testxpath.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/udf6.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input_part1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/udf_case.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby2.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/subq.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby3.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby4.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby5.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/groupby6.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/case_sensitivity.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/udf_when.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input20.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample2.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample3.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample4.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample5.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample6.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/sample7.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/cast1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/join1.q.xml&apos;
Reverted &apos;ql/src/test/results/compiler/plan/input1.q.xml&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestIntegerCompressionReader.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestBitFieldReader.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRunLengthIntegerReader.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRunLengthByteReader.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestBitPack.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestInStream.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestOrcFile.java&apos;
Reverted &apos;ql/src/test/org/apache/hadoop/hive/ql/io/sarg/TestSearchArgumentImpl.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/exec/TableScanOperator.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/Reader.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/BitFieldReader.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/RecordReaderImpl.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/OrcSerde.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/RunLengthByteReader.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/InStream.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/orc/ReaderImpl.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/sarg/SearchArgument.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/sarg/SearchArgumentImpl.java&apos;
Reverted &apos;ql/src/java/org/apache/hadoop/hive/ql/io/HiveInputFormat.java&apos;
++ awk &apos;{print $2}&apos;
++ egrep -v &apos;^X|^Performing status on external&apos;
++ svn status --no-ignore
+ rm -rf build hcatalog/build hcatalog/core/build hcatalog/storage-handlers/hbase/build hcatalog/server-extensions/build hcatalog/webhcat/svr/build hcatalog/webhcat/java-client/build hcatalog/hcatalog-pig-adapter/build common/src/gen ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRecordReaderImpl.java
+ svn update

Fetching external item into &apos;hcatalog/src/test/e2e/harness&apos;
External at revision 1513744.

At revision 1513744.
+ patchCommandPath=/data/hive-ptest/working/scratch/smart-apply-patch.sh
+ patchFilePath=/data/hive-ptest/working/scratch/build.patch
+ [[ -f /data/hive-ptest/working/scratch/build.patch ]]
+ chmod +x /data/hive-ptest/working/scratch/smart-apply-patch.sh
+ /data/hive-ptest/working/scratch/smart-apply-patch.sh /data/hive-ptest/working/scratch/build.patch
The patch does not appear to apply with p0 to p2
+ exit 1
&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13740269" author="gopalv" created="Wed, 14 Aug 2013 22:05:32 +0000"  >&lt;p&gt;I have created &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5093&quot; title=&quot;Use a combiner for LIMIT with GROUP BY and ORDER BY operators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5093&quot;&gt;&lt;del&gt;HIVE-5093&lt;/del&gt;&lt;/a&gt; to hold my limit combiner patch (rebased to trunk &amp;amp; turned off by default).&lt;/p&gt;</comment>
                            <comment id="13744568" author="phabricator@reviews.facebook.net" created="Tue, 20 Aug 2013 00:42:52 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Rebased to trunk&lt;/p&gt;

&lt;p&gt;Reviewers: tarball, JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=32943&amp;amp;id=38379#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=32943&amp;amp;id=38379#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13744728" author="hiveqa" created="Tue, 20 Aug 2013 05:45:46 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12598877/HIVE-3562.D5967.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12598877/HIVE-3562.D5967.6.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 2886 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/482/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/482/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/482/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/482/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13747625" author="ashutoshc" created="Thu, 22 Aug 2013 16:18:47 +0000"  >&lt;p&gt;As always, high quality work, Navis! &lt;br/&gt;
Left few implementation comments on phabricator. Most important ones are:&lt;br/&gt;
1. Is it possible to use one DataStructure (TreeSet probably) for two implementations of ReduceSinkHash. If so, that will simplify this code quite a bit.&lt;br/&gt;
2. Not sure how RS corresponding to distinct will be handled with this optimization. So, I requested for test cases for it.&lt;/p&gt;

&lt;p&gt;Cool stuff. Lets get this in!&lt;/p&gt;</comment>
                            <comment id="13747626" author="phabricator@reviews.facebook.net" created="Thu, 22 Aug 2013 16:18:55 +0000"  >&lt;p&gt;ashutoshc has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:528 I think we don&apos;t need a boolean flag. If user has set hive.limit.pushdown.memory.usage=0 it is pretty clear he wants the optimization to be disabled.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:1187 I didnt fully follow the example here. What are the keys/values/rows here?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:154 select key from src limit 0; implies user doesn&apos;t want any data, so RS doesnt need to emit any thing, this optimization is still valid and super useful here. Isn&apos;t it? So, this should be limit &amp;lt; 0, instead limit &amp;lt;=0&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:157 Can you add a comment why you are subtracting limit * 64 in this calculation of threshold?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:171 I think we need not to special handle limit = 0 by null&apos;ing the collector. As I said above better is to make RSHash to null in that case. This avoids a null check of collector in processOp().&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:325 As I noted above, lets not have this null check. Apart from you null&apos;ing the collector above, could there ever be case when it will be null. I dont think so, in that case lets remove this if-branch from inner loop.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:340 Shall this be instead collect(keyWritable, value) ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:343 Didn&apos;t get your comment for retry here. Can you add more comment for it?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:346 collect() instead of out.collect() ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:434-436 transient?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:471 It will be good to add a LOG.DEBUG() here saying, disabling ReduceSinkHash.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:477 I didn&apos;t get your TODO here. Can you explain?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:495 Better name: remove ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:498 Add a comment here saying values&lt;span class=&quot;error&quot;&gt;&amp;#91;index&amp;#93;&lt;/span&gt; could be null, if flush() was called after this value is added but before remove() is called.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:535 You are using PriorityQueue almost like a sorted set.  I think java.util.TreeSet will suffice what you need here.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:566 I dont see you making use of any feature corresponding to Map interface. Looks like TreeSet would be sufficient here as well.&lt;/p&gt;

&lt;p&gt;  If it so that at both places we can use TreeSet than we do need not these two diff implementation of ReduceSinkHash. This will simplify code quite a bit.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:253-264 This handling of distinct keys case can also be refactored to use ReduceSinkHash. Will be a good idea to take this up in a follow up jira.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:535 Also need to mark it transient.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:91 If we are able to use one DataStructure in ReduceSinkHash (either TreeSet or some other) for both cases, we wont need this boolean.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:46 How are enforcing this condition of applying this optimization only for last RS. Can you add comments about this.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:14 Can you also add a test for following query with this optimization on:&lt;br/&gt;
  explain select distinct(key) from src limit 20;&lt;br/&gt;
  explain select count(distinct(key)) from src group by key limit 20;&lt;/p&gt;

&lt;p&gt;  select distinct(key) from src limit 20;&lt;br/&gt;
  select count(distinct(key)) from src group by key limit 20;&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:43 It will be good to seprate these queries where optimization will not be fired in a seprate .q file.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13747635" author="appodictic" created="Thu, 22 Aug 2013 16:27:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;1. Is it possible to use one DataStructure (TreeSet probably) for two implementations of ReduceSinkHash. If so, that will simplify this code quite a bit.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think we are better off using the MinMaxPriorityQueue&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://highscalability.com/blog/2013/5/22/strategy-stop-using-linked-lists.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://highscalability.com/blog/2013/5/22/strategy-stop-using-linked-lists.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Structures that use Node&apos;s are really inefficient in java. The pointers bloat the structure, and the non-local memory access and causes a lot of cache misses. I benched a similar scenario sorting large tree sets, and even though the big O is smaller (believe it or not) to sort a list then maintain a treeSet.  MinMaxPriorityQueue has a middle-ground implementation which real world works much faster then TreeSet. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.ArrayList;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Collection;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Collections;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.LinkedList;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.List;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Random;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.TreeSet;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TreeSetTest {

    &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Random r = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Random();
   
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; [] args){
       
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        {
        List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
        doIt(500000,arrayList);
        sortIt(arrayList);
        }
        {
            List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
            doIt(500000,arrayList);
            sortIt(arrayList);
            }
        {
            List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
            doIt(500000,arrayList);
            sortIt(arrayList);
            }
       
        {
            List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
            doIt(500000,arrayList);
            sortIt(arrayList);
            }
        {
            List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
            doIt(500000,arrayList);
            sortIt(arrayList);
            }
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        doIt(500000,&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;());
        {
            List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; arrayList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LinkedList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;();
            doIt(500000,arrayList);
            sortIt(arrayList);
            }
       
       
    }
   
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void sortIt(List l){
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; start = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        Collections.sort(l);
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; end = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(l.getClass().getName()+&lt;span class=&quot;code-quote&quot;&gt;&quot; sort it &quot;&lt;/span&gt;+ (end-start));
    }
   
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void doIt(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; n, Collection l){
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; start = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i =0;i&amp;lt;n;i++){
            randomDouble(l);
        }
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; end = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(l.getClass().getName()+&lt;span class=&quot;code-quote&quot;&gt;&quot; add it &quot;&lt;/span&gt;+ (end-start));
    }
   
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void randomDouble(Collection l){
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rangeMin=0;
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rangeMax=20000000;
              
        &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; randomValue = rangeMin + (rangeMax - rangeMin) * r.nextDouble();
        l.add(randomValue);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13747643" author="ashutoshc" created="Thu, 22 Aug 2013 16:36:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; Can you also add a test case for following query with both this optimization on as well as reducesink dedup optimization on? This will trigger a case for one merged RS for both group by and order by.&lt;br/&gt;
 select value,avg(key) from src group by value order by value limit 20;&lt;/p&gt;</comment>
                            <comment id="13747647" author="ashutoshc" created="Thu, 22 Aug 2013 16:41:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appodictic&quot; class=&quot;user-hover&quot; rel=&quot;appodictic&quot;&gt;Edward Capriolo&lt;/a&gt; I dont care which DS you pick, I am looking for simplicity of implementation. Current patch has two implementation for RSHash which only differs on choice of DS and it appears to me that in both cases underlying DS is used in very similar fashion. If one can be used (whichever it is), this will make code simpler to read, understand and less bug prone.&lt;/p&gt;</comment>
                            <comment id="13747649" author="appodictic" created="Thu, 22 Aug 2013 16:42:52 +0000"  >&lt;p&gt;Makes sense.&lt;/p&gt;</comment>
                            <comment id="13748676" author="ashutoshc" created="Fri, 23 Aug 2013 16:18:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; It occurred to me that this optimization will become very powerful in combination with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4002&quot; title=&quot;Fetch task aggregation for simple group by query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4002&quot;&gt;&lt;del&gt;HIVE-4002&lt;/del&gt;&lt;/a&gt; Imagine a case where there is a limit which can be pushed up in front of last RS. Than mappers will output very little data and with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4002&quot; title=&quot;Fetch task aggregation for simple group by query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4002&quot;&gt;&lt;del&gt;HIVE-4002&lt;/del&gt;&lt;/a&gt; we can eliminate reducer altogether. Though these two optimizations cannot occur simultaneously in their current form since RSHash is implemented inside RS. We need to reimplement RSHash in FS. Alternative approach could be to implement RSHash as an operator which can than be put in front of either RS or FS. What do you think?&lt;/p&gt;</comment>
                            <comment id="13748683" author="yhuai" created="Fri, 23 Aug 2013 16:31:49 +0000"  >&lt;p&gt;Implementing RSHash as an operator sounds good. We can also use it in front of the RS of the right table of left semi join. Right now, there is a GBY. It is not straightforward in the query plan.&lt;/p&gt;</comment>
                            <comment id="13749290" author="phabricator@reviews.facebook.net" created="Sat, 24 Aug 2013 03:56:52 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Thanks for a review.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:528 I thought it&apos;s a convention of hive to make configurations for enable/disable and threshold each, which was requested several times till now for me for other issues. I&apos;ll address that.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:1187 Legend : A(a) --&amp;gt; key A, value a, row A(a)&lt;/p&gt;

&lt;p&gt;  If each mapper takes rows lite this&lt;br/&gt;
  MAP1(RS) : 40(a)-10(b)-30(c)-10(d)-70(e)-80(f)&lt;br/&gt;
  MAP2(RS) : 90(g)-80(h)-60&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;-40(j)-30(k)-20(l)&lt;br/&gt;
  MAP3(RS) : 40(m)-50&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;-30(o)-30(p)-60(q)-70(r)&lt;/p&gt;

&lt;p&gt;  REDUCER : 10(b,d)-20(l)-30(c,k,o)-40(a,j,m)-50&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;-60(i,q)-70(e,r)-80(f,h)-90(g)&lt;br/&gt;
  REDUCER(LIMIT 3) : 10(b,d)-20(l)-30(c,k,o)&lt;/p&gt;

&lt;p&gt;  with this patch&lt;/p&gt;

&lt;p&gt;  MAP1 : 40(a)-10(b)-30(c)-10(d)&lt;br/&gt;
  MAP2 : 40(j)-30(k)-20(l)&lt;br/&gt;
  MAP3 : 40(m)-50&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;-30(o)-30(p)&lt;/p&gt;

&lt;p&gt;  REDUCER : 10(b,d)-20(l)-30(c,k,o)-40(a,j,m)-50&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
  REDUCER(LIMIT 3) : 10(b,d)-20(l)-30(c,k,o)&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:154 I thought limit 0 is not realistic and can be used for some kind of testing. I&apos;ll address that case but making Hash seemed a little much.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:157 ReduceSinkHash makes arrays for key/value/hashes. It&apos;s for compensating those (not exact but I like the number).&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:325 I think there was a test for RS operator which has no collector. I&apos;ll check that.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:340 Right. I&apos;ve missed that.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:343 It&apos;s possible to add key/value to hash which is flushed right before. But I just forwarded it.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:346 Right.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:434-436 It&apos;s not serializable class. But I&apos;ll add transient mod.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:471 I&apos;ll leave log message in the processOp() method.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:477 Return value can be false only if it&apos;s for GBY. False means the key exists already in RS hash.&lt;br/&gt;
  For case A(a)&lt;del&gt;&amp;gt;A(b)&lt;/del&gt;&amp;gt;B(c) with limit 5, the first A(a) will be stored into hash. For the second A(b), value b should be stored, which means values should be byte[][][] using additional array for each index consuming more memory. But I suspected that case could be a common case with map aggregation. So I just decided to forward A(b) to output collector.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:495 It does not remove anything. This is called after index is removed from RS hash.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:498 Good.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:535 Main difference of HashForOrder from HashForGroupBy is that it should store duplicated keys. As described in comments, A-&amp;gt;B-&amp;gt;B-&amp;gt;C limit 3 should store A,B,B not A,B,C. I believe this behavior can be possibly implemented with simple TreeSet but thought this is way simpler.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:566 I prefer Map rather than Set but I&apos;ll change that.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:14 ok&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:43 ok.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:46 This is not exact description. RS for limit (not last RS). I&apos;ll change this, too.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:253-264 Looks promising. Need more investigation on implementation of distinct.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13749292" author="navis" created="Sat, 24 Aug 2013 04:05:30 +0000"  >&lt;p&gt;I think RSHash should be a entity that can be used in various operators but not independent operator, because the behavior might be dependent to each operator. In current implementation, I&apos;ve modified RS only but the better way to implement this is calculating limit for each operators (bottom up way like CP or PPD) and make HASH for them. (Limit for GBY should be handled in GBY and for simple limit, RS, etc.)&lt;/p&gt;

&lt;p&gt;There seemed remain much works to do. &lt;/p&gt;</comment>
                            <comment id="13749296" author="ashutoshc" created="Sat, 24 Aug 2013 04:21:44 +0000"  >&lt;p&gt;I agree that will be quite a bit of work and given that this patch is out there for long, We should try to get this in without major rework. Though, I think hash for FS will make this optimization with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4002&quot; title=&quot;Fetch task aggregation for simple group by query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4002&quot;&gt;&lt;del&gt;HIVE-4002&lt;/del&gt;&lt;/a&gt; real cool.  &lt;/p&gt;</comment>
                            <comment id="13749302" author="navis" created="Sat, 24 Aug 2013 04:38:49 +0000"  >&lt;p&gt;Then, FS will be needed for context of limiting rows(limit, key expressions, etc.). I&apos;ll consider that, too.&lt;/p&gt;</comment>
                            <comment id="13749303" author="ashutoshc" created="Sat, 24 Aug 2013 04:41:23 +0000"  >&lt;p&gt;Correct. Thanks a lot for considering. I am fine doing that in seprate jira. FSHashSink will expand scope of this jira unnecessarily.&lt;/p&gt;</comment>
                            <comment id="13749306" author="phabricator@reviews.facebook.net" created="Sat, 24 Aug 2013 04:46:52 +0000"  >&lt;p&gt;ashutoshc has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Good stuff!&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:528 Yeah I know historically we have done that way. But in my experience having more configs always confuses users instead of helping.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:1187 Looks good. Can you update the patch with this?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:157 Sounds good. Please add it in comment.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:325 Sounds good.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:343 I see. I think just forwarding in this case is simple and better thing to do. So, lets leave it that way. Can you add a comment saying its possible to retry to add this to hash, but we don&apos;t do that yet. Also, collect()&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:434-436 Ah.. right. Than better not to add transient, otherwise will cause confusion.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:477 I see. Can you add comment here that further optimization like this is possible here. We can do this later.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:495 OK.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:535 I see. Missed this difference of duplicates. My major motivation in trying to unifying these two is so that in optimization rule we need not to worry about detecting whether there is a GBY in mapper or not.&lt;br/&gt;
  If using TreeSet will not over complicate this, I will suggest that. But if that complicates things too much here, I am fine with current implementation as well. I will let you decide on that.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:566 Here, using Set is definitely cleaner (and memory efficient) as far as I can see.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:46 Thanks.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:14 Thanks. Also, as I said in comment add&lt;br/&gt;
  select value,avg(key) from src group by value order by value limit 20;&lt;br/&gt;
  with reduce sink dedup optimization on.&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q:43 Thanks.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13749927" author="phabricator@reviews.facebook.net" created="Mon, 26 Aug 2013 09:01:00 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Addressed some comments&lt;/p&gt;

&lt;p&gt;Reviewers: ashutoshc, JIRA, tarball&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=38379&amp;amp;id=39009#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=38379&amp;amp;id=39009#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13750007" author="phabricator@reviews.facebook.net" created="Mon, 26 Aug 2013 11:18:52 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Missed ASF header&lt;br/&gt;
  Removed unnecessary array creation in RS&lt;/p&gt;

&lt;p&gt;Reviewers: ashutoshc, JIRA, tarball&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=39009&amp;amp;id=39015#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=39009&amp;amp;id=39015#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13750398" author="phabricator@reviews.facebook.net" created="Mon, 26 Aug 2013 18:50:52 +0000"  >&lt;p&gt;ashutoshc has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Looks pretty good. Just requesting to add few more comments.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  conf/hive-default.xml.template:1586-1590 We can remove this now.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:1186 Just to add more clarity, say something like: we can push the limit above GBY (running in Reducer), since that will generate single row for each group. This doesn&apos;t necessarily hold for GBY (running in Mappers), so we don&apos;t push limit above it.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:182 It will be good to add comment about what this field is holding. Add a comment saying: This two dimensional array holds key data and a corresponding Union object which contains the tag identifying the aggregate expression for distinct columns.&lt;/p&gt;

&lt;p&gt;  Ideally, instead of this 2-D array, we should have probably enhanced HiveKey class for this logic. We should do that in a follow-up jira.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:267 I didnt follow this logic completely.&lt;br/&gt;
  Seems like this is an optimization not to evaluate union object repeatedly and do system copy for it. Can you add a comment explaining this?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:271 seems like it will be null only for all i = 0. If so, better do if (i==0) check ? Also add comment when this will be null and when it will be non-null?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java:260 You made changes to this section, because you found bug or are you purely refactoring this? If you hit upon the bug, can you explain what was it?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java:50-51 It will be good to add comment about what these 2D arrays are holding?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java:52 Also, add comment saying this array holds hashcode for keys.&lt;/p&gt;

&lt;p&gt;  Also, add note that indices of all these arrays must line up.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java:82 Nice Comments!&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java:34 It will be good to add a javadoc for this class.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java:36 Also javadoc for this interface.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13750876" author="phabricator@reviews.facebook.net" created="Tue, 27 Aug 2013 01:52:55 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;/p&gt;

&lt;p&gt;Reviewers: ashutoshc, JIRA, tarball&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967?vs=39015&amp;amp;id=39051#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967?vs=39015&amp;amp;id=39051#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/build.xml&lt;br/&gt;
  ql/ivy.xml&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13750955" author="phabricator@reviews.facebook.net" created="Tue, 27 Aug 2013 04:40:53 +0000"  >&lt;p&gt;ashutoshc has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Some limit can be pushed down to map stage&quot;.&lt;/p&gt;

&lt;p&gt;  +1&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5967&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5967&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, tarball, ashutoshc, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13751276" author="navis" created="Tue, 27 Aug 2013 14:01:14 +0000"  >&lt;p&gt;I&apos;m on vacation till next tuesday. Feel free to modify this patch, thanks.&lt;/p&gt;</comment>
                            <comment id="13752476" author="ashutoshc" created="Wed, 28 Aug 2013 15:02:57 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Navis for your persistence on this one!&lt;/p&gt;</comment>
                            <comment id="13752490" author="gopalv" created="Wed, 28 Aug 2013 15:13:02 +0000"  >&lt;p&gt;Good work Navis.&lt;/p&gt;

&lt;p&gt;Let me mark &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5093&quot; title=&quot;Use a combiner for LIMIT with GROUP BY and ORDER BY operators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5093&quot;&gt;&lt;del&gt;HIVE-5093&lt;/del&gt;&lt;/a&gt; as obsoleted by this - no need for that hack anymore.&lt;/p&gt;</comment>
                            <comment id="13752529" author="hudson" created="Wed, 28 Aug 2013 16:10:48 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2-ptest #74 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/74/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/74/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; : Some limit can be pushed down to map stage (Navis via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13752543" author="snarayanan" created="Wed, 28 Aug 2013 16:24:09 +0000"  >&lt;p&gt;Good stuff, Navis!&lt;/p&gt;</comment>
                            <comment id="13752552" author="hudson" created="Wed, 28 Aug 2013 16:30:56 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #142 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/142/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/142/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; : Some limit can be pushed down to map stage (Navis via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13753307" author="hudson" created="Thu, 29 Aug 2013 05:14:02 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hive-trunk-h0.21 #2295 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2295/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; : Some limit can be pushed down to map stage (Navis via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13753365" author="hudson" created="Thu, 29 Aug 2013 06:33:44 +0000"  >&lt;p&gt;ABORTED: Integrated in Hive-trunk-hadoop2 #387 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/387/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/387/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3562&quot; title=&quot;Some limit can be pushed down to map stage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3562&quot;&gt;&lt;del&gt;HIVE-3562&lt;/del&gt;&lt;/a&gt; : Some limit can be pushed down to map stage (Navis via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1518234&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExtractOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ForwardOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ReduceSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SelectOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TopNHash.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/HiveKey.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/LimitPushdownOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ReduceSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/limit_pushdown_negative.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13795963" author="ashutoshc" created="Tue, 15 Oct 2013 23:30:04 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                            <comment id="13805523" author="sershe" created="Fri, 25 Oct 2013 17:59:15 +0000"  >&lt;p&gt;Quick question - is it intended that excluded is only counted when the key is thrown out immediately? So if this doesn&apos;t happen it is likely to self-disable.&lt;br/&gt;
If the keys all go to the heap and later get evicted, it can still be useful to output less rows esp. if the data size is big and N is comparatively small.&lt;/p&gt;</comment>
                            <comment id="13808846" author="navis" created="Wed, 30 Oct 2013 08:21:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt; Sorry for late reply. I thought the cost of top-n hash(array copy, memory usage, etc.) would be bigger than possible gain of unknown future. Better policy might be implemented in following issue by someone with good idea.&lt;/p&gt;</comment>
                            <comment id="13809865" author="sershe" created="Thu, 31 Oct 2013 02:40:13 +0000"  >&lt;p&gt;Let me file a jira...&lt;/p&gt;</comment>
                            <comment id="14392243" author="lefty@hortonworks.com" created="Thu, 2 Apr 2015 06:50:53 +0000"  >&lt;p&gt;Doc note &amp;amp; questions:  This adds &lt;b&gt;hive.limit.pushdown.memory.usage&lt;/b&gt; to HiveConf.java, so it has been documented in the wiki with the description &quot;The maximum memory to be used for hash in RS operator for top K selection. The default value &apos;-1&apos; means no limit.&quot;&lt;/p&gt;

&lt;p&gt;Q1:  Does RS mean reduce sink?  (If so, I&apos;ll explain that in the description.)&lt;br/&gt;
Q2:  What values can be set?  (The template file originally said the default was 0.3, which implies it&apos;s a proportion of total memory or some such.)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.limit.pushdown.memory.usage&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Configuration Properties &amp;#8211; hive.limit.pushdown.memory.usage &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12663731">HIVE-5093</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12910195">HIVE-12329</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12663731">HIVE-5093</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12548523" name="HIVE-3562.D5967.1.patch" size="19572" author="phabricator@reviews.facebook.net" created="Wed, 10 Oct 2012 05:21:02 +0000"/>
                            <attachment id="12560156" name="HIVE-3562.D5967.2.patch" size="44317" author="phabricator@reviews.facebook.net" created="Mon, 10 Dec 2012 08:03:19 +0000"/>
                            <attachment id="12563009" name="HIVE-3562.D5967.3.patch" size="67615" author="phabricator@reviews.facebook.net" created="Thu, 3 Jan 2013 01:22:11 +0000"/>
                            <attachment id="12575492" name="HIVE-3562.D5967.4.patch" size="85315" author="phabricator@reviews.facebook.net" created="Tue, 26 Mar 2013 08:25:14 +0000"/>
                            <attachment id="12580643" name="HIVE-3562.D5967.5.patch" size="92688" author="phabricator@reviews.facebook.net" created="Fri, 26 Apr 2013 01:38:14 +0000"/>
                            <attachment id="12598877" name="HIVE-3562.D5967.6.patch" size="87727" author="phabricator@reviews.facebook.net" created="Tue, 20 Aug 2013 00:42:52 +0000"/>
                            <attachment id="12599898" name="HIVE-3562.D5967.7.patch" size="105125" author="phabricator@reviews.facebook.net" created="Mon, 26 Aug 2013 09:01:00 +0000"/>
                            <attachment id="12599929" name="HIVE-3562.D5967.8.patch" size="107220" author="phabricator@reviews.facebook.net" created="Mon, 26 Aug 2013 11:18:52 +0000"/>
                            <attachment id="12600080" name="HIVE-3562.D5967.9.patch" size="106970" author="phabricator@reviews.facebook.net" created="Tue, 27 Aug 2013 01:52:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2012 05:21:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246897</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07win:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44035</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3563] Drop database cascade fails when there are indexes on any tables</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3563</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Drop database cascade fails if any of the table has index. &lt;/p&gt;

&lt;p&gt;create database db2;&lt;br/&gt;
use db2;&lt;/p&gt;

&lt;p&gt;create table tab1 (id int, name string);&lt;br/&gt;
create index idx1 on table tab1(id) as  &apos;COMPACT&apos; with DEFERRED REBUILD;&lt;/p&gt;

&lt;p&gt;drop database db2 cascade;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611241">HIVE-3563</key>
            <summary>Drop database cascade fails when there are indexes on any tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasadm">Prasad Mujumdar</assignee>
                                    <reporter username="prasadm">Prasad Mujumdar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2012 20:48:40 +0000</created>
                <updated>Mon, 28 Oct 2013 03:53:12 +0000</updated>
                            <resolved>Fri, 2 Nov 2012 08:11:30 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Indexing</component>
                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13473572" author="prasadm" created="Wed, 10 Oct 2012 21:15:44 +0000"  >&lt;p&gt;Review request on &lt;a href=&quot;https://reviews.apache.org/r/7517/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/7517/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13473616" author="cwsteinbach" created="Wed, 10 Oct 2012 22:17:13 +0000"  >&lt;p&gt;@Prasad: Please see my comments on RB. Thanks.&lt;/p&gt;</comment>
                            <comment id="13478218" author="prasadm" created="Wed, 17 Oct 2012 18:44:03 +0000"  >&lt;p&gt;Review request on &lt;a href=&quot;https://reviews.apache.org/r/7517/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/7517/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13478558" author="cwsteinbach" created="Thu, 18 Oct 2012 01:13:49 +0000"  >&lt;p&gt;@Prasad: I left some more comments on reviewboard. Thanks.&lt;/p&gt;</comment>
                            <comment id="13481984" author="cwsteinbach" created="Tue, 23 Oct 2012 00:29:48 +0000"  >&lt;p&gt;@Prasad: Is this ready for review? Is &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3563&quot; title=&quot;Drop database cascade fails when there are indexes on any tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3563&quot;&gt;&lt;del&gt;HIVE-3563&lt;/del&gt;&lt;/a&gt;-2.patch the most recent version of this patch? Thanks.&lt;/p&gt;</comment>
                            <comment id="13483327" author="prasadm" created="Wed, 24 Oct 2012 15:45:15 +0000"  >&lt;p&gt;Attached the latest patch &lt;/p&gt;</comment>
                            <comment id="13484311" author="cwsteinbach" created="Thu, 25 Oct 2012 17:37:49 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13484330" author="prasadm" created="Thu, 25 Oct 2012 18:11:16 +0000"  >&lt;p&gt;Rebased the patch&lt;/p&gt;</comment>
                            <comment id="13484690" author="prasadm" created="Fri, 26 Oct 2012 04:17:51 +0000"  >&lt;p&gt;Patch with test fixes&lt;/p&gt;</comment>
                            <comment id="13488492" author="cwsteinbach" created="Thu, 1 Nov 2012 05:47:57 +0000"  >&lt;p&gt;The gen-test hbase-handler ant target fails:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;BUILD FAILED
/Users/carl/Work/repos/hive-test/build.xml:306: The following error occurred while executing this line:
/Users/carl/Work/repos/hive-test/build.xml:119: The following error occurred while executing this line:
/Users/carl/Work/repos/hive-test/hbase-handler/build.xml:76: java.lang.NullPointerException
	at java.util.Arrays$ArrayList.&amp;lt;init&amp;gt;(Arrays.java:3357)
	at java.util.Arrays.asList(Arrays.java:3343)
	at org.apache.hadoop.hive.ant.QTestGenTask.execute(QTestGenTask.java:288)
	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
	at org.apache.tools.ant.Task.perform(Task.java:348)
	at org.apache.tools.ant.Target.execute(Target.java:390)
	at org.apache.tools.ant.Target.performTasks(Target.java:411)
	at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1397)
	at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)
	at org.apache.tools.ant.Project.executeTargets(Project.java:1249)
	at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:442)
	at org.apache.tools.ant.taskdefs.SubAnt.execute(SubAnt.java:302)
	at org.apache.tools.ant.taskdefs.SubAnt.execute(SubAnt.java:221)
	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
	at org.apache.tools.ant.Task.perform(Task.java:348)
	at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
	at org.apache.tools.ant.Task.perform(Task.java:348)
	at org.apache.tools.ant.taskdefs.MacroInstance.execute(MacroInstance.java:398)
	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
	at org.apache.tools.ant.Task.perform(Task.java:348)
	at org.apache.tools.ant.Target.execute(Target.java:390)
	at org.apache.tools.ant.Target.performTasks(Target.java:411)
	at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1397)
	at org.apache.tools.ant.Project.executeTarget(Project.java:1366)
	at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
	at org.apache.tools.ant.Project.executeTargets(Project.java:1249)
	at org.apache.tools.ant.Main.runBuild(Main.java:801)
	at org.apache.tools.ant.Main.startAnt(Main.java:218)
	at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
	at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)

Total time: 1 minute 11 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If running all of the tests is too onerous then please at least run one small test in order to trigger all of the gen-test targets. Thanks.&lt;/p&gt;</comment>
                            <comment id="13488501" author="prasadm" created="Thu, 1 Nov 2012 06:19:48 +0000"  >&lt;p&gt;Revised patch with cascade db drop fix in metastore client&lt;/p&gt;</comment>
                            <comment id="13488508" author="cwsteinbach" created="Thu, 1 Nov 2012 06:49:28 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13489304" author="cwsteinbach" created="Fri, 2 Nov 2012 08:11:30 +0000"  >&lt;p&gt;Committed to trunk. Thanks Prasad!&lt;/p&gt;</comment>
                            <comment id="13489841" author="hudson" created="Fri, 2 Nov 2012 23:35:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1770 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1770/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1770/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3563&quot; title=&quot;Drop database cascade fails when there are indexes on any tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3563&quot;&gt;&lt;del&gt;HIVE-3563&lt;/del&gt;&lt;/a&gt;. Drop database cascade fails when there are indexes on any tables (Prasad Mujumdar via cws) (Revision 1404890)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404890&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404890&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/database_drop.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/database_drop.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548033" author="hudson" created="Wed, 9 Jan 2013 10:24:08 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3563&quot; title=&quot;Drop database cascade fails when there are indexes on any tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3563&quot;&gt;&lt;del&gt;HIVE-3563&lt;/del&gt;&lt;/a&gt;. Drop database cascade fails when there are indexes on any tables (Prasad Mujumdar via cws) (Revision 1404890)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404890&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404890&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/database_drop.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/database_drop.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550271" author="ashutoshc" created="Thu, 10 Jan 2013 19:54:03 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12676053">HIVE-5664</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12529778">HIVE-2542</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12550640" name="HIVE-3563-3.patch" size="81478" author="prasadm" created="Wed, 24 Oct 2012 15:44:34 +0000"/>
                            <attachment id="12550822" name="HIVE-3563-4.patch" size="81477" author="prasadm" created="Thu, 25 Oct 2012 18:11:16 +0000"/>
                            <attachment id="12550920" name="HIVE-3563-6.patch" size="84135" author="prasadm" created="Fri, 26 Oct 2012 04:17:51 +0000"/>
                            <attachment id="12551676" name="HIVE-3563-7.patch" size="69664" author="prasadm" created="Thu, 1 Nov 2012 06:19:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2012 22:17:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07z7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44473</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3564] hivetest.py: revision number and applied patch</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3564</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;It&apos;s required to add new option for hivetest.py which will allow to show base revision number and applied patch.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611247">HIVE-3564</key>
            <summary>hivetest.py: revision number and applied patch</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ivangorbachev">Ivan Gorbachev</assignee>
                                    <reporter username="ivangorbachev">Ivan Gorbachev</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2012 21:09:42 +0000</created>
                <updated>Thu, 16 May 2013 21:10:27 +0000</updated>
                            <resolved>Fri, 12 Oct 2012 14:35:14 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13474475" author="ivangorbachev" created="Thu, 11 Oct 2012 20:09:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D5973&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5973&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13474520" author="namit" created="Thu, 11 Oct 2012 21:21:03 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13475022" author="namit" created="Fri, 12 Oct 2012 14:35:14 +0000"  >&lt;p&gt;Committed. Thanks Ivan&lt;/p&gt;</comment>
                            <comment id="13548032" author="hudson" created="Wed, 9 Jan 2013 10:24:08 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3564&quot; title=&quot;hivetest.py: revision number and applied patch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3564&quot;&gt;&lt;del&gt;HIVE-3564&lt;/del&gt;&lt;/a&gt; hivetest.py: revision number and applied patch&lt;br/&gt;
(Ivan Gorbachev via namit) (Revision 1397583)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397583&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397583&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/testutils/ptest/hivetest.py&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548798" name="hive-3564.0.patch.txt" size="1582" author="ivangorbachev" created="Thu, 11 Oct 2012 20:09:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 11 Oct 2012 21:21:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07z9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44482</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3565] use hbase tables for writing intermediate directories across map-reduce boundaries</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3565</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12611285">HIVE-3565</key>
            <summary>use hbase tables for writing intermediate directories across map-reduce boundaries</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 02:18:33 +0000</created>
                <updated>Mon, 28 Jan 2013 05:45:35 +0000</updated>
                                                                            <component>HBase Handler</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13473788" author="namit" created="Thu, 11 Oct 2012 02:23:56 +0000"  >&lt;p&gt;Consider a query like:&lt;/p&gt;

&lt;p&gt;select B.y, count(1) from&lt;br/&gt;
A join B on A.x=B.x&lt;br/&gt;
group by B.y;&lt;/p&gt;

&lt;p&gt;This will require  2 MR jobs. The first MR job will perform the join, and the second MR job will perform the group by (note that the 2nd MR job would have a &lt;br/&gt;
identity mapper). If the first MR job could write the output of the join to a HBase table (which is keyed by B.y), the 2nd MR can be a map-only job which can&lt;br/&gt;
simply scan the HBase table. This idea can be extended to joins as well.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247188</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i084pr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>45363</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3566] Hive List Bucketing - Query Logic Optimization</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3566</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;There are a few places to optimize list bucketing query:&lt;br/&gt;
1. evaluateExprOnCell() need not be called for all cells for &apos;Other&apos;. Stop the first time, any &apos;Other&apos; is false.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611301">HIVE-3566</key>
            <summary>Hive List Bucketing - Query Logic Optimization</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="gangtimliu">Gang Tim Liu</assignee>
                                    <reporter username="gangtimliu">Gang Tim Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 07:15:22 +0000</created>
                <updated>Thu, 2 May 2013 02:30:54 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12555256">HIVE-3026</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12610884">HIVE-3554</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247274</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i089jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46147</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3567] Hive List Bucketing - Query logic supports &lt;, &lt;=, &gt; , &gt;= and in</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3567</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Query logic supports equal. It should handle &amp;lt;, &amp;lt;=, &amp;gt; , &amp;gt;=  and in also.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611302">HIVE-3567</key>
            <summary>Hive List Bucketing - Query logic supports &lt;, &lt;=, &gt; , &gt;= and in</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="gangtimliu">Gang Tim Liu</assignee>
                                    <reporter username="gangtimliu">Gang Tim Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 07:20:15 +0000</created>
                <updated>Thu, 2 May 2013 02:30:54 +0000</updated>
                                            <version>0.10.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12555256">HIVE-3026</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12610884">HIVE-3554</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247275</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i089k7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3568] No pushdown subquery&apos;s group by key in outside filter</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3568</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;pushdown doesn&apos;t happen with group by in subquery and group by key in outside filter.&lt;/p&gt;

&lt;p&gt;select * from (select x, count(1) from fact_daily where ds =&apos;1&apos; group by x) subq where x = 484;&lt;/p&gt;

&lt;p&gt;subquery still scans the partition.&lt;/p&gt;

&lt;p&gt;expect only scan x = 484.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611311">HIVE-3568</key>
            <summary>No pushdown subquery&apos;s group by key in outside filter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gangtimliu">Gang Tim Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 08:09:10 +0000</created>
                <updated>Thu, 11 Oct 2012 08:09:10 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247286</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i089mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3569] RCFile requires native Hadoop library</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3569</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;RCFile requires the native Hadoop library. It does not work when using the Java &lt;tt&gt;GzipCodec&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The root cause is that the two versions of &lt;tt&gt;GzipCodec.createInputStream()&lt;/tt&gt; work differently. The native version simply saves a reference to the supplied input stream. The Java version wraps the stream in a Java &lt;tt&gt;GZIPInputStream&lt;/tt&gt;, which immediately tries to read the header.&lt;/p&gt;

&lt;p&gt;The problem occurs because the stream passed by the &lt;tt&gt;RCFile.ValueBuffer&lt;/tt&gt; constructor is empty (the buffer backing the stream is still empty at that point).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;12/10/11 10:37:25 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
12/10/11 10:37:25 INFO io.CodecPool: Got brand-new decompressor
12/10/11 10:37:25 INFO io.CodecPool: Got brand-new decompressor
Exception in thread &quot;main&quot; java.io.EOFException
	at java.util.zip.GZIPInputStream.readUByte(GZIPInputStream.java:264)
	at java.util.zip.GZIPInputStream.readUShort(GZIPInputStream.java:254)
	at java.util.zip.GZIPInputStream.readHeader(GZIPInputStream.java:163)
	at java.util.zip.GZIPInputStream.&amp;lt;init&amp;gt;(GZIPInputStream.java:78)
	at java.util.zip.GZIPInputStream.&amp;lt;init&amp;gt;(GZIPInputStream.java:90)
	at org.apache.hadoop.io.compress.GzipCodec$GzipInputStream$ResetableGZIPInputStream.&amp;lt;init&amp;gt;(GzipCodec.java:92)
	at org.apache.hadoop.io.compress.GzipCodec$GzipInputStream.&amp;lt;init&amp;gt;(GzipCodec.java:101)
	at org.apache.hadoop.io.compress.GzipCodec.createInputStream(GzipCodec.java:169)
	at org.apache.hadoop.io.compress.GzipCodec.createInputStream(GzipCodec.java:179)
	at org.apache.hadoop.hive.ql.io.RCFile$ValueBuffer.&amp;lt;init&amp;gt;(RCFile.java:451)
	at org.apache.hadoop.hive.ql.io.RCFile$Reader.&amp;lt;init&amp;gt;(RCFile.java:1205)
	at org.apache.hadoop.hive.ql.io.RCFile$Reader.&amp;lt;init&amp;gt;(RCFile.java:1111)
	at org.apache.hadoop.hive.ql.io.RCFileRecordReader.&amp;lt;init&amp;gt;(RCFileRecordReader.java:52)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12611404">HIVE-3569</key>
            <summary>RCFile requires native Hadoop library</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="electrum">David Phillips</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 18:03:12 +0000</created>
                <updated>Thu, 11 Oct 2012 18:05:42 +0000</updated>
                                            <version>0.10.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08pnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3570] Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3570</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Requirement: Collect Operator specific stats for hive queries. Use the counter framework available in Hive Operator.java to accomplish that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611419">HIVE-3570</key>
            <summary>Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="satadrupan">Satadru Pan</assignee>
                                    <reporter username="satadrupan">Satadru Pan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 19:23:47 +0000</created>
                <updated>Thu, 10 Jan 2013 19:53:24 +0000</updated>
                            <resolved>Fri, 2 Nov 2012 12:00:43 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Statistics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13474462" author="satadrupan" created="Thu, 11 Oct 2012 19:49:05 +0000"  >&lt;p&gt;Patch for the task &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13475243" author="phabricator@reviews.facebook.net" created="Fri, 12 Oct 2012 18:59:02 +0000"  >&lt;p&gt;satadru added you to the CC list for the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Single box testing&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: JIRA&lt;/p&gt;</comment>
                            <comment id="13475379" author="phabricator@reviews.facebook.net" created="Fri, 12 Oct 2012 21:39:02 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;  Please add a test.&lt;/p&gt;

&lt;p&gt;  Add a simple hook which prints the number of hashed rows.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:1000 NUM_INPUT_ROWS are present in every operator.&lt;br/&gt;
  You dont need it again.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA&lt;/p&gt;</comment>
                            <comment id="13475380" author="namit" created="Fri, 12 Oct 2012 21:39:03 +0000"  >&lt;p&gt;Comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13478372" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 21:02:02 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain&lt;/p&gt;

&lt;p&gt;  Update with CR comments by Namit&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/test/results/clientpositive/OptrStatGroupBy.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA&lt;/p&gt;</comment>
                            <comment id="13478387" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 21:10:03 +0000"  >&lt;p&gt;satadru has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;  @njain : I have done the changes and added an hook. Whenever I am executing the hook from outside(ie hive cli) everything works fine. But when it is run from the &quot;ant test -Dtestcase=...&quot; command, the Counter object in the Operator.java coming as null. (Probable reason: the unit test is not executing the query in actual hadoop cluster, without which counters are always null). Please suggest if there is any way to get around this problem. I tried searching for unit test involving counters in Operator.java, but couldn&apos;t find.&lt;/p&gt;



&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA&lt;/p&gt;</comment>
                            <comment id="13480130" author="phabricator@reviews.facebook.net" created="Fri, 19 Oct 2012 16:58:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain&lt;/p&gt;


&lt;p&gt;  Fix a patch issue in OptrStatGroupByHook.java which happened in the last revision.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/test/results/clientpositive/OptrStatGroupBy.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA, adobriyal, sambavim&lt;/p&gt;</comment>
                            <comment id="13481994" author="phabricator@reviews.facebook.net" created="Tue, 23 Oct 2012 00:50:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain&lt;/p&gt;

&lt;p&gt;  Fix unit test issue mentioned above.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build-common.xml&lt;br/&gt;
  ql/src/test/results/clientpositive/OptrStatGroupBy.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA, adobriyal, sambavim&lt;/p&gt;</comment>
                            <comment id="13481998" author="phabricator@reviews.facebook.net" created="Tue, 23 Oct 2012 00:54:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain&lt;/p&gt;

&lt;p&gt;  Final diff: After fixing a patch issue&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build-common.xml&lt;br/&gt;
  ql/src/test/results/clientpositive/OptrStatGroupBy.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, satadru&lt;br/&gt;
Cc: JIRA, adobriyal, sambavim&lt;/p&gt;</comment>
                            <comment id="13485871" author="phabricator@reviews.facebook.net" created="Mon, 29 Oct 2012 07:07:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java:1 add apache header&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java:29 add some comments - what are you trying to do ?&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java:49 fix lint&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q:1 add some comments in the test.&lt;br/&gt;
  What are you trying to achieve ?&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q:1 The test names start with a lower case letter - can you rename this test file ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java:997 lint ??&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13485875" author="namit" created="Mon, 29 Oct 2012 07:12:34 +0000"  >&lt;p&gt;minor comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13488519" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 07:07:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain, sambavim, kevinwilfong&lt;/p&gt;

&lt;p&gt;  Updated the code according to the review comments.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build-common.xml&lt;br/&gt;
  ql/src/test/results/clientpositive/optrstat_groupby.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/optrstat_groupby.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13488520" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 07:11:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain, sambavim, kevinwilfong&lt;/p&gt;

&lt;p&gt;  Removing one unintended change build-common.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build-common.xml&lt;br/&gt;
  ql/src/test/results/clientpositive/optrstat_groupby.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/optrstat_groupby.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13488530" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 07:35:11 +0000"  >&lt;p&gt;satadru has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q:1 Getting ant test failure whenever I am adding a comment line (-- comment) in the .q file. This seems to be some problem with the minimr test case.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13488550" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 08:37:11 +0000"  >&lt;p&gt;njain has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/results/clientpositive/optrstat_groupby.q.out:5 Outside the scope of this patch, but there seems to be a bug in num output rows.&lt;br/&gt;
  It should be 1, not 0.&lt;br/&gt;
  Can you file a new jira with the details ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  svn&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13488551" author="namit" created="Thu, 1 Nov 2012 08:37:52 +0000"  >&lt;p&gt;minor comments&lt;/p&gt;</comment>
                            <comment id="13488552" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 08:39:11 +0000"  >&lt;p&gt;njain has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;  ignore my accept, can you try putting a comment&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/OptrStatGroupBy.q:1 There is a bug where comments cannot come before a SET statement.&lt;/p&gt;

&lt;p&gt;  Can you try putting a comment before line 4 (select count(1) from src) ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  svn&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13489294" author="phabricator@reviews.facebook.net" created="Fri, 2 Nov 2012 07:18:11 +0000"  >&lt;p&gt;satadru updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;br/&gt;
Reviewers: njain, sambavim, kevinwilfong&lt;/p&gt;

&lt;p&gt;  Added the comment in the .q file, modified the test a little bit to avoid a new time depndent counter&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build-common.xml&lt;br/&gt;
  ql/src/test/results/clientpositive/optrstat_groupby.q.out&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/optrstat_groupby.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13489306" author="namit" created="Fri, 2 Nov 2012 08:14:25 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13489307" author="phabricator@reviews.facebook.net" created="Fri, 2 Nov 2012 08:16:11 +0000"  >&lt;p&gt;njain has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive changes for Optr level stats&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5985&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5985&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  svn&lt;/p&gt;

&lt;p&gt;To: njain, sambavim, kevinwilfong, satadru&lt;br/&gt;
Cc: JIRA, adobriyal&lt;/p&gt;</comment>
                            <comment id="13489376" author="namit" created="Fri, 2 Nov 2012 12:00:43 +0000"  >&lt;p&gt;Committed. Thanks Satadru&lt;/p&gt;</comment>
                            <comment id="13489842" author="hudson" created="Fri, 2 Nov 2012 23:35:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1770 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1770/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1770/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out&lt;br/&gt;
counter for GroupBy Optr (Satadru Pan via namit) (Revision 1404933)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404933&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404933&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/optrstat_groupby.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/optrstat_groupby.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548040" author="hudson" created="Wed, 9 Jan 2013 10:24:09 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3570&quot; title=&quot;Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out counter for GroupBy Optr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3570&quot;&gt;&lt;del&gt;HIVE-3570&lt;/del&gt;&lt;/a&gt; Add/fix facility to collect operator specific statisticsin hive + add hash-in/hash-out&lt;br/&gt;
counter for GroupBy Optr (Satadru Pan via namit) (Revision 1404933)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404933&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1404933&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Operator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/hooks/OptrStatGroupByHook.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/optrstat_groupby.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/optrstat_groupby.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550105" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:24 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12614875">HIVE-3674</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12548795" name="HIVE-3570.1.patch.txt" size="7532" author="satadrupan" created="Thu, 11 Oct 2012 19:49:05 +0000"/>
                            <attachment id="12548936" name="HIVE-3570.D5985.1.patch" size="7242" author="phabricator@reviews.facebook.net" created="Fri, 12 Oct 2012 18:59:02 +0000"/>
                            <attachment id="12549575" name="HIVE-3570.D5985.2.patch" size="14199" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 21:02:02 +0000"/>
                            <attachment id="12550006" name="HIVE-3570.D5985.3.patch" size="11206" author="phabricator@reviews.facebook.net" created="Fri, 19 Oct 2012 16:58:11 +0000"/>
                            <attachment id="12550387" name="HIVE-3570.D5985.4.patch" size="15629" author="phabricator@reviews.facebook.net" created="Tue, 23 Oct 2012 00:50:11 +0000"/>
                            <attachment id="12550388" name="HIVE-3570.D5985.5.patch" size="12263" author="phabricator@reviews.facebook.net" created="Tue, 23 Oct 2012 00:54:11 +0000"/>
                            <attachment id="12551679" name="HIVE-3570.D5985.6.patch" size="13452" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 07:07:11 +0000"/>
                            <attachment id="12551681" name="HIVE-3570.D5985.7.patch" size="13235" author="phabricator@reviews.facebook.net" created="Thu, 1 Nov 2012 07:11:11 +0000"/>
                            <attachment id="12551830" name="HIVE-3570.D5985.8.patch" size="13583" author="phabricator@reviews.facebook.net" created="Fri, 2 Nov 2012 07:18:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Oct 2012 18:59:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08psf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48777</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3571] add a way to run a small unit quickly</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3571</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;A simple unit test:&lt;/p&gt;

&lt;p&gt;ant test -Dtestcase=TestCliDriver -Dqfile=groupby2.q&lt;/p&gt;

&lt;p&gt;takes a long time.&lt;/p&gt;

&lt;p&gt;There should be a quick way to achieve that for debugging.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611475">HIVE-3571</key>
            <summary>add a way to run a small unit quickly</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2012 01:10:59 +0000</created>
                <updated>Thu, 16 May 2013 21:10:52 +0000</updated>
                            <resolved>Mon, 4 Feb 2013 07:43:37 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13478691" author="navis" created="Thu, 18 Oct 2012 05:38:37 +0000"  >&lt;p&gt;ant test-ql -Dtestcase=TestCliDriver -Dqfile=union.q&lt;/p&gt;

&lt;p&gt;I know little about ant script. Someone can generify this for common usage (it&apos;s only for tests in ql module)&lt;/p&gt;</comment>
                            <comment id="13496960" author="libing" created="Wed, 14 Nov 2012 09:02:56 +0000"  >&lt;p&gt;Based on current build scripts, it will prepare all the test classes and jars, even if only one test case needed to run.&lt;/p&gt;

&lt;p&gt;I think we can add a new option named -Dmodule= , the command could be like&lt;br/&gt;
ant test -Dmodule=ql -Dtestcase=TestCliDriver -Dqfile=union.q&lt;/p&gt;

&lt;p&gt;With this option, it only needs to generate/compile necessary files.&lt;/p&gt;

&lt;p&gt;Does it make sense?&lt;/p&gt;</comment>
                            <comment id="13540436" author="phabricator@reviews.facebook.net" created="Fri, 28 Dec 2012 11:50:11 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-1918 add a way to run a small unit quickly&lt;/p&gt;

&lt;p&gt;  A simple unit test:&lt;/p&gt;

&lt;p&gt;  ant test -Dtestcase=TestCliDriver -Dqfile=groupby2.q&lt;/p&gt;

&lt;p&gt;  takes a long time.&lt;/p&gt;

&lt;p&gt;  There should be a quick way to achieve that for debugging.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build.xml&lt;br/&gt;
  ql/build.xml&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/18453/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/18453/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13540438" author="navis" created="Fri, 28 Dec 2012 11:52:46 +0000"  >&lt;p&gt;added &quot;-Dmodule=&quot; option, halving test prepare time for single test.&lt;/p&gt;</comment>
                            <comment id="13541978" author="cwsteinbach" created="Wed, 2 Jan 2013 03:14:09 +0000"  >&lt;p&gt;@Navis: I left some comments on phabricator. Thanks.&lt;/p&gt;</comment>
                            <comment id="13541979" author="phabricator@reviews.facebook.net" created="Wed, 2 Jan 2013 03:14:11 +0000"  >&lt;p&gt;cwsteinbach has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  build.xml:61 Please move these property definitions to build.properties and add some comments explaining what they do.&lt;br/&gt;
  build.xml:113 Now that the module list is defined elsewhere it looks like we can probably consolidate the iterate-* macros into a single iterate-target macro.&lt;br/&gt;
  ql/build.xml:49 On my laptop all of these qtestgen tasks take a total of 400 milliseconds to execute. I don&apos;t think it&apos;s worth trying to save this.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1918&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, navis&lt;/p&gt;</comment>
                            <comment id="13541985" author="phabricator@reviews.facebook.net" created="Wed, 2 Jan 2013 04:00:11 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/build.xml:49 It took 2 seconds less for my laptop (compile time?) with this mod but still small enough. I&apos;ll remove it.&lt;br/&gt;
  build.xml:61 ok.&lt;br/&gt;
  build.xml:113 ok.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1918&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, navis&lt;/p&gt;</comment>
                            <comment id="13541991" author="phabricator@reviews.facebook.net" created="Wed, 2 Jan 2013 04:48:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;br/&gt;
Reviewers: JIRA, cwsteinbach&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build.properties&lt;br/&gt;
  build.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, navis&lt;/p&gt;</comment>
                            <comment id="13542008" author="namit" created="Wed, 2 Jan 2013 05:37:14 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good. This should really help the debugging/testing.&lt;/p&gt;</comment>
                            <comment id="13549371" author="namit" created="Thu, 10 Jan 2013 05:39:40 +0000"  >&lt;p&gt;The tests are failing&lt;/p&gt;</comment>
                            <comment id="13554830" author="phabricator@reviews.facebook.net" created="Wed, 16 Jan 2013 08:12:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;br/&gt;
Reviewers: JIRA, cwsteinbach&lt;/p&gt;

&lt;p&gt;  Replaced property to var&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  build.properties&lt;br/&gt;
  build.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, navis&lt;/p&gt;</comment>
                            <comment id="13569848" author="phabricator@reviews.facebook.net" created="Sun, 3 Feb 2013 18:42:12 +0000"  >&lt;p&gt;ashutoshc has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;/p&gt;

&lt;p&gt;  +1 Running tests.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1918&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, ashutoshc, navis&lt;/p&gt;</comment>
                            <comment id="13570046" author="ashutoshc" created="Mon, 4 Feb 2013 07:43:37 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Navis!&lt;/p&gt;</comment>
                            <comment id="13570127" author="hudson" created="Mon, 4 Feb 2013 12:10:01 +0000"  >&lt;p&gt;Integrated in hive-trunk-hadoop1 #67 (See &lt;a href=&quot;https://builds.apache.org/job/hive-trunk-hadoop1/67/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hive-trunk-hadoop1/67/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; : add a way to run a small unit quickly (Navis via Ashutosh Chauhan) (Revision 1442043)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13570403" author="hudson" created="Mon, 4 Feb 2013 17:15:54 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #106 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/106/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/106/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; : add a way to run a small unit quickly (Navis via Ashutosh Chauhan) (Revision 1442043)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13570779" author="hudson" created="Tue, 5 Feb 2013 00:08:11 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1955 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1955/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1955/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; : add a way to run a small unit quickly (Navis via Ashutosh Chauhan) (Revision 1442043)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1442043&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13580583" author="phabricator@reviews.facebook.net" created="Mon, 18 Feb 2013 12:39:11 +0000"  >&lt;p&gt;navis has closed the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3571&quot; title=&quot;add a way to run a small unit quickly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3571&quot;&gt;&lt;del&gt;HIVE-3571&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; add a way to run a small unit quickly&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7695&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7695&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, cwsteinbach, ashutoshc, navis&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549642" name="HIVE-3571.1.patch.txt" size="5523" author="navis" created="Thu, 18 Oct 2012 05:38:37 +0000"/>
                            <attachment id="12562578" name="HIVE-3571.D7695.1.patch" size="11433" author="phabricator@reviews.facebook.net" created="Fri, 28 Dec 2012 11:50:11 +0000"/>
                            <attachment id="12562880" name="HIVE-3571.D7695.2.patch" size="8391" author="phabricator@reviews.facebook.net" created="Wed, 2 Jan 2013 04:48:12 +0000"/>
                            <attachment id="12565090" name="HIVE-3571.D7695.3.patch" size="8523" author="phabricator@reviews.facebook.net" created="Wed, 16 Jan 2013 08:12:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 18 Oct 2012 05:38:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08q9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3572] Expressions in distribute/cluster/order/sort by used to work sometimes</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3572</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This query used to work&lt;br/&gt;
explain select key from src distribute by (key + 50);&lt;/p&gt;

&lt;p&gt;But after &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3268&quot; title=&quot;expressions in cluster by are not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3268&quot;&gt;&lt;del&gt;HIVE-3268&lt;/del&gt;&lt;/a&gt; it fails in compilation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611568">HIVE-3572</key>
            <summary>Expressions in distribute/cluster/order/sort by used to work sometimes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2012 18:07:01 +0000</created>
                <updated>Fri, 12 Oct 2012 18:07:46 +0000</updated>
                                            <version>0.10.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                    <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12599228">HIVE-3268</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248030</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09l0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>53837</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3573] Revert HIVE-3268</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3573</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This patch introduces some code which can breaks distribute/order/cluster/sort by.  We should revert this code until it can be fixed (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3572&quot; title=&quot;Expressions in distribute/cluster/order/sort by used to work sometimes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3572&quot;&gt;HIVE-3572&lt;/a&gt;).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611608">HIVE-3573</key>
            <summary>Revert HIVE-3268</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2012 18:25:21 +0000</created>
                <updated>Thu, 22 Aug 2013 20:40:10 +0000</updated>
                            <resolved>Mon, 15 Oct 2012 22:47:22 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13475277" author="namit" created="Fri, 12 Oct 2012 19:34:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D6015&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6015&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13475284" author="kevinwilfong" created="Fri, 12 Oct 2012 19:41:47 +0000"  >&lt;p&gt;If you plan to remove the config once the bug is fixed, we&apos;d probably be better off just reverting it.&lt;/p&gt;</comment>
                            <comment id="13475422" author="kevinwilfong" created="Fri, 12 Oct 2012 23:13:48 +0000"  >&lt;p&gt;+1 Thanks Namit&lt;/p&gt;</comment>
                            <comment id="13475746" author="kevinwilfong" created="Sun, 14 Oct 2012 02:05:30 +0000"  >&lt;p&gt;Committed.  Thanks Namit.&lt;/p&gt;</comment>
                            <comment id="13475834" author="hudson" created="Sun, 14 Oct 2012 13:19:17 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1737 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1737/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1737/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3573&quot; title=&quot;Revert HIVE-3268&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3573&quot;&gt;&lt;del&gt;HIVE-3573&lt;/del&gt;&lt;/a&gt;. Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3268&quot; title=&quot;expressions in cluster by are not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3268&quot;&gt;&lt;del&gt;HIVE-3268&lt;/del&gt;&lt;/a&gt;. (njain via kevinwilfong) (Revision 1397994)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397994&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/QBParseInfo.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_clusterby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_distributeby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_distributeby_sortby_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_orderby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_sortby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_clusterby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_distributeby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_distributeby_sortby_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_orderby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_sortby1.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13548041" author="hudson" created="Wed, 9 Jan 2013 10:24:10 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3573&quot; title=&quot;Revert HIVE-3268&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3573&quot;&gt;&lt;del&gt;HIVE-3573&lt;/del&gt;&lt;/a&gt;. Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3268&quot; title=&quot;expressions in cluster by are not working&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3268&quot;&gt;&lt;del&gt;HIVE-3268&lt;/del&gt;&lt;/a&gt;. (njain via kevinwilfong) (Revision 1397994)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
kevinwilfong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1397994&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/QBParseInfo.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_clusterby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_distributeby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_distributeby_sortby_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_orderby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/expr_sortby1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_clusterby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_distributeby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_distributeby_sortby_1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_orderby1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/expr_sortby1.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550160" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:37 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12599228">HIVE-3268</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12548944" name="hive.3573.1.patch" size="6625" author="namit" created="Fri, 12 Oct 2012 19:35:15 +0000"/>
                            <attachment id="12548972" name="hive.3573.2.patch" size="21985" author="namit" created="Fri, 12 Oct 2012 21:29:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Oct 2012 19:34:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248091</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09ldz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>53898</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3574] Allow Hive to Submit MapReduce jobs via the MapReduce API (instead of using Hadoop BIN)</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3574</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The current behavior of the MapRedTask is to start a process that invokes the &quot;hadoop jar&quot; command, passing each additional jobconf property as an argument to this Hadoop CLI.&lt;/p&gt;

&lt;p&gt;Having Hive to submit generated jobs to an M/R cluster via the MapReduce API would allow for potentially greater compatibility across platforms, in addition to allowing for these jobs to be run easily against pseudo-clusters in tests (think MiniMRCluster).&lt;/p&gt;

&lt;p&gt;This kind of change could involve something as simple as using a Hadoop Configuration object with a generic ToolRunner or something similar to run jobs.&lt;/p&gt;

&lt;p&gt;Specifically, this kind of change would most likely occur in the execute() method of org.apache.hadoop.hive.ql.exec.MapRedTask.&lt;/p&gt;</description>
                <environment>&lt;p&gt;All environments would be affected by this&lt;/p&gt;</environment>
        <key id="12611637">HIVE-3574</key>
            <summary>Allow Hive to Submit MapReduce jobs via the MapReduce API (instead of using Hadoop BIN)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jerluc">Jeremy A. Lucas</reporter>
                        <labels>
                            <label>feature</label>
                            <label>test</label>
                    </labels>
                <created>Fri, 12 Oct 2012 21:30:39 +0000</created>
                <updated>Fri, 25 Apr 2014 09:43:07 +0000</updated>
                                            <version>0.3.0</version>
                    <version>0.4.0</version>
                    <version>0.4.1</version>
                    <version>0.5.0</version>
                    <version>0.6.0</version>
                    <version>0.7.0</version>
                    <version>0.7.1</version>
                    <version>0.8.0</version>
                    <version>0.8.1</version>
                    <version>0.9.0</version>
                    <version>0.9.1</version>
                    <version>0.10.0</version>
                                                    <component>Query Processor</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13475405" author="ashutoshc" created="Fri, 12 Oct 2012 22:20:35 +0000"  >&lt;p&gt;+1 on the idea. I have also been hit by this. Reliance on hadoop script to launch MR jobs is not cool.&lt;/p&gt;</comment>
                            <comment id="13475437" author="andrewlook" created="Fri, 12 Oct 2012 23:29:46 +0000"  >&lt;p&gt;+1. I find it to be a much more robust and flexible approach to rely on what&apos;s in the classpath rather than what&apos;s installed on the system.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Oct 2012 22:20:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248125</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09lnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>53943</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>mapreduce</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3575] maintain dependency between views/view partitions and tables/partitions</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3575</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12611646">HIVE-3575</key>
            <summary>maintain dependency between views/view partitions and tables/partitions</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2012 23:02:46 +0000</created>
                <updated>Wed, 5 Dec 2012 07:04:48 +0000</updated>
                                                                            <component>Metastore</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13475420" author="namit" created="Fri, 12 Oct 2012 23:10:41 +0000"  >&lt;p&gt;Hive supports both partitioned and unpartitioned views. Let us consider a specific example:&lt;br/&gt;
create table T (key string, value string) partitioned by (ds string, hr string);&lt;br/&gt;
insert overwrite table T partition (ds=&apos;1&apos;, hr=&apos;1&apos;) ...;&lt;br/&gt;
..&lt;br/&gt;
insert overwrite table T partition (ds=&apos;1&apos;, hr=&apos;24&apos;) ...;&lt;br/&gt;
T is a partitioned table by date and hour, and Tview is a view which conceptually denotes the table T partitioned by ds.&lt;br/&gt;
create view Tview (key string, value string) partitioned by (ds string) as select key, value, ds from T;&lt;br/&gt;
When all the hourly partitions are created for a day (ds=&apos;1&apos;), the corresponding partition can be added to Tview&lt;br/&gt;
alter view Tview add partition (ds=&apos;1&apos;);&lt;br/&gt;
There is a implicit dependency between Tview@ds=1 and T@ds=1/hr=1, T@ds=1/hr=2, .... T@ds=1/hr=24, but that dependency is not captured anywhere&lt;br/&gt;
in the metastore. It would be useful to explicitly create that dependency. This dependency can be used for all kinds of auditing purposes. &lt;br/&gt;
The table&apos;s partition T@ds=1/hr=1 cannot be dropped unless the view partition Tview@ds=1 is dropped.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09lrb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>53958</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3576] Regression: ALTER TABLE DROP IF EXISTS PARTITION throws a SemanticException if Partition is not found</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3576</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Doing a simple &quot;&lt;tt&gt;ALTER TABLE testtable DROP IF EXISTS PARTITION(dt=NONEXISTENTPARTITION)&lt;/tt&gt;&quot; fails with a SemanticException of the 10006 kind (INVALID_PARTITION).&lt;/p&gt;

&lt;p&gt;This does not respect the &lt;tt&gt;hive.exec.drop.ignorenonexistent&lt;/tt&gt; condition either, since there are no if-check-wraps around this area, when fetching partitions from the store.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611735">HIVE-3576</key>
            <summary>Regression: ALTER TABLE DROP IF EXISTS PARTITION throws a SemanticException if Partition is not found</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                    </labels>
                <created>Sun, 14 Oct 2012 08:10:51 +0000</created>
                <updated>Wed, 26 Mar 2014 07:48:25 +0000</updated>
                            <resolved>Wed, 26 Mar 2014 07:48:25 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Metastore</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13475878" author="qwertymaniac" created="Sun, 14 Oct 2012 18:37:51 +0000"  >&lt;p&gt;Sorry, let me explain with an example:&lt;/p&gt;

&lt;p&gt;On 0.7.1:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table test(a string) partitioned by (dt string);
OK
Time taken: 21.049 seconds
hive&amp;gt; alter table test drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition(dt=2007);
OK
Time taken: 1.297 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On 0.9.0:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table test(a string) partitioned by (dt string);
OK
Time taken: 2.133 seconds
hive&amp;gt; alter table test drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition(dt=2007);
FAILED: SemanticException [Error 10006]: Partition not found dt = 2007
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Again, if we make sure to use &apos;strings&apos;, on 0.9.0, it works:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; alter table test drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition(dt=&lt;span class=&quot;code-quote&quot;&gt;&apos;2007&apos;&lt;/span&gt;);
OK
Time taken: 0.684 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13484004" author="qwertymaniac" created="Thu, 25 Oct 2012 09:31:32 +0000"  >&lt;p&gt;This also only happens on tables partitioned by a string type key, not int types, for example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table str_part_table (a string) partitioned by (dt string);
OK
Time taken: 0.054 seconds
hive&amp;gt; create table int_part_table (a string) partitioned by (dt &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);   
OK
Time taken: 0.031 seconds
hive&amp;gt; alter table str_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=2007);
FAILED: SemanticException [Error 10006]: Partition not found dt = 2007
hive&amp;gt; alter table int_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=2007);
OK
Time taken: 0.091 seconds
hive&amp;gt; alter table str_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&apos;2007&apos;&lt;/span&gt;);
OK
Time taken: 0.06 seconds
hive&amp;gt; alter table int_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&apos;2007&apos;&lt;/span&gt;);
OK
Time taken: 0.065 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13708263" author="kjsingh" created="Mon, 15 Jul 2013 06:31:57 +0000"  >&lt;p&gt;Any updates on this issue?&lt;/p&gt;</comment>
                            <comment id="13947638" author="qwertymaniac" created="Wed, 26 Mar 2014 07:48:25 +0000"  >&lt;p&gt;Unable to reproduce in 0.11+. Resolving.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table str_part_table (a string) partitioned by (dt string);
OK
Time taken: 16.108 seconds
hive&amp;gt; create table int_part_table (a string) partitioned by (dt &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
OK
Time taken: 0.705 seconds
hive&amp;gt; alter table str_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=2007);
OK
Time taken: 1.38 seconds
hive&amp;gt; alter table int_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=2007);
OK
Time taken: 3.494 seconds
hive&amp;gt; alter table str_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&apos;2007&apos;&lt;/span&gt;);
OK
Time taken: 0.091 seconds
hive&amp;gt; alter table int_part_table drop &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists partition (dt=&lt;span class=&quot;code-quote&quot;&gt;&apos;2007&apos;&lt;/span&gt;);
OK
Time taken: 0.101 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 15 Jul 2013 06:31:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248543</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 43 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09vxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3577] Subquery Unnesting</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3577</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive requires subquery to be used only in the FROM clause. But real-world queries can be much more complex and subqueries could appear in WHERE, having and SELECT clauses. Many of such subqueries can be transformed/unnested to various join operations. This is an umbrella id to include all subquery unnesting work, specifically:&lt;/p&gt;

&lt;p&gt;1. subquery in WHERE conditions, including subquery used as operand of IN, EXISTS, ISNULL ALL/ANY/SOME, and etc.&lt;/p&gt;

&lt;p&gt;2. correlated subquery (a correlated subquery is a subquery that refers to a column of a table not in its FROM clause),e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select * from t1 where exists ( select * from t2 where t1.b = t2.y );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;3. scalar subquery (a subquery that returns exactly one column value from one row). e.g. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select a,b,c,d,e,(select z from t2 where t2.y = t1.b and z != 99 ) from t1;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;4. top-level subquery, e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(select * from t1) union all (select * from t2) union (all select * from t3 order by 1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="12611787">HIVE-3577</key>
            <summary>Subquery Unnesting</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12607881">HIVE-3472</parent>
                                    <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shane.huang">Shane Huang</reporter>
                        <labels>
                            <label>SQL</label>
                    </labels>
                <created>Mon, 15 Oct 2012 06:51:30 +0000</created>
                <updated>Wed, 25 Dec 2013 22:43:56 +0000</updated>
                                            <version>0.10.0</version>
                    <version>0.11.0</version>
                    <version>0.12.0</version>
                    <version>0.13.0</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13856576" author="danielbos" created="Wed, 25 Dec 2013 11:32:29 +0000"  >&lt;p&gt;We use 2, 3 and 4 often, migrating to Hive cost us a lot of time since we have to rewrite the queries completely. Is there an outlook in which version these query options will be added?&lt;/p&gt;</comment>
                            <comment id="13856674" author="ashutoshc" created="Wed, 25 Dec 2013 22:43:56 +0000"  >&lt;p&gt;Support for 2 and 3 has landed in trunk via via &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-784&quot; title=&quot;Support uncorrelated subqueries in the WHERE clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-784&quot;&gt;&lt;del&gt;HIVE-784&lt;/del&gt;&lt;/a&gt; &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12433867">HIVE-784</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Dec 2013 11:32:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248641</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 4 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09xf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3578] Multiple-table selection support</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3578</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Support syntax of select from multiple tables. This kind of syntax is used in many customer case and standard benchmarks (TPC-H, TPC-DS) e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;select * from t1,t2 where t1.c = t2.z;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12611788">HIVE-3578</key>
            <summary>Multiple-table selection support</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12607881">HIVE-3472</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shane.huang">Shane Huang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 06:56:27 +0000</created>
                <updated>Mon, 15 Oct 2012 06:56:40 +0000</updated>
                                            <version>0.10.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248644</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09xgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55861</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3579] Queries in hive-0.8.1-cdh4.0.1 that invoke the Reducer results in Task Failed. The log file shows the ecxception: java.lang.Exception: java.lang.OutOfMemoryError: Java heap space</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3579</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;hive&amp;gt; select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from table1; &lt;/p&gt;


&lt;p&gt;       Total MapReduce jobs = 1    &lt;br/&gt;
       Launching Job 1 out of 1&lt;br/&gt;
       Number of reduce tasks determined at compile time: 1        &lt;br/&gt;
       12/10/15 23:07:02 WARN conf.Configuration: mapred.job.name is deprecated. Instead, use mapreduce.job.name     &lt;br/&gt;
       12/10/15 23:07:02 WARN conf.Configuration: mapred.system.dir is deprecated. Instead, use mapreduce.jobtracker.system.dir    &lt;br/&gt;
       12/10/15 23:07:02 WARN conf.Configuration: mapred.local.dir is deprecated. Instead, use mapreduce.cluster.local.dir   &lt;br/&gt;
       12/10/15 23:07:02 WARN conf.HiveConf: hive-site.xml not found on CLASSPATH    &lt;br/&gt;
       WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.    &lt;br/&gt;
       Execution log at: /tmp/XXXX    &lt;br/&gt;
       /XXXX_20121015230707_c93521d0-4a97-4972-92b9-0fdd3ab42e5f.log    &lt;br/&gt;
       SLF4J: Class path contains multiple SLF4J bindings.    &lt;br/&gt;
       SLF4J: Found binding in &lt;span class=&quot;error&quot;&gt;&amp;#91;jar:file:/home/XXXX/hadoop-2.0.0-cdh4.0.1/share/hadoop/common/lib/slf4j-log4j12-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class&amp;#93;&lt;/span&gt;    &lt;br/&gt;
       SLF4J: Found binding in &lt;span class=&quot;error&quot;&gt;&amp;#91;jar:file:/home/XXXX/hive-0.8.1-cdh4.0.1/lib/slf4j-log4j12-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class&amp;#93;&lt;/span&gt;    &lt;br/&gt;
       SLF4J: See &amp;lt;&lt;a href=&quot;http://www.slf4j.org/codes.html#multiple_bindings&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.slf4j.org/codes.html#multiple_bindings&lt;/a&gt;&amp;gt; for an explanation.&lt;br/&gt;
       Job running in-process (local Hadoop)     &lt;br/&gt;
       Hadoop job information for null: number of mappers: 0; number of reducers: 0    &lt;br/&gt;
       2012-10-15 23:07:04,721 null map = 0%,  reduce = 0%    &lt;br/&gt;
       Ended Job = job_local_0001 with errors    &lt;br/&gt;
       Error during job, obtaining debugging information...    &lt;br/&gt;
       *&lt;b&gt;Execution failed with exit status: 2&lt;/b&gt;*    &lt;br/&gt;
       Obtaining error information    &lt;br/&gt;
       *&lt;b&gt;Task failed!&lt;/b&gt;*    &lt;br/&gt;
       Task ID:    &lt;br/&gt;
       Stage-1    &lt;br/&gt;
       Logs:    &lt;br/&gt;
       /tmp/XXXX/hive.log    &lt;br/&gt;
       FAILED: Execution Error, return code 2 from      org.apache.hadoop.hive.ql.exec.MapRedTask  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12611834">HIVE-3579</key>
            <summary>Queries in hive-0.8.1-cdh4.0.1 that invoke the Reducer results in Task Failed. The log file shows the ecxception: java.lang.Exception: java.lang.OutOfMemoryError: Java heap space</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jickson">Jickson T George</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 14:07:16 +0000</created>
                <updated>Mon, 15 Oct 2012 14:07:16 +0000</updated>
                                            <version>0.8.1</version>
                    <version>0.9.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09xxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55937</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3580] STACK() is crashes if an argument is a literal NULL</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3580</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;SELECT foo, bar FROM table LATERAL VIEW STACK(3, 1.0, &apos;a&apos;, NULL, &apos;b&apos;, 2.0, &apos;c&apos;) z AS foo, bar &lt;/p&gt;

&lt;p&gt;fails.  Type conversion between the NULL and the doubles is probably broken in the UDF.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611910">HIVE-3580</key>
            <summary>STACK() is crashes if an argument is a literal NULL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jonchang">Jonathan Chang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 21:11:52 +0000</created>
                <updated>Mon, 15 Oct 2012 21:11:52 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a08n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3581] get_json_object and json_tuple return null in the presence of new line characters</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3581</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This was introduced when these functions were updated to use Jackson.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611924">HIVE-3581</key>
            <summary>get_json_object and json_tuple return null in the presence of new line characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 22:32:59 +0000</created>
                <updated>Thu, 10 Jan 2013 19:54:09 +0000</updated>
                            <resolved>Tue, 16 Oct 2012 05:37:02 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13476552" author="kevinwilfong" created="Mon, 15 Oct 2012 23:03:06 +0000"  >&lt;p&gt;diff here &lt;a href=&quot;https://reviews.facebook.net/D6039&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6039&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13476598" author="namit" created="Tue, 16 Oct 2012 00:17:35 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13476757" author="namit" created="Tue, 16 Oct 2012 05:37:02 +0000"  >&lt;p&gt;Committed. Thanks Kevin&lt;/p&gt;</comment>
                            <comment id="13476965" author="hudson" created="Tue, 16 Oct 2012 12:48:40 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1740 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1740/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1740/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3581&quot; title=&quot;get_json_object and json_tuple return null in the presence of new line characters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3581&quot;&gt;&lt;del&gt;HIVE-3581&lt;/del&gt;&lt;/a&gt; get_json_object and json_tuple return null in the presence of new line characters&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1398654)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1398654&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1398654&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFJson.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_get_json_object.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udtf_json_tuple.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_get_json_object.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13477800" author="philip.tromans" created="Wed, 17 Oct 2012 11:55:24 +0000"  >&lt;p&gt;This patch breaks hive trunk on Hadoop 0.20.205.0, I guess because of the difference in Jackson versions. Running hive gives:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.NoSuchFieldError: ALLOW_UNQUOTED_CONTROL_CHARS&lt;br/&gt;
        at org.apache.hadoop.hive.ql.udf.generic.GenericUDTFJSONTuple.&amp;lt;clinit&amp;gt;(GenericUDTFJSONTuple.java:59)&lt;br/&gt;
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)&lt;br/&gt;
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)&lt;br/&gt;
        at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:113)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.exec.FunctionRegistry.registerGenericUDTF(FunctionRegistry.java:545)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.exec.FunctionRegistry.registerGenericUDTF(FunctionRegistry.java:539)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.exec.FunctionRegistry.&amp;lt;clinit&amp;gt;(FunctionRegistry.java:472)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.session.SessionState.&amp;lt;init&amp;gt;(SessionState.java:202)&lt;br/&gt;
        at org.apache.hadoop.hive.cli.CliSessionState.&amp;lt;init&amp;gt;(CliSessionState.java:86)&lt;br/&gt;
        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:635)&lt;br/&gt;
        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:613)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.util.RunJar.main(RunJar.java:156)&lt;/p&gt;

&lt;p&gt;Backing the patch out makes everything work again.&lt;/p&gt;</comment>
                            <comment id="13479137" author="kevinwilfong" created="Thu, 18 Oct 2012 16:49:16 +0000"  >&lt;p&gt;Sorry about that.  It looks like we&apos;ll either need to set mapreduce.task.classpath.user.precedence to true in Hive, or provide two versions of JSON parsing, one using JSONObject and the other using Jackson, controlled by a config.  I think the former sounds preferable provided it works.&lt;/p&gt;</comment>
                            <comment id="13481952" author="kevinwilfong" created="Mon, 22 Oct 2012 23:56:28 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3607&quot; title=&quot;Set mapreduce.task.classpath.user.precedence to true by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3607&quot;&gt;HIVE-3607&lt;/a&gt; to set mapreduce.task.classpath.user.precedence to true.&lt;/p&gt;</comment>
                            <comment id="13548181" author="hudson" created="Wed, 9 Jan 2013 10:24:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3581&quot; title=&quot;get_json_object and json_tuple return null in the presence of new line characters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3581&quot;&gt;&lt;del&gt;HIVE-3581&lt;/del&gt;&lt;/a&gt; get_json_object and json_tuple return null in the presence of new line characters&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1398654)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1398654&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1398654&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFJson.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFJSONTuple.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_get_json_object.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udtf_json_tuple.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_get_json_object.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550298" author="ashutoshc" created="Thu, 10 Jan 2013 19:54:09 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549230" name="HIVE-3581.1.patch.txt" size="8646" author="kevinwilfong" created="Mon, 15 Oct 2012 23:03:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Oct 2012 00:17:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a0lj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56370</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3582] NPE in union processing followed by lateral view followed by 2 group bys</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3582</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;EXPLAIN &lt;br/&gt;
SELECT e.key, e.arr_ele, count(1) FROM (&lt;br/&gt;
  SELECT d.key as key, d.arr_ele as arr_ele, d.value  as value, count(1) as cnt FROM (&lt;br/&gt;
    SELECT c.arr_ele as arr_ele, a.key as key, a.value as value FROM (&lt;br/&gt;
      SELECT key, value, array(1,2,3) as arr&lt;br/&gt;
      FROM src&lt;/p&gt;

&lt;p&gt;      UNION ALL&lt;/p&gt;

&lt;p&gt;      SELECT key, value, array(1,2,3) as arr&lt;br/&gt;
      FROM srcpart&lt;br/&gt;
      WHERE ds = &apos;2008-04-08&apos; and hr=&apos;12&apos;&lt;br/&gt;
    ) a LATERAL VIEW EXPLODE(arr) c AS arr_ele&lt;br/&gt;
  ) d group by d.key, d.arr_ele, d.value&lt;br/&gt;
) e group by e.key, e.arr_ele;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611926">HIVE-3582</key>
            <summary>NPE in union processing followed by lateral view followed by 2 group bys</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 22:46:01 +0000</created>
                <updated>Thu, 16 May 2013 21:11:04 +0000</updated>
                            <resolved>Mon, 21 Jan 2013 08:23:22 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13477747" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 10:00:02 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-1915 NPE in union processing followed by lateral view followed by 2 group bys&lt;/p&gt;

&lt;p&gt;  EXPLAIN&lt;br/&gt;
  SELECT e.key, e.arr_ele, count(1) FROM (&lt;br/&gt;
    SELECT d.key as key, d.arr_ele as arr_ele, d.value  as value, count(1) as cnt FROM (&lt;br/&gt;
      SELECT c.arr_ele as arr_ele, a.key as key, a.value as value FROM (&lt;br/&gt;
        SELECT key, value, array(1,2,3) as arr&lt;br/&gt;
        FROM src&lt;/p&gt;

&lt;p&gt;        UNION ALL&lt;/p&gt;

&lt;p&gt;        SELECT key, value, array(1,2,3) as arr&lt;br/&gt;
        FROM srcpart&lt;br/&gt;
        WHERE ds = &apos;2008-04-08&apos; and hr=&apos;12&apos;&lt;br/&gt;
      ) a LATERAL VIEW EXPLODE(arr) c AS arr_ele&lt;br/&gt;
    ) d group by d.key, d.arr_ele, d.value&lt;br/&gt;
  ) e group by e.key, e.arr_ele;&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/lib/Utils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink1.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink2.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink3.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink4.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinFactory.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/union_lateralview2.q&lt;br/&gt;
  ql/src/test/results/clientpositive/union_lateralview2.q.out&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/14469/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/14469/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13547604" author="phabricator@reviews.facebook.net" created="Wed, 9 Jan 2013 03:46:12 +0000"  >&lt;p&gt;zhenxiao has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/lib/Utils.java:54 More comments here?&lt;br/&gt;
  Find Node of specific target type in the stack&lt;br/&gt;
  Maybe a more meaningful name, findTargetTypeNode() ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinFactory.java:360 Maybe:&lt;br/&gt;
  boolean local = (pos != mapJoin.getConf().getPosBigTable());&lt;br/&gt;
  ql/src/test/queries/clientpositive/union_lateralview2.q:2 Is it possible to simplify the query?&lt;br/&gt;
  I mean, select less fields, less columns in group by, only keep the simplest query to reproduce the exception.&lt;/p&gt;

&lt;p&gt;  Also, do an ORDER BY to preserve the result order, or select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; with limit to reduce the result size.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: zhenxiao&lt;/p&gt;</comment>
                            <comment id="13547605" author="zhenxiao" created="Wed, 9 Jan 2013 03:48:06 +0000"  >&lt;p&gt;Hi Navis,&lt;/p&gt;

&lt;p&gt;I did an non-committer review. Mostly Good. Leave comments at:&lt;br/&gt;
&lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, maybe we could CC Namit in the Revision?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Zhenxiao&lt;/p&gt;</comment>
                            <comment id="13553686" author="phabricator@reviews.facebook.net" created="Tue, 15 Jan 2013 11:28:12 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/lib/Utils.java:54 ok.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinFactory.java:360 I think it&apos;s same meaning. I&apos;ll add clarifying round brackets.&lt;br/&gt;
  ql/src/test/queries/clientpositive/union_lateralview2.q:2 ok.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: zhenxiao&lt;/p&gt;</comment>
                            <comment id="13553810" author="phabricator@reviews.facebook.net" created="Tue, 15 Jan 2013 13:42:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/lib/Utils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink1.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink2.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink3.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRRedSink4.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinFactory.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/union_lateralview2.q&lt;br/&gt;
  ql/src/test/results/clientpositive/union_lateralview2.q.out&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: zhenxiao&lt;/p&gt;</comment>
                            <comment id="13554110" author="phabricator@reviews.facebook.net" created="Tue, 15 Jan 2013 18:38:12 +0000"  >&lt;p&gt;zhenxiao has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;/p&gt;

&lt;p&gt;  Non-committer +1.&lt;br/&gt;
  Looks good to me.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: zhenxiao&lt;/p&gt;</comment>
                            <comment id="13554114" author="zhenxiao" created="Tue, 15 Jan 2013 18:39:58 +0000"  >&lt;p&gt;Non-commiter +1.&lt;/p&gt;</comment>
                            <comment id="13558178" author="ashutoshc" created="Sun, 20 Jan 2013 07:09:11 +0000"  >&lt;p&gt;+1 Running tests.&lt;/p&gt;</comment>
                            <comment id="13558358" author="ashutoshc" created="Sun, 20 Jan 2013 19:47:41 +0000"  >&lt;p&gt;All the tests passed.&lt;/p&gt;</comment>
                            <comment id="13558566" author="namit" created="Mon, 21 Jan 2013 06:30:03 +0000"  >&lt;p&gt;Looks perfect.&lt;/p&gt;

&lt;p&gt;I had a question: do you think it would be possible to remove currUnionOp from the context&lt;br/&gt;
completely ? That will simplify things a lot.&lt;/p&gt;

&lt;p&gt;I am +1 on this patch as is, you can remove currUnionOp from the context in a follow-up if&lt;br/&gt;
it seems possible.&lt;/p&gt;

&lt;p&gt;Ashutosh, I am assuming you are committing this patch, since you already ran the tests.&lt;/p&gt;</comment>
                            <comment id="13558567" author="phabricator@reviews.facebook.net" created="Mon, 21 Jan 2013 06:30:12 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;/p&gt;

&lt;p&gt;  Looks perfect.&lt;/p&gt;

&lt;p&gt;  I had a question: do you think it would be possible to remove currUnionOp from the context&lt;br/&gt;
  completely ? That will simplify things a lot.&lt;/p&gt;

&lt;p&gt;  I am +1 on this patch as is, you can remove currUnionOp from the context in a follow-up if&lt;br/&gt;
  it seems possible.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: zhenxiao, njain&lt;/p&gt;</comment>
                            <comment id="13558568" author="phabricator@reviews.facebook.net" created="Mon, 21 Jan 2013 06:32:12 +0000"  >&lt;p&gt;njain has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3582&quot; title=&quot;NPE in union processing followed by lateral view followed by 2 group bys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3582&quot;&gt;&lt;del&gt;HIVE-3582&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; NPE in union processing followed by lateral view followed by 2 group bys&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6051&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6051&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-1915&lt;/p&gt;

&lt;p&gt;To: JIRA, njain, navis&lt;br/&gt;
Cc: zhenxiao, njain&lt;/p&gt;</comment>
                            <comment id="13558600" author="navis" created="Mon, 21 Jan 2013 07:59:15 +0000"  >&lt;p&gt;currUnionOp might be removed and I&apos;ve considered it. But I couldn&apos;t sure of that (Codes of genMR* are confusing for me). &lt;/p&gt;</comment>
                            <comment id="13558614" author="ashutoshc" created="Mon, 21 Jan 2013 08:23:22 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Navis. If you figure out a way to get rid of curUnionOp that will simplify the dependency of these function calls, feel free to open a jira and attach patch there.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549483" name="HIVE-3582.D6051.1.patch" size="45674" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 10:00:02 +0000"/>
                            <attachment id="12564924" name="HIVE-3582.D6051.2.patch" size="33237" author="phabricator@reviews.facebook.net" created="Tue, 15 Jan 2013 13:42:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Oct 2012 10:00:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248846</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a0m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56373</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-3583] &apos;parameters&apos; component of DESCRIBE EXTENDED output is non-deterministic</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3583</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12611938">HIVE-3583</key>
            <summary>&apos;parameters&apos; component of DESCRIBE EXTENDED output is non-deterministic</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12550255">HIVE-2935</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                            <label>HiveServer2</label>
                    </labels>
                <created>Tue, 16 Oct 2012 00:03:42 +0000</created>
                <updated>Sat, 6 Dec 2014 09:59:04 +0000</updated>
                                                                            <component>Query Processor</component>
                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13476592" author="cwsteinbach" created="Tue, 16 Oct 2012 00:06:32 +0000"  >&lt;p&gt;This issue was first observed while running TestBeeLineDriver. It is missed by TestCliDriver due to over-aggressive diff-masking in QTestUtil.&lt;/p&gt;

&lt;p&gt;The &apos;totalSize&apos; and &apos;numRows&apos; subcomponents of the &apos;parameters&apos; field are frequently reversed:&lt;/p&gt;

&lt;p&gt;parameters:&lt;/p&gt;
{numPartitions=1, numFiles=3, transient_lastDdlTime=!!UNIXTIME!!, totalSize=636, numRows=0, rawDataSize=0}

&lt;p&gt;vs:&lt;/p&gt;

&lt;p&gt;parameters:&lt;/p&gt;
{numPartitions=1, numFiles=3, transient_lastDdlTime=!!UNIXTIME!!, numRows=0, totalSize=636, rawDataSize=0}

&lt;p&gt;The easiest way to fix this is sort the parameters alphabetically by key name.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a23r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3584] Merging compare predicates</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3584</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Some compare predicates, for example &apos;a&amp;gt;10 AND a&amp;gt;20&apos; can be merged into &apos;a&amp;gt;20&apos;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611983">HIVE-3584</key>
            <summary>Merging compare predicates</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="navis">Navis</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2012 07:31:41 +0000</created>
                <updated>Mon, 23 Dec 2013 23:01:59 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13478501" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 23:50:02 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3584&quot; title=&quot;Merging compare predicates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3584&quot;&gt;HIVE-3584&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Merging compare predicates&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-1914 Merging compare predicates&lt;/p&gt;

&lt;p&gt;  Some compare predicates, for example &apos;a&amp;gt;10 AND a&amp;gt;20&apos; can be merged into &apos;a&amp;gt;20&apos;&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6069&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6069&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FetchOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/pcr/PcrOpProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionPruner.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeConstantDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/FetchWork.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/plan/TestExprNodeDescUtils.java&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_filter_on_outerjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sample8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_count.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_percentile.q.out&lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorUtils.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/14511/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/14511/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13478506" author="navis" created="Wed, 17 Oct 2012 23:54:06 +0000"  >&lt;p&gt;This patch contains input pruning for empty table, which means predicate for TS is FALSE, it does not read anything from it. This was supported behavior for partitioned table but for non-partitioned empty table, it was not.&lt;/p&gt;</comment>
                            <comment id="13482912" author="navis" created="Wed, 24 Oct 2012 02:05:48 +0000"  >&lt;p&gt;1. Queries converted to single FetchTask are not handling empty tables properly. &lt;br/&gt;
2. Equal operator should win all other compares.&lt;br/&gt;
I&apos;ll fix that.&lt;/p&gt;</comment>
                            <comment id="13495755" author="phabricator@reviews.facebook.net" created="Mon, 12 Nov 2012 23:37:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3584&quot; title=&quot;Merging compare predicates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3584&quot;&gt;HIVE-3584&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Merging compare predicates&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Fixed and rebased on trunk&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D6069&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D6069&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java&lt;br/&gt;
  hbase-handler/src/test/queries/positive/ppd_key_ranges.q&lt;br/&gt;
  hbase-handler/src/test/results/positive/hbase_ppd_key_range.q.out&lt;br/&gt;
  hbase-handler/src/test/results/positive/hbase_pushdown.q.out&lt;br/&gt;
  hbase-handler/src/test/results/positive/ppd_key_ranges.q.out&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FetchOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexSearchCondition.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/SimpleFetchOptimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/pcr/PcrOpProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionPruner.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeConstantDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/FetchWork.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;br/&gt;
  ql/src/test/org/apache/hadoop/hive/ql/plan/TestExprNodeDescUtils.java&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_filter_on_outerjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sample8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_count.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_percentile.q.out&lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorUtils.java&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13855998" author="ashutoshc" created="Mon, 23 Dec 2013 23:01:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;This patch contains input pruning for empty table, which means predicate for TS is FALSE, it does not read anything from it. This was supported behavior for partitioned table but for non-partitioned empty table, it was not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To make review easier shall we separate current patch into 2. One for input pruning for non-partitioned empty table. 2nd for actually merging predicates. 2nd one anyway depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3617&quot; title=&quot;Predicates pushed down to hbase is not handled properly when constant part is shown first&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3617&quot;&gt;&lt;del&gt;HIVE-3617&lt;/del&gt;&lt;/a&gt;, so 1st one can get in probably earlier.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12613445">HIVE-3617</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12549606" name="HIVE-3584.D6069.1.patch" size="118776" author="phabricator@reviews.facebook.net" created="Wed, 17 Oct 2012 23:50:02 +0000"/>
                            <attachment id="12553224" name="HIVE-3584.D6069.2.patch" size="138763" author="phabricator@reviews.facebook.net" created="Mon, 12 Nov 2012 23:37:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Oct 2012 23:50:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248922</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a2i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56679</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3585] Integrate Trevni as another columnar oriented file format</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3585</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;add new avro module trevni as another columnar format.New columnar format need a columnar SerDe,seems fastutil is a good choice.the shark project use fastutil library as columnar serde library but it seems too large (almost 15m) for just a few primitive array collection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611990">HIVE-3585</key>
            <summary>Integrate Trevni as another columnar oriented file format</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="mwagner">Mark Wagner</assignee>
                                    <reporter username="gemini5201314">alex gemini</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2012 08:37:17 +0000</created>
                <updated>Wed, 18 Sep 2013 17:22:47 +0000</updated>
                                            <version>0.10.0</version>
                                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>14</votes>
                                    <watches>31</watches>
                                                                                                            <comments>
                            <comment id="13496389" author="he yongqiang" created="Tue, 13 Nov 2012 18:31:40 +0000"  >&lt;p&gt;vote for -1.&lt;/p&gt;

&lt;p&gt;I did not see any benefit of adding one that is just a copycat of rcfile.&lt;/p&gt;</comment>
                            <comment id="13496530" author="cwsteinbach" created="Tue, 13 Nov 2012 20:53:54 +0000"  >&lt;p&gt;@Yongqiang: Trevni aims to offer significant performance improvements over RCFile. Have you read the spec? &lt;a href=&quot;http://avro.apache.org/docs/current/trevni/spec.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/current/trevni/spec.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13496537" author="he yongqiang" created="Tue, 13 Nov 2012 21:03:24 +0000"  >&lt;p&gt;Yeah i read some docs of it. But i really did not see a big difference. Some features can be added to RCFile easily. Please point out if you think there is a dramatic difference in some designs. &lt;/p&gt;</comment>
                            <comment id="13496543" author="russell.jurney" created="Tue, 13 Nov 2012 21:07:40 +0000"  >&lt;p&gt;Trevni is an independent file format. It is not RCFile. It already exists. Why is RCFile relevant to this ticket?&lt;/p&gt;
</comment>
                            <comment id="13496546" author="he yongqiang" created="Tue, 13 Nov 2012 21:10:03 +0000"  >&lt;p&gt;Although it is so similar to RCFIle, i did not see any reference to RCFile in its doc. I assume that will help avoid confusion for its users. But as part of Hive, if we got two formats that are so similar to each other, the confusion will be thrown to all hive users.&lt;/p&gt;</comment>
                            <comment id="13496547" author="russell.jurney" created="Tue, 13 Nov 2012 21:12:08 +0000"  >&lt;p&gt;Can you please explain how supporting additional formats will confuse anyone? This does not seem to follow.&lt;/p&gt;</comment>
                            <comment id="13496944" author="russell.jurney" created="Wed, 14 Nov 2012 08:36:49 +0000"  >&lt;p&gt;It is worth noting that Hive already supports Avro via &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-895&quot; title=&quot;Add SerDe for Avro serialized data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-895&quot;&gt;&lt;del&gt;HIVE-895&lt;/del&gt;&lt;/a&gt;. Trevni is part of Avro. Therefore the possibility for confusion seems minimal.&lt;/p&gt;

&lt;p&gt;Looking at the Serde document &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/SerDe&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/SerDe&lt;/a&gt; it seems the Serde mechanism was created specifically for adding other storage formats to Hive. Restricting Serdes based on their similarity or dissimilarity to RCFile is not covered in this document and seems unusual.&lt;/p&gt;

&lt;p&gt;Pig and other tools are starting to generate Trevni data. There is demand to work with this data in Hive. RCFile seems completely unrelated to this feature JIRA, which is simply an extension of the existing Avro support in Hive.&lt;/p&gt;</comment>
                            <comment id="13542432" author="mwagner" created="Wed, 2 Jan 2013 21:29:15 +0000"  >&lt;p&gt;I&apos;m taking this over for Jakob. Please add me as a contributor so that I can assign this ticket to myself.&lt;/p&gt;</comment>
                            <comment id="13542442" author="jghoman" created="Wed, 2 Jan 2013 21:34:52 +0000"  >&lt;p&gt;Also, He, I&apos;m assuming your -1 is not intended to be a veto? I don&apos;t believe it would hold up technically.  Trevni is essentially a variation on Avro.  Not letting people read their Trevni-encoded data in Hive just because there&apos;s already another columnar format doesn&apos;t seem like a good way forward.&lt;/p&gt;</comment>
                            <comment id="13543253" author="he yongqiang" created="Thu, 3 Jan 2013 20:29:36 +0000"  >&lt;p&gt;@jakob, you can always implement reader of customized data in a 3rd party lib and let hive load it from there.&lt;/p&gt;</comment>
                            <comment id="13543260" author="cwsteinbach" created="Thu, 3 Jan 2013 20:39:23 +0000"  >&lt;p&gt;I don&apos;t think there&apos;s any harm in adding this to Hive. There is already overlap among the existing SerDes that are included with Hive (e.g. Avro and Thrift) and no one seems to care about that. &lt;/p&gt;</comment>
                            <comment id="13543294" author="he yongqiang" created="Thu, 3 Jan 2013 21:23:51 +0000"  >&lt;p&gt;@Carl, adding code that is not much used is always no harm except a lot of maintenance and document pain. You can first go with a contrib folder or a 3rd party lib and merge to core hive later if it proves success. &lt;/p&gt;</comment>
                            <comment id="13543314" author="jghoman" created="Thu, 3 Jan 2013 21:45:31 +0000"  >&lt;p&gt;And we have active users and contributors to this code (myself, Mark, Sean, etc.).  There&apos;s essentially no chance this will be orphaned on arrival.&lt;/p&gt;</comment>
                            <comment id="13543324" author="busbey" created="Thu, 3 Jan 2013 21:51:48 +0000"  >&lt;p&gt;+1 to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jghoman&quot; class=&quot;user-hover&quot; rel=&quot;jghoman&quot;&gt;Jakob Homan&lt;/a&gt;&apos;s sentiments, for what it&apos;s worth.&lt;/p&gt;

&lt;p&gt;It&apos;s been my experience that the support cost of some code and documentation is proportional to feature use. People rarely notice inaccuracies and bugs in stuff that doesn&apos;t get used. Unused SerDes can always get backed out on next breaking change. &lt;/p&gt;</comment>
                            <comment id="13543360" author="he yongqiang" created="Thu, 3 Jan 2013 22:28:01 +0000"  >&lt;p&gt;@jakob, awesome to hear you are planning to own its maintenance. No particular intention to complicate your use case here, but i think a 3rd party lib or contrib folder would be good start and won&apos;t affect your usage. If i remember correctly, we used to do similar things for Pig&apos;s Zebra.&lt;/p&gt;</comment>
                            <comment id="13543378" author="jghoman" created="Thu, 3 Jan 2013 22:46:34 +0000"  >&lt;p&gt;But the Avro Serde wasn&apos;t added to a contrib package (org.apache.hadoop.hive.serde2.avro.AvroSerDe) - so why should its Trevni variant be?  They share a &lt;b&gt;lot&lt;/b&gt; of code.  If it weren&apos;t for some subtle problems with updating partition schemas, I&apos;d probably have just gone ahead and made read/write from trevni a table property of tables using the AvroSerde rather than have a separate TrevniSerde....&lt;/p&gt;</comment>
                            <comment id="13543391" author="he yongqiang" created="Thu, 3 Jan 2013 22:58:29 +0000"  >&lt;p&gt;Thanks for just reminding me that there is already a Avro serde. Have you tried to make the required changes to be part of the existing Avro serde instead of creating a new one?&lt;/p&gt;</comment>
                            <comment id="13543401" author="jghoman" created="Thu, 3 Jan 2013 23:13:57 +0000"  >&lt;p&gt;yeah.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If it weren&apos;t for some subtle problems with updating partition schemas, I&apos;d probably have just gone ahead and made read/write from trevni a table property of tables using the AvroSerde rather than have a separate TrevniSerde....&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13543413" author="he yongqiang" created="Thu, 3 Jan 2013 23:30:49 +0000"  >&lt;p&gt;I did not get why it does not work with partition schema update. &lt;/p&gt;</comment>
                            <comment id="13544211" author="russell.jurney" created="Fri, 4 Jan 2013 20:11:29 +0000"  >&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3015&quot; title=&quot;Rewrite of AvroStorage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3015&quot;&gt;&lt;del&gt;PIG-3015&lt;/del&gt;&lt;/a&gt;, Apache Pig will soon be generating many petabytes of Apache Trevni data, as a builtin. There is every reason for Hive to read this data, as a builtin. With Apache HCatalog, a Hive Trevni builtin can be used to load Apache Trevni data in Apache Hadoop MapReduce, Apache Pig, Apache Hive, Shark and eventually Apache Hadoop streaming. Integration between these tools will create much value for many users.&lt;/p&gt;

&lt;p&gt;Please note that Apache Trevni is part of Apache Avro, and was developed completely in the open, under Apache governance: &lt;a href=&quot;http://avro.apache.org/docs/current/trevni/spec.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/current/trevni/spec.html&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="13544213" author="russell.jurney" created="Fri, 4 Jan 2013 20:12:42 +0000"  >&lt;p&gt;Also note this ticket currently has 3 votes and 15 watchers.&lt;/p&gt;</comment>
                            <comment id="13544225" author="appodictic" created="Fri, 4 Jan 2013 20:25:11 +0000"  >&lt;p&gt;Question. Will Trevni but just another Serde/inputFormat combination of will it involve large scale changes to hive?&lt;/p&gt;</comment>
                            <comment id="13544229" author="appodictic" created="Fri, 4 Jan 2013 20:30:36 +0000"  >&lt;p&gt;In our wiki hive states:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Home&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/Home&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Hive does not mandate read or written data be in the &quot;Hive format&quot;---there is no such thing. Hive works equally well on Thrift, control delimited, or your specialized data formats. Please see File Format and SerDe in the Developer Guide for details.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So if the new format does not require large scale changes to accommodate I see no issues, and would be +1.&lt;/p&gt;</comment>
                            <comment id="13544237" author="jghoman" created="Fri, 4 Jan 2013 20:44:32 +0000"  >&lt;blockquote&gt;&lt;p&gt;Will Trevni but just another Serde/inputFormat combination of will it involve large scale changes to hive?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Just another serde/inputformat combination.  In fact, for Avro-wrapped Trevni, it&apos;ll just be AvroSerde + Trevni&lt;/p&gt;
{I|O}Format.  For raw Trevni data it&apos;ll just be TrevniSerde + (probably) (?Raw)Trevni{I|O}
&lt;p&gt;Format.  This is not a big patch and doesn&apos;t require any more changes to Hive than AvroSerde did - none at all.  As I mentioned above, a veto on this can&apos;t be sustained on technical grounds, so I&apos;m happy to re-assure He as to his concerns, but I don&apos;t see any reason not to proceed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I did not get why it does not work with partition schema update.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I didn&apos;t want to try to mix Avro-style schemas and Trevni-style schemas, but Mark has a way around that.&lt;/p&gt;</comment>
                            <comment id="13544253" author="appodictic" created="Fri, 4 Jan 2013 21:04:48 +0000"  >&lt;p&gt;On one end when I look at hadoop core there is ALOT of stuff not really core to anything. A good example is DBInputFormat.&lt;/p&gt;

&lt;p&gt;In Hive&apos;s case we do have quite a big code base, and at some point we may have so many UDF&apos;s and InputFormat&apos;s that we should draw a line on critical/vs extra. But we are not there yet. If it is just another serde+inputformat I am 100% +1. &lt;/p&gt;

&lt;p&gt;Having hive avro gave us a big boost in project exposure and will help keep the ball rolling. Not everyone uses avro I/WE don&apos;t. But I really hate when I read a wiki with something to the effect of &quot;Hive doesn&apos;t support X&quot; when it actually does and X is just something easy waiting in the patch queue. Bring it on!&lt;/p&gt;

</comment>
                            <comment id="13544382" author="he yongqiang" created="Sat, 5 Jan 2013 00:36:49 +0000"  >&lt;p&gt;So far i am still not convinced to have it as another builtin serde in Hive&apos;s core codebase. We initially did put some new serdes in contrib or 3rd party libs, examples include HBaseSerde and Zebra serde.&lt;/p&gt;

&lt;p&gt;If you can make it work with existing Avro serde, it will also be great.&lt;/p&gt;</comment>
                            <comment id="13544541" author="russell.jurney" created="Sat, 5 Jan 2013 02:56:17 +0000"  >&lt;p&gt;Pig is adding TrevniStorage as a builtin, and interoperability is desired.&lt;/p&gt;</comment>
                            <comment id="13544569" author="appodictic" created="Sat, 5 Jan 2013 04:10:27 +0000"  >&lt;p&gt;I do not follow your point . HbaseSerde is not in trunk/contrib, it is it&apos;s own subfolder and I do not any zerbra support in hive. Maybe you are thinking of some other contrib besides trunk/config?&lt;/p&gt;</comment>
                            <comment id="13545661" author="namit" created="Mon, 7 Jan 2013 06:25:41 +0000"  >&lt;p&gt;Will Trevni work without needing Avro ? Is it a stand-alone file format which some users of hive&lt;br/&gt;
(not using avro) can benefit from ?&lt;/p&gt;</comment>
                            <comment id="13546152" author="he yongqiang" created="Mon, 7 Jan 2013 18:56:04 +0000"  >&lt;p&gt;HBaseSerde is first added to contrib and then moved to core later.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Pig is adding TrevniStorage as a builtin, and interoperability is desired.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think interoperability is not a problem no matter where the code residents.&lt;/p&gt;</comment>
                            <comment id="13546170" author="busbey" created="Mon, 7 Jan 2013 19:11:41 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;~namita&amp;#93;&lt;/span&gt; Trevni defines a columnar format that can be used with different serialization systems. I believe initial efforts across different components are planning to use Avro for serialization.&lt;/p&gt;

&lt;p&gt;Eventually, Trevni support should also work for Thrift and Protobufs.&lt;/p&gt;</comment>
                            <comment id="13546210" author="cwsteinbach" created="Mon, 7 Jan 2013 19:56:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;HBaseSerde is first added to contrib and then moved to core later.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And what did this accomplish? Wouldn&apos;t it have been better to put it in core to begin with? In fact, can anyone tell me why we shouldn&apos;t abolish contrib altogether?&lt;/p&gt;</comment>
                            <comment id="13546348" author="he yongqiang" created="Mon, 7 Jan 2013 22:30:33 +0000"  >&lt;p&gt;contrib is a good place for any projects that is not mature. There are so many custom data formats out there, it does not make sense to support all of them in core hive code base. contrib is a good place for them to grow. &lt;/p&gt;

&lt;p&gt;From &lt;a href=&quot;http://incubator.apache.org/hcatalog/docs/r0.4.0/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://incubator.apache.org/hcatalog/docs/r0.4.0/&lt;/a&gt;, another good place i can think of is the hcatalog project. But i don&apos;t know if hcatalog itself includes custom data format support or not.&lt;/p&gt;</comment>
                            <comment id="13546400" author="cwsteinbach" created="Mon, 7 Jan 2013 23:18:09 +0000"  >&lt;p&gt;The only concrete difference between core and contrib that I&apos;m aware of is that the latter doesn&apos;t appear on Hive&apos;s classpath by default. As such I can only see two advantages to putting code in contrib: 1) it makes it harder for folks to use, and 2) it makes it harder for us to test. Did I miss anything?&lt;/p&gt;</comment>
                            <comment id="13546516" author="russell.jurney" created="Tue, 8 Jan 2013 02:00:54 +0000"  >&lt;p&gt;He, HCatalog uses Hive Serde. By adding the Trevni builtin for Apache Hive, Apache Hive, Shark, Apache HCatalog and Apache Pig will all get Trevni support. Synergy, baby!&lt;/p&gt;

&lt;p&gt;Apache Trevni is part of an actual Apache top-level project, Apache Avro, so it is nothing like Zebra, which I notice you reported yourself for addition in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-781&quot; title=&quot;Integrate Zebra with Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-781&quot;&gt;&lt;del&gt;HIVE-781&lt;/del&gt;&lt;/a&gt;. Avro and Trevni are specifically designed for Hadoop workloads, and other tools like Pig are including Trevni immediately.&lt;/p&gt;</comment>
                            <comment id="13546517" author="russell.jurney" created="Tue, 8 Jan 2013 02:01:55 +0000"  >&lt;p&gt;This ticket now has 5 votes, and 22 watchers. Support for a Trevni builtin is overwhelming.&lt;/p&gt;</comment>
                            <comment id="13546522" author="russell.jurney" created="Tue, 8 Jan 2013 02:09:04 +0000"  >&lt;p&gt;Relates to &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-806&quot; title=&quot;add a column-major file format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-806&quot;&gt;&lt;del&gt;AVRO-806&lt;/del&gt;&lt;/a&gt;, see goals/differences from RCFile.&lt;/p&gt;</comment>
                            <comment id="13546609" author="namit" created="Tue, 8 Jan 2013 04:43:52 +0000"  >&lt;p&gt;The main reason that contrib exists is to add new features/projects which are being tested, may take some time to&lt;br/&gt;
mature, and are reasonably stand-alone, so that they dont need many changes in existing code. New serdes/fileformats/udfs&lt;br/&gt;
are good usecases for them.&lt;/p&gt;

&lt;p&gt;I dont see why is testing/development in contrib so difficult or different as compared to development in any other component.&lt;br/&gt;
This is the reason why contrib was added, so new stand-alone components can bake. We can definitely move it from contrib, once&lt;br/&gt;
it is mature/safe.&lt;/p&gt;

&lt;p&gt;Why is development in contrib such a bad idea ?&lt;/p&gt;</comment>
                            <comment id="13547117" author="namit" created="Tue, 8 Jan 2013 18:55:58 +0000"  >&lt;p&gt;This would be really useful to the community. Also, no-one answered my earlier question - can this be used without Avro in hive ?&lt;/p&gt;</comment>
                            <comment id="13547122" author="busbey" created="Tue, 8 Jan 2013 19:03:22 +0000"  >&lt;p&gt;@Namit My earlier comment was meant to answer this&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Trevni defines a columnar format that can be used with different serialization systems. I believe initial efforts across different components are planning to use Avro for serialization.&lt;/p&gt;

&lt;p&gt;Eventually, Trevni support should also work for Thrift and Protobufs.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In short, Trevni always requires a serialization format. Current efforts across components are focused on Avro as the first implementation. With that, users will need access to the Avro libraries.&lt;/p&gt;</comment>
                            <comment id="13547233" author="jghoman" created="Tue, 8 Jan 2013 20:39:07 +0000"  >&lt;p&gt;Expanding on what Sean said.  Yes, there will be a TrevniSerde that doesn&apos;t write Avro but happens to require the Avro libraries.  And there will be an extension to the AvroSerde that writes Trevni-encoded Avro.  &lt;/p&gt;

&lt;p&gt;This patch is going to share 90% of its small code with the existing AvroSerde that was never shunted into contrib.  Why should this variation be?  There are active users and developers of this code.  Again, I&apos;m not seeing any technical reasons to block progress.  Is anyone planning on exercising a -1?&lt;/p&gt;</comment>
                            <comment id="13550347" author="he yongqiang" created="Thu, 10 Jan 2013 20:02:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;This patch is going to share 90% of its small code with the existing AvroSerde that was never shunted into contrib. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Then why it is so hard to make it part of existing AvroSerde?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m not seeing any technical reasons to block progress. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Technically, there is no issue. Technically I am pretty sure this can be well done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is anyone planning on exercising a -1?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have listed two options that i insist on. one is to develop it as part of existing avroserde, the other is to put it in contrib or a 3rd party lib (maybe github?).&lt;/p&gt;
</comment>
                            <comment id="13565872" author="mwagner" created="Tue, 29 Jan 2013 22:10:28 +0000"  >&lt;p&gt;Patch attached. Some notes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This patch implements a SerDe for Avro wrapped Trevni, which allows it to be implemented as a separate file format for the existing AvroSerDe&lt;/li&gt;
	&lt;li&gt;This patch contains contributions from Srinivas Vemuri derived from uncommitted patches to Haivvreo&lt;/li&gt;
	&lt;li&gt;Avro version has been bumped to 1.7.3 to bring in trevni&lt;/li&gt;
	&lt;li&gt;trevni-avro and trevni-core modules of Avro are now included&lt;/li&gt;
	&lt;li&gt;The test avro_partition_format.q has no corresponding *.q.out file due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3953&quot; title=&quot;Reading of partitioned Avro data fails because of missing properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3953&quot;&gt;&lt;del&gt;HIVE-3953&lt;/del&gt;&lt;/a&gt;. What&apos;s the best way to handle this test? Include it knowing it will fail, wait until &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3953&quot; title=&quot;Reading of partitioned Avro data fails because of missing properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3953&quot;&gt;&lt;del&gt;HIVE-3953&lt;/del&gt;&lt;/a&gt; is resolved to commit, or another option?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13629366" author="fsaintjacques" created="Thu, 11 Apr 2013 21:02:06 +0000"  >&lt;p&gt;The Avro team suggest the use of 1.7.4 instead of 1.7.3 see &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1259&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1259&lt;/a&gt; .&lt;/p&gt;
</comment>
                            <comment id="13709400" author="appodictic" created="Tue, 16 Jul 2013 03:00:10 +0000"  >&lt;p&gt;+1 with one minor comment. It seems like the SELECT in the q tests are all &apos;SELECT *&apos; those do not really test the map/reduce path. Please do a column pruning operation like select col1, or select distinct(column1). &lt;/p&gt;</comment>
                            <comment id="13713370" author="yhuai" created="Fri, 19 Jul 2013 06:14:32 +0000"  >&lt;p&gt;I am concerned about the performance of Trevni. Please correct me if my explanation is not accurate.&lt;/p&gt;

&lt;p&gt;First, seems we store a column by multiple compression blocks and the size of a block is around 64 KiB. When the reader reads data from a stored table, we read a compression block at a time. Because the reader is row-oriented, in the worst case, the reader needs to seek to another column after reading every single compression block. As pointed out in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1208&quot; title=&quot;Improve Trevni&amp;#39;s performance on row-oriented data access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1208&quot;&gt;&lt;del&gt;AVRO-1208&lt;/del&gt;&lt;/a&gt;, the performance degradation is significant. &lt;/p&gt;

&lt;p&gt;Second, since we read a compression unit at a time, when the size of a compression unit is smaller than the size of buffer used in the BufferedInputStream inside BlockReader, we may not be able to efficiently read data. We will just use a portion of data fetched by BufferedInputStream and the rest of data cannot be used. I have experience that the performance of Trevni on HDFS without short circuit is not good. I think this issue may be the reason. But I have not dug very deep.&lt;/p&gt;</comment>
                            <comment id="13767383" author="appodictic" created="Sat, 14 Sep 2013 06:41:17 +0000"  >&lt;p&gt;Would anyone like to rebase this patch. It no longer applies on trunk due to other avro changes.&lt;/p&gt;</comment>
                            <comment id="13767543" author="busbey" created="Sat, 14 Sep 2013 19:11:07 +0000"  >&lt;p&gt;I&apos;ve got the patch rebased to work on trunk, and I&apos;ve got additional tests to force the MR path. Unfortunately, even through &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3953&quot; title=&quot;Reading of partitioned Avro data fails because of missing properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3953&quot;&gt;&lt;del&gt;HIVE-3953&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4789&quot; title=&quot;FetchOperator fails on partitioned Avro data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4789&quot;&gt;&lt;del&gt;HIVE-4789&lt;/del&gt;&lt;/a&gt; are no longer a problem, I still get test failures. I think it&apos;s from the part of the &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4789&quot; title=&quot;FetchOperator fails on partitioned Avro data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4789&quot;&gt;&lt;del&gt;HIVE-4789&lt;/del&gt;&lt;/a&gt; patch that was left out due to not having an applicable test case.&lt;/p&gt;

&lt;p&gt;Care for the updated patch w/o applicable .out files now? That way once I get an issue filed and fixed for just that last part of local-only avro+partitioned support someone just has to get test outputs?&lt;/p&gt;</comment>
                            <comment id="13767575" author="yhuai" created="Sat, 14 Sep 2013 20:46:28 +0000"  >&lt;p&gt;My impression is that &lt;a href=&quot;http://www.dbms2.com/2013/06/23/impala-and-parquet/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Parquet is the replacement of Trevni&lt;/a&gt;. So, my question is if there is any serious user of it.&lt;/p&gt;</comment>
                            <comment id="13767876" author="appodictic" created="Sun, 15 Sep 2013 18:30:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;Yin Huai&lt;/a&gt; We have no way of judging who is using what. Maybe more people would be using Trevni if we (committers) had focused on getting the hive support committed. There are 34 watchers, and avro is here to stay. There seems to be a bit of &quot;politics&quot; around what is part of hive and what is not. Hive has support for other columnar inputs formats so who are we do say what should or should not be in hive? &lt;/p&gt;</comment>
                            <comment id="13767892" author="mwagner" created="Sun, 15 Sep 2013 20:08:14 +0000"  >&lt;p&gt;As Yin said, Parquet has mostly taken the mindshare from Trevni. Looking at the Avro jira, it does seem that there are a few users of Trevni. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appodictic&quot; class=&quot;user-hover&quot; rel=&quot;appodictic&quot;&gt;Edward Capriolo&lt;/a&gt;, if you&apos;d like to include this for them, then that&apos;s fine. The only change to the Avro Serde was a bit of refactoring, so it shouldn&apos;t be any burden on the &quot;main&quot; Avro Serde. That said, I think it&apos;d be good for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4732&quot; title=&quot;Reduce or eliminate the expensive Schema equals() check for AvroSerde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4732&quot;&gt;&lt;del&gt;HIVE-4732&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4734&quot; title=&quot;Use custom ObjectInspectors for AvroSerde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4734&quot;&gt;HIVE-4734&lt;/a&gt; to go in first. Both of those should be ready to commit shortly and will require a bit more rebasing of this patch. Also, the Avro version should get bumped to 1.7.5.&lt;/p&gt;</comment>
                            <comment id="13767899" author="appodictic" created="Sun, 15 Sep 2013 20:20:09 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Care for the updated patch w/o applicable .out files now? That way once I get an issue filed and fixed for just that last part of local-only avro+partitioned support someone just has to get test outputs?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I would rather just fix it as part of this issue. We do not have to create issues just for the sake of creating issues. Unless you want to.&lt;/p&gt;</comment>
                            <comment id="13767983" author="cwsteinbach" created="Mon, 16 Sep 2013 01:13:32 +0000"  >&lt;p&gt;I agree with what Ed said earlier and want to add that as a project we shouldn&apos;t put ourselves in the position of picking winners and losers when it comes battles between competing data serialization formats. As long as a patch like this meets the same code quality standards that we apply to every other patch I think it should get committed.&lt;/p&gt;</comment>
                            <comment id="13770497" author="busbey" created="Wed, 18 Sep 2013 06:33:29 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5302&quot; title=&quot;PartitionPruner logs warning on Avro non-partitioned data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5302&quot;&gt;&lt;del&gt;HIVE-5302&lt;/del&gt;&lt;/a&gt; for the last of the &quot;Avro needs table information when a partition doesn&apos;t have it&quot; issues, which is the failure I mentioned here. It touches a bunch of things unrelated to this, so I broke it out.&lt;/p&gt;</comment>
                            <comment id="13770798" author="busbey" created="Wed, 18 Sep 2013 14:13:21 +0000"  >&lt;p&gt;Updated patch rebased onto trunk. &lt;a href=&quot;https://reviews.apache.org/r/14204/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;review board&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5302&quot; title=&quot;PartitionPruner logs warning on Avro non-partitioned data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5302&quot;&gt;&lt;del&gt;HIVE-5302&lt;/del&gt;&lt;/a&gt; being applied to allow testing&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Updated Avro to 1.7.5&lt;/li&gt;
	&lt;li&gt;update AvroRecordReaderBase for changes that have since happened in AvroGenericRecordReader&lt;/li&gt;
	&lt;li&gt;added client positive queries that hit MR, per feedback from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appodictic&quot; class=&quot;user-hover&quot; rel=&quot;appodictic&quot;&gt;Edward Capriolo&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;added .out for avro_parition_format.q&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Personally, I think the performance issues can wait for a follow up ticket. esp once we can use a version of Trevni that has a solution for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1208&quot; title=&quot;Improve Trevni&amp;#39;s performance on row-oriented data access&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1208&quot;&gt;&lt;del&gt;AVRO-1208&lt;/del&gt;&lt;/a&gt; in place.&lt;/p&gt;</comment>
                            <comment id="13770800" author="busbey" created="Wed, 18 Sep 2013 14:15:08 +0000"  >&lt;p&gt;and since I forgot to tell the precommit build bot not ot try to test it, that&apos;s going to fail since it won&apos;t have the futurama_episodes.avro file.&lt;/p&gt;</comment>
                            <comment id="13770826" author="appodictic" created="Wed, 18 Sep 2013 14:42:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt; I will commit the avro data (there is no harm in that) where is it supposed to go? &lt;/p&gt;</comment>
                            <comment id="13770850" author="busbey" created="Wed, 18 Sep 2013 15:06:58 +0000"  >&lt;p&gt;It goes in &lt;em&gt;data/files/&lt;/em&gt;&lt;/p&gt;</comment>
                            <comment id="13770877" author="appodictic" created="Wed, 18 Sep 2013 15:22:41 +0000"  >&lt;p&gt;Re-uplloaded the patch and hit SUBMIT_PATCH testing should begin soon.&lt;/p&gt;</comment>
                            <comment id="13770977" author="hiveqa" created="Wed, 18 Sep 2013 17:13:24 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12603845/HIVE-3585.3.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12603845/HIVE-3585.3.patch.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 3129 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_avro_partition_format
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/803/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/803/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/803/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/803/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13770985" author="brocknoland" created="Wed, 18 Sep 2013 17:22:47 +0000"  >&lt;p&gt;Error message is here &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-803/failed/TestCliDriver-multigroupby_singlemr.q-nestedvirtual.q-join_vc.q-and-12-more/hadoop.log&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-Build-803/failed/TestCliDriver-multigroupby_singlemr.q-nestedvirtual.q-join_vc.q-and-12-more/hadoop.log&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12668963">HIVE-5302</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12629597">HIVE-3953</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12654871">HIVE-4789</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12613793">FLUME-1669</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12504731">AVRO-806</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12630438">AVRO-1241</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12613954">PIG-3015</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12438666">HIVE-895</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12626885">AVRO-1229</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12567061" name="HIVE-3585.1.patch.txt" size="56626" author="mwagner" created="Tue, 29 Jan 2013 22:10:28 +0000"/>
                            <attachment id="12603831" name="HIVE-3585.2.patch.txt" size="79019" author="busbey" created="Wed, 18 Sep 2013 14:13:21 +0000"/>
                            <attachment id="12603845" name="HIVE-3585.3.patch.txt" size="79019" author="appodictic" created="Wed, 18 Sep 2013 15:21:41 +0000"/>
                            <attachment id="12567062" name="futurama_episodes.avro" size="3044" author="mwagner" created="Tue, 29 Jan 2013 22:10:28 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12669267">HIVE-5310</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Nov 2012 18:31:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248930</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a2jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56687</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3586] External partition</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3586</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;External tables are extremely useful when two or more tables share the same data but would like to avoid the data copy and ownership conflicts. We found it useful to extend the &quot;external&quot; concept to the partition level: some partitions of a managed table could be external, so that dropping an external partition won&apos;t delete the data. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12612077">HIVE-3586</key>
            <summary>External partition</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2012 18:07:02 +0000</created>
                <updated>Tue, 16 Oct 2012 18:07:02 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249089</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a4ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-3587] Lost data during INSERT query</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3587</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I&apos;m trying to load a table using an INSERT query (1).  Not all the data is making it from the original table into the new table.  The query generates 2 jobs.  The first job takes about 45 minutes with mapred.mapper.class = org.apache.hadoop.hive.ql.io.rcfile.merge.RCFileMergeMapper and the second takes ~10 seconds with mapred.mapper.class = org.apache.hadoop.hive.ql.exec.ExecMapper.  Toward the end (&amp;lt; 2 minutes) of the first job a number of IOExceptions are raised (2).  The exceptions are only raised in the last mapper task to complete, the other mapper tasks complete successfully.  The exceptions indicate that an expected temporary file is missing.  The second jobs completes entirely successfully.  According to the task tracker web interface the jobs are run sequentially with no overlap.  However, the second job spawns a number of tasks which rename the very temporary files that are the cause of the failures in the first job (3).&lt;/p&gt;

&lt;p&gt;(1) &lt;a href=&quot;https://cwiki.apache.org/Hive/languagemanual-dml.html#LanguageManualDML-InsertingdataintoHiveTablesfromqueries&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/Hive/languagemanual-dml.html#LanguageManualDML-InsertingdataintoHiveTablesfromqueries&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(2) Example: ERROR org.apache.hadoop.hdfs.DFSClient: Failed to close file /tmp/hive-hive/hive_2012-10-15_13-45-21_245_1936216192130095423/_task_tmp.-ext-10002/month=2012-01/_tmp.000000_1&lt;br/&gt;
org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /tmp/hive-hive/hive_2012-10-15_13-45-21_245_1936216192130095423/&lt;em&gt;task_tmp.-ext-10002/month=2012-01/_tmp.000000_1 File does not exist. Holder DFSClient_NONMAPREDUCE&lt;/em&gt;-672101740_1 does not have any open files.&lt;/p&gt;

&lt;p&gt;(3) Example: 2012-10-16 15:36:57,605 INFO RCFileMergeMapper: renamed path hdfs://analysis-hadoop-master/tmp/hive-hive/hive_2012-10-16_14-48-47_633_7033175453889409541/_task_tmp.-ext-10000/month=2012-01/_tmp.000011_0 to hdfs://analysis-hadoop-master/tmp/hive-hive/hive_2012-10-16_14-48-47_633_7033175453889409541/_tmp.-ext-10000/month=2012-01/000011_0 . File size is 3482&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 10.04&lt;br/&gt;
Hadoop MapReduce 0.20.2&lt;br/&gt;
Cloudera 4.1.0&lt;br/&gt;
3 data/task nodes&lt;/p&gt;</environment>
        <key id="12612127">HIVE-3587</key>
            <summary>Lost data during INSERT query</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jimmyk-rdio">Jim Krehl</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Oct 2012 23:30:33 +0000</created>
                <updated>Tue, 16 Oct 2012 23:31:28 +0000</updated>
                                            <version>0.9.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249156</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a5ef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>
