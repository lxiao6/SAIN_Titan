<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:12:49 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2009-1-27+AND+created+%3C%3D+2009-2-3+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="16" total="16"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-252] Automatically add CLUSTER BY and set the number of reducers if the target table is declared with &quot;CLUSTERED BY (xxx) INTO yyy BUCKETS&quot;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-252</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We should automatically add a &quot;cluster by&quot; clause to the following query with 64 reducers.&lt;/p&gt;

&lt;p&gt;CREATE TABLE aaa (a BIGINT, b INT)&lt;br/&gt;
PARTITIONED BY(ds STRING)&lt;br/&gt;
CLUSTERED BY(a) INTO 64 BUCKETS &lt;br/&gt;
STORED AS SEQUENCEFILE;&lt;/p&gt;

&lt;p&gt;INSERT OVERWRITE TABLE aaa PARTITION(ds=&apos;2009-01-24&apos;)&lt;br/&gt;
SELECT a.a, a.b&lt;br/&gt;
FROM training_set a&lt;br/&gt;
WHERE a.ds = &apos;2009-01-24&apos;;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413338">HIVE-252</key>
            <summary>Automatically add CLUSTER BY and set the number of reducers if the target table is declared with &quot;CLUSTERED BY (xxx) INTO yyy BUCKETS&quot;</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Jan 2009 01:51:56 +0000</created>
                <updated>Wed, 28 Jan 2009 07:27:08 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12667571" author="jsensarma" created="Tue, 27 Jan 2009 03:12:13 +0000"  >&lt;p&gt;if we are going down this line - this should be generalized. an insert to any clustered table would have to check that the data is clustered by the right key prior to the insertion. &lt;/p&gt;

&lt;p&gt;the query re-write may not be so obvious in all cases where a violation of the above is detected. it would be more consistent user experience to &apos;suggest&apos; the right query where possible.&lt;/p&gt;

&lt;p&gt;there&apos;s the flip side to this - to set the clustering property on the inserted table/partition in case the query is constructed in this manner (what Adam was asking for a couple of days back)&lt;/p&gt;</comment>
                            <comment id="12667796" author="athusoo" created="Tue, 27 Jan 2009 20:27:45 +0000"  >&lt;p&gt;I think what Zheng is suggesting is that if the DDL has a clustering then before the filesinkoperator we introduce the plan fragment for cluster by. &lt;/p&gt;

&lt;p&gt;I guess we could eliminate any non needed cluster bys from the operator plan using the tree walker so we would not incur the cost of another clustering if the data is already being clustered..&lt;/p&gt;</comment>
                            <comment id="12667954" author="jsensarma" created="Wed, 28 Jan 2009 07:27:08 +0000"  >&lt;p&gt;suppose i have &lt;/p&gt;

&lt;p&gt;... cluster by a.x insert overwrite table T select a.x+1,...;&lt;/p&gt;

&lt;p&gt;where T is declared clustered on first column. clearly the query does not require any modification - but it will be hard to detect this in the compiler. or i am missing something.&lt;/p&gt;

&lt;p&gt;did someone request this? (a little curious - since i think that the act of declaring a table to be clustered would be typically done by an advanced user. such users can write the correct query without a lot of compiler smarts. if, on the other hand, we want to help out the average user - we would be a lot better served by inferring and storing  the clustering property of the target table/partition automatically from the query - so that we can leverage it for future plans).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Jan 2009 03:12:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42873</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8rj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122070</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-253] rand() gets precomputated in compilation phase</title>
                <link>https://issues.apache.org/jira/browse/HIVE-253</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;SELECT * FROM t WHERE rand() &amp;lt; 0.01;&lt;/p&gt;

&lt;p&gt;Hive will say: &quot;No need to submit job&quot;, because the condition evaluates to false.&lt;/p&gt;

&lt;p&gt;The rand() function is special in the sense that every time it evaluates to a different value. We should disallow computing the value in the compiling phase.&lt;/p&gt;

&lt;p&gt;One way to do that is to add an annotation in the UDFRand and check that in the compiling phase.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12413425">HIVE-253</key>
            <summary>rand() gets precomputated in compilation phase</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsm">Raghotham Murthy</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2009 00:52:34 +0000</created>
                <updated>Sat, 17 Dec 2011 00:09:01 +0000</updated>
                            <resolved>Wed, 18 Mar 2009 22:02:38 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12667899" author="indigoviolet" created="Wed, 28 Jan 2009 01:03:39 +0000"  >&lt;p&gt;marking as blocker as per athusoo&apos;s recommendation. &lt;/p&gt;</comment>
                            <comment id="12668626" author="athusoo" created="Thu, 29 Jan 2009 21:56:53 +0000"  >&lt;p&gt;Marking this for 0.2.0 version.&lt;/p&gt;</comment>
                            <comment id="12681569" author="athusoo" created="Fri, 13 Mar 2009 01:08:14 +0000"  >&lt;p&gt;Load balancing...&lt;/p&gt;</comment>
                            <comment id="12682127" author="rsm" created="Sun, 15 Mar 2009 04:52:43 +0000"  >&lt;p&gt;Created an annotation called UDFType. If a UDF is not deterministic, dont include it in the partition pruner.&lt;/p&gt;</comment>
                            <comment id="12682483" author="namit" created="Mon, 16 Mar 2009 22:02:09 +0000"  >&lt;p&gt;Looks good: I have some minor comments:&lt;/p&gt;

&lt;p&gt;1. No need to include UDFRand in PartitionPruner&lt;br/&gt;
2. test rand_partitionpruner.q:&lt;br/&gt;
     can you add that on a partitioned table, srcpart, instead ?&lt;br/&gt;
     can you add a explain plan which will show that all partitions are included ? &lt;br/&gt;
3. Can you add another tests for AND/OR of some expression and rand(), like&lt;br/&gt;
    Again can you perform a explain plan ?&lt;/p&gt;</comment>
                            <comment id="12682522" author="rsm" created="Mon, 16 Mar 2009 23:53:34 +0000"  >&lt;p&gt;Incorporated Namit&apos;s comments. Created a couple more test cases.&lt;/p&gt;</comment>
                            <comment id="12682527" author="namit" created="Tue, 17 Mar 2009 00:14:08 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good&lt;/p&gt;</comment>
                            <comment id="12682536" author="athusoo" created="Tue, 17 Mar 2009 01:05:12 +0000"  >&lt;p&gt;I am getting some failures in the tests...&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Begin query: input_testxpath2.q&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcpart partition &lt;/p&gt;
{ds=2008-04-08, hr=11}
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcpart partition &lt;/p&gt;
{ds=2008-04-08, hr=12}
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcpart partition &lt;/p&gt;
{ds=2008-04-09, hr=11}
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcpart partition &lt;/p&gt;
{ds=2008-04-09, hr=12}
&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcbucket&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table srcbucket&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Loading data to table src&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; OK&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Exception: Client Execution failed with error code = 10&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; junit.framework.AssertionFailedError: Client Execution failed with error code = 10&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_input_testxpath2(TestCliDriver.java:3815)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestCase.runTest(TestCase.java:154)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestCase.runBare(TestCase.java:127)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestCase.run(TestCase.java:118)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:297)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:672)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:567)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Hive history file=/data/users/athusoo/commits/hive_trunk_ws6/ql/../build/ql/tmp/hive_job_log_athusoo&lt;/p&gt;</comment>
                            <comment id="12682973" author="rsm" created="Wed, 18 Mar 2009 09:49:12 +0000"  >&lt;p&gt;The problem was a bug in the patch. In the process of trying to not duplicate code, I introduced a bug where not all UDFs were getting nulled in the pruneExpr. I have now fixed the condition where the nodes are replaced with null.&lt;/p&gt;</comment>
                            <comment id="12683123" author="namit" created="Wed, 18 Mar 2009 18:30:40 +0000"  >&lt;p&gt;running tests for committing now&lt;/p&gt;</comment>
                            <comment id="12683195" author="namit" created="Wed, 18 Mar 2009 22:02:38 +0000"  >&lt;p&gt;committed. Thanks Raghu!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12416185">HIVE-325</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12402213" name="hive-253.1.patch" size="7536" author="rsm" created="Sun, 15 Mar 2009 04:52:43 +0000"/>
                            <attachment id="12402330" name="hive-253.2.patch" size="26338" author="rsm" created="Mon, 16 Mar 2009 23:53:34 +0000"/>
                            <attachment id="12402468" name="hive-253.3.patch" size="24972" author="rsm" created="Wed, 18 Mar 2009 09:49:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Jan 2009 01:03:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122071</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-254] Tracker page should provide a link to the &quot;next step&quot;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-254</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This may belong in Hadoop Core, or maybe more about Hive integration with Hadoop, but many queries these days take multiple steps or mapreduce phases. It would be lovely if a &quot;finished&quot; mapreduce from a Hive query that has several steps could provide a link to the tracker page for the next mapreduce step.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413427">HIVE-254</key>
            <summary>Tracker page should provide a link to the &quot;next step&quot;</summary>
                <type id="5" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Wish</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="appodictic">Edward Capriolo</assignee>
                                    <reporter username="akramer">Adam Kramer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2009 02:10:46 +0000</created>
                <updated>Sat, 17 Dec 2011 00:07:48 +0000</updated>
                            <resolved>Mon, 27 Apr 2009 23:44:27 +0000</resolved>
                                                    <fixVersion>0.4.0</fixVersion>
                                    <component>Web UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12699516" author="appodictic" created="Thu, 16 Apr 2009 04:22:43 +0000"  >&lt;p&gt;The hive history page has been added. I can make the page hyperlink to the job tracker.&lt;/p&gt;</comment>
                            <comment id="12700418" author="appodictic" created="Sat, 18 Apr 2009 03:14:56 +0000"  >&lt;p&gt;This patch allows hot links from the history page to the hadoop job tracker. I also corrected the hive-default which was loaded the war from hive.war hive-hwi.war.&lt;/p&gt;</comment>
                            <comment id="12700419" author="appodictic" created="Sat, 18 Apr 2009 03:16:27 +0000"  >&lt;p&gt;Fixed conf. Added a link from hive-history to job-tracker.&lt;/p&gt;</comment>
                            <comment id="12700772" author="appodictic" created="Mon, 20 Apr 2009 11:45:19 +0000"  >&lt;p&gt;screen shot of session_history. Notice how any task with the key TASK_HADOOP_ID is supplemented with a hyperlink to the Hadoop Job Tracker.&lt;/p&gt;</comment>
                            <comment id="12701764" author="athusoo" created="Thu, 23 Apr 2009 00:41:12 +0000"  >&lt;p&gt;Adam,&lt;/p&gt;

&lt;p&gt;I don&apos;t think that this will get into hadoop core as they probably don&apos;t want to put in hive specific code into hadoop. Having said that Edwards fix does solve this in the Hive web interface..&lt;/p&gt;

&lt;p&gt;Edward, &lt;/p&gt;

&lt;p&gt;Changes look good. Is it possible to add a test case to test the new function.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Ashish&lt;/p&gt;</comment>
                            <comment id="12701960" author="appodictic" created="Thu, 23 Apr 2009 15:12:40 +0000"  >&lt;p&gt;Ashish,&lt;/p&gt;

&lt;p&gt;The test cases are running in local mode, as a result the running job produces no TASK_HADOOP_ID and there is nothing to link to. So in local mode I do not think I can produce a test case for the function.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;09/04/22 19:56:38 INFO exec.ExecDriver: Job running in-process (local Hadoop)
09/04/22 19:56:38 INFO mapred.FileInputFormat: Total input paths to process : 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12702861" author="athusoo" created="Sun, 26 Apr 2009 08:15:41 +0000"  >&lt;p&gt;I suppose we can add a test case for this once the MiniMR cluster work that is being done by Namit gets done as then you would get the TASK_HADOOP_ID. Can you open a JIRA for the tests that depends on&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-204&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-204&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Otherwise, &lt;/p&gt;

&lt;p&gt;+1 from my side. Will run the tests and commit once the test runs are good.&lt;/p&gt;</comment>
                            <comment id="12703440" author="athusoo" created="Mon, 27 Apr 2009 23:44:27 +0000"  >&lt;p&gt;committed. Thanks Edward!!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12405918" name="click_through.png" size="94633" author="appodictic" created="Mon, 20 Apr 2009 11:45:19 +0000"/>
                            <attachment id="12405837" name="hive-254.diff" size="3420" author="appodictic" created="Sat, 18 Apr 2009 03:16:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Apr 2009 04:22:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8rz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122072</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-255] User name is not propagated correctly when a hive server or a web client is issuing hive queries. </title>
                <link>https://issues.apache.org/jira/browse/HIVE-255</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive should use the parameter set in hadoop.job.ugi config value instead of user.name which gets overwritten during job submission. Otherwise clients have to set both user.name and hadoop.job.ugi which is clunky.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413429">HIVE-255</key>
            <summary>User name is not propagated correctly when a hive server or a web client is issuing hive queries. </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prasadc">Prasad Chakka</assignee>
                                    <reporter username="prasadc">Prasad Chakka</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2009 02:51:00 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:44 +0000</updated>
                            <resolved>Mon, 9 Feb 2009 05:04:42 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12667922" author="prasadc" created="Wed, 28 Jan 2009 02:52:27 +0000"  >&lt;p&gt;also removed some templated warnings in HiveConf.java&lt;/p&gt;</comment>
                            <comment id="12667923" author="prasadc" created="Wed, 28 Jan 2009 02:53:57 +0000"  >&lt;p&gt;zheng, can you please review and commit?&lt;/p&gt;</comment>
                            <comment id="12668106" author="zshao" created="Wed, 28 Jan 2009 18:46:15 +0000"  >&lt;p&gt;Committed revision 738406. Thanks Prasad!&lt;/p&gt;</comment>
                            <comment id="12668107" author="zshao" created="Wed, 28 Jan 2009 18:47:12 +0000"  >&lt;p&gt;Everything is done with this jira. Assigned back to the author for computing stats in the future.&lt;/p&gt;</comment>
                            <comment id="12670541" author="prasadc" created="Wed, 4 Feb 2009 22:53:23 +0000"  >&lt;p&gt;user name is not getting propagated unless the hadoop.job.ugi information is supplied from hive command line. set hadoop.job.ugi is not having an effect because later calls to getUGI information use cached info instead of new. &lt;/p&gt;</comment>
                            <comment id="12670544" author="prasadc" created="Wed, 4 Feb 2009 22:58:53 +0000"  >&lt;p&gt;changed user for create table and alter table as well. Not it return error if user information is not available.&lt;/p&gt;</comment>
                            <comment id="12670564" author="zshao" created="Wed, 4 Feb 2009 23:57:39 +0000"  >&lt;p&gt;Committed revision 740941. for trunk&lt;br/&gt;
Committed revision 740942. for branch 0.2.&lt;/p&gt;

&lt;p&gt;Thanks Prasad.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12399491" name="hive-255.patch" size="1809" author="prasadc" created="Wed, 4 Feb 2009 22:58:53 +0000"/>
                            <attachment id="12398875" name="hive-255.patch" size="3467" author="prasadc" created="Wed, 28 Jan 2009 02:52:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Jan 2009 18:46:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73669</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8s7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122073</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-255&quot; title=&quot;User name is not propagated correctly when a hive server or a web client is issuing hive queries. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-255&quot;&gt;&lt;strike&gt;HIVE-255&lt;/strike&gt;&lt;/a&gt;. Propagate user name from hadoop.job.ugi to Hive metastore. (Prasad Chakka via zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-256] map side aggregation : number of output rows is same as number of input rows</title>
                <link>https://issues.apache.org/jira/browse/HIVE-256</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;map side aggregation : number of output rows is same as number of input rows&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413503">HIVE-256</key>
            <summary>map side aggregation : number of output rows is same as number of input rows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Jan 2009 23:56:08 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:35 +0000</updated>
                            <resolved>Thu, 29 Jan 2009 03:55:26 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12668281" author="athusoo" created="Thu, 29 Jan 2009 01:55:49 +0000"  >&lt;p&gt;can you give a description of the bug? How is it triggered?&lt;/p&gt;</comment>
                            <comment id="12668282" author="athusoo" created="Thu, 29 Jan 2009 01:57:19 +0000"  >&lt;p&gt;where is the aggrPositions variable used? Seems like it is not used anywhere...&lt;/p&gt;</comment>
                            <comment id="12668301" author="namit" created="Thu, 29 Jan 2009 03:02:28 +0000"  >&lt;p&gt;It is used to keep track of the aggregation classes using variable length fields. There were few bugs there, which were getting hidden because the reflection API getFields() only shows public fields, whereas getDeclaredFields() shows all fields.&lt;/p&gt;

&lt;p&gt;For example, max has a string variable whose size is not fixed, it is sampled at runtime&lt;/p&gt;</comment>
                            <comment id="12668307" author="athusoo" created="Thu, 29 Jan 2009 03:26:36 +0000"  >&lt;p&gt;got it..&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Running tests now and will check in if everything passes.&lt;/p&gt;</comment>
                            <comment id="12668310" author="jsensarma" created="Thu, 29 Jan 2009 03:42:09 +0000"  >&lt;p&gt;is this the source of the count(1) issue?&lt;/p&gt;</comment>
                            <comment id="12668311" author="namit" created="Thu, 29 Jan 2009 03:43:55 +0000"  >&lt;p&gt;yes, ran that on the production successfully&lt;/p&gt;</comment>
                            <comment id="12668315" author="athusoo" created="Thu, 29 Jan 2009 03:55:26 +0000"  >&lt;p&gt;committed. Thanks Namit!!&lt;/p&gt;</comment>
                            <comment id="12668334" author="jsensarma" created="Thu, 29 Jan 2009 04:34:13 +0000"  >&lt;p&gt;man - the commits are fast! &lt;/p&gt;

&lt;p&gt;i had some questions:&lt;/p&gt;

&lt;p&gt;Curious - &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if ((numEntries % NUMROWSESTIMATESIZE) == 0) {&lt;br/&gt;
+    if ((numEntriesHashTable == 0) || ((numEntries % NUMROWSESTIMATESIZE) == 0)) {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Guessing this was the critical change - but couldn&apos;t follow how numEntriesHashTable could ever be 0 without numEntries being 0 as well.&lt;/p&gt;

&lt;p&gt;Also - I couldn&apos;t understand this code fragment (quoting the old code since it doesn&apos;t matter):&lt;/p&gt;

&lt;p&gt;      Field[] fArr = agg.getFields();&lt;br/&gt;
      for (Field f : fArr) &lt;br/&gt;
        fixedRowSize += getSize(i, agg, f);&lt;/p&gt;

&lt;p&gt;the getSize() call doesn&apos;t even look at the Field - it seems to base it&apos;s decision on the class type of agg - and I think will default to unknowntype (which is a whopping 256 bytes)?&lt;/p&gt;

&lt;p&gt;(sorry - unrelated to this bug - just generally curious since looking at this code in detail for first time)&lt;/p&gt;
</comment>
                            <comment id="12668339" author="athusoo" created="Thu, 29 Jan 2009 04:43:47 +0000"  >&lt;p&gt;From what Namit told me, there were 3 bugs:&lt;/p&gt;

&lt;p&gt;1. aggrPositions was not being initialized so we were not tracking the variable length fields properly.&lt;br/&gt;
2. Instead of getFields he had to use getDeclaredFields as the former only gives public fields where as most of our fields are private.&lt;br/&gt;
3. The numEntries stuff which would not let the code kick in if there were less thatn NUMROWESTIMATESIZE of rows...&lt;/p&gt;

&lt;p&gt;We had used 256 as a heuristic for unknown types...&lt;/p&gt;</comment>
                            <comment id="12668341" author="jsensarma" created="Thu, 29 Jan 2009 04:49:18 +0000"  >&lt;p&gt;the getSize() call ignores the field altogether. it looks at the aggregation class. the code seems to indicate that the intent was to sum up the sizes of the fields in the aggregation class - so something amiss there. perhaps we should just open a separate jira since the issue here is resolved.&lt;/p&gt;

&lt;p&gt;ok - got it on the numEntries thing - seems like we never call shouldFlushed with hashsize of zero.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12412042">HIVE-219</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12398952" name="patch-256.1.txt" size="2099" author="namit" created="Thu, 29 Jan 2009 00:00:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Jan 2009 01:55:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73668</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122074</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-257] Put the structed hhive query location in hive-site.xml</title>
                <link>https://issues.apache.org/jira/browse/HIVE-257</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Put the structed hhive query location in hive-site.xml. Also chnage name of query log to add a random integer to file name. So that mutiple session do not overwrite same file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413504">HIVE-257</key>
            <summary>Put the structed hhive query location in hive-site.xml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="santony73">Suresh Antony</assignee>
                                    <reporter username="santony73">Suresh Antony</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2009 00:34:58 +0000</created>
                <updated>Sat, 17 Dec 2011 00:09:03 +0000</updated>
                            <resolved>Thu, 29 Jan 2009 02:50:02 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12668283" author="athusoo" created="Thu, 29 Jan 2009 01:58:11 +0000"  >&lt;p&gt;submitting patch.&lt;/p&gt;</comment>
                            <comment id="12668284" author="athusoo" created="Thu, 29 Jan 2009 02:00:56 +0000"  >&lt;p&gt;looks like this patch contains other changes as well apart from the site-xml stuff.&lt;/p&gt;

&lt;p&gt;some of this seems to be the patch for the hive history JIRA. Can you isolate these?&lt;/p&gt;</comment>
                            <comment id="12668287" author="santony73" created="Thu, 29 Jan 2009 02:14:08 +0000"  >&lt;p&gt;Last patch contained all the changes...&lt;/p&gt;</comment>
                            <comment id="12668290" author="athusoo" created="Thu, 29 Jan 2009 02:19:11 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Looks good to me.&lt;/p&gt;</comment>
                            <comment id="12668297" author="athusoo" created="Thu, 29 Jan 2009 02:50:02 +0000"  >&lt;p&gt;committed. Thanks Suresh!!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12398960" name="patch_257.txt" size="66214" author="santony73" created="Thu, 29 Jan 2009 00:36:37 +0000"/>
                            <attachment id="12398967" name="patch_257_2.txt" size="1517" author="santony73" created="Thu, 29 Jan 2009 02:14:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Jan 2009 01:58:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8sn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122075</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-258] Support IF(test, valueTrue, valueFalseOrNull)</title>
                <link>https://issues.apache.org/jira/browse/HIVE-258</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html&lt;/a&gt; for details.&lt;/p&gt;

&lt;p&gt;Syntax:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;IF(expr1,expr2,expr3)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12413514">HIVE-258</key>
            <summary>Support IF(test, valueTrue, valueFalseOrNull)</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zshao">Zheng Shao</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2009 04:40:08 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:29 +0000</updated>
                            <resolved>Thu, 29 Jan 2009 04:55:21 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12668337" author="zshao" created="Thu, 29 Jan 2009 04:41:22 +0000"  >&lt;p&gt;Renamed from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-164&quot; title=&quot;Support CASE statement using GenericUDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-164&quot;&gt;&lt;del&gt;HIVE-164&lt;/del&gt;&lt;/a&gt;.2.patch.&lt;/p&gt;</comment>
                            <comment id="12668340" author="athusoo" created="Thu, 29 Jan 2009 04:44:41 +0000"  >&lt;p&gt;+1.&lt;/p&gt;

</comment>
                            <comment id="12668345" author="athusoo" created="Thu, 29 Jan 2009 04:53:08 +0000"  >&lt;p&gt;Also forgot to mention.. Thanks for fixing some of the bugs that got introduced with the implicit txn patch.. &lt;/p&gt;</comment>
                            <comment id="12668347" author="zshao" created="Thu, 29 Jan 2009 04:55:21 +0000"  >&lt;p&gt;Committed revision 738759.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12410450">HIVE-164</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12398976" name="HIVE-258.2.patch" size="37110" author="zshao" created="Thu, 29 Jan 2009 04:41:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Jan 2009 04:44:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73666</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-258&quot; title=&quot;Support IF(test, valueTrue, valueFalseOrNull)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-258&quot;&gt;&lt;strike&gt;HIVE-258&lt;/strike&gt;&lt;/a&gt;. New UDF IF(test, valueTrue, valueFalseOrNull). (zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-259] Add PERCENTILE aggregate function</title>
                <link>https://issues.apache.org/jira/browse/HIVE-259</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Compute atleast 25, 50, 75th percentiles&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413568">HIVE-259</key>
            <summary>Add PERCENTILE aggregate function</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jboulon">Jerome Boulon</assignee>
                                    <reporter username="indigoviolet">Venky Iyer</reporter>
                        <labels>
                            <label>analyticsql</label>
                            <label>median</label>
                            <label>olap</label>
                            <label>percentile</label>
                    </labels>
                <created>Thu, 29 Jan 2009 22:17:47 +0000</created>
                <updated>Tue, 27 Mar 2012 18:22:08 +0000</updated>
                            <resolved>Sun, 28 Feb 2010 10:42:03 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                    <component>OLAP</component>
                    <component>Query Processor</component>
                    <component>UDF</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="12668699" author="appodictic" created="Fri, 30 Jan 2009 01:26:41 +0000"  >&lt;p&gt;95% percentile is very often used in Internet Service Provider billing that might be useful. &lt;/p&gt;

&lt;p&gt;The percentile calculation is a sort and then picking an element. The syntax could be like:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;PERCENTILE(column, .99)&lt;/li&gt;
	&lt;li&gt;PERCENTILE(column, .50)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In this manner you could do any percentile.&lt;/p&gt;</comment>
                            <comment id="12781824" author="cwsteinbach" created="Tue, 24 Nov 2009 08:41:19 +0000"  >&lt;p&gt;This would be a very useful function to have.&lt;/p&gt;

&lt;p&gt;For the sake of completeness (and without much additional effort) it would be nice to provide both PERCENTILE_DISC and PERCENTILE_CONT.&lt;/p&gt;

&lt;p&gt;PERCENTILE_CONT: &lt;a href=&quot;http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions110.htm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions110.htm&lt;/a&gt;&lt;br/&gt;
PERCENTILE_DISC:  &lt;a href=&quot;http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions111.htm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/functions111.htm&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12782120" author="tlipcon" created="Tue, 24 Nov 2009 19:41:48 +0000"  >&lt;p&gt;An easy way to do this that would work for a ton of data sets would to be essentially do counting sort. If you have only a few thousand distinct values in the column to be analyzed, just make a hashtable, count up how many you see, and then in the single reducer use the histogram to figure out the percentile. This should work great for datasets like age, and even for sets like &quot;number of days since user signed up&quot;. For sets that are truly continuous, would be useful when combined with a binning UDF to discretize it.&lt;/p&gt;

&lt;p&gt;Sadly it&apos;s not general case, but would be an easy first step.&lt;/p&gt;</comment>
                            <comment id="12802616" author="zshao" created="Wed, 20 Jan 2010 01:57:21 +0000"  >&lt;p&gt;This is a good first step. We can provide some UDFs to &quot;bucketize&quot; the values first in case the user needs it.&lt;/p&gt;</comment>
                            <comment id="12806134" author="jboulon" created="Thu, 28 Jan 2010 22:34:22 +0000"  >&lt;p&gt;It will also be good to be able to ask for more than one PERCENTILE(column, .99) with only one single structure in memory&lt;br/&gt;
ex: select PERCENTILE(column, .99), PERCENTILE(column, .50) from myTable;&lt;/p&gt;</comment>
                            <comment id="12806183" author="cwsteinbach" created="Fri, 29 Jan 2010 01:21:42 +0000"  >
&lt;p&gt;@Jerome: Agreed. Allowing sort results to be shared by multiple functions (like in the following example) is key to supporting analytic functions efficiently.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; department_id,
   &lt;span class=&quot;code-keyword&quot;&gt;PERCENTILE_CONT&lt;/span&gt;(0.5) &lt;span class=&quot;code-keyword&quot;&gt;WITHIN&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;GROUP&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; salary &lt;span class=&quot;code-keyword&quot;&gt;DESC&lt;/span&gt;) 
      &lt;span class=&quot;code-quote&quot;&gt;&quot;Median cont&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-keyword&quot;&gt;PERCENTILE_DISC&lt;/span&gt;(0.5) &lt;span class=&quot;code-keyword&quot;&gt;WITHIN&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;GROUP&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; salary &lt;span class=&quot;code-keyword&quot;&gt;DESC&lt;/span&gt;) 
      &lt;span class=&quot;code-quote&quot;&gt;&quot;Median disc&quot;&lt;/span&gt;
   &lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; employees &lt;span class=&quot;code-keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; department_id;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12831786" author="jboulon" created="Wed, 10 Feb 2010 00:52:10 +0000"  >&lt;p&gt;First iteration for percentile (tested using Hive trunk and Hadoop 0.18.3):&lt;br/&gt;
usage:&lt;br/&gt;
CREATE TEMPORARY FUNCTION percentile AS &apos;org.apache.hadoop.hive.ql.udf.Percentile&apos;;&lt;br/&gt;
select percentile(myColumn,&quot;25,50,99&quot;) from MyTable;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;How can I share the state object cross functions?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12832134" author="zshao" created="Wed, 10 Feb 2010 19:16:24 +0000"  >&lt;p&gt;Jerome, it seems to me that the best data structure for counting is a HashMap, which allows near-constant-time insertion, find, and insertion. When we &quot;terminate&quot; we can get the entries and sort them but that cost should be small (it&apos;s one-time cost and the number of unique items won&apos;t be too big - users should have used &quot;round&quot; to shrink the number of unique numbers).&lt;/p&gt;

&lt;p&gt;It seems currently we are paying log&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; cost for each find, and O&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; cost for each insertion.&lt;/p&gt;

&lt;p&gt;Does that make sense?&lt;/p&gt;

&lt;p&gt;For sharing the state object, we can just declare the state class as public static.&lt;/p&gt;</comment>
                            <comment id="12832139" author="tlipcon" created="Wed, 10 Feb 2010 19:27:44 +0000"  >&lt;p&gt;Agreed re HashMap. Also, there should be some kind of setting that limits how much RAM gets used up. In a later iteration we could do adaptive histogramming once we hit the limit. In this version we should just throw up our hands and fail with a message that says the user needs to discretize harder.&lt;/p&gt;</comment>
                            <comment id="12832146" author="jboulon" created="Wed, 10 Feb 2010 19:43:36 +0000"  >&lt;p&gt;Didn&apos;t know that we can use an Hash on the state Object ...&lt;br/&gt;
Is there any limitation on what can be used on the state object or can we use any java Object? &lt;br/&gt;
Also how is the state serialized between Map and Reduce?&lt;/p&gt;</comment>
                            <comment id="12832315" author="zshao" created="Thu, 11 Feb 2010 00:10:34 +0000"  >&lt;p&gt;Jerome, I did a skeleton of the code to use HashMap. Do you want to start from there and add what is missing?&lt;/p&gt;</comment>
                            <comment id="12832572" author="jboulon" created="Thu, 11 Feb 2010 17:13:35 +0000"  >&lt;p&gt;Sure, with Map support it&apos;s much simple &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12834474" author="zshao" created="Tue, 16 Feb 2010 21:17:44 +0000"  >&lt;p&gt;&amp;gt; Is there any limitation on what can be used on the state object or can we use any java Object? &lt;br/&gt;
We support primitive classes, HashMap (translated into map&amp;lt;&amp;gt; type in Hive), ArrayList (array type in Hive), and any simple struct-like classes (struct type in Hive).&lt;br/&gt;
We support arbitrary levels of nesting, but no recursive types.&lt;/p&gt;

&lt;p&gt;&amp;gt; Also how is the state serialized between Map and Reduce?&lt;br/&gt;
We use SerDe (see SerDe.serialize(...) ) to serialize/deserialize the objects, as well as translations between objects that have the same &quot;type&quot; (see ObjectInspector and ObjectInspectorConverters).&lt;/p&gt;</comment>
                            <comment id="12837338" author="jboulon" created="Tue, 23 Feb 2010 17:43:12 +0000"  >&lt;p&gt;Percentile function&lt;/p&gt;</comment>
                            <comment id="12837340" author="jboulon" created="Tue, 23 Feb 2010 17:48:55 +0000"  >&lt;p&gt;Percentile test file + validation using Excep Percentile function:&lt;br/&gt;
CREATE TABLE JB2&lt;br/&gt;
(&lt;br/&gt;
duration bigint,&lt;br/&gt;
code string&lt;br/&gt;
)&lt;br/&gt;
ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos; &apos; LINES TERMINATED BY &apos;\n&apos;&lt;br/&gt;
    STORED AS TEXTFILE;&lt;/p&gt;

&lt;p&gt;LOAD DATA LOCAL INPATH &apos;/jb2.txt&apos; INTO TABLE JB2;&lt;/p&gt;



&lt;p&gt;Result:&lt;br/&gt;
hive&amp;gt; select percentile(duration,&quot;25,50,99&quot;) from JB2;&lt;br/&gt;
Ended Job = job_201002201654_0006&lt;br/&gt;
OK&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;14.0,33.0,416.4000000000001&amp;#93;&lt;/span&gt;&lt;br/&gt;
Time taken: 36.261 seconds&lt;/p&gt;

&lt;p&gt;hive&amp;gt; select code,percentile(duration,&quot;25,50,99&quot;) from JB2 group by code;&lt;br/&gt;
Ended Job = job_201002201654_0007&lt;br/&gt;
OK&lt;br/&gt;
a	&lt;span class=&quot;error&quot;&gt;&amp;#91;2.0,17.5,427.2299999999999&amp;#93;&lt;/span&gt;&lt;br/&gt;
b	&lt;span class=&quot;error&quot;&gt;&amp;#91;22.75,44.5,345.84999999999997&amp;#93;&lt;/span&gt;&lt;br/&gt;
c	&lt;span class=&quot;error&quot;&gt;&amp;#91;18.0,29.0,58.760000000000005&amp;#93;&lt;/span&gt;&lt;br/&gt;
Time taken: 23.419 seconds&lt;br/&gt;
hive&amp;gt; quit;&lt;/p&gt;</comment>
                            <comment id="12837342" author="jboulon" created="Tue, 23 Feb 2010 17:51:11 +0000"  >&lt;p&gt;Percentile function.&lt;br/&gt;
Usage: select code,percentile(MyColumnB,&quot;&amp;lt;P1,P2,P3,Px&amp;gt;&quot;) from &amp;lt;MyTable&amp;gt; group by &amp;lt;myColumn&amp;gt;;&lt;/p&gt;</comment>
                            <comment id="12837500" author="cwsteinbach" created="Tue, 23 Feb 2010 23:08:56 +0000"  >&lt;p&gt;Please fix the new Checkstyle errors in UDAFPercentile.java:&lt;/p&gt;

&lt;p&gt;35: Missing a Javadoc comment.&lt;br/&gt;
39: Missing a Javadoc comment.&lt;br/&gt;
39:10: &apos;public&apos; modifier out of order with the JLS suggestions.&lt;br/&gt;
41: Missing a Javadoc comment.&lt;br/&gt;
41:12: &apos;public&apos; modifier out of order with the JLS suggestions.&lt;br/&gt;
42:15: Variable &apos;initDone&apos; must be private and have accessor methods.&lt;br/&gt;
43:7: Declaring variables, return values or parameters of type &apos;HashMap&apos; is not allowed.&lt;br/&gt;
43:35: Variable &apos;counts&apos; must be private and have accessor methods.&lt;br/&gt;
44:7: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;br/&gt;
44:26: Variable &apos;percentiles&apos; must be private and have accessor methods.&lt;br/&gt;
47: Missing a Javadoc comment.&lt;br/&gt;
47:12: &apos;public&apos; modifier out of order with the JLS suggestions.&lt;br/&gt;
56:11: Variable &apos;state&apos; must be private and have accessor methods.&lt;br/&gt;
82:43: Name &apos;_percentiles&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
85:28: Expression can be simplified.&lt;br/&gt;
105:39: &apos;)&apos; is preceded with whitespace.&lt;br/&gt;
117:26: Expression can be simplified.&lt;br/&gt;
125:65: Name &apos;RN&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
129:12: Name &apos;CRN&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
130:12: Name &apos;FRN&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
164:12: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;br/&gt;
173: Line is longer than 100 characters.&lt;br/&gt;
184:7: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;br/&gt;
188:12: Name &apos;N&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
189:14: Name &apos;RN&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;br/&gt;
191:16: Name &apos;P&apos; must match pattern &apos;^&lt;span class=&quot;error&quot;&gt;&amp;#91;a-z&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;a-zA-Z0-9&amp;#93;&lt;/span&gt;*$&apos;.&lt;/p&gt;</comment>
                            <comment id="12837522" author="jboulon" created="Tue, 23 Feb 2010 23:41:39 +0000"  >&lt;p&gt;@Carl: How did you get this list?&lt;/p&gt;

&lt;p&gt;Also, I&apos;m not sure to understand this: &lt;/p&gt;

&lt;p&gt;Why HashMap and ArrayList are not allowed if supported??&lt;/p&gt;

&lt;p&gt;43:7: Declaring variables, return values or parameters of type &apos;HashMap&apos; is not allowed.&lt;br/&gt;
44:7: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;br/&gt;
164:12: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;br/&gt;
184:7: Declaring variables, return values or parameters of type &apos;ArrayList&apos; is not allowed.&lt;/p&gt;</comment>
                            <comment id="12837526" author="alexlod" created="Tue, 23 Feb 2010 23:46:28 +0000"  >&lt;p&gt;Hey Jerome,&lt;/p&gt;

&lt;p&gt;I assume it&apos;s because you&apos;re supposed to use the interface type (e.g. Map or List) for return types, parameter types, and declaring variables.&lt;/p&gt;

&lt;p&gt;Correct me if I&apos;m wrong, those of you more knowledgeable about Hive&apos;s checkstyle &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Alex&lt;/p&gt;</comment>
                            <comment id="12837527" author="cwsteinbach" created="Tue, 23 Feb 2010 23:49:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;How did you get this list? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Run &apos;ant checkstyle&apos;. The list of violations gets dumped to build/checkstyle/checkstyle-errors.txt.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Why HashMap and ArrayList are not allowed if supported?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You&apos;re allowed to use ArrayList and HashMap, but you&apos;re supposed to refer&lt;br/&gt;
to instances of these classes using the interface (List or Map) instead of the&lt;br/&gt;
concrete type, e.g.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; myMap = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getStringList() {
   &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12838118" author="zshao" created="Thu, 25 Feb 2010 00:41:34 +0000"  >&lt;p&gt;Also see &lt;a href=&quot;http://wiki.apache.org/hadoop/Hive/HowToContribute#Coding_Convention&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hive/HowToContribute#Coding_Convention&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12838119" author="zshao" created="Thu, 25 Feb 2010 00:42:17 +0000"  >&lt;p&gt;The test cases looks a bit too trivial or the results have problems? They always return the same number for the 3 different percentile values.&lt;/p&gt;</comment>
                            <comment id="12838135" author="zshao" created="Thu, 25 Feb 2010 01:29:21 +0000"  >&lt;p&gt;1. We are converting &quot;25,50,99&quot; to ArrayList&amp;lt;Integer&amp;gt;. Why don&apos;t we directly accept an int array (or a double array to allow 99.9).&lt;/p&gt;

&lt;p&gt;In the query, the user can say:&lt;/p&gt;

&lt;p&gt;SELECT percentile(mycol, array(25, 50, 99) FROM mytable;&lt;/p&gt;

&lt;p&gt;2. Get rid of State.initDone.  We can set &quot;ArrayList&amp;lt;Integer&amp;gt; percentiles&quot; to null first. That saves some space in memory as well as network when we transfer the state from mapper to reducer.&lt;/p&gt;

&lt;p&gt;3. In Java, variable names should be lowercased.&lt;/p&gt;

&lt;p&gt;4. We should change the test case to be non-trivial.&lt;/p&gt;</comment>
                            <comment id="12838173" author="jboulon" created="Thu, 25 Feb 2010 03:19:01 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;From my point of view, changing variable access to private in the state object will not make the code more readable ...&lt;/li&gt;
	&lt;li&gt;I&apos;ll change all variables to be lowerCase to match java style, current variable&apos;s name are based on Oracle definition.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@Zheng - I&apos;m not using an ArrayList&amp;lt;Integer&amp;gt; but a String to avoid unnecessary object creation (for every single row) ... would even be better if the constructor could have been used but I haven&apos;t found how to do that. If we care about 1 extra empty arrayList per mapper/spill in memory then we should care about creating (1 ArrayList + 1 Integer Object per percentile) per row.&lt;/p&gt;

&lt;p&gt;@Zheng - Regarding the test case that what I add in mind when I asked you, howto create my own table and that exactly the reason why I post Jb2.* files&lt;/p&gt;</comment>
                            <comment id="12838512" author="jboulon" created="Thu, 25 Feb 2010 20:02:22 +0000"  >&lt;p&gt;Can someone explain how can I create/populate a new table to be used by the ant test target?&lt;/p&gt;</comment>
                            <comment id="12838516" author="cwsteinbach" created="Thu, 25 Feb 2010 20:10:10 +0000"  >&lt;p&gt;@Jerome: take a look at ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java&lt;/p&gt;</comment>
                            <comment id="12838718" author="zshao" created="Fri, 26 Feb 2010 05:41:20 +0000"  >&lt;p&gt;Hi Jerome, using ArrayList&amp;lt;Integer&amp;gt; won&apos;t cause unnecessary Object creation. We will just create a single ArrayList&amp;lt;Integer&amp;gt; and use it forever.&lt;br/&gt;
Does that make sense?&lt;/p&gt;</comment>
                            <comment id="12838735" author="tlipcon" created="Fri, 26 Feb 2010 07:29:23 +0000"  >&lt;p&gt;Doesn&apos;t the autoboxing of Integer types actually allocate objects? I think JVM only flyweights integers for very small ones (iirc only from -127 to 128)&lt;/p&gt;</comment>
                            <comment id="12839071" author="jboulon" created="Fri, 26 Feb 2010 23:09:40 +0000"  >&lt;p&gt;Percentiles that match included test case&lt;/p&gt;</comment>
                            <comment id="12839072" author="jboulon" created="Fri, 26 Feb 2010 23:11:53 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;use Double instead of Integer for percentile so we can ask for 99.999 percentile&lt;/li&gt;
	&lt;li&gt;checkstyle fix except State object&lt;/li&gt;
	&lt;li&gt;new test case&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12839093" author="jboulon" created="Sat, 27 Feb 2010 00:21:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-259&quot; title=&quot;Add PERCENTILE aggregate function&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-259&quot;&gt;&lt;del&gt;HIVE-259&lt;/del&gt;&lt;/a&gt;-3.patch&lt;/p&gt;</comment>
                            <comment id="12839116" author="zshao" created="Sat, 27 Feb 2010 01:40:48 +0000"  >&lt;p&gt;This one fixes all checkstyle errors, and uses *Writable classes to avoid creating new objects as much as possible.&lt;/p&gt;</comment>
                            <comment id="12839391" author="he yongqiang" created="Sun, 28 Feb 2010 09:24:12 +0000"  >&lt;p&gt;The code looks very good. Thanks for the code work, Jerome and Zheng!&lt;br/&gt;
Just some minor comments:&lt;br/&gt;
(1) I am not familiar with the exact definition of percentile function. Is the percentile()&apos;s result must be a member of input data? &lt;br/&gt;
(2) HashMap and ArrayList is used to copy and sort. Can we use tree map here? this is a small and can be ignored.&lt;br/&gt;
In the beginning of  new test case, &lt;br/&gt;
DESCRIBE FUNCTION percentile;&lt;br/&gt;
DESCRIBE FUNCTION EXTENDED percentile;&lt;br/&gt;
appears two times.&lt;/p&gt;

&lt;p&gt;And this is a very good function to have, it will be great if we can update its usage to the wiki page or somewhere.&lt;/p&gt;</comment>
                            <comment id="12839392" author="zshao" created="Sun, 28 Feb 2010 09:37:34 +0000"  >&lt;p&gt;We take the method recommended by NIST.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://en.wikipedia.org/wiki/Percentile#Alternative_methods&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/Percentile#Alternative_methods&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12839393" author="zshao" created="Sun, 28 Feb 2010 09:40:06 +0000"  >&lt;p&gt;&amp;gt; (1) I am not familiar with the exact definition of percentile function. Is the percentile()&apos;s result must be a member of input data?&lt;br/&gt;
See the link above.&lt;/p&gt;

&lt;p&gt;&amp;gt; (2) HashMap and ArrayList is used to copy and sort. Can we use tree map here? this is a small and can be ignored.&lt;br/&gt;
In the beginning of new test case, &lt;br/&gt;
I think HashMap is better here. The reason is that the number of &quot;iterate&quot; is usually much higher than the number of unique numbers (the size of the HashMap). By using HashMap we reduce the cost of &quot;iterate&quot;.&lt;/p&gt;

&lt;p&gt;&amp;gt; In the beginning of new test case, .. appears two times&lt;br/&gt;
Fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-259&quot; title=&quot;Add PERCENTILE aggregate function&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-259&quot;&gt;&lt;del&gt;HIVE-259&lt;/del&gt;&lt;/a&gt;.5.patch&lt;/p&gt;</comment>
                            <comment id="12839394" author="he yongqiang" created="Sun, 28 Feb 2010 09:42:38 +0000"  >&lt;p&gt;looks good, will test and commit.&lt;/p&gt;</comment>
                            <comment id="12839406" author="he yongqiang" created="Sun, 28 Feb 2010 10:42:03 +0000"  >&lt;p&gt;Committed. Thanks for the hard work, Jerome Boulon and Zheng.&lt;/p&gt;

&lt;p&gt;Btw, i manually fixed a show_function.q diff.  Please update the usage of percentile function on the wiki or somewhere.&lt;/p&gt;</comment>
                            <comment id="12858600" author="nzhang" created="Mon, 19 Apr 2010 17:11:37 +0000"  >&lt;p&gt;Hi Jerome and Zheng, &lt;/p&gt;

&lt;p&gt;Could any of you write the syntax and semantics of the percentile function in the wiki page (&lt;a href=&quot;http://wiki.apache.org/hadoop/Hive/LanguageManual/UDF&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hive/LanguageManual/UDF&lt;/a&gt; or &lt;a href=&quot;http://wiki.apache.org/hadoop/Hive/HiveUDFGuide)?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hive/HiveUDFGuide)?&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;</comment>
                            <comment id="12860061" author="jvs" created="Thu, 22 Apr 2010 23:04:20 +0000"  >&lt;p&gt;I couldn&apos;t see the point of having two competing UDF guide pages, so I renamed the XPath-specific one as such and linked it from the main one.  Just housekeeping to reduce confusion; I did not actually add the percentile info.&lt;/p&gt;</comment>
                            <comment id="12863415" author="jvs" created="Mon, 3 May 2010 17:26:31 +0000"  >&lt;p&gt;PERCENTILE docs are still missing on the consolidated page:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://wiki.apache.org/hadoop/Hive/LanguageManual/UDF&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hive/LanguageManual/UDF&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12466126">HIVE-1387</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12436725" name="HIVE-259-2.patch" size="15962" author="jboulon" created="Tue, 23 Feb 2010 17:43:12 +0000"/>
                            <attachment id="12437272" name="HIVE-259-3.patch" size="14324" author="jboulon" created="Fri, 26 Feb 2010 23:11:53 +0000"/>
                            <attachment id="12435522" name="HIVE-259.1.patch" size="5463" author="zshao" created="Thu, 11 Feb 2010 00:10:34 +0000"/>
                            <attachment id="12437294" name="HIVE-259.4.patch" size="27403" author="zshao" created="Sat, 27 Feb 2010 01:40:48 +0000"/>
                            <attachment id="12437376" name="HIVE-259.5.patch" size="26946" author="zshao" created="Sun, 28 Feb 2010 09:37:34 +0000"/>
                            <attachment id="12435385" name="HIVE-259.patch" size="8728" author="jboulon" created="Wed, 10 Feb 2010 00:52:10 +0000"/>
                            <attachment id="12437271" name="Percentile.xlsx" size="36933" author="jboulon" created="Fri, 26 Feb 2010 23:09:40 +0000"/>
                            <attachment id="12436726" name="jb2.txt" size="183" author="jboulon" created="Tue, 23 Feb 2010 17:48:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 Jan 2009 01:26:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8t3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-260] hive cli should not output the line by default</title>
                <link>https://issues.apache.org/jira/browse/HIVE-260</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This is at the beginning of hive cli output:&lt;/p&gt;

&lt;p&gt;Hive history file=/tmp/zshao/hive_job_log_zshao_200901291532_-1964746650.txt&lt;/p&gt;

&lt;p&gt;We should remove it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413575">HIVE-260</key>
            <summary>hive cli should not output the line by default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2009 23:54:26 +0000</created>
                <updated>Tue, 12 Jan 2010 19:20:22 +0000</updated>
                            <resolved>Fri, 30 Jan 2009 05:25:32 +0000</resolved>
                                    <version>0.6.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12668681" author="athusoo" created="Fri, 30 Jan 2009 00:38:00 +0000"  >&lt;p&gt;Does this show up along with the message that outputs the number of reducers etc...&lt;/p&gt;

&lt;p&gt;If so would this just not go away with running the cli in silent mode?&lt;/p&gt;</comment>
                            <comment id="12668706" author="zshao" created="Fri, 30 Jan 2009 01:55:01 +0000"  >&lt;p&gt;No. The number of reducers is not there.&lt;/p&gt;

</comment>
                            <comment id="12668751" author="zshao" created="Fri, 30 Jan 2009 05:25:32 +0000"  >&lt;p&gt;&quot;-S&quot; option does remove that line.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 Jan 2009 00:38:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73664</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8tb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122078</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-261] union all query hangs</title>
                <link>https://issues.apache.org/jira/browse/HIVE-261</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;we have this query:&lt;/p&gt;

&lt;p&gt;SELECT a.u, b.id FROM (&lt;br/&gt;
 SELECT a1.u, a1.id as id FROM t_1 a1 WHERE a1.date = &apos;2009-01-01&apos; UNION ALL&lt;br/&gt;
 SELECT a2.u, a2.id as id FROM t_2 a2 WHERE a2.date = &apos;2009-01-01&apos; UNION ALL&lt;br/&gt;
 ...&lt;br/&gt;
 SELECT aN.u, aN.id as id FROM t_N an WHERE aN.date = &apos;2009-01-01&apos;&lt;br/&gt;
) a &lt;br/&gt;
JOIN t b ON a.id = b.id WHERE b.date=&apos;2009-01-01&apos; &lt;br/&gt;
GROUP BY a.u, b.id&lt;/p&gt;

&lt;p&gt;When we union more than 20 tables, the query will hang. It looks like something wrong in the compiler.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413576">HIVE-261</key>
            <summary>union all query hangs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="hliu">Hao Liu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2009 23:58:34 +0000</created>
                <updated>Thu, 26 Mar 2009 00:04:49 +0000</updated>
                            <resolved>Thu, 26 Mar 2009 00:04:49 +0000</resolved>
                                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12669815" author="zshao" created="Tue, 3 Feb 2009 00:43:07 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sed &lt;span class=&quot;code-quote&quot;&gt;&apos;s@msgs.push(&lt;span class=&quot;code-quote&quot;&gt;&quot;\(.*\)&quot;&lt;/span&gt;);@&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;msgs size=&quot;&lt;/span&gt; + msgs.size() + &lt;span class=&quot;code-quote&quot;&gt;&quot; \1&quot;&lt;/span&gt;); msgs.push(&lt;span class=&quot;code-quote&quot;&gt;&quot;\1&quot;&lt;/span&gt;);@g&apos;&lt;/span&gt; ./ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems there is a missing pop or something:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    [junit] msgs size=1756954 selection target
    [junit] msgs size=1756955 select expression
    [junit] msgs size=1756956 expression specification
    [junit] msgs size=1756957 function specification
    [junit] msgs size=1756958 function name
    [junit] msgs size=1756959 table column identifier
    [junit] msgs size=1756960 table column identifier
    [junit] msgs size=1756961 function specification
    [junit] msgs size=1756962 function name
    [junit] msgs size=1756963 table column identifier
    [junit] msgs size=1756964 table column identifier
    [junit] msgs size=1756965 function specification
    [junit] msgs size=1756966 function name
    [junit] msgs size=1756967 table column identifier
    [junit] msgs size=1756968 table column identifier
    [junit] msgs size=1756969 expression specification
    [junit] msgs size=1756970 function specification
    [junit] msgs size=1756971 function name
    [junit] msgs size=1756972 table column identifier
    [junit] msgs size=1756973 table column identifier
    [junit] msgs size=1756974 function specification
    [junit] msgs size=1756975 function name
    [junit] msgs size=1756976 table column identifier
    [junit] msgs size=1756977 table column identifier
    [junit] msgs size=1756978 function specification
    [junit] msgs size=1756979 function name
    [junit] msgs size=1756980 table column identifier
    [junit] msgs size=1756981 table column identifier
    [junit] msgs size=1756982 selection target
    [junit] msgs size=1756983 select expression
    [junit] msgs size=1756984 expression specification
    [junit] msgs size=1756985 function specification
    [junit] msgs size=1756986 function name
    [junit] msgs size=1756987 table column identifier
    [junit] msgs size=1756988 table column identifier
    [junit] msgs size=1756989 function specification
    [junit] msgs size=1756990 function name
    [junit] msgs size=1756991 table column identifier
    [junit] msgs size=1756992 table column identifier
    [junit] msgs size=1756993 function specification
    [junit] msgs size=1756994 function name
    [junit] msgs size=1756995 table column identifier
    [junit] msgs size=1756996 table column identifier
    [junit] msgs size=1756997 expression specification
    [junit] msgs size=1756998 function specification
    [junit] msgs size=1756999 function name
    [junit] msgs size=1757000 table column identifier
    [junit] msgs size=1757001 table column identifier
    [junit] msgs size=1757002 function specification
    [junit] msgs size=1757003 function name
    [junit] msgs size=1757004 table column identifier
    [junit] msgs size=1757005 table column identifier
    [junit] msgs size=1757006 function specification
    [junit] msgs size=1757007 function name
    [junit] msgs size=1757008 table column identifier
    [junit] msgs size=1757009 table column identifier
    [junit] msgs size=1757010 select list
    [junit] msgs size=1757011 selection target
    [junit] msgs size=1757012 select expression
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;My query:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;explain
  select count(1) FROM (

select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL

select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL

select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL

select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL

select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL
select s1.key as key, s1.value as value from src s1 UNION ALL

select s2.key as key, s2.value as value from src s2) unionsrc;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12669827" author="zshao" created="Tue, 3 Feb 2009 01:03:17 +0000"  >&lt;p&gt;I am very surprised at the number of levels that antlr needs to go through to parse this query.&lt;br/&gt;
Also it seems msgs.pop() was not executed for some reason.&lt;/p&gt;</comment>
                            <comment id="12669835" author="zshao" created="Tue, 3 Feb 2009 01:28:42 +0000"  >&lt;p&gt;Antlr does not put the code in @after in every return statement.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    ./build/ql/gen-java/org/apache/hadoop/hive/ql/parse/HiveParser.java

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; explainStatement_return explainStatement() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; RecognitionException {
        explainStatement_return retval = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; explainStatement_return();
        retval.start = input.LT(1);

        CommonTree root_0 = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        Token isExtended=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        Token KW_EXPLAIN5=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        execStatement_return execStatement6 = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;


        CommonTree isExtended_tree=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        CommonTree KW_EXPLAIN5_tree=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        RewriteRuleTokenStream stream_KW_EXTENDED=&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RewriteRuleTokenStream(adaptor,&lt;span class=&quot;code-quote&quot;&gt;&quot;token KW_EXTENDED&quot;&lt;/span&gt;);
        RewriteRuleTokenStream stream_KW_EXPLAIN=&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RewriteRuleTokenStream(adaptor,&lt;span class=&quot;code-quote&quot;&gt;&quot;token KW_EXPLAIN&quot;&lt;/span&gt;);
        RewriteRuleSubtreeStream stream_execStatement=&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RewriteRuleSubtreeStream(adaptor,&lt;span class=&quot;code-quote&quot;&gt;&quot;rule execStatement&quot;&lt;/span&gt;);
         &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;msgs size=&quot;&lt;/span&gt; + msgs.size() + &lt;span class=&quot;code-quote&quot;&gt;&quot; explain statement&quot;&lt;/span&gt;); msgs.push(&lt;span class=&quot;code-quote&quot;&gt;&quot;explain statement&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-comment&quot;&gt;// /data/users/zshao/sync/apache-trunk-HIVE-261/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:157:2: ( KW_EXPLAIN (isExtended= KW_EXTENDED )? execStatement -&amp;gt; ^( TOK_EXPLAI\
&lt;/span&gt;N execStatement ( $isExtended)? ) )
            &lt;span class=&quot;code-comment&quot;&gt;// /data/users/zshao/sync/apache-trunk-HIVE-261/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:157:4: KW_EXPLAIN (isExtended= KW_EXTENDED )? execStatement
&lt;/span&gt;            {
            KW_EXPLAIN5=(Token)input.LT(1);
            match(input,KW_EXPLAIN,FOLLOW_KW_EXPLAIN_in_explainStatement448); &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (failed) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; retval;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( backtracking==0 ) stream_KW_EXPLAIN.add(KW_EXPLAIN5);

            &lt;span class=&quot;code-comment&quot;&gt;// /data/users/zshao/sync/apache-trunk-HIVE-261/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:157:15: (isExtended= KW_EXTENDED )?
&lt;/span&gt;            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; alt2=2;
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; LA2_0 = input.LA(1);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12689286" author="namit" created="Thu, 26 Mar 2009 00:04:49 +0000"  >&lt;p&gt;duplicate of jira 318&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 3 Feb 2009 00:43:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 44 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122079</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-262] outer join gets some duplicate rows in some scenarios</title>
                <link>https://issues.apache.org/jira/browse/HIVE-262</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;SELECT * FROM src src1 JOIN src src2 ON (src1.key = src2.key AND src1.key &amp;lt; 10) RIGHT OUTER JOIN src src3 ON (src1.key = src3.key AND src3.key &amp;lt; 20);&lt;/p&gt;


&lt;p&gt;returns duplicate rows for outer join&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413589">HIVE-262</key>
            <summary>outer join gets some duplicate rows in some scenarios</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Jan 2009 02:08:05 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:47 +0000</updated>
                            <resolved>Wed, 4 Feb 2009 01:38:07 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12668720" author="namit" created="Fri, 30 Jan 2009 02:55:44 +0000"  >&lt;p&gt;forgot to update parse result files&lt;/p&gt;</comment>
                            <comment id="12668980" author="zshao" created="Fri, 30 Jan 2009 19:05:54 +0000"  >&lt;p&gt;Does this happen to only 2 consecutive joins with the same set of the keys?&lt;/p&gt;</comment>
                            <comment id="12669040" author="dhruba" created="Fri, 30 Jan 2009 21:39:45 +0000"  >&lt;p&gt;I marked this a s a Blocker, to indicate that this should definiotely go into the 0.20 branch.&lt;/p&gt;</comment>
                            <comment id="12669044" author="namit" created="Fri, 30 Jan 2009 21:51:39 +0000"  >&lt;p&gt;Does this happen to only 2 consecutive joins with the same set of the keys?  ----&amp;gt; YES&lt;/p&gt;</comment>
                            <comment id="12669286" author="namit" created="Sat, 31 Jan 2009 23:28:38 +0000"  >&lt;p&gt;Ashish suggested the following approach:&lt;/p&gt;

&lt;p&gt;Based on join conditions, create a set of all tables being joined (no outer join), and if one of them is null for a given value, all of them become null.&lt;/p&gt;

&lt;p&gt;For example,&lt;/p&gt;

&lt;p&gt;A join B on A.c1=B.c1 join C on A.c1=C.c1 right outer join D on A.c1=D.c1&lt;/p&gt;

&lt;p&gt;A,B,C belong to the same group (since A joins with B and A joins with C).&lt;/p&gt;

&lt;p&gt;So, for a given key (c1), if there is no row corresponding to either of A, B, or C - assume that&lt;br/&gt;
there is no row for all of them for that key.&lt;/p&gt;

&lt;p&gt;That works for the example above, and the approach is different from the patch&lt;/p&gt;</comment>
                            <comment id="12669288" author="namit" created="Sat, 31 Jan 2009 23:34:06 +0000"  >&lt;p&gt;However, the above does not work for the following:&lt;/p&gt;


&lt;p&gt;A left outer join B on A.c1=B.c1 right outer join C on B.c1=C.c1&lt;/p&gt;

&lt;p&gt;Consider the following rows for a given value of c1:&lt;/p&gt;

&lt;p&gt;A --&amp;gt; a1 a2&lt;br/&gt;
B -&amp;gt; null&lt;br/&gt;
C -&amp;gt; c1 c2&lt;/p&gt;

&lt;p&gt;Since there is no join, no pruning will happen, and the following output will be produced&lt;/p&gt;

&lt;p&gt;null null c1&lt;br/&gt;
null null c1&lt;br/&gt;
null null c2&lt;br/&gt;
null null c2&lt;/p&gt;

&lt;p&gt;whereas the correct output is:&lt;/p&gt;

&lt;p&gt;null null c1&lt;br/&gt;
null null c2&lt;/p&gt;

&lt;p&gt;Note that 2 extra rows will be produced.&lt;/p&gt;

&lt;p&gt;So, I think the patch&apos;s approach should be better&lt;/p&gt;</comment>
                            <comment id="12669848" author="namit" created="Tue, 3 Feb 2009 02:22:15 +0000"  >&lt;p&gt;need to add more tests&lt;/p&gt;</comment>
                            <comment id="12670085" author="athusoo" created="Tue, 3 Feb 2009 19:59:50 +0000"  >&lt;p&gt;can you add explain plans for the new test cases. Otherwise this looks good.&lt;/p&gt;</comment>
                            <comment id="12670185" author="namit" created="Tue, 3 Feb 2009 23:59:17 +0000"  >&lt;p&gt;added explains to test&lt;/p&gt;</comment>
                            <comment id="12670207" author="athusoo" created="Wed, 4 Feb 2009 01:11:13 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good to me.&lt;/p&gt;

&lt;p&gt;I am running the tests right now and will commit once they pass.&lt;/p&gt;</comment>
                            <comment id="12670210" author="athusoo" created="Wed, 4 Feb 2009 01:38:07 +0000"  >&lt;p&gt;committed. Thanks Namit!!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12399324" name="patch-262.3.txt" size="20381" author="namit" created="Tue, 3 Feb 2009 02:24:17 +0000"/>
                            <attachment id="12399087" name="patch.262.1.txt" size="13002" author="namit" created="Fri, 30 Jan 2009 02:14:32 +0000"/>
                            <attachment id="12399409" name="patch.262.4.txt" size="30592" author="namit" created="Tue, 3 Feb 2009 23:58:53 +0000"/>
                            <attachment id="12399089" name="patch262.2.txt" size="18884" author="namit" created="Fri, 30 Jan 2009 02:55:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 Jan 2009 19:05:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73662</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8tr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122080</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-263] TCTLSeparatedProtocol should use UTF-8 to decode the data</title>
                <link>https://issues.apache.org/jira/browse/HIVE-263</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;TCTLSeparatedProtocol now uses the default character encoding. We should use UTF8 from hadoop Text class:&lt;/p&gt;

&lt;p&gt;Now:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; row = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(buf, 0, length);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We want:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; row;
          &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            row = Text.decode(buf, 0, length);
          } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (CharacterCodingException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12413672">HIVE-263</key>
            <summary>TCTLSeparatedProtocol should use UTF-8 to decode the data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zshao">Zheng Shao</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Sat, 31 Jan 2009 01:17:07 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:38 +0000</updated>
                            <resolved>Tue, 3 Feb 2009 01:56:29 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12669779" author="jsensarma" created="Mon, 2 Feb 2009 22:49:45 +0000"  >&lt;p&gt;we also need to encode using Text i think.&lt;/p&gt;

&lt;p&gt;also - metadatatypedserde - i guess we need to fix that as well?&lt;/p&gt;</comment>
                            <comment id="12669793" author="zshao" created="Mon, 2 Feb 2009 23:12:12 +0000"  >&lt;p&gt;Modified serialization as well.&lt;br/&gt;
Also checked MetadataTypedColumnsetSerDe. That code is already using Text.&lt;/p&gt;</comment>
                            <comment id="12669825" author="jsensarma" created="Tue, 3 Feb 2009 01:02:32 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;the only thing that concerns me is that if any row does not conform to utf-8 - then the whole job fails. earlier we had tried to have a setup that the serde throws a serdeexception and we deal with it in query layer (we can ignore some fixed % of bad rows for example).&lt;/p&gt;

&lt;p&gt;but looking at the code - this might be hard to do right now - so happy to wait for a rewrite for this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12669841" author="zshao" created="Tue, 3 Feb 2009 01:56:28 +0000"  >&lt;p&gt;Committed revision 740187. (for trunk)&lt;br/&gt;
Committed revision 740188. (for branch 0.2)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12399258" name="HIVE-263.1.patch" size="1404" author="zshao" created="Mon, 2 Feb 2009 05:42:48 +0000"/>
                            <attachment id="12399310" name="HIVE-263.2.patch" size="2952" author="zshao" created="Mon, 2 Feb 2009 23:12:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Feb 2009 22:49:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73661</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8tz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-263&quot; title=&quot;TCTLSeparatedProtocol should use UTF-8 to decode the data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-263&quot;&gt;&lt;strike&gt;HIVE-263&lt;/strike&gt;&lt;/a&gt;. TCTLSeparatedProtocol should use UTF-8 to encode/decode the data. (zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-264] TBinarySortable Protocol should support null characters</title>
                <link>https://issues.apache.org/jira/browse/HIVE-264</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently TBinarySortable Protocol does not support serializing null &quot;\0&quot; characters which confused a lot of users.&lt;br/&gt;
We should support that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413748">HIVE-264</key>
            <summary>TBinarySortable Protocol should support null characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zshao">Zheng Shao</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Feb 2009 03:29:27 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:34 +0000</updated>
                            <resolved>Thu, 5 Feb 2009 23:40:13 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12669503" author="zshao" created="Mon, 2 Feb 2009 03:30:44 +0000"  >&lt;p&gt;A simple way to do that is to escape &quot;\000&quot; with &quot;\001&quot; &quot;\001&quot;, and escape &quot;\001&quot; with &quot;\001&quot; &quot;\002&quot;,&lt;/p&gt;</comment>
                            <comment id="12670242" author="zshao" created="Wed, 4 Feb 2009 05:18:27 +0000"  >&lt;p&gt;string.txt that contains ^@ and ^A&lt;/p&gt;</comment>
                            <comment id="12670245" author="zshao" created="Wed, 4 Feb 2009 05:21:55 +0000"  >&lt;p&gt;including a testcase with both ^@ and ^A characters.&lt;/p&gt;</comment>
                            <comment id="12670247" author="zshao" created="Wed, 4 Feb 2009 05:29:36 +0000"  >&lt;p&gt;Replaced special characters in the query output with normal characters.&lt;/p&gt;</comment>
                            <comment id="12670250" author="prasadc" created="Wed, 4 Feb 2009 05:35:38 +0000"  >&lt;p&gt;logging is set to debug&lt;/p&gt;</comment>
                            <comment id="12670253" author="zshao" created="Wed, 4 Feb 2009 05:55:35 +0000"  >&lt;p&gt;Reverted logging change.&lt;/p&gt;</comment>
                            <comment id="12670547" author="prasadc" created="Wed, 4 Feb 2009 23:15:22 +0000"  >&lt;p&gt;the line below&lt;/p&gt;

&lt;p&gt; assert(bin&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; == 1 || bin&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; == 2);&lt;/p&gt;


&lt;p&gt;should be&lt;/p&gt;


&lt;p&gt; assert(bin&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; == 1 || bin&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; == 2);&lt;/p&gt;</comment>
                            <comment id="12670557" author="zshao" created="Wed, 4 Feb 2009 23:43:36 +0000"  >&lt;p&gt;Fixed the assert bug as Prasad pointed out.&lt;/p&gt;</comment>
                            <comment id="12670558" author="prasadc" created="Wed, 4 Feb 2009 23:48:07 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12670602" author="zshao" created="Thu, 5 Feb 2009 02:03:04 +0000"  >&lt;p&gt;Added &quot;-a&quot; to &quot;diff&quot; command to always compare file in text mode.&lt;/p&gt;</comment>
                            <comment id="12670899" author="zshao" created="Thu, 5 Feb 2009 20:54:19 +0000"  >&lt;p&gt;Increased test timeout to 1800 seconds because TestCliDriver is taking longer and longer time.&lt;/p&gt;</comment>
                            <comment id="12670953" author="zshao" created="Thu, 5 Feb 2009 23:40:13 +0000"  >&lt;p&gt;Committed revision 741341 for branch 0.2.&lt;br/&gt;
Committed revision 741339 for trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12399423" name="HIVE-264.1.patch" size="9426" author="zshao" created="Wed, 4 Feb 2009 05:29:36 +0000"/>
                            <attachment id="12399425" name="HIVE-264.2.patch" size="9021" author="zshao" created="Wed, 4 Feb 2009 05:55:35 +0000"/>
                            <attachment id="12399495" name="HIVE-264.3.patch" size="8531" author="zshao" created="Wed, 4 Feb 2009 23:43:36 +0000"/>
                            <attachment id="12399587" name="HIVE-264.5.patch" size="10577" author="zshao" created="Thu, 5 Feb 2009 20:54:19 +0000"/>
                            <attachment id="12399421" name="string.txt" size="93" author="zshao" created="Wed, 4 Feb 2009 05:18:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Feb 2009 05:35:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73660</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8u7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-264&quot; title=&quot;TBinarySortable Protocol should support null characters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-264&quot;&gt;&lt;strike&gt;HIVE-264&lt;/strike&gt;&lt;/a&gt;. TBinarySortable Protocol supports null characters. (zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-265] Implement COPY TO syntax</title>
                <link>https://issues.apache.org/jira/browse/HIVE-265</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Postgres has a nice syntax for moving data from a file into a table, and vice versa. It&apos;s similar to Hive&apos;s &quot;INSERT INTO ... SELECT ...&quot; syntax, but may be easier to use for Postgres users. In particular, I like the ability to COPY TO with delimiters specified. This would allow for easy CSV export.&lt;/p&gt;

&lt;p&gt;Docs: &lt;a href=&quot;http://www.postgresql.org/docs/current/interactive/sql-copy.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.postgresql.org/docs/current/interactive/sql-copy.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413754">HIVE-265</key>
            <summary>Implement COPY TO syntax</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hammer">Jeff Hammerbacher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Feb 2009 05:38:52 +0000</created>
                <updated>Sun, 7 Sep 2014 12:02:50 +0000</updated>
                            <resolved>Sun, 7 Sep 2014 12:02:50 +0000</resolved>
                                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="14124876" author="lars_francke" created="Sun, 7 Sep 2014 12:02:25 +0000"  >&lt;p&gt;I think this is supported using the extended INSERT syntax as of Hive 0.11 &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-Writingdataintothefilesystemfromqueries&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-Writingdataintothefilesystemfromqueries&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ll close this for now but feel free to reopen if you think that functionality doesn&apos;t cover your request.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 7 Sep 2014 12:02:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 20 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122083</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-266] Improve SerDe performance by using Text instead of String</title>
                <link>https://issues.apache.org/jira/browse/HIVE-266</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;A recent performance study showed that 2 places in Hive code has exhibited large cpu usage percentage:&lt;br/&gt;
1. String.getBytes() (UTF-8 encoding)&lt;br/&gt;
2. String.split()&lt;/p&gt;

&lt;p&gt;We should replace String with Text object to:&lt;br/&gt;
1. Avoid UTF-8 decoding and encoding&lt;br/&gt;
2. Reuse the Text object and avoid creating new objects for each column in each row like in String.split()&lt;/p&gt;

&lt;p&gt;This is expected to give a big (20%+) performance improvement to Hive.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413755">HIVE-266</key>
            <summary>Improve SerDe performance by using Text instead of String</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zshao">Zheng Shao</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Feb 2009 05:54:41 +0000</created>
                <updated>Sat, 17 Dec 2011 00:07:45 +0000</updated>
                            <resolved>Tue, 14 Apr 2009 22:56:18 +0000</resolved>
                                    <version>0.4.0</version>
                                    <fixVersion>0.4.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12674074" author="zshao" created="Mon, 16 Feb 2009 22:29:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-270&quot; title=&quot;Add a lazy-deserialized SerDe for space and cpu efficient serialization of rows with primitive types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-270&quot;&gt;&lt;del&gt;HIVE-270&lt;/del&gt;&lt;/a&gt; LazySimpleSerDe avoids String.split() but it still creates a String object per column per row.&lt;/p&gt;

&lt;p&gt;Also we will need to write routines for LazySimpleSerDe to directly serialize (append) int/long/byte/short etc to UTF-8 buffer.&lt;/p&gt;</comment>
                            <comment id="12694315" author="zshao" created="Tue, 31 Mar 2009 23:02:18 +0000"  >&lt;p&gt;We had a discussion yesterday:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Logical Data Types
	&lt;ul&gt;
		&lt;li&gt;Used for defining table columns&lt;/li&gt;
		&lt;li&gt;Example: String, Integer&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Physical Data Types
	&lt;ul&gt;
		&lt;li&gt;Used for Internal Processing&lt;/li&gt;
		&lt;li&gt;Examples: String/Text, Integer/IntWritable&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Efficiency
	&lt;ul&gt;
		&lt;li&gt;Text is reusable&lt;/li&gt;
		&lt;li&gt;Text is UTF-8&lt;/li&gt;
		&lt;li&gt;Usually the same as serialized format&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Standard:
	&lt;ul&gt;
		&lt;li&gt;Text is Hadoop standard&lt;/li&gt;
		&lt;li&gt;String is Java standard&lt;/li&gt;
		&lt;li&gt;Will be useful to interface with Thrift, ProtocolBuffer etc&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Now:
	&lt;ul&gt;
		&lt;li&gt;Everything is String (and Integer)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Future:
	&lt;ul&gt;
		&lt;li&gt;Choice 1: Use only Text (and IntWritable)
		&lt;ul&gt;
			&lt;li&gt;How to interface with Thrift and other standard Java libraries?&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li&gt;Choice 2: Use a combination of String/Text (and Integer/IntWritable)
		&lt;ul&gt;
			&lt;li&gt;Ideal case&lt;/li&gt;
			&lt;li&gt;Much more complicated: PhysicalDataTypes will change after SerDe (ReduceSinkOperator or FileSinkOperator)&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The conclusion is that we will go Choice 1: Replace String/Integer etc in Hive with Text/IntWritable.&lt;br/&gt;
As a side-effect, all SerDe/UDF(including UDAF) needs to use Writables instead of Java Primitive classes.&lt;/p&gt;

&lt;p&gt;We will change hive internal SerDe/UDF functions.  For user-defined SerDe/UDFs, users will need to change them to make them work with Hive 0.4.&lt;/p&gt;
</comment>
                            <comment id="12695231" author="zshao" created="Fri, 3 Apr 2009 04:06:28 +0000"  >&lt;p&gt;First cut.&lt;/p&gt;

&lt;p&gt;I mainly followed Choice 1 while there are some changes in the details:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TypeInfo: Added PrimitiveTypeEntry in TypeInfoUtils.java to describe a primitive type: name, java primitive type, java primitive Class, WritableClass.
	&lt;ul&gt;
		&lt;li&gt;Modified all codes to use TypeInfo to identify a type (instead of Class&amp;lt;?&amp;gt; - we should never use Class&amp;lt;?&amp;gt; now)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;ObjectInspector: Add methods in PrimitiveObjectInspector to extract the Java Object and the Writable Object
	&lt;ul&gt;
		&lt;li&gt;In this way, we still allow both Text/String to flow in the system.&lt;/li&gt;
		&lt;li&gt;They will have the same TypeInfo, but different PrimitiveObjectInspector: JavaPrimitiveObjectInspector for Java Object and StandardPrimitiveObjectInspector for Writable Object.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;SerDe:
	&lt;ul&gt;
		&lt;li&gt;MetadataTypedColumnsetSerDe and DynamicSerDe will produce Java Objects, and they use JavaPrimitiveObjectInspector as a foundation to create their ObjectInspectors&lt;/li&gt;
		&lt;li&gt;LazySimpleSerDe will produce Writable Objects, and it uses StandardPrimitiveObjectInspector as a foundation to create its ObjectInspector&lt;/li&gt;
		&lt;li&gt;All SerDes accepts Java Objects and Writable Objects in the serialization path - that difference is handled by PrimitiveObjectInspectors&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Operators
	&lt;ul&gt;
		&lt;li&gt;GroupByOperator and JoinOperator now do copy when caching Objects.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12695243" author="zshao" created="Fri, 3 Apr 2009 05:19:43 +0000"  >&lt;p&gt;A simple &quot;INSERT SELECT *&quot; shows with the pending changes (and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-375&quot; title=&quot;LazySimpleSerDe to directly serialize (append) int/long/byte/short etc to UTF-8 buffer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-375&quot;&gt;&lt;del&gt;HIVE-375&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-356&quot; title=&quot;Remove Arrays.asList calls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-356&quot;&gt;&lt;del&gt;HIVE-356&lt;/del&gt;&lt;/a&gt;) we saved 23% or running time:&lt;br/&gt;
Both input and output tables are gzip-block-compressed sequence files. The saving could be bigger for uncompressed tables.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;task	&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(sec)	old(sec)	ratio
0	137	183	0.74863388
1	135	173	0.780346821
2	131	172	0.761627907
3	127	165	0.76969697
4	136	180	0.755555556
5	142	170	0.835294118
6	128	170	0.752941176
7	133	177	0.751412429
8	143	173	0.826589595
9	126	178	0.707865169
total	1338	1741	0.768523837
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12695254" author="zshao" created="Fri, 3 Apr 2009 06:09:48 +0000"  >&lt;p&gt;Corrected some more test errors.&lt;/p&gt;</comment>
                            <comment id="12695275" author="zshao" created="Fri, 3 Apr 2009 07:31:51 +0000"  >&lt;p&gt;TestExpressionEvaluation also showed improvements.&lt;/p&gt;

&lt;p&gt;Originally: (also moved result checking outside of the loop, as we do in this patch)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test:
    [junit] Running org.apache.hadoop.hive.ql.exec.TestExpressionEvaluator
    [junit] ExprNodeColumnEvaluator ok
    [junit] ExprNodeFuncEvaluator ok
    [junit] testExprNodeConversionEvaluator ok
    [junit] Evaluating 1 + 2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 0.682 seconds, 0.068 seconds/million call.
    [junit] Evaluating 1 + 2 - 3 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 2.100 seconds, 0.210 seconds/million call.
    [junit] Evaluating 1 + 2 - 3 + 4 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 2.894 seconds, 0.289 seconds/million call.
    [junit] Evaluating concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 2.284 seconds, 0.228 seconds/million call.
    [junit] Evaluating concat(concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 4.120 seconds, 0.412 seconds/million call.
    [junit] Evaluating concat(concat(concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;4&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 6.345 seconds, 0.635 seconds/million call.
    [junit] Evaluating concat(col1[1], cola[1]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.354 seconds, 0.354 seconds/million call.
    [junit] Evaluating concat(concat(col1[1], cola[1]), col1[2]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.657 seconds, 0.657 seconds/million call.
    [junit] Evaluating concat(concat(concat(col1[1], cola[1]), col1[2]), cola[2]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.869 seconds, 0.869 seconds/million call.
    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 20.464 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test:
    [junit] Running org.apache.hadoop.hive.ql.exec.TestExpressionEvaluator
    [junit] ExprNodeColumnEvaluator ok
    [junit] ExprNodeFuncEvaluator ok
    [junit] testExprNodeConversionEvaluator ok
    [junit] Evaluating 1 + 2 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 0.731 seconds, 0.073 seconds/million call.
    [junit] Evaluating 1 + 2 - 3 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 1.921 seconds, 0.192 seconds/million call.
    [junit] Evaluating 1 + 2 - 3 + 4 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 2.849 seconds, 0.285 seconds/million call.
    [junit] Evaluating concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 1.303 seconds, 0.130 seconds/million call.
    [junit] Evaluating concat(concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 2.522 seconds, 0.252 seconds/million call.
    [junit] Evaluating concat(concat(concat(&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;3&quot;&lt;/span&gt;), &lt;span class=&quot;code-quote&quot;&gt;&quot;4&quot;&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10000000 times
    [junit] Evaluation finished: 3.716 seconds, 0.372 seconds/million call.
    [junit] Evaluating concat(col1[1], cola[1]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.321 seconds, 0.321 seconds/million call.
    [junit] Evaluating concat(concat(col1[1], cola[1]), col1[2]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.504 seconds, 0.504 seconds/million call.
    [junit] Evaluating concat(concat(concat(col1[1], cola[1]), col1[2]), cola[2]) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 1000000 times
    [junit] Evaluation finished: 0.651 seconds, 0.651 seconds/million call.
    [junit] Tests run: 4, Failures: 0, Errors: 0, Time elapsed: 14.729 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12696891" author="zshao" created="Wed, 8 Apr 2009 05:06:16 +0000"  >&lt;p&gt;Cleaned up some long if-elseif-...-else by using Enums and switch.&lt;br/&gt;
This will also help with the speed.&lt;/p&gt;</comment>
                            <comment id="12698464" author="zshao" created="Mon, 13 Apr 2009 17:59:46 +0000"  >&lt;p&gt;Temporary fix for the outer-join problem. Full fix requires &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-405&quot; title=&quot;Cleanup operator initialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-405&quot;&gt;&lt;del&gt;HIVE-405&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12698505" author="namit" created="Mon, 13 Apr 2009 19:16:04 +0000"  >&lt;p&gt;1 minor edit in JoinOperator:&lt;/p&gt;

&lt;p&gt;instead of checking for nullness of forwardCache everytime - you can create forwardCache in initialize() itself&lt;br/&gt;
Also, instead of (p=-1, and +&lt;ins&gt;p) &amp;#8211; can you use (p=0, p&lt;/ins&gt;+) looks more readable&lt;/p&gt;</comment>
                            <comment id="12698511" author="zshao" created="Mon, 13 Apr 2009 19:28:39 +0000"  >&lt;p&gt;Incorporated Namit&apos;s feedback.&lt;br/&gt;
Also changed GroupByOperator.getSize() to work with Writable.&lt;/p&gt;</comment>
                            <comment id="12698572" author="zshao" created="Mon, 13 Apr 2009 22:13:05 +0000"  >&lt;p&gt;Make the code backward compatible with existing UDF classes that uses Java primitive types.&lt;br/&gt;
Added a test case for that.&lt;/p&gt;</comment>
                            <comment id="12698627" author="athusoo" created="Tue, 14 Apr 2009 02:24:59 +0000"  >&lt;p&gt;I looked at the UDAF evaluator stuff and the UDF changes. They look fine to me. So +1 from my side. Though we should think of ways in which the UDAF does not need to create a sub class for the evaluator. Will run the tests and checkin if all the tests pass on trunk.&lt;/p&gt;</comment>
                            <comment id="12698663" author="zshao" created="Tue, 14 Apr 2009 06:26:08 +0000"  >&lt;p&gt;Fixed javadoc warnings.&lt;/p&gt;</comment>
                            <comment id="12698882" author="zshao" created="Tue, 14 Apr 2009 19:06:32 +0000"  >&lt;p&gt;Forgot to mention: I also removed the JEXL jar because Hive does not depend on JEXL for a long time.&lt;/p&gt;</comment>
                            <comment id="12698904" author="zshao" created="Tue, 14 Apr 2009 20:05:51 +0000"  >&lt;p&gt;Because of the last change (make it compatible with Java Primitive Class UDFs), we can calculate hashcode based on String (just as before) instead of Text now.&lt;br/&gt;
This reverted the changes to sample*.q.out. Here is the updated patch.&lt;/p&gt;</comment>
                            <comment id="12698974" author="namit" created="Tue, 14 Apr 2009 22:56:18 +0000"  >&lt;p&gt;Committed. Thanks Zheng&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12416592">HIVE-337</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12419596">HIVE-375</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12413976">HIVE-270</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12404502" name="HIVE-266.1.patch" size="1331340" author="zshao" created="Fri, 3 Apr 2009 04:20:06 +0000"/>
                            <attachment id="12404507" name="HIVE-266.2.patch" size="1337796" author="zshao" created="Fri, 3 Apr 2009 06:09:48 +0000"/>
                            <attachment id="12404925" name="HIVE-266.3.patch" size="1435518" author="zshao" created="Wed, 8 Apr 2009 05:06:16 +0000"/>
                            <attachment id="12405333" name="HIVE-266.4.patch" size="1464974" author="zshao" created="Mon, 13 Apr 2009 17:59:46 +0000"/>
                            <attachment id="12405342" name="HIVE-266.5.patch" size="1466218" author="zshao" created="Mon, 13 Apr 2009 19:28:39 +0000"/>
                            <attachment id="12405361" name="HIVE-266.6.patch" size="1472398" author="zshao" created="Mon, 13 Apr 2009 22:13:05 +0000"/>
                            <attachment id="12405393" name="HIVE-266.7.patch" size="1478348" author="zshao" created="Tue, 14 Apr 2009 06:26:08 +0000"/>
                            <attachment id="12405455" name="HIVE-266.8.patch" size="935724" author="zshao" created="Tue, 14 Apr 2009 20:05:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Apr 2009 19:16:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l8un:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122084</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-267] Multi-GroupBy inserts with the same distinct expression should share the first map-reduce job</title>
                <link>https://issues.apache.org/jira/browse/HIVE-267</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently multi-GroupBy inserts was done in a way that each GroupBy is separate.&lt;/p&gt;

&lt;p&gt;We should be able to optimize the plan.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413762">HIVE-267</key>
            <summary>Multi-GroupBy inserts with the same distinct expression should share the first map-reduce job</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                            <label>optimization</label>
                    </labels>
                <created>Mon, 2 Feb 2009 08:15:59 +0000</created>
                <updated>Tue, 5 Apr 2011 23:13:23 +0000</updated>
                                            <version>0.6.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12669525" author="zshao" created="Mon, 2 Feb 2009 08:25:52 +0000"  >&lt;p&gt;Some preliminary thinking:&lt;/p&gt;

&lt;p&gt;When there is a single shared global distinct expression:&lt;br/&gt;
1. When generating the first reducer for the GroupBy plans, put the distinct expression into the key.&lt;br/&gt;
2. Let the query optimizer merge the reduceSinkOperators with the same source tables and key value expressions. Note that there might be filter operators, and the query optimizer needs to take a union of all rows that might pass any filter operators.&lt;br/&gt;
3. The reducer outputs need to be separated into several different sets, each for one GroupBy.&lt;/p&gt;

&lt;p&gt;When there is no distinct expression:&lt;br/&gt;
1. Run a map-only job and do map-side aggregation for all group-bys.&lt;br/&gt;
2. Split the results into different sets.&lt;/p&gt;


&lt;p&gt;Both require some infrastructure change: to be able to split the output of mappers/reducers into several sets.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42871</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08ou7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48623</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>
