<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:17:48 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2011-3-8+AND+created+%3C%3D+2011-3-16+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="28" total="28"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-2030] isEmptyPath() to use ContentSummary cache</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2030</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;addInputPaths() calls isEmptyPath() for every input path. Now every call is a DFS namenode call. Making isEmptyPath() to use cached ContentSummary, we should be able to avoid some namenode calls and reduce latency in the case of multiple partitions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500712">HIVE-2030</key>
            <summary>isEmptyPath() to use ContentSummary cache</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 01:16:27 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:12 +0000</updated>
                            <resolved>Fri, 11 Mar 2011 21:44:26 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13004253" author="he yongqiang" created="Tue, 8 Mar 2011 22:13:53 +0000"  >&lt;p&gt;The ContentSummary is not guaranteed to be populated. Even it is, it seems this information is not passed to the child process. (So this is not empty only when executing with local mode)&lt;/p&gt;</comment>
                            <comment id="13004259" author="sdong" created="Tue, 8 Mar 2011 22:23:38 +0000"  >&lt;p&gt;In the case of Exception, we don&apos;t populate cache. It&apos;s to make sure cache never gets wrong value.&lt;/p&gt;</comment>
                            <comment id="13004260" author="sdong" created="Tue, 8 Mar 2011 22:26:00 +0000"  >&lt;p&gt;Yongqiang, I don&apos;t quite understand your comment. If there is a cache miss, we call the original method. We never make things worse.&lt;/p&gt;</comment>
                            <comment id="13004317" author="he yongqiang" created="Wed, 9 Mar 2011 00:56:09 +0000"  >&lt;p&gt;okay, will test and commit.&lt;/p&gt;</comment>
                            <comment id="13005234" author="he yongqiang" created="Thu, 10 Mar 2011 18:44:23 +0000"  >&lt;p&gt;siying, can you update the patch?&lt;/p&gt;</comment>
                            <comment id="13005358" author="he yongqiang" created="Thu, 10 Mar 2011 22:23:29 +0000"  >&lt;p&gt;running tests with the new patch&lt;/p&gt;</comment>
                            <comment id="13005856" author="he yongqiang" created="Fri, 11 Mar 2011 21:44:26 +0000"  >&lt;p&gt;committed. thanks siying!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12472891" name="HIVE-2030.1.patch" size="4684" author="sdong" created="Tue, 8 Mar 2011 01:18:19 +0000"/>
                            <attachment id="12473069" name="HIVE-2030.2.patch" size="4904" author="sdong" created="Tue, 8 Mar 2011 22:23:38 +0000"/>
                            <attachment id="12473313" name="HIVE-2030.3.patch" size="4201" author="sdong" created="Thu, 10 Mar 2011 19:28:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Mar 2011 22:13:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123581</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2031] Correct the exception message for the better traceability for the scenario load into the partitioned table having 2  partitions by specifying only one partition in the load statement. </title>
                <link>https://issues.apache.org/jira/browse/HIVE-2031</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt; Load into the partitioned table having 2 partitions by specifying only one partition in the load statement is failing and logging the following exception message.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; org.apache.hadoop.hive.ql.parse.SemanticException: line 1:91 Partition not found &apos;21Oct&apos;
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer$tableSpec.&amp;lt;init&amp;gt;(BaseSemanticAnalyzer.java:685)
	at org.apache.hadoop.hive.ql.parse.LoadSemanticAnalyzer.analyzeInternal(LoadSemanticAnalyzer.java:196)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:238)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:340)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:736)
	at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:151)
	at org.apache.hadoop.hive.service.ThriftHive$Processor$execute.process(ThriftHive.java:764)
	at org.apache.hadoop.hive.service.ThriftHive$Processor.process(ThriftHive.java:742)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:253)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:619)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This needs to be corrected in such a way what is the actual root cause for this.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12500751">HIVE-2031</key>
            <summary>Correct the exception message for the better traceability for the scenario load into the partitioned table having 2  partitions by specifying only one partition in the load statement. </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 11:38:53 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:53 +0000</updated>
                            <resolved>Sat, 9 Apr 2011 16:26:05 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Logging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13003951" author="chinnalalam" created="Tue, 8 Mar 2011 14:12:39 +0000"  >

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
create table sampletable (a string,b string) PARTITIONED BY(dt STRING, country STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;@&apos;&quot;;

LOAD DATA INPATH &apos;/user/root/mytable/joindata.txt&apos; OVERWRITE INTO TABLE sampletable partition (dt=&apos;21Oct&apos;);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above query will fail because load query don&apos;t have 2 partitions information. If the log message is coming like this it is easy to debug&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2011-03-08 17:13:20,901 ERROR ql.Driver (SessionState.java:printError(365)) - FAILED: Error in semantic analysis: line 1:91 Partition not found &apos;21Oct&apos;
org.apache.hadoop.hive.ql.parse.SemanticException: line 1:91 Partition not found &apos;21Oct&apos;
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer$tableSpec.&amp;lt;init&amp;gt;(BaseSemanticAnalyzer.java:685)
	.............
	at java.lang.Thread.run(Thread.java:619)
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: table is partitioned but partition spec is not specified or does not fully match table partitioning: {dt=21Oct}
	at org.apache.hadoop.hive.ql.metadata.Table.isValidSpec(Table.java:341)
	........... 11 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13006345" author="amareshwari" created="Mon, 14 Mar 2011 07:55:12 +0000"  >&lt;p&gt;Change looks fine. Can you add a test in clientnegative?&lt;/p&gt;</comment>
                            <comment id="13009586" author="chinnalalam" created="Tue, 22 Mar 2011 08:41:22 +0000"  >&lt;p&gt;Updated the patch with test cases.&lt;/p&gt;</comment>
                            <comment id="13009643" author="amareshwari" created="Tue, 22 Mar 2011 13:45:16 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13010011" author="amareshwari" created="Wed, 23 Mar 2011 06:07:55 +0000"  >&lt;p&gt;Committed. Thanks Chinna.&lt;/p&gt;</comment>
                            <comment id="13017898" author="namit" created="Sat, 9 Apr 2011 16:26:05 +0000"  >&lt;p&gt;This was committed, but was not closed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473690" name="HIVE-2031.2.patch" size="2242" author="chinnalalam" created="Tue, 15 Mar 2011 15:06:01 +0000"/>
                            <attachment id="12472948" name="HIVE-2031.patch" size="1067" author="chinnalalam" created="Tue, 8 Mar 2011 12:37:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 14 Mar 2011 07:55:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69570</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123582</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2032] create database does not honour warehouse.dir in dbproperties</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2032</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;ol&gt;
	&lt;li&gt;create database db with dbproperties (&apos;hive.metastore.warehouse.dir&apos; = &apos;loc&apos;);&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The above command does not set location of &apos;db&apos; to &apos;loc&apos;. It instead creates &apos;db.db&apos; under the warehouse directory configured in hive-site.xml of CLI. Looks conflicting with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1820&quot; title=&quot;Make Hive database data center aware&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1820&quot;&gt;&lt;del&gt;HIVE-1820&lt;/del&gt;&lt;/a&gt;&apos;s expectation. If scratch dir is specified here, that is honoured.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500803">HIVE-2032</key>
            <summary>create database does not honour warehouse.dir in dbproperties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="thiruvel">Thiruvel Thirumoolan</assignee>
                                    <reporter username="thiruvel">Thiruvel Thirumoolan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 19:14:31 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:06 +0000</updated>
                            <resolved>Tue, 12 Apr 2011 04:08:34 +0000</resolved>
                                    <version>0.7.0</version>
                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Clients</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13004143" author="thiruvel" created="Tue, 8 Mar 2011 19:19:15 +0000"  >&lt;p&gt;Preliminary patch. Test cases are added.&lt;/p&gt;</comment>
                            <comment id="13014458" author="amareshwari" created="Fri, 1 Apr 2011 07:32:53 +0000"  >&lt;p&gt;I see changes for alter Database also to change the location URI. What are semantics of alter database for changing location uri? Is it going to create the tables under the new location after altering? If so, what happens to earlier tables. I see that location uri is accessed only in create db and drop db. So, I think we should not allow altering the location uri. Shall we throw an error if it altered?&lt;/p&gt;

&lt;p&gt;Changes for create DB look fine. Can you update TestHiveMetaStore.testDatabase() to test the same?&lt;/p&gt;</comment>
                            <comment id="13015818" author="thiruvel" created="Tue, 5 Apr 2011 09:46:47 +0000"  >&lt;p&gt;@Amareshwari&lt;/p&gt;

&lt;p&gt;Post altering, new tables will be created under new location. Old tables&apos; have the fully qualified location in metadata and they should continue to work as before.&lt;/p&gt;

&lt;p&gt;The reasons I went with alter location are:&lt;/p&gt;

&lt;p&gt;1. Allow migration to happen if one would like to reorganize or if quota runs out. Not sure how many folks have this situation.&lt;br/&gt;
2. One can migrate new tables to another DFS cluster (existing cluster becoming full).&lt;br/&gt;
3. One can migrate between file systems if they have sufficient use cases.&lt;/p&gt;

&lt;p&gt;Do you think these are valid use cases?&lt;/p&gt;</comment>
                            <comment id="13015918" author="amareshwari" created="Tue, 5 Apr 2011 13:37:21 +0000"  >&lt;p&gt;Use cases make sense. But, drop database would remove tables only from new location. &lt;br/&gt;
Does anyone have the idea why alter Database currently allows to change only DB properties? Namit/Ning?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Post altering, new tables will be created under new location. Old tables&apos; have the fully qualified location in metadata and they should continue to work as before.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Thiruvel, did you get a chance to test this? Because, your changes in patch does not look complete. Changes should be propagated to PersistentManager through ObjectStore.&lt;/p&gt;</comment>
                            <comment id="13015925" author="thiruvel" created="Tue, 5 Apr 2011 13:49:59 +0000"  >&lt;p&gt;&amp;gt; Use cases make sense. But, drop database would remove tables only from new location.&lt;/p&gt;

&lt;p&gt;If I am not wrong, drop db succeeds only if all tables under it are dropped.&lt;/p&gt;

&lt;p&gt;&amp;gt; Thiruvel, did you get a chance to test this? Because, your changes in patch does not look complete. Changes should be propagated to PersistentManager through ObjectStore.&lt;/p&gt;

&lt;p&gt;Will take a look.&lt;/p&gt;</comment>
                            <comment id="13015951" author="thiruvel" created="Tue, 5 Apr 2011 15:13:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt; is supporting LOCATION in create database command&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-675&quot; title=&quot;Add Database/Schema support to Hive QL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-675&quot;&gt;&lt;del&gt;HIVE-675&lt;/del&gt;&lt;/a&gt; - first comment is consistent with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1820&quot; title=&quot;Make Hive database data center aware&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1820&quot;&gt;&lt;del&gt;HIVE-1820&lt;/del&gt;&lt;/a&gt; is about warehouse location through DBPROPERTIES&lt;/p&gt;

&lt;p&gt;My approach on this JIRA so far was based on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1820&quot; title=&quot;Make Hive database data center aware&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1820&quot;&gt;&lt;del&gt;HIVE-1820&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;What is the suggested way to specify location during create database?&lt;/p&gt;

&lt;p&gt;@Carl, @Ning, @He Yongqiang - suggestions?&lt;/p&gt;</comment>
                            <comment id="13017277" author="nzhang" created="Fri, 8 Apr 2011 04:50:21 +0000"  >&lt;p&gt;Thiruvel, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1820&quot; title=&quot;Make Hive database data center aware&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1820&quot;&gt;&lt;del&gt;HIVE-1820&lt;/del&gt;&lt;/a&gt; (actually the subtask of it &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1836&quot; title=&quot;Extend the CREATE DATABASE command with DBPROPERTIES&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1836&quot;&gt;&lt;del&gt;HIVE-1836&lt;/del&gt;&lt;/a&gt;) is not intended to define the database LOCATION. The database metastore schema already contains a LOCATION field, but it was not currently exposed through the CREATE DATABASE syntax. That&apos;s what &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt; is about to solve. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1836&quot; title=&quot;Extend the CREATE DATABASE command with DBPROPERTIES&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1836&quot;&gt;&lt;del&gt;HIVE-1836&lt;/del&gt;&lt;/a&gt; is to introduce dbproperties of generic key-value pairs. The dbproperties can be used/interpreted by application-level pre-execution hooks. We currently do not require the warehouse.dir (if it is one of the keys) must be consistent with the LOCATION field, and I think probably we don&apos;t need to keep 2 piece of information with the same semantics. &lt;/p&gt;

&lt;p&gt;If you want to change the database location URL I think probably a better way is to change the CREATE DATABASE syntax to add location (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt;) and any table created under that database should honor the database location property. What do you think?&lt;/p&gt;</comment>
                            <comment id="13017363" author="amareshwari" created="Fri, 8 Apr 2011 09:43:15 +0000"  >&lt;p&gt;I agree with Ning. There should not be two piece of information with same semantics. Location should be added to create database and alter database if it can be altered. Also, We should document that dbproperties are interpreted at application level. &lt;/p&gt;</comment>
                            <comment id="13017419" author="thiruvel" created="Fri, 8 Apr 2011 12:15:08 +0000"  >&lt;p&gt;I prefer &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt; approach. I got confused by the test queries and found 1537 only later.&lt;/p&gt;

&lt;p&gt;Thanks for the clarification.&lt;/p&gt;</comment>
                            <comment id="13018700" author="thiruvel" created="Tue, 12 Apr 2011 04:08:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt; will address specifying a location for a db.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473028" name="DatabaseLocation.patch" size="1364" author="thiruvel" created="Tue, 8 Mar 2011 19:19:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Apr 2011 07:32:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72575</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123583</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2033] A database&apos;s warehouse.dir is not used for tables created in it.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2033</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;$ create database db with dbproperties (&apos;hive.metastore.warehouse.dir&apos; = &apos;loc&apos;);&lt;br/&gt;
$ use db;&lt;br/&gt;
$ create table test(name string);&lt;/p&gt;

&lt;p&gt;Table &apos;test&apos;s location is not under &apos;loc&apos;. Instead its under hive-site.xml&apos;s warehouse dir.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500805">HIVE-2033</key>
            <summary>A database&apos;s warehouse.dir is not used for tables created in it.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="thiruvel">Thiruvel Thirumoolan</assignee>
                                    <reporter username="thiruvel">Thiruvel Thirumoolan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 19:24:35 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:41 +0000</updated>
                            <resolved>Tue, 21 Jun 2011 18:45:53 +0000</resolved>
                                    <version>0.7.0</version>
                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Clients</component>
                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13004145" author="thiruvel" created="Tue, 8 Mar 2011 19:25:52 +0000"  >&lt;p&gt;Preliminary patch. Test cases being added.&lt;/p&gt;</comment>
                            <comment id="13019263" author="amareshwari" created="Wed, 13 Apr 2011 09:33:11 +0000"  >&lt;p&gt;Do you want close this in favor of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13052758" author="thiruvel" created="Tue, 21 Jun 2011 18:45:53 +0000"  >&lt;p&gt;Addressing it as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1537&quot; title=&quot;Allow users to specify LOCATION in CREATE DATABASE statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1537&quot;&gt;&lt;del&gt;HIVE-1537&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473029" name="HIVE-2033_prelim.patch" size="3093" author="thiruvel" created="Tue, 8 Mar 2011 19:25:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 13 Apr 2011 09:33:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>70669</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123584</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2034] Backport HIVE-1991 after overridden by HIVE-1950</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2034</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12500818">HIVE-2034</key>
            <summary>Backport HIVE-1991 after overridden by HIVE-1950</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 21:40:39 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:41 +0000</updated>
                            <resolved>Wed, 9 Mar 2011 17:30:33 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13004257" author="nzhang" created="Tue, 8 Mar 2011 22:20:27 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13004668" author="nzhang" created="Wed, 9 Mar 2011 17:30:33 +0000"  >&lt;p&gt;Committed. Thanks Siying!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473066" name="HIVE-2034.1.patch" size="2416" author="sdong" created="Tue, 8 Mar 2011 22:07:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Mar 2011 22:20:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72574</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123585</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2035] Use block-level merge for RCFile if merging intermediate results are needed</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2035</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently if hive.merge.mapredfiles and/or hive.merge.mapfile is set to true the intermediate data could be merged using an additional MapReduce job. This could be quite expensive if the data size is large. With &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1950&quot; title=&quot;Block merge for RCFile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1950&quot;&gt;&lt;del&gt;HIVE-1950&lt;/del&gt;&lt;/a&gt;, merging can be done in the RCFile block level so that it bypasses the (de-)compression, (de-)serialization phases. This could improve the merge process significantly. &lt;/p&gt;

&lt;p&gt;This JIRA should handle the case where the input table is not stored in RCFile, but the destination table is (which requires the intermediate data should be stored in the same format as the destination table). &lt;/p&gt;</description>
                <environment></environment>
        <key id="12500825">HIVE-2035</key>
            <summary>Use block-level merge for RCFile if merging intermediate results are needed</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="franklinhu">Franklin Hu</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2011 22:27:32 +0000</created>
                <updated>Thu, 24 Jul 2014 22:32:17 +0000</updated>
                            <resolved>Mon, 18 Jul 2011 19:41:16 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13025645" author="jiraposter@reviews.apache.org" created="Wed, 27 Apr 2011 07:10:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/669/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/669/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Paul Yang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2135&quot; title=&quot;Refactor HiveMetaStore.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2135&quot;&gt;&lt;del&gt;HIVE-2135&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1096976 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreCommand.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1096976 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/URLConnectionUpdater.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/669/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/669/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Since this is a refactoring patch, no new tests are required. Ran all the tests in metastore. All of them passed.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13025909" author="nzhang" created="Wed, 27 Apr 2011 17:31:50 +0000"  >&lt;p&gt;Ashutosh, it seems the review request #669 got a wrong HIVE JIRA reference? &lt;/p&gt;</comment>
                            <comment id="13025937" author="ashutoshc" created="Wed, 27 Apr 2011 18:26:38 +0000"  >&lt;p&gt;Yeah, correct Ning. I missed jira number by 100. Edited the review request. &lt;br/&gt;
Btw, it will be great if you can take a look at that.&lt;/p&gt;</comment>
                            <comment id="13047450" author="franklinhu" created="Fri, 10 Jun 2011 20:57:29 +0000"  >&lt;p&gt;Implements block level merge of intermediate results to a table or partition stored as RCFile.&lt;/p&gt;</comment>
                            <comment id="13051316" author="jiraposter@reviews.apache.org" created="Fri, 17 Jun 2011 20:46:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;For a table stored as RCFile, intermediate results are sometimes merged if those files are below a certain threshold. For RCFiles, we can do a block level merge that does not deserialize the blocks and is more efficient. This patch leverages the existing code used to merge for ALTER TABLE ... CONCATENATE.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileBlockMergeRecordReader.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileKeyBufferWrapper.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java 1134415 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java 1134415 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_createas1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_insert.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge4.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_insert.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge4.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/935/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Franklin&lt;/p&gt;
</comment>
                            <comment id="13051415" author="sdong" created="Sat, 18 Jun 2011 00:40:11 +0000"  >&lt;p&gt;will take a look.&lt;/p&gt;</comment>
                            <comment id="13051430" author="jiraposter@reviews.apache.org" created="Sat, 18 Jun 2011 01:19:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/935/#review864&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#review864&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/935/#comment1889&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#comment1889&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    It doesn&apos;t seem to be a RuntimeException&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/935/#comment1890&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#comment1890&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    why not &quot;inputDepth--&quot;?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/935/#comment1891&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#comment1891&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    should we just throw an exception instead of return a magic null?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_insert.q&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/935/#comment1893&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#comment1893&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Will it launch a merge job? If it launches, it seems a bug in Hive that CombineHiveInputFormat doesn&apos;t span to multiple partitions when it needs to.&lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/935/#comment1892&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#comment1892&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    It doesn&apos;t seem to launch merge jobs. If it launches. It seems to be a bug.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Siying&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-17 20:45:46, Franklin Hu wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-17 20:45:46)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;For a table stored as RCFile, intermediate results are sometimes merged if those files are below a certain threshold. For RCFiles, we can do a block level merge that does not deserialize the blocks and is more efficient. This patch leverages the existing code used to merge for ALTER TABLE ... CONCATENATE.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileBlockMergeRecordReader.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileKeyBufferWrapper.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java 1134415 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_createas1.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_insert.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge4.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_insert.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge1.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge4.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/935/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Franklin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13052176" author="jiraposter@reviews.apache.org" created="Mon, 20 Jun 2011 19:22:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-20 19:20:53.263299)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Throw error at compile time for bad rcfile merge input format class rather than at runtime, remove bad test, stylistic fixes&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;For a table stored as RCFile, intermediate results are sometimes merged if those files are below a certain threshold. For RCFiles, we can do a block level merge that does not deserialize the blocks and is more efficient. This patch leverages the existing code used to merge for ALTER TABLE ... CONCATENATE.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileBlockMergeRecordReader.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileKeyBufferWrapper.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java 1136090 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java 1136090 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_createas1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge4.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge4.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/935/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Franklin&lt;/p&gt;
</comment>
                            <comment id="13052940" author="jiraposter@reviews.apache.org" created="Tue, 21 Jun 2011 23:34:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/935/#review875&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/#review875&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Can you make sure that in the test cases, the query need the merge step?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Siying&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-20 19:20:53, Franklin Hu wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-20 19:20:53)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;For a table stored as RCFile, intermediate results are sometimes merged if those files are below a certain threshold. For RCFiles, we can do a block level merge that does not deserialize the blocks and is more efficient. This patch leverages the existing code used to merge for ALTER TABLE ... CONCATENATE.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileBlockMergeRecordReader.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileKeyBufferWrapper.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java 1136090 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_createas1.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/rcfile_merge4.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge1.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_merge4.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/935/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Franklin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13054031" author="franklinhu" created="Thu, 23 Jun 2011 18:57:02 +0000"  >&lt;p&gt;Add min/max split size settings to unit tests&lt;/p&gt;</comment>
                            <comment id="13054033" author="jiraposter@reviews.apache.org" created="Thu, 23 Jun 2011 18:57:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-23 18:56:14.903379)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add max and min split size configs to unit tests&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;For a table stored as RCFile, intermediate results are sometimes merged if those files are below a certain threshold. For RCFiles, we can do a block level merge that does not deserialize the blocks and is more efficient. This patch leverages the existing code used to merge for ALTER TABLE ... CONCATENATE.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; title=&quot;Use block-level merge for RCFile if merging intermediate results are needed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2035&quot;&gt;&lt;del&gt;HIVE-2035&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2035&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/TaskFactory.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/MergeWork.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileBlockMergeRecordReader.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileKeyBufferWrapper.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/RCFileMergeMapper.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java 1139014 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapredWork.java 1139014 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_createas1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge1.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/rcfile_merge4.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge1.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_merge4.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/935/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/935/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Franklin&lt;/p&gt;
</comment>
                            <comment id="13055355" author="sdong" created="Mon, 27 Jun 2011 06:34:33 +0000"  >&lt;p&gt;+1, will run regression tests&lt;/p&gt;</comment>
                            <comment id="13056205" author="sdong" created="Mon, 27 Jun 2011 23:43:11 +0000"  >&lt;p&gt;committed&lt;/p&gt;</comment>
                            <comment id="13056745" author="hudson" created="Tue, 28 Jun 2011 20:45:19 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #798 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/798/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/798/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12497602">HIVE-1950</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12729598">HIVE-7509</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12482096" name="hive-2035.1.patch" size="481765" author="franklinhu" created="Fri, 10 Jun 2011 20:57:29 +0000"/>
                            <attachment id="12483632" name="hive-2035.3.patch" size="468744" author="franklinhu" created="Thu, 23 Jun 2011 18:57:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 27 Apr 2011 07:10:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66753</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123586</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>For tables stored as RCFile, intermediate results that have too many small files will be merged with a block-level merge that does not deserialize and re-serialized the contents of each block.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2036] Update bitmap indexes for automatic usage</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2036</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1644&quot; title=&quot;use filter pushdown for automatically accessing indexes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1644&quot;&gt;&lt;del&gt;HIVE-1644&lt;/del&gt;&lt;/a&gt; will provide automatic usage of indexes, and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1803&quot; title=&quot;Implement bitmap indexing in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1803&quot;&gt;&lt;del&gt;HIVE-1803&lt;/del&gt;&lt;/a&gt; adds bitmap index support.  The bitmap code will need to be extended after it is committed to enable automatic use of indexing.  Most work will be focused in the BitmapIndexHandler, which needs to generate the re-entrant QL index query.  There may also be significant work in the IndexPredicateAnalyzer to support predicates with OR&apos;s, instead of just AND&apos;s as it is currently.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500846">HIVE-2036</key>
            <summary>Update bitmap indexes for automatic usage</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="salbiz">Syed S. Albiz</assignee>
                                    <reporter username="rmelick">Russell Melick</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2011 06:47:22 +0000</created>
                <updated>Thu, 2 May 2013 02:29:36 +0000</updated>
                            <resolved>Tue, 21 Jun 2011 01:41:41 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Indexing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13036449" author="mwang5" created="Thu, 19 May 2011 20:49:48 +0000"  >&lt;p&gt;Making notes on how to do this:&lt;/p&gt;

&lt;p&gt;One of the difficult/different parts about using bitmap indexes is that the only time they become useful is when multiple indexes are combined. Thus, you need a query that joins the various bitmap index tables and returns the blocks that contain the rows we want.&lt;/p&gt;

&lt;p&gt;Thus the two parts to writing the automatic use index handler for bitmap indexes are:&lt;/p&gt;

&lt;p&gt;1. Figuring out what indexes to use:&lt;/p&gt;

&lt;p&gt;As mentioned above, you may need to extend the IndexPredicateAnalyzer to support ORs and possibly to return a tree of predicates (I don&apos;t think it already does this).&lt;/p&gt;

&lt;p&gt;2. Building a query that accesses the index tables:&lt;/p&gt;

&lt;p&gt;This is an example query that I know works for querying the index tables in the query&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT * FROM lineitem WHERE  L_QUANTITY = 50.0 AND L_DISCOUNT = 0.08 AND L_TAX = 0.01;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SELECT bucketname AS `_bucketname`, COLLECT_SET(offset) as `_offsets`
FROM (SELECT
        `_bucketname` AS bucketname, `_offset` AS offset
      FROM
        (SELECT ab.`_bucketname`, ab.`_offset`, EWAH_BITMAP_AND(ab.bitmap, c.`_bitmaps`) as bitmap FROM
          (SELECT a.`_bucketname`, b.`_offset`, EWAH_BITMAP_AND(a.`_bitmaps`, b.`_bitmaps`) as bitmap FROM 
            (SELECT * FROM default__lineitem_quantity__ WHERE L_QUANTITY = 50.0) a JOIN 
            (SELECT * FROM default__lineitem_discount__ WHERE L_DISCOUNT = 0.08) b 
                ON a.`_bucketname` = b.`_bucketname` AND a.`_offset` = b.`_offset`) ab JOIN
              (SELECT * FROM default__lineitem_tax__ WHERE L_TAX = 0.01) c
                ON ab.`_bucketname` = c.`_bucketname` AND ab.`_offset` = c.`_offset`) abc 
      WHERE 
        NOT EWAH_BITMAP_EMPTY(abc.bitmap)
) t
GROUP BY bucketname;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This format is perfect for joining any number of AND predicates. I&apos;m pretty sure you can figure out how to expand them to include OR predicates and different grounping of predicates as well. If you make any changes/extensions to the format you should be sure to test them to make sure they have the performance characteristics you want.&lt;/p&gt;</comment>
                            <comment id="13036685" author="rmelick" created="Fri, 20 May 2011 05:39:13 +0000"  >&lt;p&gt;To expand a bit on Marquis&apos; comments.&lt;/p&gt;

&lt;p&gt;In CompactIndexHandler.getIndexPredicateAnalyzer(), we instantiate a predicate analyzer.  My theory is that you&apos;re going to want a whole new PredicateAnalyzer class to deal with bitmaps, and then you&apos;ll instantiate it in a very similar way inside BitmapIndexHandler.  You can also see here how we only search for columns on which we have indexes.  This is going to need to be modified, since it currently only allows columns from a single index.&lt;/p&gt;

&lt;p&gt;You may also want to rewrite some of the logic in IndexWhereProcessor.process():110.  It currently loops through every index available and asks it to do a rewrite.  Perhaps it should loop through every index type and try to find the rewrites possible only using indexes of that type.&lt;/p&gt;

&lt;p&gt;If you look at IndexPredicateAnalyzer:123, you can see where it&apos;s making sure that all the parent operators are AND operations.  It should be easy to modify this to allow OR operations, but I&apos;m not sure that simply allowing them and using the current system will maintain logical correctness.  It&apos;s probably better to start off with just AND&apos;s.&lt;/p&gt;

&lt;p&gt;The pushedPredicate is the important thing returned by the predicate analyzer.  The pushed predicate is what it was able to recognize/process.  That&apos;s the tree you&apos;ll want to use to generate the bitmap query.  The residual predicate is what it couldn&apos;t process. There&apos;s a separate JIRA open (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2115&quot; title=&quot;Process residual predicate during automatic index query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2115&quot;&gt;HIVE-2115&lt;/a&gt;) to use the residual to cut down on remaining work.&lt;/p&gt;

&lt;p&gt;The query generation lives in the IndexHandlers.generateIndexQuery(...).  You&apos;ll definitely need more logic than the simple call to decomposedPredicate.pushedPredicate.getExprString() that is in the CompactIndexHandler.&lt;/p&gt;

&lt;p&gt;There are a few spots where hive.index.compact.file is used.  These may need generalized.  However, Marquis may have already taken care of this with the bitmap stuff.  I don&apos;t remember what the new name for it was (I think it&apos;s hive.index.blockfilter.file), but it&apos;s probably easiest to look in one of his unit tests for it.&lt;/p&gt;

&lt;p&gt;The last thing I can think of is that having multiple index types on a single table, or queries that use multiple tables may become an issue.  I created &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2128&quot; title=&quot;Automatic Indexing with multiple tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2128&quot;&gt;&lt;del&gt;HIVE-2128&lt;/del&gt;&lt;/a&gt; to deal with the multiple tables.&lt;/p&gt;

&lt;p&gt;Good luck!&lt;/p&gt;</comment>
                            <comment id="13036709" author="mwang5" created="Fri, 20 May 2011 07:42:53 +0000"  >&lt;p&gt;Russell is right. hive.index.compact.file is deprecated and replaced with hive.index.blockfilter.file (I think). I kept the former around for backwards-compatibility reasons, but we should try to avoid using it.&lt;/p&gt;</comment>
                            <comment id="13037081" author="jvs" created="Fri, 20 May 2011 20:51:37 +0000"  >&lt;p&gt;Yeah, starting off with just AND is probably already a good-sized chunk of work.&lt;/p&gt;</comment>
                            <comment id="13045140" author="jiraposter@reviews.apache.org" created="Mon, 6 Jun 2011 21:38:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/HiveBitmapIndexInputFormat.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap3.q 508eb94 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13045577" author="jvs" created="Tue, 7 Jun 2011 18:30:56 +0000"  >&lt;p&gt;I&apos;ve added some review board comments; I&apos;ll probably have some more once we&apos;ve resolved these.&lt;/p&gt;</comment>
                            <comment id="13045578" author="jiraposter@reviews.apache.org" created="Tue, 7 Jun 2011 18:31:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review773&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review773&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1666&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1666&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Update Javadoc and param name, including an explanation of what handler is supposed to do when multiple indexes are passed in.&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1675&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1675&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m confused by the logic here.  You are throwing together all of the columns for all of the indexes, but we need to keep them segregated, don&apos;t we?  Each subquery should only contain references to the columns relevant to the corresponding index.&lt;/p&gt;

&lt;p&gt;    (But the partitioning predicates need to be applied to each index.)&lt;/p&gt;




&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1668&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1668&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why is this public instead of private?&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1667&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1667&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Use HiveUtils.unparseIdentifier&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/HiveBitmapIndexInputFormat.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1669&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1669&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why do we need this class at all?  The superclass already uses hive.index.blockfilter.file by default.&lt;/p&gt;




&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1672&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1672&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Seems like we should only be looking at the indexes on the table accessed by this table scan.  (This comment is retroactive to the original version of the file.)&lt;/p&gt;




&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1673&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1673&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Seems like the costing comment below applies to this too.&lt;/p&gt;



&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap3.q&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1670&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1670&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why do we need this setting at all?  (I&apos;m not sure why it was there in the original version of the file.)&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-06 21:37:38, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-06 21:37:38)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/HiveBitmapIndexInputFormat.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap3.q 508eb94 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13045717" author="jiraposter@reviews.apache.org" created="Wed, 8 Jun 2011 00:23:59 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-06-07 18:30:15, John Sichi wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java, line 54&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/diff/1/?file=20596#file20596line54&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff/1/?file=20596#file20596line54&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Use HiveUtils.unparseIdentifier&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;HiveUtils.unparseIdentifier is used on the argument passed in through to the constructor.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-06-07 18:30:15, John Sichi wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/HiveBitmapIndexInputFormat.java, line 25&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/diff/1/?file=20599#file20599line25&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff/1/?file=20599#file20599line25&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Why do we need this class at all?  The superclass already uses hive.index.blockfilter.file by default.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;removed in next diff&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Syed&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review773&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review773&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-06-08 00:22:37, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-08 00:22:37)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13045718" author="jiraposter@reviews.apache.org" created="Wed, 8 Jun 2011 00:23:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-08 00:22:37.292935)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Addressed comments. Still does not propagate partition predicates to every single index sub-query, but it does ensure that predicates are only applied to indexes for which there are matching columns. After looking at the behavior of CompactIndexHandler on partitioned tables (and in testcase index_auto_partitioned.q) I can&apos;t quite see how the CompactIndexHandler identifies and propagates partitioning predicates correctly.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13045770" author="jvs" created="Wed, 8 Jun 2011 04:36:34 +0000"  >&lt;p&gt;I&apos;ll take a look at the new patch tomorrow.  index_auto_partitioned.q does not actually include a predicate on the partitioning column, so it should be enhanced to do that.&lt;/p&gt;

&lt;p&gt;The way it works for the compact index handler is that if we have a predicate like&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WHERE part_col = 1 AND index_col = 2 AND some_other_col = 3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;then it should generate&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;WHERE part_col = 1 AND index_col = 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;in the internal query against the index table.  That&apos;s the reason that getIndexPredicateAnalyzer walks through all the partitions and adds the predicate columns via allowColumnName.  (The way it does it isn&apos;t so great since it repeats it for each partition, when in fact one partition should be good enough.)&lt;/p&gt;</comment>
                            <comment id="13045772" author="jiraposter@reviews.apache.org" created="Wed, 8 Jun 2011 04:37:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review782&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review782&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1680&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1680&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    It&apos;s preferable to apply the unparsing right at the point of SQL rendering.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-08 00:22:37, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-08 00:22:37)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13046277" author="jvs" created="Wed, 8 Jun 2011 23:33:35 +0000"  >&lt;p&gt;Added a few new comments on review board.&lt;/p&gt;</comment>
                            <comment id="13046278" author="jiraposter@reviews.apache.org" created="Wed, 8 Jun 2011 23:33:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review785&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review785&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1681&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1681&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think that should be a period instead of a comma in &quot;indexes, if&quot;&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1682&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1682&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    How exactly are they combined?  This Javadoc should be written as a contract between the optimizer and the index plugin author, so that the author knows exactly how to interpret the inputs and also what is going to be done with the output.&lt;/p&gt;




&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1683&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1683&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why do you need to use toArray here?  indexCols.keySet is already a collection.&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1684&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1684&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why are you converting the search conditions back into predicate form here?  Wouldn&apos;t it be easier to analyze them as search conditions?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-08 00:22:37, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-08 00:22:37)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13047029" author="jiraposter@reviews.apache.org" created="Fri, 10 Jun 2011 06:35:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-10 06:35:32.125295)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Based on a discussion with yongqian, I re-implemented the predicate decomposition into two steps, computing the overall residual predicate from the union of all columns in the available indexes, and then computing the predicates to apply to each index individually. Additionally I have also extended the functionality to pass in partition columns to allowColumnNames and added/extended the testcases to check that partition predicates are propagated correctly. This required adding a check in IndexWhereProcessor.java that the correct FilterOperator was passed to the process(...) method (apparently a duplicate FilterOperator that does not have the entire predicate gets created).&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13047368" author="salbiz" created="Fri, 10 Jun 2011 18:47:30 +0000"  >&lt;p&gt;This patch is still WIP, there are a couple of issues I know still need correcting. In particular, the index_auto_unused.q testcase fails, since I updated the partition predicates to propagate properly, there was no check to make sure that the index was built on the partition being queried (but the testcase would still pass since partition predicates weren&apos;t propagated anyway)&lt;/p&gt;

&lt;p&gt;I probably also want to refactor the logic in IndexWhereProcessor before this is ready.&lt;/p&gt;</comment>
                            <comment id="13047980" author="jiraposter@reviews.apache.org" created="Sat, 11 Jun 2011 20:18:12 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-11 19:05:42.241706)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix index_auto_unused.q testcase by adding a check for partitions in the index and ensuring that only partitions actually in the index are used to compute index predicates.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13048854" author="jiraposter@reviews.apache.org" created="Mon, 13 Jun 2011 22:57:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review825&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review825&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1790&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1790&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I don&apos;t think this should be necessary.  We just want to propagate the partition column predicate (whatever it is) from the base table query to the index table query; partition pruning on the index table query will do the rest of the work.&lt;/p&gt;

&lt;p&gt;    In other words, if the original query had&lt;/p&gt;

&lt;p&gt;    part_key=&amp;lt;whatever&amp;gt;&lt;/p&gt;

&lt;p&gt;    we want to preserve that on the index table query.  That&apos;s what the code is already supposed to be doing before your change; was it not working?&lt;/p&gt;



&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-11 19:05:42, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-11 19:05:42)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13048857" author="jiraposter@reviews.apache.org" created="Mon, 13 Jun 2011 23:03:48 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review826&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review826&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1792&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1792&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Don&apos;t bother with empty return statements.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-11 19:05:42, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-11 19:05:42)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13048859" author="jiraposter@reviews.apache.org" created="Mon, 13 Jun 2011 23:05:47 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-06-13 22:57:46, John Sichi wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java, line 114&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/diff/4/?file=20984#file20984line114&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff/4/?file=20984#file20984line114&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I don&apos;t think this should be necessary.  We just want to propagate the partition column predicate (whatever it is) from the base table query to the index table query; partition pruning on the index table query will do the rest of the work.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     In other words, if the original query had&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     part_key=&amp;lt;whatever&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     we want to preserve that on the index table query.  That&apos;s what the code is already supposed to be doing before your change; was it not working?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This code is to prevent automatic usage from kicking in if the index has not been built on the partition specified in the partition predicate. (i.e. if the index has only been built on partition ds=foo, and the query is select key from src where ds=bar; We do not want to execute an index query in this case. It seems like adding a test for bitmaps specifically to mirror index_auto_unused.q(which is where this functionality is tested for Compact indices) would be a good idea.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Syed&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review825&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review825&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-06-11 19:05:42, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-11 19:05:42)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13048977" author="jiraposter@reviews.apache.org" created="Tue, 14 Jun 2011 04:05:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-14 04:05:43.158797)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Removed redundant check on partition predicate (which is done in IndexWhereProcessor). The reason this was causing problems was that when the index was being built, the query generated to build the index was run through the optimizer and at this stage the optimizer thought that the index was already built and had the partition. A simpler solution is to just disable index query optimization for building indexes. &lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13049324" author="jiraposter@reviews.apache.org" created="Tue, 14 Jun 2011 18:34:48 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-06-13 22:57:46, John Sichi wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java, line 114&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/diff/4/?file=20984#file20984line114&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff/4/?file=20984#file20984line114&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I don&apos;t think this should be necessary.  We just want to propagate the partition column predicate (whatever it is) from the base table query to the index table query; partition pruning on the index table query will do the rest of the work.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     In other words, if the original query had&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     part_key=&amp;lt;whatever&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     we want to preserve that on the index table query.  That&apos;s what the code is already supposed to be doing before your change; was it not working?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed Albiz wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This code is to prevent automatic usage from kicking in if the index has not been built on the partition specified in the partition predicate. (i.e. if the index has only been built on partition ds=foo, and the query is select key from src where ds=bar; We do not want to execute an index query in this case. It seems like adding a test for bitmaps specifically to mirror index_auto_unused.q(which is where this functionality is tested for Compact indices) would be a good idea.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The logic for making sure that the necessary index partitions exist is already present in IndexWhereProcessor.checkPartitionsCoveredByIndex.  If that&apos;s not working, we should fix it; it should not be necessary to change the predicate analyzer at all.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review825&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review825&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-06-14 04:05:43, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-14 04:05:43)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13049406" author="jiraposter@reviews.apache.org" created="Tue, 14 Jun 2011 20:52:49 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review836&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review836&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1806&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1806&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Slight rephrasing suggested:&lt;/p&gt;

&lt;p&gt;    &quot;If multiple indexes are provided, it is up to handler to decide whether to use none, one, some, or all of them.  The supplied predicate may reference any of the columns from any of the indexes.  If the handler decides to use more than one index, then it is responsible for generating tasks to combine their search results (e.g. via a JOIN).&quot;&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1805&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1805&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This should be gone.&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1807&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1807&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Delete commented-out code, or convert it into a TODO with a corresponding JIRA issue link.&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1808&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1808&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Could you explain more about what&apos;s going on here?&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1817&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1817&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Only do indexes.get(0) once.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-14 04:05:43, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-14 04:05:43)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13049436" author="jiraposter@reviews.apache.org" created="Tue, 14 Jun 2011 21:26:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-14 21:26:21.276789)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Addressed comments, added some more commenting for why we use indexes.get(0) in IndexWhereProcessor as that seemed a bit unclear&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13050150" author="jiraposter@reviews.apache.org" created="Wed, 15 Jun 2011 23:46:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-15 23:46:24.176586)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Used setFilterExpr on the TableScanDesc to propagate the complete original predicate as the partition predicate was getting removed by the PartitionConditionRemover from the FilterOperator&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java 95fef73 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java d22654b &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out 713bb40 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out 894a556 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out 27092dc &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out 8a1eda5 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out dadfa77 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13050610" author="jiraposter@reviews.apache.org" created="Thu, 16 Jun 2011 18:05:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/#review856&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#review856&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/857/#comment1865&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/#comment1865&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Need to update this comment now, explaining why we don&apos;t even look for the filter operator any more.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-15 23:46:24, Syed Albiz wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-15 23:46:24)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java 95fef73 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java d22654b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto.q.out 713bb40 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_file_format.q.out 894a556 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_multiple.q.out 27092dc &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_auto_unused.q.out 8a1eda5 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap3.q.out dadfa77 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Syed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13051368" author="jiraposter@reviews.apache.org" created="Fri, 17 Jun 2011 22:34:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/857/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-17 22:34:18.950303)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;added comments, only push filter expr into TS operator when automatic indexing is turned on.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add support for generating index queries to support automatic usage of bitmap indexes. This required changing the interface to the IndexHandlers to support accepting queries on multiple indexes. The compact indexes were modified to use this new interface as well, although no functional changes were made to how they work. Only supports AND predicates right now, but it should be possibly to extend the BitmapQuery interface defined in this patch to easily support OR predicates as well. Currently benchmarking these changes on a test cluster.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; title=&quot;Update bitmap indexes for automatic usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2036&quot;&gt;&lt;del&gt;HIVE-2036&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2036&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/HiveIndexHandler.java e5ee183 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java 3caa4cc &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java af9d7b1 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapInnerQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapOuterQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapQuery.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 56e7609 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/io/HiveFileFormatUtils.java d64e88b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereProcessor.java 268560d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/index/IndexWhereTaskDispatcher.java 0873e1a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java 95fef73 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java d22654b &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_partitioned.q 5f92f04 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto.q PRE-CREATION &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out 713bb40 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out 894a556 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out 27092dc &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out 05cc84a &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out 8a1eda5 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out dadfa77 &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/857/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/857/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes unit tests, additional testcase to test automatic bitmap indexing index_bitmap_auto.q was also added to the TestCliDriver suite. Currently benchmarking changes on a test cluster.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13052196" author="jvs" created="Mon, 20 Jun 2011 20:08:14 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13052197" author="jvs" created="Mon, 20 Jun 2011 20:09:03 +0000"  >&lt;p&gt;I mean, once the latest patch gets uploaded.&lt;/p&gt;</comment>
                            <comment id="13052310" author="jvs" created="Tue, 21 Jun 2011 01:41:41 +0000"  >&lt;p&gt;Committed.  Thanks Syed!&lt;/p&gt;</comment>
                            <comment id="13054058" author="hudson" created="Thu, 23 Jun 2011 19:47:05 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #790 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/790/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/790/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12480471">HIVE-1803</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12474222">HIVE-1644</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12481634" name="HIVE-2036.1.patch" size="163233" author="salbiz" created="Mon, 6 Jun 2011 22:12:15 +0000"/>
                            <attachment id="12482088" name="HIVE-2036.3.patch" size="184558" author="salbiz" created="Fri, 10 Jun 2011 18:47:30 +0000"/>
                            <attachment id="12483204" name="HIVE-2036.8.patch" size="433866" author="salbiz" created="Mon, 20 Jun 2011 20:19:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 19 May 2011 20:49:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>70150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i010db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2037] Merge result file size should honor hive.merge.size.per.task</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2037</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The merge job set mapred.min.split.size to the value of hive.merge.size.per.task, which roughly equals to the output file size. However the input split size is also determined by mapred.min.split.size.per.node, mapred.min.split.size.per.rack, and mapred.max.split.size. They should be set the same as hive.merge.size.per.task as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500848">HIVE-2037</key>
            <summary>Merge result file size should honor hive.merge.size.per.task</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2011 07:12:17 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:24 +0000</updated>
                            <resolved>Wed, 9 Mar 2011 23:10:50 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13004802" author="jsensarma" created="Wed, 9 Mar 2011 21:15:07 +0000"  >&lt;p&gt;looks ok - please run the tests and i will commit.&lt;/p&gt;</comment>
                            <comment id="13004852" author="nzhang" created="Wed, 9 Mar 2011 22:46:08 +0000"  >&lt;p&gt;@joy, the unit tests are clean. &lt;/p&gt;</comment>
                            <comment id="13004866" author="jsensarma" created="Wed, 9 Mar 2011 23:10:31 +0000"  >&lt;p&gt;committed. thanks Ning.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473106" name="HIVE-2037.patch" size="6208" author="nzhang" created="Wed, 9 Mar 2011 07:13:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 Mar 2011 21:15:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37479</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05im7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30113</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2038] Metastore listener</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2038</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Provide to way to observe changes happening on Metastore&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500931">HIVE-2038</key>
            <summary>Metastore listener</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashutoshc">Ashutosh Chauhan</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2011 19:16:45 +0000</created>
                <updated>Tue, 22 Nov 2016 07:53:28 +0000</updated>
                            <resolved>Fri, 6 May 2011 03:18:40 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13004743" author="ashutoshc" created="Wed, 9 Mar 2011 19:18:45 +0000"  >&lt;p&gt;Every time some change on metastore takes&lt;br/&gt;
place, we have some logic which needs to be run. For example, if a new&lt;br/&gt;
table is getting created in metastore I want to send a message to a&lt;br/&gt;
message bus. &lt;/p&gt;</comment>
                            <comment id="13004747" author="ashutoshc" created="Wed, 9 Mar 2011 19:25:50 +0000"  >&lt;p&gt;Proposed interface. Not polished and complete. Posting early to get feedback if this looks viable way to achieve the desired functionality.&lt;/p&gt;</comment>
                            <comment id="13004752" author="ashutoshc" created="Wed, 9 Mar 2011 19:30:51 +0000"  >&lt;p&gt;Missed couple of files. In svn, you need to svn add files. Spoiled by git goodness.&lt;/p&gt;</comment>
                            <comment id="13018544" author="ashutoshc" created="Mon, 11 Apr 2011 20:13:05 +0000"  >&lt;p&gt;The patch is ready for review.&lt;/p&gt;</comment>
                            <comment id="13018608" author="cwsteinbach" created="Mon, 11 Apr 2011 22:35:30 +0000"  >&lt;p&gt;@Ashutosh: Can you please post a review request? Thanks!&lt;/p&gt;</comment>
                            <comment id="13018668" author="jiraposter@reviews.apache.org" created="Tue, 12 Apr 2011 01:31:05 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/581/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Paul Yang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Review request for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1079575 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1079575 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1079575 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreListener.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/581/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit test with dummy listener included. Also tested with an alternate listener which sends a message on a message bus.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13018682" author="cwsteinbach" created="Tue, 12 Apr 2011 03:08:13 +0000"  >&lt;p&gt;Please see my comments on reviewboard. Thanks.&lt;/p&gt;</comment>
                            <comment id="13018683" author="jiraposter@reviews.apache.org" created="Tue, 12 Apr 2011 03:09:06 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/581/#review428&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#review428&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment808&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment808&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Please add this property to hive-default.xml along with a description of what it does.&lt;/p&gt;




&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment809&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment809&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Please run checkstyle and correct any violations included in your patch.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment810&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment810&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    No need to reference &quot;this&quot;, right?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment815&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment815&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    What do you think about changing the name to MetaStoreEventListener or CatalogEventListener?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment811&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment811&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Please add some javadoc explaining the intended use of this interface. &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Are the methods called before or after an action completes? What happens if a metastore operation fails?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Are the methods allowed to block? Are they run in a separate thread?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Are the methods allowed to modify the catalog objects that are passed in as parameters?&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment812&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment812&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Checkstyle.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment816&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment816&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Instead of passing in raw Table/Partition/Database objects it may be better to instead wrap these objects in containers, e.g. CreateTableEvent, DropTableEvent, etc. Eventually this interface will probably include onAlterTable() and onAlterPartition(), and programmers will probably want to access both the before and after versions of a Table/Partition, etc.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment813&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment813&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Unrelated bugfix?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/#comment814&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#comment814&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Checkstyle.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-04-12 01:29:41, Ashutosh Chauhan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/581/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-04-12 01:29:41)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/581/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Unit test with dummy listener included. Also tested with an alternate listener which sends a message on a message bus.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ashutosh&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13018877" author="jiraposter@reviews.apache.org" created="Tue, 12 Apr 2011 15:45:06 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java, line 999&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15625#file15625line999&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15625#file15625line999&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Unrelated bugfix?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Related bugfix, I will say : ) Without it, when drop partition returns from object store, partition object doesn&apos;t contain partition values. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java, line 180&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15621#file15621line180&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15621#file15621line180&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Please add this property to hive-default.xml along with a description of what it does.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will add it in hive-default.xml.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java, line 955&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15622#file15622line955&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15622#file15622line955&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Please run checkstyle and correct any violations included in your patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will run checkstyle to check for any style violations.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java, line 27&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line27&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line27&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Please add some javadoc explaining the intended use of this interface. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     * Are the methods called before or after an action completes? What happens if a metastore operation fails?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     * Are the methods allowed to block? Are they run in a separate thread?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     * Are the methods allowed to modify the catalog objects that are passed in as parameters?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will also add in javadoc.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Methods are called after action completes. Only if action succeeds. They are not called if operation fails since in that case nothing has actually changed in metastore.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;This is upto implementation. They can run in same thread, or they can schedule there work in separate thread and return immediately.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I don&apos;t see a reason to disallow modification of passed in parameter objects. But, its mostly irrelevant here since methods are called after change has already been persisted on metastore. So, modifying these objects can&apos;t change any state on metastore.&lt;/li&gt;
&lt;/ul&gt;



&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java, line 29&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line29&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line29&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Instead of passing in raw Table/Partition/Database objects it may be better to instead wrap these objects in containers, e.g. CreateTableEvent, DropTableEvent, etc. Eventually this interface will probably include onAlterTable() and onAlterPartition(), and programmers will probably want to access both the before and after versions of a Table/Partition, etc.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Whats the advantage of wrapper container objects?&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java, line 1446&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15622#file15622line1446&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15622#file15622line1446&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     No need to reference &quot;this&quot;, right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right. Though, I think using &quot;this&quot; in such cases improves code readability. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-04-12 03:07:54, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java, line 26&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line26&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff/1/?file=15623#file15623line26&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     What do you think about changing the name to MetaStoreEventListener or CatalogEventListener?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;MetaStoreEventListener is fine too.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ashutosh&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/581/#review428&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/#review428&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-04-12 01:29:41, Ashutosh Chauhan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/581/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-04-12 01:29:41)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1079575 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/581/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/581/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Unit test with dummy listener included. Also tested with an alternate listener which sends a message on a message bus.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ashutosh&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13020453" author="jiraposter@reviews.apache.org" created="Fri, 15 Apr 2011 22:19:05 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/606/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/606/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Addressed Carl&apos;s comments.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1092811 &lt;br/&gt;
  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1092811 &lt;br/&gt;
  trunk/conf/hive-default.xml 1092811 &lt;br/&gt;
  trunk/metastore/if/hive_metastore.thrift 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1092811 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1092811 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1092811 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1092811 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1092811 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1092811 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1092811 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/606/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/606/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13021172" author="jiraposter@reviews.apache.org" created="Mon, 18 Apr 2011 18:45:06 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/618/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Addresses Carl&apos;s comment for previous patch. &lt;br/&gt;
Also added a new method finalizePartition in metastore through which metastore client can indicate to metastore that partition can be finalized.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1094688 &lt;br/&gt;
  trunk/conf/hive-default.xml 1094688 &lt;br/&gt;
  trunk/metastore/if/hive_metastore.thrift 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1094688 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1094688 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1094688 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1094688 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1094688 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1094688 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1094688 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/618/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13021174" author="ashutoshc" created="Mon, 18 Apr 2011 18:46:46 +0000"  >&lt;p&gt;@Carl,&lt;br/&gt;
I have uploaded a new patch on reviewboard. It addresses your comments. When I run checkstyle on it, it reports huge number of problems even without my patch. It&apos;s hard to figure out which new ones are there (if any). I tried to correct all those style issues which I could find. If you find any more, it will be great if you can point those ones to me.&lt;/p&gt;</comment>
                            <comment id="13021337" author="cwsteinbach" created="Mon, 18 Apr 2011 23:29:56 +0000"  >&lt;p&gt;@Ashutosh: I&apos;ll take a look later tonight. Thanks.&lt;/p&gt;</comment>
                            <comment id="13022968" author="cwsteinbach" created="Thu, 21 Apr 2011 22:52:03 +0000"  >&lt;p&gt;@Ashutosh: please see my comments here: &lt;a href=&quot;https://reviews.apache.org/r/618/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13022969" author="jiraposter@reviews.apache.org" created="Thu, 21 Apr 2011 22:52:06 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/618/#review522&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#review522&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1070&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1070&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1071&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1071&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    formatting&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1072&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1072&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1073&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1073&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1074&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1074&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1075&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1075&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This change should go in a separate ticket. What does it mean to &quot;finalize&quot; a partition?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1076&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1076&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1087&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1087&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Instead of passing in raw Table/Partition/Database objects please wrap these objects in containers, e.g. CreateTableEvent, DropTableEvent, etc.&lt;/p&gt;

&lt;p&gt;    Q: Whats the advantage of wrapper container objects?&lt;/p&gt;

&lt;p&gt;    The advantage of container objects is that it allows us to evolve the API without breaking compatibility with older clients. With the current interface if I want to add a parameter to one of these methods I will break compatibility, but if we use container objects I can add a new field to the container without affecting older clients.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1077&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1077&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1078&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1078&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1079&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1079&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1080&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1080&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Please remove this and include it in a separate patch. We need to discuss what &quot;finalizing&quot; a partition actually means, and how it relates to locking.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1083&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1083&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1082&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1082&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1081&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1081&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1086&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1086&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    spacing&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-04-18 18:44:05, Ashutosh Chauhan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/618/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-04-18 18:44:05)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Addresses Carl&apos;s comment for previous patch. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Also added a new method finalizePartition in metastore through which metastore client can indicate to metastore that partition can be finalized.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/conf/hive-default.xml 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/618/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ashutosh&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13023036" author="jiraposter@reviews.apache.org" created="Thu, 21 Apr 2011 23:46:07 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-04-21 22:51:56, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java, line 41&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/diff/1/?file=15927#file15927line41&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/diff/1/?file=15927#file15927line41&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Instead of passing in raw Table/Partition/Database objects please wrap these objects in containers, e.g. CreateTableEvent, DropTableEvent, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Q: Whats the advantage of wrapper container objects?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     The advantage of container objects is that it allows us to evolve the API without breaking compatibility with older clients. With the current interface if I want to add a parameter to one of these methods I will break compatibility, but if we use container objects I can add a new field to the container without affecting older clients.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It seems like this same concern also dictates that MetaStoreListener should be an abstract class instead of an interface. Can you please make this change?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/618/#review522&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#review522&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-04-18 18:44:05, Ashutosh Chauhan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/618/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-04-18 18:44:05)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Addresses Carl&apos;s comment for previous patch. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Also added a new method finalizePartition in metastore through which metastore client can indicate to metastore that partition can be finalized.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/conf/hive-default.xml 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/618/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ashutosh&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13023037" author="jiraposter@reviews.apache.org" created="Thu, 21 Apr 2011 23:50:05 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/618/#review526&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#review526&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/618/#comment1090&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/#comment1090&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think it should be possible to specify multiple metastore listeners. Can you please make the following changes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Change the name of the conf property from &quot;hive.metastore.listener&quot; to &quot;hive.metastore.event.listeners&quot; and update the description to indicate that this is a comma separated list of listener classnames.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Change the default value for this property to be an empty string.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Update the code that initializes these listeners. You can cut and paste the code that&apos;s used to initialize hive.exec.pre.hooks&lt;/li&gt;
&lt;/ul&gt;




&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-04-18 18:44:05, Ashutosh Chauhan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/618/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-04-18 18:44:05)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Addresses Carl&apos;s comment for previous patch. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Also added a new method finalizePartition in metastore through which metastore client can indicate to metastore that partition can be finalized.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/conf/hive-default.xml 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/NoOpListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1094688 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/618/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/618/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ashutosh&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13023084" author="ashutoshc" created="Fri, 22 Apr 2011 02:52:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;We need to discuss what &quot;finalizing&quot; a partition actually means, and how it relates to locking.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Meaning of &quot;finalizing&quot; is not defined by MetaStore but by listener hook. It is left to listener to take whatever action it thinks is appropriate. I didn&apos;t get your concern w.r.t locking. Can you explain what you are thinking here w.r.t locking?&lt;/p&gt;</comment>
                            <comment id="13023320" author="cwsteinbach" created="Fri, 22 Apr 2011 18:22:53 +0000"  >&lt;p&gt;I think the meaning of &quot;finalizing&quot; a partition is actually defined by the metastore client, since it&apos;s the client that has to call finalizePartition(). But when is the client supposed to call this? What happens if you have multiple listeners registered which each has a different idea of what it means to finalize a partition? I think the main problem with this is that the name of the method gives the impression that this is somehow well defined, when in fact the definition is left completely up to the application.&lt;/p&gt;

&lt;p&gt;It sounds like what you actually want is a mechanism that allows the metastore client to send application specific events to metastore listeners. Is this accurate?&lt;/p&gt;
</comment>
                            <comment id="13023429" author="ashutoshc" created="Fri, 22 Apr 2011 22:15:33 +0000"  >&lt;p&gt;Ya, you are accurate. A mechanism for metastore client to send application specific event to metastore listener. I agree &quot;finalize&quot; may not be an appropriate choice here. Can&apos;t think of anything better. Any suggestions : )&lt;/p&gt;</comment>
                            <comment id="13023430" author="ashutoshc" created="Fri, 22 Apr 2011 22:17:42 +0000"  >&lt;p&gt;Shall we call it takeActionOnPartition() ? Too verbose ?&lt;/p&gt;</comment>
                            <comment id="13023439" author="cwsteinbach" created="Fri, 22 Apr 2011 22:45:58 +0000"  >&lt;p&gt;If you do it this way I think you can only support registering a single listener. This follows from the fact that the meaning of a takeActionOnPartition() event is specific to a particular application, but the listener has no way of knowing which application fired the event. I don&apos;t think this is an acceptable limitation.&lt;/p&gt;

&lt;p&gt;You can get around this by defining a ListenerEvent base class that third-party applications are allowed to extend. Applications can then fire this event from the client side, and listeners can register events that they are interested in listening for using an event type registry. Getting this to work is further complicated by the fact that you have to support serialization of the event objects over the Thrift interface.&lt;/p&gt;

&lt;p&gt;I think it&apos;s appropriate to tackle this problem in a separate JIRA. I&apos;d like to see some concrete use cases and discuss alternatives. I&apos;m not convinced that the MetastoreClient/MetastoreListener should support the ability to fire arbitrary events.&lt;/p&gt;</comment>
                            <comment id="13023521" author="jiraposter@reviews.apache.org" created="Sat, 23 Apr 2011 07:33:06 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/648/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/648/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. Removed finalizePartition(). Will file separate jira for it.&lt;br/&gt;
2. Added container objects for different event types.&lt;br/&gt;
3. Changed MetaStoreEventListener from interface to abstract class.&lt;br/&gt;
4. Modifications to allow a list of listeners instead of just one.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1096112 &lt;br/&gt;
  trunk/conf/hive-default.xml 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/AddPartitionEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/CreateDatabaseEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/CreateTableEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropDatabaseEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropPartitionEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropTableEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/ListenerEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/648/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/648/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13025335" author="ashutoshc" created="Tue, 26 Apr 2011 17:20:28 +0000"  >&lt;p&gt;This is identical patch to the one on ReviewBoard with only diff being listeners are now instantiated with constructors which takes conf as parameter.&lt;/p&gt;</comment>
                            <comment id="13025940" author="jiraposter@reviews.apache.org" created="Wed, 27 Apr 2011 18:33:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/648/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/648/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-04-27 18:32:08.932517)&lt;/p&gt;


&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Identical patch on jira.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. Removed finalizePartition(). Will file separate jira for it.&lt;br/&gt;
2. Added container objects for different event types.&lt;br/&gt;
3. Changed MetaStoreEventListener from interface to abstract class.&lt;br/&gt;
4. Modifications to allow a list of listeners instead of just one.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2038&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1096112 &lt;br/&gt;
  trunk/conf/hive-default.xml 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreEventListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/MetaStoreUtils.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1096112 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/AddPartitionEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/CreateDatabaseEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/CreateTableEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropDatabaseEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropPartitionEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/DropTableEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/events/ListenerEvent.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/DummyListener.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestMetaStoreEventListener.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/648/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/648/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ashutosh&lt;/p&gt;
</comment>
                            <comment id="13026060" author="cwsteinbach" created="Thu, 28 Apr 2011 00:39:12 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13027239" author="cwsteinbach" created="Fri, 29 Apr 2011 23:45:05 +0000"  >&lt;p&gt;@Ashutosh: Apologies for the delay in getting this committed. I&apos;ve been having problems with my test setup lately, but I think I&apos;ve got the issue resolved. Expect to see this go in sometime in the next day or so.&lt;/p&gt;</comment>
                            <comment id="13027970" author="ashutoshc" created="Tue, 3 May 2011 01:01:13 +0000"  >&lt;p&gt;Updated patch to sync with trunk.&lt;/p&gt;</comment>
                            <comment id="13029434" author="ashutoshc" created="Thu, 5 May 2011 16:59:43 +0000"  >&lt;p&gt;@Carl,&lt;/p&gt;

&lt;p&gt;Knock knock : ) Let me know if I can be of any help here.&lt;/p&gt;</comment>
                            <comment id="13029680" author="cwsteinbach" created="Fri, 6 May 2011 00:51:44 +0000"  >&lt;p&gt;@Ashutosh: I think I finally got a my build problems fixed. I haven&apos;t had a clean test run yet, but a majority of tests are now passing. I&apos;ll send out another update later today, &lt;/p&gt;</comment>
                            <comment id="13029709" author="cwsteinbach" created="Fri, 6 May 2011 03:18:40 +0000"  >&lt;p&gt;Committed to trunk. Thanks Ashutosh!&lt;/p&gt;</comment>
                            <comment id="13029817" author="hudson" created="Fri, 6 May 2011 07:59:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.20 #712 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/712/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/712/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2038&quot; title=&quot;Metastore listener&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2038&quot;&gt;&lt;del&gt;HIVE-2038&lt;/del&gt;&lt;/a&gt;. Add MetaStoreListener interface (Ashutosh Chauhan via cws)&lt;/p&gt;</comment>
                            <comment id="13593844" author="amalakar" created="Tue, 5 Mar 2013 20:03:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt; is the MetaStoreListener implementation supposed to be threadsafe? I am seeing issues related to that in HCatalog. The javadoc of the listener interface doesn&apos;t mention anything.&lt;/p&gt;</comment>
                            <comment id="15685995" author="lefty@hortonworks.com" created="Tue, 22 Nov 2016 07:53:28 +0000"  >&lt;p&gt;Doc note:  This adds &lt;b&gt;hive.metastore.event.listeners&lt;/b&gt; to HiveConf.java.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.metastore.event.listeners&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Configuration Properties &amp;#8211; hive.metastore.event.listeners &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13966&quot; title=&quot;DbNotificationListener: can loose DDL operation notifications&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13966&quot;&gt;&lt;del&gt;HIVE-13966&lt;/del&gt;&lt;/a&gt; updates the parameter description.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12506080">HIVE-2147</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12976647">HIVE-13966</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12476051" name="hive-2038.patch" size="17322" author="ashutoshc" created="Mon, 11 Apr 2011 20:13:05 +0000"/>
                            <attachment id="12477425" name="hive_2038_3.patch" size="32882" author="ashutoshc" created="Tue, 26 Apr 2011 17:20:28 +0000"/>
                            <attachment id="12478009" name="hive_2038_4.patch" size="33789" author="ashutoshc" created="Tue, 3 May 2011 01:01:13 +0000"/>
                            <attachment id="12473186" name="metastore_listener.patch" size="9459" author="ashutoshc" created="Wed, 9 Mar 2011 19:30:51 +0000"/>
                            <attachment id="12473185" name="metastore_listener.patch" size="9459" author="ashutoshc" created="Wed, 9 Mar 2011 19:30:51 +0000"/>
                            <attachment id="12473183" name="metastore_listener.patch" size="7567" author="ashutoshc" created="Wed, 9 Mar 2011 19:25:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 11 Apr 2011 22:35:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2039] remove hadoop version check from hive cli shell script</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2039</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;looking at cli startup times - one thing i noticed is that the version check in execHiveCmd.sh consumes 0.5-1s of wall-clock time (depending on where hive is installed).&lt;/p&gt;

&lt;p&gt;AFAIK - hive doesn&apos;t support versions less than 20 right now - and this check is only to check if version is less than 20. So we should be able to safely take it out. please comment if that is not the case.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500962">HIVE-2039</key>
            <summary>remove hadoop version check from hive cli shell script</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jsensarma">Joydeep Sen Sarma</assignee>
                                    <reporter username="jsensarma">Joydeep Sen Sarma</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2011 23:31:29 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:02 +0000</updated>
                            <resolved>Fri, 11 Mar 2011 02:45:46 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13004874" author="jsensarma" created="Wed, 9 Mar 2011 23:34:54 +0000"  >&lt;p&gt;never mind. looks like it&apos;s already gone and i am looking at old version.&lt;/p&gt;</comment>
                            <comment id="13004884" author="jsensarma" created="Thu, 10 Mar 2011 00:01:59 +0000"  >&lt;p&gt;spoke too fast - the version check has moved to a different place - but it&apos;s still there. i plan to provide a way to avoid the version check (via env var) because it&apos;s pretty expensive. it would still be there by default.&lt;/p&gt;</comment>
                            <comment id="13004893" author="jsensarma" created="Thu, 10 Mar 2011 00:25:54 +0000"  >&lt;p&gt;skip hadoop version check via hadoop subcommand if version is supplied by env variable.&lt;/p&gt;</comment>
                            <comment id="13004899" author="nzhang" created="Thu, 10 Mar 2011 00:42:19 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13005464" author="nzhang" created="Fri, 11 Mar 2011 02:45:46 +0000"  >&lt;p&gt;Committed. Thanks Joydeep!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473220" name="HIVE-2039.1.patch" size="827" author="jsensarma" created="Thu, 10 Mar 2011 00:25:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 Mar 2011 00:42:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72573</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hive startup shell script allows bypassing running &amp;#39;hadoop version&amp;#39; subcommand via setting of HADOOP_VERSION environment variable. this can reduce latency of starting up the hive cli.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2040] the retry logic in Hive&apos;s concurrency  is not working correctly.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2040</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12501082">HIVE-2040</key>
            <summary>the retry logic in Hive&apos;s concurrency  is not working correctly.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Mar 2011 23:21:17 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:08 +0000</updated>
                            <resolved>Fri, 11 Mar 2011 06:38:49 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13005407" author="he yongqiang" created="Thu, 10 Mar 2011 23:52:05 +0000"  >&lt;p&gt;change to use a do{}while(); just in case the user set an incorrect retry number.&lt;/p&gt;</comment>
                            <comment id="13005458" author="namit" created="Fri, 11 Mar 2011 02:03:42 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13005519" author="namit" created="Fri, 11 Mar 2011 06:38:49 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473348" name="HIVE-2040.1.patch" size="12680" author="he yongqiang" created="Thu, 10 Mar 2011 23:33:54 +0000"/>
                            <attachment id="12473350" name="HIVE-2040.2.patch" size="12684" author="he yongqiang" created="Thu, 10 Mar 2011 23:52:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Mar 2011 02:03:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69609</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123589</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2041] Log message improvement for the ScriptOperator.java</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2041</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Added some new log messages and updated exception message in the existing log messages.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501116">HIVE-2041</key>
            <summary>Log message improvement for the ScriptOperator.java</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:19:12 +0000</created>
                <updated>Mon, 22 Aug 2016 18:14:52 +0000</updated>
                            <resolved>Mon, 22 Aug 2016 18:14:52 +0000</resolved>
                                    <version>0.7.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13007114" author="he yongqiang" created="Tue, 15 Mar 2011 19:22:33 +0000"  >&lt;p&gt;can you elaborate why do you need the full stack trace in the log file? &lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473382" name="HIVE-2041.Patch" size="2122" author="chinnalalam" created="Fri, 11 Mar 2011 12:23:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Mar 2011 19:22:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123590</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2042] In error scenario some opened streams may not closed</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2042</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) In error scenario PrintStream may not be closed in execute() of  ExplainTask.java&lt;br/&gt;
2) In error scenario InputStream may not be closed in checkJobTracker() of Throttle.java &lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501117">HIVE-2042</key>
            <summary>In error scenario some opened streams may not closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:23:20 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:02 +0000</updated>
                            <resolved>Tue, 22 Mar 2011 09:55:50 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13006351" author="amareshwari" created="Mon, 14 Mar 2011 08:41:33 +0000"  >&lt;p&gt;Can you combine &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;del&gt;HIVE-2042&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2043&quot; title=&quot;In error scenario some opened streams may not closed in ql.io package&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2043&quot;&gt;&lt;del&gt;HIVE-2043&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2044&quot; title=&quot;In error scenario opened streams may not closed in TypedBytesWritableOutput.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2044&quot;&gt;&lt;del&gt;HIVE-2044&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2046&quot; title=&quot;In error scenario some opened streams may not closed in Utilities.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2046&quot;&gt;&lt;del&gt;HIVE-2046&lt;/del&gt;&lt;/a&gt; patches into single one? Because all of them are trying to fix opened streams in error scenarios. That would ease reviewing and testing as well.&lt;/p&gt;</comment>
                            <comment id="13006963" author="chinnalalam" created="Tue, 15 Mar 2011 15:19:00 +0000"  >&lt;p&gt;Sure Amareshwari, I uploaded a patch by combining these issues &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;del&gt;HIVE-2042&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2043&quot; title=&quot;In error scenario some opened streams may not closed in ql.io package&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2043&quot;&gt;&lt;del&gt;HIVE-2043&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2044&quot; title=&quot;In error scenario opened streams may not closed in TypedBytesWritableOutput.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2044&quot;&gt;&lt;del&gt;HIVE-2044&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2046&quot; title=&quot;In error scenario some opened streams may not closed in Utilities.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2046&quot;&gt;&lt;del&gt;HIVE-2046&lt;/del&gt;&lt;/a&gt; into one patch.&lt;/p&gt;

&lt;p&gt;Next time onwards i will logically group the comments and i will upload the patch.&lt;/p&gt;</comment>
                            <comment id="13009270" author="namit" created="Mon, 21 Mar 2011 18:38:57 +0000"  >&lt;p&gt;Looks good to me.&lt;/p&gt;

&lt;p&gt;@Amareshwari, what do you think ?&lt;/p&gt;</comment>
                            <comment id="13009549" author="amareshwari" created="Tue, 22 Mar 2011 04:28:47 +0000"  >&lt;p&gt;Looks fine to me also.&lt;/p&gt;</comment>
                            <comment id="13009567" author="amareshwari" created="Tue, 22 Mar 2011 06:49:21 +0000"  >&lt;p&gt;Running tests. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13009598" author="amareshwari" created="Tue, 22 Mar 2011 09:55:50 +0000"  >&lt;p&gt;I just committed this. Thanks Chinna.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473688" name="HIVE-2042.2.Patch" size="9690" author="chinnalalam" created="Tue, 15 Mar 2011 15:04:58 +0000"/>
                            <attachment id="12473383" name="HIVE-2042.Patch" size="2455" author="chinnalalam" created="Fri, 11 Mar 2011 12:24:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 14 Mar 2011 08:41:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72572</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123591</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2043] In error scenario some opened streams may not closed in ql.io package</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2043</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) In error scenario SequenceFile.Reader may not be closed in validateInput() of SequenceFileInputFormatChecker.java &lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501118">HIVE-2043</key>
            <summary>In error scenario some opened streams may not closed in ql.io package</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:27:30 +0000</created>
                <updated>Tue, 15 Mar 2011 19:18:40 +0000</updated>
                            <resolved>Tue, 15 Mar 2011 19:18:40 +0000</resolved>
                                    <version>0.7.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                            <attachment id="12473384" name="HIVE-2043.Patch" size="1119" author="chinnalalam" created="Fri, 11 Mar 2011 12:25:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72571</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123592</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This is going to be merged to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;strike&gt;HIVE-2042&lt;/strike&gt;&lt;/a&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2044] In error scenario opened streams may not closed in TypedBytesWritableOutput.java</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2044</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) In error scenario DataOutputStream may not be closed in writeWritable of  TypedBytesWritableOutput.java&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501119">HIVE-2044</key>
            <summary>In error scenario opened streams may not closed in TypedBytesWritableOutput.java</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:30:35 +0000</created>
                <updated>Tue, 26 Jul 2011 23:51:22 +0000</updated>
                            <resolved>Tue, 26 Jul 2011 23:51:22 +0000</resolved>
                                    <version>0.7.0</version>
                                                    <component>Contrib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13071443" author="cwsteinbach" created="Tue, 26 Jul 2011 23:51:22 +0000"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;del&gt;HIVE-2042&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473385" name="HIVE-2044.Patch" size="1547" author="chinnalalam" created="Fri, 11 Mar 2011 12:26:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Jul 2011 23:51:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123593</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This is going to be merged to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;strike&gt;HIVE-2042&lt;/strike&gt;&lt;/a&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2045] TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() throws Null Pointer Exception in some cases</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2045</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) In TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() is doing null check for the tokenizer.&lt;br/&gt;
If tokenizer is null, fillTokenizer() method is called to get the tokenizer object. But fillTokenizer() method also can update the tokenizer with NULL , so NULL check should be done before using the tokenizer.&lt;/p&gt;

&lt;p&gt;2) Also improved some logging in TCTLSeparatedProtocol.java&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501120">HIVE-2045</key>
            <summary>TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() throws Null Pointer Exception in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:39:55 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:08 +0000</updated>
                            <resolved>Fri, 8 Jul 2011 18:32:26 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13043364" author="chinnalalam" created="Fri, 3 Jun 2011 14:18:40 +0000"  >&lt;p&gt;In TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() handled null pointer exception&lt;/p&gt;</comment>
                            <comment id="13061628" author="jiraposter@reviews.apache.org" created="Thu, 7 Jul 2011 22:06:17 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1035/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1035/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;review by jvs&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2045&quot; title=&quot;TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() throws Null Pointer Exception in some cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2045&quot;&gt;&lt;del&gt;HIVE-2045&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2045&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2045&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/thrift/TCTLSeparatedProtocol.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/thrift/TCTLSeparatedProtocol.java&lt;/a&gt; 1127457 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/TestTCTLSeparatedProtocol.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/TestTCTLSeparatedProtocol.java&lt;/a&gt; 1127457 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1035/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1035/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;John&lt;/p&gt;
</comment>
                            <comment id="13061631" author="jvs" created="Thu, 7 Jul 2011 22:31:01 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13062101" author="jvs" created="Fri, 8 Jul 2011 18:32:26 +0000"  >&lt;p&gt;Committed.  Thanks Chinna!&lt;/p&gt;</comment>
                            <comment id="13062247" author="hudson" created="Fri, 8 Jul 2011 23:15:05 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #816 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/816/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/816/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2045&quot; title=&quot;TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() throws Null Pointer Exception in some cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2045&quot;&gt;&lt;del&gt;HIVE-2045&lt;/del&gt;&lt;/a&gt;.  TCTLSeparatedProtocol.SimpleTransportTokenizer.nextToken() throws&lt;br/&gt;
Null Pointer Exception in some cases.  (Chinna Rao Lalam via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1144418&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1144418&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/thrift/TCTLSeparatedProtocol.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/TestTCTLSeparatedProtocol.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12481343" name="HIVE-2045.patch" size="3066" author="chinnalalam" created="Fri, 3 Jun 2011 14:17:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Jul 2011 22:06:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>68683</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123594</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2046] In error scenario some opened streams may not closed in Utilities.java</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2046</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;1) In error scenario XMLDecoder &amp;amp; XMLEncoder may not be closed in serializeMapRedWork() and deserializeMapRedWork() Utilities.java&lt;/p&gt;

&lt;p&gt;2) BufferedReader is not closed in Utilities.StreamPrinter&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.7.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5).&lt;/p&gt;</environment>
        <key id="12501121">HIVE-2046</key>
            <summary>In error scenario some opened streams may not closed in Utilities.java</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 08:49:00 +0000</created>
                <updated>Tue, 26 Jul 2011 23:50:49 +0000</updated>
                            <resolved>Tue, 26 Jul 2011 23:50:49 +0000</resolved>
                                    <version>0.7.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13007111" author="he yongqiang" created="Tue, 15 Mar 2011 19:19:15 +0000"  >&lt;p&gt;This is going to be merged to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2042&quot; title=&quot;In error scenario some opened streams may not closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2042&quot;&gt;&lt;del&gt;HIVE-2042&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473386" name="HIVE-2046.Patch" size="3839" author="chinnalalam" created="Fri, 11 Mar 2011 12:28:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Mar 2011 19:19:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66856</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123595</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2047] refactor PartitionPrunner&apos;s prune method</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2047</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12501188">HIVE-2047</key>
            <summary>refactor PartitionPrunner&apos;s prune method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 20:02:03 +0000</created>
                <updated>Fri, 11 Mar 2011 20:02:03 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2048] Expedite Partition Pruning</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2048</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Partition pruning is a large part of Hive client side overhead. Partition filter has been introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1609&quot; title=&quot;Support partition filtering in metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1609&quot;&gt;&lt;del&gt;HIVE-1609&lt;/del&gt;&lt;/a&gt;, but it is enabled due to JDO issues (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1853&quot; title=&quot;downgrade JDO version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1853&quot;&gt;&lt;del&gt;HIVE-1853&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1862&quot; title=&quot;Revive partition filtering in the Hive MetaStore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1862&quot;&gt;&lt;del&gt;HIVE-1862&lt;/del&gt;&lt;/a&gt;). This JIRA is created as an umbrella to a set of optimizations we can do under this situation. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12501190">HIVE-2048</key>
            <summary>Expedite Partition Pruning</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                            <label>JDO</label>
                            <label>PartitionPruner</label>
                    </labels>
                <created>Fri, 11 Mar 2011 20:12:43 +0000</created>
                <updated>Tue, 16 Jul 2013 01:19:11 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12537866">HIVE-2702</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12493928">HIVE-1862</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12472999">HIVE-1609</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12501191">HIVE-2049</subtask>
                            <subtask id="12501193">HIVE-2050</subtask>
                            <subtask id="12501995">HIVE-2067</subtask>
                            <subtask id="12504393">HIVE-2114</subtask>
                            <subtask id="12504604">HIVE-2118</subtask>
                            <subtask id="12604002">HIVE-3397</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08nfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48396</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2049] Push down partition pruning to JDO filtering for a subset of partition predicates</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2049</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Several tasks:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;expose HiveMetaStoreClient.listPartitionsByFilter() to Hive.java so that PartitionPruner can use that for certain partition predicates.&lt;/li&gt;
	&lt;li&gt;figure out a safe subset of partition predicates that can be pushed down to JDO filtering.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;By my initial testing for the 2nd part is equality queries with AND/OR can be pushed down and return correct results. However range queries on partition columns gave NPE by the JDO execute() function. This might be a bug in the JDO query string itself, but we need to figure it out and heavily test all cases. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12501191">HIVE-2049</key>
            <summary>Push down partition pruning to JDO filtering for a subset of partition predicates</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12501190">HIVE-2048</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                            <label>JDO</label>
                            <label>PartitionPruner</label>
                    </labels>
                <created>Fri, 11 Mar 2011 20:25:17 +0000</created>
                <updated>Mon, 20 Aug 2012 21:48:01 +0000</updated>
                            <resolved>Tue, 22 Mar 2011 16:33:49 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13005878" author="nzhang" created="Fri, 11 Mar 2011 22:48:30 +0000"  >&lt;p&gt;This patch only allows partition predicates to be &lt;/p&gt;
{=, AND, OR}
&lt;p&gt;. Still running tests.&lt;/p&gt;</comment>
                            <comment id="13005882" author="nzhang" created="Fri, 11 Mar 2011 23:00:48 +0000"  >&lt;p&gt;Uploading a new patch that resolved a conflict with a recent commit. &lt;/p&gt;

&lt;p&gt;The review request: &lt;a href=&quot;https://reviews.apache.org/r/489/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/489/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13005923" author="nzhang" created="Sat, 12 Mar 2011 00:25:20 +0000"  >&lt;p&gt;This are diffs in the unit tests. I&apos;ll working on it. &lt;/p&gt;</comment>
                            <comment id="13007748" author="nzhang" created="Wed, 16 Mar 2011 23:50:30 +0000"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2049&quot; title=&quot;Push down partition pruning to JDO filtering for a subset of partition predicates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2049&quot;&gt;&lt;del&gt;HIVE-2049&lt;/del&gt;&lt;/a&gt;.3.patch. This one passed all unit tests. I&apos;ve also update the review board. &lt;/p&gt;</comment>
                            <comment id="13009365" author="namit" created="Mon, 21 Mar 2011 20:46:59 +0000"  >&lt;p&gt;Added comments in the review board&lt;/p&gt;</comment>
                            <comment id="13009461" author="nzhang" created="Mon, 21 Mar 2011 23:05:27 +0000"  >&lt;p&gt;Attaching a new patch that address review comments. The review board is also updated.&lt;/p&gt;</comment>
                            <comment id="13009479" author="namit" created="Tue, 22 Mar 2011 00:08:16 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13009702" author="namit" created="Tue, 22 Mar 2011 16:33:49 +0000"  >&lt;p&gt;Committed. Thanks Ning&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12501995">HIVE-2067</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12473441" name="HIVE-2049.2.patch" size="16456" author="nzhang" created="Fri, 11 Mar 2011 23:00:48 +0000"/>
                            <attachment id="12473862" name="HIVE-2049.3.patch" size="69031" author="nzhang" created="Wed, 16 Mar 2011 23:50:30 +0000"/>
                            <attachment id="12474247" name="HIVE-2049.4.patch" size="73005" author="nzhang" created="Mon, 21 Mar 2011 23:05:27 +0000"/>
                            <attachment id="12473440" name="HIVE-2049.patch" size="17666" author="nzhang" created="Fri, 11 Mar 2011 22:48:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 21 Mar 2011 20:46:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123597</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2050] batch processing partition pruning process</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2050</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;For partition predicates that cannot be pushed down to JDO filtering (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2049&quot; title=&quot;Push down partition pruning to JDO filtering for a subset of partition predicates&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2049&quot;&gt;&lt;del&gt;HIVE-2049&lt;/del&gt;&lt;/a&gt;), we should fall back to the old approach of listing all partition names first and use Hive&apos;s expression evaluation engine to select the correct partitions. Then the partition pruner should hand Hive a list of partition names and return a list of Partition Object (this should be added to the Hive API). &lt;/p&gt;

&lt;p&gt;A possible optimization is that the the partition pruner should give Hive a set of ranges of partition names (say &lt;span class=&quot;error&quot;&gt;&amp;#91;ts=01, ts=11&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;ts=20, ts=24&amp;#93;&lt;/span&gt;), and the JDO query should be formulated as range queries. Range queries are possible because the first step list all partition names in sorted order. It&apos;s easy to come up with a range and it is guaranteed that the JDO range query results should be equivalent to the query with a list of partition names. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12501193">HIVE-2050</key>
            <summary>batch processing partition pruning process</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12501190">HIVE-2048</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                            <label>PartitionPruner</label>
                    </labels>
                <created>Fri, 11 Mar 2011 20:38:48 +0000</created>
                <updated>Mon, 20 Aug 2012 21:48:15 +0000</updated>
                            <resolved>Wed, 30 Mar 2011 01:00:04 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Metastore</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13009926" author="nzhang" created="Wed, 23 Mar 2011 00:21:08 +0000"  >&lt;p&gt;Uploading a new patch for review. Still running tests. The review board request: &lt;a href=&quot;https://reviews.apache.org/r/522/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/522/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13009993" author="nzhang" created="Wed, 23 Mar 2011 04:39:39 +0000"  >&lt;p&gt;passed all unit tests.&lt;/p&gt;</comment>
                            <comment id="13010001" author="nzhang" created="Wed, 23 Mar 2011 05:11:35 +0000"  >&lt;p&gt;Note that this patch implements a simple API that passes a list of partition names rather than a range of partition names. My performance testing indicates that bottleneck is not in the JDO query itself. The JDO queries that getting the list of all MPartitions takes about 5 secs for a list of 20k partitions. However converting these 20k MPartitions to Partitions took about 3 mins. Committing the transaction took another 3 mins. &lt;/p&gt;

&lt;p&gt;Note that converting MPartitions to Partitions and committing transactions are common operations. Even though we use JDO pushdown (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2048&quot; title=&quot;Expedite Partition Pruning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2048&quot;&gt;HIVE-2048&lt;/a&gt;) or use range queries, these costs are still there. We need to optimize these costs away in the next step. &lt;/p&gt;</comment>
                            <comment id="13011518" author="namit" created="Sat, 26 Mar 2011 00:39:19 +0000"  >&lt;p&gt;Based on an offline review, this may increase memory, we need to return the&lt;br/&gt;
partition names periodically to put a memory bound&lt;/p&gt;</comment>
                            <comment id="13011918" author="nzhang" created="Mon, 28 Mar 2011 06:01:43 +0000"  >&lt;p&gt;There are 2 major changes from the last patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;added a parameter hive.metastore.batch.retrieve.max to control the maximum number of partitions can be retrieved from the metastore in one batch (default 300). In Hive.getPartitionsByNames(), the input partition name list are separated into sublists and call the metastore API for each sublist.&lt;/li&gt;
	&lt;li&gt;one of the most time consuming DB operations is the retrieve the sub-classes of MPartition. In particular the list of FieldSchema are retrieved for each partition and they are never used (the table&apos;s field schema is used for all partitions). So one of the changes here is to omit the retrieval of FieldSchema and make the table&apos;s fieldschema as the partitions. If later we need the partition&apos;s fieldschema for schema evaluation, we should add another function/flag for that.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These changes reduce memory by 50% and CPU by 20%. &lt;/p&gt;

&lt;p&gt;The review board is also updated with the Java-only patch. &lt;/p&gt;</comment>
                            <comment id="13012149" author="namit" created="Mon, 28 Mar 2011 17:34:49 +0000"  >&lt;p&gt;Comments posted on the review board&lt;/p&gt;</comment>
                            <comment id="13012160" author="nzhang" created="Mon, 28 Mar 2011 18:03:10 +0000"  >&lt;p&gt;Taken Namit&apos;s comment. Review board is also updated. &lt;/p&gt;</comment>
                            <comment id="13012167" author="namit" created="Mon, 28 Mar 2011 18:19:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13012283" author="namit" created="Tue, 29 Mar 2011 00:06:49 +0000"  >&lt;p&gt;The test pcr.q is failing - can you take a look ?&lt;br/&gt;
The results look wrong.&lt;/p&gt;</comment>
                            <comment id="13012338" author="nzhang" created="Tue, 29 Mar 2011 05:29:25 +0000"  >&lt;p&gt;resolved pcr.q (only PartitionPruner.java is changed). I&apos;m also running tests now. &lt;/p&gt;</comment>
                            <comment id="13012339" author="namit" created="Tue, 29 Mar 2011 05:41:43 +0000"  >&lt;p&gt;can you update review board also ?&lt;/p&gt;</comment>
                            <comment id="13012543" author="nzhang" created="Tue, 29 Mar 2011 16:21:04 +0000"  >&lt;p&gt;updated the review board. Also my tests passed.&lt;/p&gt;</comment>
                            <comment id="13012635" author="namit" created="Tue, 29 Mar 2011 19:24:36 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13012798" author="namit" created="Wed, 30 Mar 2011 01:00:04 +0000"  >&lt;p&gt;Committed. Thanks Ning&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474754" name="HIVE-2050.2.patch" size="174246" author="nzhang" created="Mon, 28 Mar 2011 06:01:43 +0000"/>
                            <attachment id="12474799" name="HIVE-2050.3.patch" size="170137" author="nzhang" created="Mon, 28 Mar 2011 18:03:10 +0000"/>
                            <attachment id="12474846" name="HIVE-2050.4.patch" size="170268" author="nzhang" created="Tue, 29 Mar 2011 05:29:25 +0000"/>
                            <attachment id="12474360" name="HIVE-2050.patch" size="165309" author="nzhang" created="Wed, 23 Mar 2011 00:21:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 26 Mar 2011 00:39:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 43 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123598</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2051] getInputSummary() to call FileSystem.getContentSummary() in parallel</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2051</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;getInputSummary() now call FileSystem.getContentSummary() one by one, which can be extremely slow when the number of input paths are huge. By calling those functions in parallel, we can cut latency in most cases.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501210">HIVE-2051</key>
            <summary>getInputSummary() to call FileSystem.getContentSummary() in parallel</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2011 22:02:38 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:02 +0000</updated>
                            <resolved>Wed, 20 Apr 2011 00:21:04 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13005883" author="cwsteinbach" created="Fri, 11 Mar 2011 23:04:00 +0000"  >&lt;p&gt;Review request: &lt;a href=&quot;https://reviews.apache.org/r/491/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/491/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13006366" author="cwsteinbach" created="Mon, 14 Mar 2011 09:39:43 +0000"  >&lt;p&gt;@Siying: Please see the comments on reviewboard.&lt;/p&gt;</comment>
                            <comment id="13006372" author="sdong" created="Mon, 14 Mar 2011 10:14:39 +0000"  >&lt;p&gt;@Carl, also commented on reviewboard.&lt;/p&gt;</comment>
                            <comment id="13006689" author="sdong" created="Mon, 14 Mar 2011 22:42:24 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. use ConcurrentHashMap&lt;br/&gt;
2. wait for Future objbect too&lt;br/&gt;
3. Share jobConf among threads&lt;br/&gt;
4. if user set mapred.dfsclient.parallelism.max to be 0 or 1, don&apos;t start new thread to execute it.&lt;br/&gt;
5. use Map.Entry&amp;lt;K,V&amp;gt; when iterating&lt;/p&gt;</comment>
                            <comment id="13006695" author="sdong" created="Mon, 14 Mar 2011 22:45:37 +0000"  >&lt;p&gt;Minor: typo in comments.&lt;/p&gt;</comment>
                            <comment id="13007293" author="sdong" created="Wed, 16 Mar 2011 00:14:14 +0000"  >&lt;p&gt;@Carl?&lt;/p&gt;</comment>
                            <comment id="13007323" author="jsensarma" created="Wed, 16 Mar 2011 02:40:46 +0000"  >&lt;p&gt;looked at the latest patch from Carl. don&apos;t get it - why should we pay cost for creating thread when one is not required? &lt;/p&gt;</comment>
                            <comment id="13007327" author="cwsteinbach" created="Wed, 16 Mar 2011 03:01:04 +0000"  >&lt;p&gt;Just to be clear I updated the reviewboard ticket with the latest version of Siying&apos;s patch. Also, the comments on reviewboard are from &quot;M IS&quot;, not me.&lt;/p&gt;</comment>
                            <comment id="13008221" author="jsensarma" created="Thu, 17 Mar 2011 23:41:56 +0000"  >&lt;p&gt;my bad - i thought Carl == M IS &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. &lt;/p&gt;

&lt;p&gt;looking at .3 patch - i am concerned about this code:&lt;/p&gt;


&lt;p&gt;+          result.get();&lt;br/&gt;
+        } catch (InterruptedException e) {&lt;br/&gt;
+          throw new IOException(e);&lt;/p&gt;

&lt;p&gt;in a different block of code down from this one - we ignore InterruptedException. It seems safer to ignore them (I am just not sure if we there&apos;s any reason to get a valid thread interrupt in the calling thread and if so what the thread is supposed to do in that case).&lt;/p&gt;

&lt;p&gt;is it necessary for the executor to terminate if all the tasks given to it are already terminated? (trivial point - but might reduce code a bit).&lt;/p&gt;
</comment>
                            <comment id="13008328" author="mis" created="Fri, 18 Mar 2011 05:09:15 +0000"  >&lt;p&gt;Yes it is necessary for the executor to be terminated if the jobs have been submitted to it, even though submitted jobs may have been completed. &lt;/p&gt;

&lt;p&gt;However, what we need not do here is, after the executor is shutdown, await till the termination gets over, since this is redundant. As all the submitted jobs to the executor will be completed by the time we shutdown the executor. This is what is ensured when we do result.get()&lt;br/&gt;
i.e., the following piece of code is not required.&lt;br/&gt;
+      do {&lt;br/&gt;
+        try &lt;/p&gt;
{
+          executor.awaitTermination(Integer.MAX_VALUE, TimeUnit.SECONDS);
+          executorDone = true;
+        }
&lt;p&gt; catch (InterruptedException e) &lt;/p&gt;
{
+        }
&lt;p&gt;+      } while (!executorDone);&lt;/p&gt;</comment>
                            <comment id="13008331" author="mis" created="Fri, 18 Mar 2011 05:19:03 +0000"  >&lt;p&gt;The solution to this issue resembles that of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2026&quot; title=&quot;Parallelize UpdateInputAccessTimeHook&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2026&quot;&gt;HIVE-2026&lt;/a&gt;, so we can follow a similar approach.&lt;/p&gt;</comment>
                            <comment id="13008549" author="jsensarma" created="Fri, 18 Mar 2011 18:02:09 +0000"  >&lt;p&gt;Siying - i think we shouldn&apos;t ignore ExecutionException. The best part of checking for each task status seems to be that we can find out if any of them failed (indicated by ExecutionException). Also we can remove the executor.awaitTermination() call as well (same feedback as the comments above).&lt;/p&gt;

&lt;p&gt;also - do you want to make the core of this routine synchronized (perhaps on the context object - which is one per query)? there really is no point running more than one of these per query at a time. (we can move this whole routine to the Context object if that seems like a better place (or at least make the call from the Context object where it can be marked as a synchronized method).&lt;/p&gt;

&lt;p&gt;otherwise looks good. please upload a new patch and i will test and commit.&lt;/p&gt;</comment>
                            <comment id="13008654" author="sdong" created="Fri, 18 Mar 2011 22:15:15 +0000"  >&lt;p&gt;Joydeep, I&apos;m nervous about putting a synchronized object put in context and have it available everywhere. I&apos;ll made this static method synchronized, so that no parallel call to it.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure whether I understand correctly but it seems that ExecutionException indicates that the waiting thread gets the signal, instead of the thread being waited. It does more sound like someone wants to kill the process. What we can do if we don&apos;t ignore nor throw ExecutionException? We only have 3 realistic choices: always throw, always ignore or continue to wait as a retry.. To me, always throwing sounds a better idea, as when we catch an exception that we don&apos;t know how to handle it, throwing it sounds the safest way to go. What&apos;s your suggestion to handle it?&lt;/p&gt;

&lt;p&gt;I&apos;ll remove the awaitTermination()&lt;/p&gt;</comment>
                            <comment id="13008657" author="sdong" created="Fri, 18 Mar 2011 22:20:13 +0000"  >&lt;p&gt;Joydeep, sorry you were talking about ExecutionException about InterruptedException. In that case, I&apos;ll just rethrow it.&lt;/p&gt;</comment>
                            <comment id="13008676" author="sdong" created="Fri, 18 Mar 2011 23:26:09 +0000"  >&lt;p&gt;I still feel that it&apos;s too dangerous to ignore InterruptedException : &lt;a href=&quot;http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#interrupt(&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#interrupt(&lt;/a&gt;). It sounds like command to shutdown the thread smoothly. In that case, we should have special reason if we don&apos;t follow the command.&lt;/p&gt;</comment>
                            <comment id="13008903" author="jsensarma" created="Sun, 20 Mar 2011 14:30:31 +0000"  >&lt;p&gt;based on: &lt;a href=&quot;http://www.ibm.com/developerworks/java/library/j-jtp05236.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ibm.com/developerworks/java/library/j-jtp05236.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;it seems that the right thing to do here is to catch the interruptedexception and then call Thread.currentThread.interrupt() (grep for &apos;swallow interrupt&apos; in this article).&lt;/p&gt;

&lt;p&gt;we could also rethrow it - but the problem then will merely be punted to the higher layer (which probably will ignore it as well)&lt;/p&gt;</comment>
                            <comment id="13009024" author="sdong" created="Mon, 21 Mar 2011 05:18:49 +0000"  >&lt;p&gt;for IterruptedException, call Thread.currentThread().interrupt() and continue waiting. &lt;/p&gt;</comment>
                            <comment id="13009237" author="jsensarma" created="Mon, 21 Mar 2011 17:52:16 +0000"  >&lt;p&gt;+1. will commit after running tests.&lt;/p&gt;</comment>
                            <comment id="13009426" author="jsensarma" created="Mon, 21 Mar 2011 22:01:58 +0000"  >&lt;p&gt;committed - thanks Siying&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473439" name="HIVE-2051.1.patch" size="5664" author="sdong" created="Fri, 11 Mar 2011 22:04:38 +0000"/>
                            <attachment id="12473627" name="HIVE-2051.2.patch" size="6780" author="sdong" created="Mon, 14 Mar 2011 22:42:24 +0000"/>
                            <attachment id="12473628" name="HIVE-2051.3.patch" size="6780" author="sdong" created="Mon, 14 Mar 2011 22:45:37 +0000"/>
                            <attachment id="12473964" name="HIVE-2051.4.patch" size="6706" author="sdong" created="Fri, 18 Mar 2011 01:24:17 +0000"/>
                            <attachment id="12474151" name="HIVE-2051.5.patch" size="12628" author="sdong" created="Mon, 21 Mar 2011 05:18:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Mar 2011 23:04:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66858</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123599</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2052] PostHook and PreHook API to add flag to indicate it is pre or post hook plus cache for content summary</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2052</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This will allow hooks to share some information better and reduce their latency&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501218">HIVE-2052</key>
            <summary>PostHook and PreHook API to add flag to indicate it is pre or post hook plus cache for content summary</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Mar 2011 00:14:31 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:38 +0000</updated>
                            <resolved>Thu, 24 Mar 2011 20:09:18 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13006365" author="amareshwari" created="Mon, 14 Mar 2011 09:34:54 +0000"  >&lt;p&gt;Can you validate HookContext.getInputPathToContentSummary() api also in your testcase?&lt;/p&gt;</comment>
                            <comment id="13006387" author="sdong" created="Mon, 14 Mar 2011 12:06:07 +0000"  >&lt;p&gt;add a test case for check HookContext.getInputPathToContentSummary(). &lt;/p&gt;</comment>
                            <comment id="13008238" author="jsensarma" created="Fri, 18 Mar 2011 00:20:27 +0000"  >&lt;p&gt;small nits:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;setinputpathtocontentsummary is called twice on the same hookcontext object&lt;/li&gt;
	&lt;li&gt;we are setting the hook type again and again (can do it once before calling postexecute)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;should the inputpathtocontentsummary be marked final in the hook and passed along with the constructor? (why would we ever change the map to a new one?).&lt;/p&gt;</comment>
                            <comment id="13008282" author="sdong" created="Fri, 18 Mar 2011 02:06:43 +0000"  >&lt;p&gt;Modify as Joydeep&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="13008558" author="jsensarma" created="Fri, 18 Mar 2011 18:09:07 +0000"  >&lt;p&gt;looks like the new patch is for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2051&quot; title=&quot;getInputSummary() to call FileSystem.getContentSummary() in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2051&quot;&gt;&lt;del&gt;HIVE-2051&lt;/del&gt;&lt;/a&gt; not &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2052&quot; title=&quot;PostHook and PreHook API to add flag to indicate it is pre or post hook plus cache for content summary&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2052&quot;&gt;&lt;del&gt;HIVE-2052&lt;/del&gt;&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="13008641" author="sdong" created="Fri, 18 Mar 2011 21:36:55 +0000"  >&lt;p&gt;the name is wrong but the content is right. I&apos;ll fix it now.&lt;/p&gt;</comment>
                            <comment id="13009427" author="jsensarma" created="Mon, 21 Mar 2011 22:02:17 +0000"  >&lt;p&gt;committed - thanks Siying!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473965" name="HIVE-2051.3.patch" size="14775" author="sdong" created="Fri, 18 Mar 2011 02:06:43 +0000"/>
                            <attachment id="12473457" name="HIVE-2052.1.patch" size="9998" author="sdong" created="Sat, 12 Mar 2011 00:58:31 +0000"/>
                            <attachment id="12473550" name="HIVE-2052.2.patch" size="14350" author="sdong" created="Mon, 14 Mar 2011 12:06:07 +0000"/>
                            <attachment id="12474036" name="HIVE-2052.3.patch" size="14775" author="sdong" created="Fri, 18 Mar 2011 22:05:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 14 Mar 2011 09:34:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66849</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123600</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2053] Hive can&apos;t find the Plan</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2053</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We I execute this SQL: select count(1) from table1;&lt;br/&gt;
The MR can&apos;t execute for it can&apos;t find the Plan File in local path.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501432">HIVE-2053</key>
            <summary>Hive can&apos;t find the Plan</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gpcuster">Aaron Guo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 07:37:38 +0000</created>
                <updated>Thu, 17 Mar 2011 07:17:18 +0000</updated>
                            <resolved>Thu, 17 Mar 2011 07:17:18 +0000</resolved>
                                    <version>0.7.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13007242" author="nzhang" created="Tue, 15 Mar 2011 22:41:18 +0000"  >&lt;p&gt;Aaron, did you see this error in trunk or an older release? I think we fixed it in some JIRA a while ago. Can you provide a reproducible test case?&lt;/p&gt;</comment>
                            <comment id="13007311" author="gpcuster" created="Wed, 16 Mar 2011 01:51:32 +0000"  >&lt;p&gt;Hi Zhangning, I see this error in the current trunk, I will provide more information later.&lt;/p&gt;</comment>
                            <comment id="13007839" author="gpcuster" created="Thu, 17 Mar 2011 07:16:59 +0000"  >&lt;p&gt;Zhangning,this isn&apos;t a bug. sorry for your time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473650" name="patch-1.patch" size="7185" author="gpcuster" created="Tue, 15 Mar 2011 07:38:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Mar 2011 22:41:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72570</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2054] Exception on windows when using the jdbc driver. &quot;IOException: The system cannot find the path specified&quot;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2054</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;It seems something recently changed on the jdbc driver which causes this IOException on windows.&lt;/p&gt;

&lt;p&gt;java.lang.RuntimeException: java.io.IOException: The system cannot find the path specified&lt;br/&gt;
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:237)&lt;br/&gt;
	at org.apache.hadoop.hive.jdbc.HiveConnection.&amp;lt;init&amp;gt;(HiveConnection.java:73)&lt;br/&gt;
	at org.apache.hadoop.hive.jdbc.HiveDriver.connect(HiveDriver.java:110)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501452">HIVE-2054</key>
            <summary>Exception on windows when using the jdbc driver. &quot;IOException: The system cannot find the path specified&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bennies">Bennie Schut</assignee>
                                    <reporter username="bennies">Bennie Schut</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 12:47:47 +0000</created>
                <updated>Wed, 27 Jul 2011 04:20:25 +0000</updated>
                            <resolved>Tue, 5 Apr 2011 18:10:25 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.7.1</fixVersion>
                    <fixVersion>0.8.0</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13006899" author="bennies" created="Tue, 15 Mar 2011 12:53:21 +0000"  >&lt;p&gt;This seems to happen because we use the same SessionState class the cli is using which is now including some temporary output files and history file references.&lt;br/&gt;
It&apos;s rather trivial to remove the SessionState from the jdbc driver to make it work again (just tried this a few minutes ago). We currently have a JdbcSessionState which extends the SessonState but I don&apos;t see a need for the JdbcSessionState either. It seems to be there as a placeholder but is not actually used. &lt;/p&gt;</comment>
                            <comment id="13006923" author="bennies" created="Tue, 15 Mar 2011 13:53:21 +0000"  >&lt;p&gt;Removing SessionState so the jdbc works correctly on windows.&lt;/p&gt;</comment>
                            <comment id="13007181" author="bennies" created="Tue, 15 Mar 2011 21:03:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/513/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/513/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13007240" author="nzhang" created="Tue, 15 Mar 2011 22:38:11 +0000"  >&lt;p&gt;Bennie, do you know what changes in SessionState causes JDBC failed on Windows? &lt;/p&gt;

&lt;p&gt;We recently committed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-818&quot; title=&quot;Create a Hive CLI that connects to hive ThriftServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-818&quot;&gt;&lt;del&gt;HIVE-818&lt;/del&gt;&lt;/a&gt; which changes HiveServer and some behavior on how to pass End-of-file from the server side to the client side. Previously server just send an empty string and now server throws an HiveServerException with ErrorCode = 0. I think that may be the reason. Can you try your test case with and without &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-818&quot; title=&quot;Create a Hive CLI that connects to hive ThriftServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-818&quot;&gt;&lt;del&gt;HIVE-818&lt;/del&gt;&lt;/a&gt; to verify?&lt;/p&gt;</comment>
                            <comment id="13007366" author="bennies" created="Wed, 16 Mar 2011 06:58:17 +0000"  >&lt;p&gt;Yes it was this code block:&lt;/p&gt;

&lt;p&gt;      try &lt;/p&gt;
{
        File tmpFile = File.createTempFile(sessionID, &quot;.pipeout&quot;, tmpDir);
        tmpFile.deleteOnExit();
        startSs.setTmpOutputFile(tmpFile);
      }
&lt;p&gt; catch (IOException e) &lt;/p&gt;
{
        throw new RuntimeException(e);
      }

&lt;p&gt;So you are correct it&apos;s related to changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-818&quot; title=&quot;Create a Hive CLI that connects to hive ThriftServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-818&quot;&gt;&lt;del&gt;HIVE-818&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13007803" author="nzhang" created="Thu, 17 Mar 2011 04:33:06 +0000"  >&lt;p&gt;I think the problem is that the tmpDir by default is /tmp/&amp;lt;user.name&amp;gt;/, specified by hive.querylog.location. Bennie, I think if you set hive.querylog.location to be something like &apos;c:\&apos; on Windows, it should work. Can you try that?&lt;/p&gt;

&lt;p&gt;The JdbcSessionState was introduced in the very first version of the JDBC driver (&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-48&quot; title=&quot;Support JDBC connections for interoperability between Hive and RDBMS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-48&quot;&gt;&lt;del&gt;HIVE-48&lt;/del&gt;&lt;/a&gt;). It is not used but I guess the reason for it to be able to set session level states for the JDBC connection. I&apos;m OK removing it, but not sure about others&apos; opinion.&lt;/p&gt;</comment>
                            <comment id="13007848" author="bennies" created="Thu, 17 Mar 2011 08:34:58 +0000"  >&lt;p&gt;Yes setting hive.querylog.location makes it work.&lt;/p&gt;

&lt;p&gt;At the very least we should remove the &quot;extends SessionState&quot; since it introduces a link to the hive server code which makes no sense at this point in time. However I have a preference for removing it all together since it currently adds no value.  On the jdbc side I would expect the HiveConnection to hold the state which it is actually doing right now.&lt;/p&gt;
</comment>
                            <comment id="13008333" author="nzhang" created="Fri, 18 Mar 2011 05:21:57 +0000"  >&lt;p&gt;Sounds reasonable to me. &lt;/p&gt;

&lt;p&gt;Raghu, what do you think?&lt;/p&gt;</comment>
                            <comment id="13008368" author="bennies" created="Fri, 18 Mar 2011 08:06:47 +0000"  >&lt;p&gt;New patch because of merge from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1815&quot; title=&quot;The class HiveResultSet should implement batch fetching.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1815&quot;&gt;&lt;del&gt;HIVE-1815&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13009337" author="bennies" created="Mon, 21 Mar 2011 19:49:16 +0000"  >&lt;p&gt;New patch because of changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2062&quot; title=&quot;HivePreparedStatement.executeImmediate always throw exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2062&quot;&gt;&lt;del&gt;HIVE-2062&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13015295" author="bennies" created="Mon, 4 Apr 2011 07:31:09 +0000"  >&lt;p&gt;Any chance in getting this committed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; This is rather annoying for windows users.&lt;/p&gt;</comment>
                            <comment id="13015513" author="cwsteinbach" created="Mon, 4 Apr 2011 17:45:54 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13016058" author="cwsteinbach" created="Tue, 5 Apr 2011 18:10:25 +0000"  >&lt;p&gt;Committed to trunk and 0.7.1. Thanks Bennie!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473675" name="HIVE-2054.1.patch.txt" size="5492" author="bennies" created="Tue, 15 Mar 2011 13:53:21 +0000"/>
                            <attachment id="12473981" name="HIVE-2054.2.patch.txt" size="5440" author="bennies" created="Fri, 18 Mar 2011 08:06:47 +0000"/>
                            <attachment id="12474218" name="HIVE-2054.3.patch.txt" size="5440" author="bennies" created="Mon, 21 Mar 2011 19:49:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Mar 2011 22:38:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 42 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123603</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fix for IOException on the jdbc driver on windows.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2055] Hive should add HBase classpath dependencies when available</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2055</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Created an external table in hive , which points to the HBase table. When tried to query a column using the column name in select clause got the following exception : ( java.lang.ClassNotFoundException: org.apache.hadoop.hive.hbase.HiveHBaseTableInputFormat), errorCode:12, SQLState:42000)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501467">HIVE-2055</key>
            <summary>Hive should add HBase classpath dependencies when available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ndimiduk">Nick Dimiduk</assignee>
                                    <reporter username="sajithv">sajith vijayan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 14:32:41 +0000</created>
                <updated>Tue, 19 Nov 2013 20:44:55 +0000</updated>
                            <resolved>Tue, 19 Nov 2013 20:44:55 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>HBase Handler</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>16</watches>
                                                                <comments>
                            <comment id="13564063" author="ndimiduk" created="Mon, 28 Jan 2013 05:39:17 +0000"  >&lt;p&gt;This sounds like a classpath issue. Can you further describe your environment?&lt;/p&gt;</comment>
                            <comment id="13567801" author="zeph" created="Thu, 31 Jan 2013 16:56:43 +0000"  >&lt;p&gt;I have the same issue... I setted up an environment with Cloudera Manager, the latest with CDH4&lt;/p&gt;

&lt;p&gt;the libraries are available under /usr/lib/hive/lib , and they are correctly in the CLASSPATH that gets computed by the hive-env.sh script (I did a print out of that), but in any case... they do not seem to get picked up, instead if I force them from command line, they work&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[zeph@yallayalla ~]$ hive
Logging initialized using configuration in jar:file:/usr/lib/hive/lib/hive-common-0.9.0-cdh4.1.2.jar!/hive-log4j.properties
Hive history file=/tmp/zeph/hive_job_log_zeph_201301311652_675003173.txt
hive&amp;gt; add jar /usr/lib/hive/lib/hive-hbase-handler-0.9.0-cdh4.1.2.jar;
Added /usr/lib/hive/lib/hive-hbase-handler-0.9.0-cdh4.1.2.jar to &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;path
Added resource: /usr/lib/hive/lib/hive-hbase-handler-0.9.0-cdh4.1.2.jar
hive&amp;gt; add jar /usr/lib/hive/lib/hbase.jar;
Added /usr/lib/hive/lib/hbase.jar to &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;path
Added resource: /usr/lib/hive/lib/hbase.jar
hive&amp;gt; select count(*) from yallayalla_vendors;                             
Total MapReduce jobs = 1
Launching Job 1 out of 1
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of reduce tasks determined at compile time: 1
In order to change the average load &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=&amp;lt;number&amp;gt;
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=&amp;lt;number&amp;gt;
In order to set a constant number of reducers:
  set mapred.reduce.tasks=&amp;lt;number&amp;gt;
Starting Job = job_201301311629_0008, Tracking URL = http:&lt;span class=&quot;code-comment&quot;&gt;//yallayalla:50030/jobdetails.jsp?jobid=job_201301311629_0008
&lt;/span&gt;Kill Command = /usr/lib/hadoop/bin/hadoop job  -Dmapred.job.tracker=yallayalla:8021 -kill job_201301311629_0008
Hadoop job information &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Stage-1: number of mappers: 1; number of reducers: 1
2013-01-31 16:52:50,532 Stage-1 map = 0%,  reduce = 0%
2013-01-31 16:52:56,591 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.32 sec
2013-01-31 16:52:57,601 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.32 sec
2013-01-31 16:52:58,608 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.32 sec
2013-01-31 16:52:59,615 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 2.32 sec
2013-01-31 16:53:00,629 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 4.14 sec
2013-01-31 16:53:01,641 Stage-1 map = 100%,  reduce = 100%, Cumulative CPU 4.14 sec
MapReduce Total cumulative CPU time: 4 seconds 140 msec
Ended Job = job_201301311629_0008
MapReduce Jobs Launched: 
Job 0: Map: 1  Reduce: 1   Cumulative CPU: 4.14 sec   HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 4 seconds 140 msec
OK
749
Time taken: 20.024 seconds
hive&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13567820" author="zeph" created="Thu, 31 Jan 2013 17:12:53 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Name        : hive                         Relocations: (not relocatable)
Version     : 0.9.0+155                         Vendor: (none)
Release     : 1.cdh4.1.2.p0.21.el6          Build Date: Fri Nov  2 01:34:37 2012
Install Date: Mon Jan 14 15:50:48 2013         Build Host: rhel64-6-0-mk1.jenkins.cloudera.com
Group       : Development/Libraries         Source RPM: hive-0.9.0+155-1.cdh4.1.2.p0.21.el6.src.rpm
Size        : 153016181                        License: Apache License v2.0
Signature   : DSA/SHA1, Mon Nov  5 16:16:55 2012, Key ID f90c0d8fe8f86acd
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Name        : hbase                        Relocations: (not relocatable)
Version     : 0.92.1+160                        Vendor: (none)
Release     : 1.cdh4.1.2.p0.24.el6          Build Date: Fri Nov  2 01:03:06 2012
Install Date: Mon Jan 14 15:50:31 2013         Build Host: rhel64-6-0-mk1.jenkins.cloudera.com
Group       : Development/Libraries         Source RPM: hbase-0.92.1+160-1.cdh4.1.2.p0.24.el6.src.rpm
Size        : 39911513                         License: APL2
Signature   : DSA/SHA1, Mon Nov  5 16:16:52 2012, Key ID f90c0d8fe8f86acd
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13568265" author="navis" created="Fri, 1 Feb 2013 00:09:03 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt; is addressing the same issue. Could you try it?&lt;/p&gt;</comment>
                            <comment id="13568578" author="zeph" created="Fri, 1 Feb 2013 08:36:25 +0000"  >&lt;p&gt;indeed, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt; is the source of this&lt;/p&gt;</comment>
                            <comment id="13577500" author="zeph" created="Wed, 13 Feb 2013 11:34:08 +0000"  >&lt;p&gt;btw... this is enough to fix it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;property&amp;gt;
&amp;lt;name&amp;gt;hive.aux.jars.path&amp;lt;/name&amp;gt;
&amp;lt;value&amp;gt;file:&lt;span class=&quot;code-comment&quot;&gt;///usr/lib/hive/lib/hbase.jar,file:///usr/lib/hive/lib/hive-hbase-handler-0.9.0-cdh4.1.2.jar&amp;lt;/value&amp;gt;
&lt;/span&gt;&amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;from Cloudera Manager into Hive Client Configuration Safety Valve for hive-site.xml&lt;/p&gt;</comment>
                            <comment id="13577507" author="zeph" created="Wed, 13 Feb 2013 12:02:05 +0000"  >&lt;p&gt;uhmm... apparently HUE does not seem to pick it up&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;                              java.io.IOException: Cannot create an instance of InputSplit class = org.apache.hadoop.hive.hbase.HBaseSplit:Class org.apache.hadoop.hive.hbase.HBaseSplit not found&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13577522" author="brocknoland" created="Wed, 13 Feb 2013 12:27:45 +0000"  >&lt;p&gt;Yeah the ultimate solution to this should be &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt;. I think this one can be resolved as a duplicate.&lt;/p&gt;</comment>
                            <comment id="13577565" author="zeph" created="Wed, 13 Feb 2013 13:37:25 +0000"  >&lt;p&gt;agree... but I can&apos;t alter the status of the ticket... &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sajithv&quot; class=&quot;user-hover&quot; rel=&quot;sajithv&quot;&gt;sajith vijayan&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13598041" author="michaeln" created="Sat, 9 Mar 2013 19:06:38 +0000"  >&lt;p&gt;Somehow CM 4.5 is ignoring Hive Client Configuration Safety Values for hive-site.xml&lt;br/&gt;
and throws the same error in Hive&lt;br/&gt;
java.io.IOException: Cannot create an instance of InputSplit class = org.apache.hadoop.hive.hbase.HBaseSplit:Class org.apache.hadoop.hive.hbase.HBaseSplit not found&lt;/p&gt;</comment>
                            <comment id="13598145" author="brocknoland" created="Sun, 10 Mar 2013 03:29:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michaeln&quot; class=&quot;user-hover&quot; rel=&quot;michaeln&quot;&gt;Michael Naumov&lt;/a&gt; CM should be discussed here &lt;a href=&quot;https://groups.google.com/a/cloudera.org/forum/?fromgroups#!forum/scm-users&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://groups.google.com/a/cloudera.org/forum/?fromgroups#!forum/scm-users&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13635804" author="gkesavan" created="Thu, 18 Apr 2013 23:06:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2055&quot; title=&quot;Hive should add HBase classpath dependencies when available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2055&quot;&gt;&lt;del&gt;HIVE-2055&lt;/del&gt;&lt;/a&gt;.patch fixes bin/hive script to include hbase and hcat lib&apos;s into the classpath&lt;/p&gt;</comment>
                            <comment id="13636834" author="sushanth" created="Fri, 19 Apr 2013 20:19:19 +0000"  >&lt;p&gt;This works for me. Non-binding +1.&lt;/p&gt;</comment>
                            <comment id="13636889" author="sushanth" created="Fri, 19 Apr 2013 21:09:07 +0000"  >&lt;p&gt;As Nick notes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-621&quot; title=&quot;bin/hcat should include hbase jar and dependencies in the classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-621&quot;&gt;HCATALOG-621&lt;/a&gt;, there might be more to this - I only tested for ddl operations. That said, setting HIVE_AUX_JARS_PATH should work for this, right?&lt;/p&gt;</comment>
                            <comment id="13637377" author="ashutoshc" created="Sat, 20 Apr 2013 21:49:32 +0000"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt; is a better fix for this. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gkesavan&quot; class=&quot;user-hover&quot; rel=&quot;gkesavan&quot;&gt;Giridharan Kesavan&lt;/a&gt; /  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;Sushanth Sowmyan&lt;/a&gt; Can you try with the patch attached there and see if that solves your problem.&lt;/p&gt;</comment>
                            <comment id="13637378" author="ashutoshc" created="Sat, 20 Apr 2013 21:52:11 +0000"  >&lt;p&gt;To be more specific, this patch just puts hbase jars in classpath of client, it doesn&apos;t ship those jars to cluster. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt; achieves that as well.&lt;/p&gt;</comment>
                            <comment id="13637685" author="ndimiduk" created="Sun, 21 Apr 2013 23:36:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt; Just as with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2786&quot; title=&quot;enhance Pig launcher script wrt. HBase/HCat integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2786&quot;&gt;&lt;del&gt;PIG-2786&lt;/del&gt;&lt;/a&gt; vs &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3285&quot; title=&quot;Jobs using HBaseStorage fail to ship dependency jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3285&quot;&gt;&lt;del&gt;PIG-3285&lt;/del&gt;&lt;/a&gt;, there are two separate issues. The former is having HBase jars on the classpath for bin/hive invocations. The latter is for shipping the dependencies to the cluster for MR jobs. The former is also effectively identical to &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-621&quot; title=&quot;bin/hcat should include hbase jar and dependencies in the classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-621&quot;&gt;HCATALOG-621&lt;/a&gt; in that this is necessary for DDL operations. This patch resolves the former. The latter must be resolved with a code change, as is underway in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13637824" author="ashutoshc" created="Mon, 22 Apr 2013 08:06:24 +0000"  >&lt;p&gt;We don&apos;t need to load hcatalog jars. Now that hcatalog and hive jars are merged, all hcatalog jars will automatically get loaded. No need to explicitly add them to classpath. &lt;/p&gt;</comment>
                            <comment id="13639259" author="ndimiduk" created="Tue, 23 Apr 2013 17:17:17 +0000"  >&lt;p&gt;Updated patch, removing HCatalog support.&lt;/p&gt;</comment>
                            <comment id="13639331" author="ashutoshc" created="Tue, 23 Apr 2013 18:09:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; hbase/lib contains 58 jars. I don&apos;t think hbase client needs all of it. Further, most of them overlaps with hive jars. Its very easy to get out of sync w.r.t versions of these jars. Can you figure out minimal jars that we need to add. We should exclude the jars which are already there in hive and also which only hbase servers use.&lt;/p&gt;</comment>
                            <comment id="13639722" author="ndimiduk" created="Tue, 23 Apr 2013 22:25:55 +0000"  >&lt;p&gt;Tracking that list of dependencies across versions sounds like a terrible game of cat-and-mouse. Also, the list of jars is larger when using HBase&apos;s bulkload functionality. This patch appends the HBase jars to Hive&apos;s own list, so the versions from Hive will be found first. The jars are only involved in launching the command; the actual jars submitted with the job are based on use of addDependencyJars (via &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2379&quot; title=&quot;Hive/HBase integration could be improved&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2379&quot;&gt;&lt;del&gt;HIVE-2379&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13639889" author="gkesavan" created="Wed, 24 Apr 2013 00:17:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt; I dont think having a list of minimal jars is scalable solution. &lt;br/&gt;
What if the next release of hbase depends of bunch of new jar&apos;s that are not part of the list that&apos;s provided in the bin/hive script? And, this would require fixing bin/hive scripts every time when hbase comes up with a new runtime dependency. &lt;/p&gt;

&lt;p&gt;As Nick pointed out hbase libs are appended to hive&apos;s classpath and hive libs still take the precedence. &lt;/p&gt;</comment>
                            <comment id="13640546" author="ashutoshc" created="Wed, 24 Apr 2013 15:49:02 +0000"  >&lt;p&gt;I am not very comfortable with adding all hbase dependency jars in hive&apos;s classpath. Couple of issues:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Order argument may be fine for hive, but what about hbase client itself, if it needs a different version of jar than what hive comes with, it will have trouble.&lt;/li&gt;
	&lt;li&gt;Classpath will become too long. We already have this trouble with Windows where because of restriction of classpath length of 8K chars, classpath is truncated without any indication to user. Linux is relaxed and allows 256KB (I believe) but this could be problem there too.&lt;br/&gt;
Further in either of these two cases, when problem did arise, its very hard to debug because it manifest in total different area usually.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you guys think adding only specific jars is unmaintainable solution, I think till we find better solution for this, we can recommend users to use HIVE_AUX_JARS_PATH env variable to supply these jars for hive&apos;s classpath. &lt;/p&gt;
</comment>
                            <comment id="13640572" author="ashutoshc" created="Wed, 24 Apr 2013 16:00:49 +0000"  >&lt;p&gt;Looking around, looks like this list is short and is already available at: &lt;a href=&quot;http://hbase.apache.org/book.html#client_dependencies&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/book.html#client_dependencies&lt;/a&gt; We should only need to add hbase jar (and possibly zk jar) from this list, since all other jars listed there will already be in classpath since they are hive&apos;s dependecies as well.&lt;/p&gt;</comment>
                            <comment id="13640631" author="ndimiduk" created="Wed, 24 Apr 2013 16:40:26 +0000"  >&lt;p&gt;The classpath length is a restriction I hadn&apos;t considered. I don&apos;t understand the relationship between CLASSPATH and HIVE_AUX_JARS_PATH. Is the latter shipped to the cluster for MR jobs? Are they used in hive-cli runtime as well?&lt;/p&gt;

&lt;p&gt;HBase jobs against an online table or involved in offline HFile/Snapshot work will depend on the hbase-client, hbase-mapreduce, zookeeper, protobuf, and perhaps guava. I believe everything else in that list is provided by Hadoop runtime.&lt;/p&gt;</comment>
                            <comment id="13641039" author="sushanth" created="Wed, 24 Apr 2013 22:11:01 +0000"  >&lt;p&gt;Hmm.. I agree with Ashutosh in that the length of the classpath is a valid consideration, especially for Windows. For the HCat JsonSerDe as well, our approach was to document that if you wanted it, users added the HCat jars to HIVE_AUX_JARS_PATH, but not have that explicitly for all the tasks which don&apos;t need it.&lt;/p&gt;

&lt;p&gt;Adding it to HIVE_AUX_JARS_PATH will result in it getting appended to the CLASSPATH for the job anyway, and people will get a long CLASSPATH, but that won&apos;t affect people who aren&apos;t using hbase and need a shorter classpath because they have other deps they want to add in.&lt;/p&gt;

&lt;p&gt;I like the shorter deps idea, but I also agree that maintaining that from hive&apos;s side is asking for desynch troubles later on. One possibility is that it could be maintained on the hbase side, so that running &quot;hbase barebones-classpath&quot; in a manner similar to the current &quot;hbase classpath&quot; can return only the deps that would have otherwise been added by addDependencyJars ? Then, users could do something like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;HIVE_AUX_JARS_PATH = $(hbase barebones-classpath) hive -f hbase_query.q
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13641042" author="sushanth" created="Wed, 24 Apr 2013 22:11:56 +0000"  >&lt;p&gt;(Don&apos;t have edit privileges to edit cmdline above, but assume we clip the spaces around the assignment)&lt;/p&gt;</comment>
                            <comment id="13641092" author="apurtell" created="Wed, 24 Apr 2013 22:38:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;One possibility is that it could be maintained on the hbase side, so that running &quot;hbase barebones-classpath&quot; in a manner similar to the current &quot;hbase classpath&quot; can return only the deps that would have otherwise been added by addDependencyJars ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That sounds plausible. What do you think Nick?&lt;/p&gt;</comment>
                            <comment id="13641094" author="ndimiduk" created="Wed, 24 Apr 2013 22:38:26 +0000"  >&lt;p&gt;Are you suggesting that the CLASSPATH length issue is going to bite us on &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2786&quot; title=&quot;enhance Pig launcher script wrt. HBase/HCat integration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2786&quot;&gt;&lt;del&gt;PIG-2786&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-621&quot; title=&quot;bin/hcat should include hbase jar and dependencies in the classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-621&quot;&gt;HCATALOG-621&lt;/a&gt; as well?&lt;/p&gt;

&lt;p&gt;I guess what we really want is the set of Hive&apos;s dependencies union HBase&apos;s dependencies minus Hadoop&apos;s runtime jars.&lt;/p&gt;</comment>
                            <comment id="13641228" author="sushanth" created="Thu, 25 Apr 2013 00:29:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; Yup, it could bite us on both of those in Windows. I&apos;m a little less worried about &lt;a href=&quot;https://issues.apache.org/jira/browse/HCATALOG-621&quot; title=&quot;bin/hcat should include hbase jar and dependencies in the classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HCATALOG-621&quot;&gt;HCATALOG-621&lt;/a&gt; itself since the hcat commandline is for ddl only, and is another thing we want to deprecate eventually in favour of the hive commandline.&lt;/p&gt;</comment>
                            <comment id="13642037" author="ndimiduk" created="Thu, 25 Apr 2013 18:14:30 +0000"  >&lt;p&gt;I took a stab at implementing a bash function that will remove duplicate entries from a PATH-like string. Trouble is, bash3 doesn&apos;t support associative maps, which makes implementation difficult. How do you feel about shelling out to perl for the string manipulation?&lt;/p&gt;</comment>
                            <comment id="13642239" author="ndimiduk" created="Thu, 25 Apr 2013 21:26:30 +0000"  >&lt;p&gt;Please have a look at the patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8438&quot; title=&quot;Extend bin/hbase to print a &amp;quot;mapreduce classpath&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8438&quot;&gt;&lt;del&gt;HBASE-8438&lt;/del&gt;&lt;/a&gt;. It should be sufficient for our needs. Consumption of it in the hive launch script would look something like&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;HBASE_CLASSPATH=&quot;$HADOOP_CLASSPATH:$(hbase classpath)&quot;
HADOOP_CLASSPATH=&quot;$(hbase classpath-min $HBASE_CLASSPATH)&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13689662" author="ndimiduk" created="Thu, 20 Jun 2013 21:03:56 +0000"  >&lt;p&gt;The topic of this issue came up in conversation with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cnauroth&quot; class=&quot;user-hover&quot; rel=&quot;cnauroth&quot;&gt;Chris Nauroth&lt;/a&gt;. He pointed me toward a Hadoop feature used by YARN to get around this very issue. Perhaps we can make use of the same.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/hadoop-common/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java#L1140&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hadoop-common/blob/trunk/hadoop-common-project/hadoop-common/src/main/java/org/apache/hadoop/fs/FileUtil.java#L1140&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13714256" author="brocknoland" created="Sat, 20 Jul 2013 00:16:20 +0000"  >&lt;p&gt;Hey guys I think the patch available status of this JIRA should be removed until these open questions are resolved.&lt;/p&gt;</comment>
                            <comment id="13714536" author="ndimiduk" created="Sat, 20 Jul 2013 20:39:47 +0000"  >&lt;p&gt;Fair enough. I lack privileges to change this attribute.&lt;/p&gt;</comment>
                            <comment id="13820558" author="ndimiduk" created="Tue, 12 Nov 2013 22:22:50 +0000"  >&lt;p&gt;My above link has turned stale. I&apos;m referring to FileUtil#createJarWithClassPath.&lt;/p&gt;

&lt;p&gt;Calling this method to construct a classpath jar every time a script calls $(hbase classpath-min) sounds time-consuming and will leave temp jars orphaned on the FS.&lt;/p&gt;

&lt;p&gt;Another idea is to use maven to generate a dependency list that omits Hadoop and other runtime jars? Any friends at BigTop who could give advice on this approach? (cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rvs&quot; class=&quot;user-hover&quot; rel=&quot;rvs&quot;&gt;Roman Shaposhnik&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mackrorysd&quot; class=&quot;user-hover&quot; rel=&quot;mackrorysd&quot;&gt;Sean Mackrory&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Yet another option is to maintain the list manually on the HBase side. We already sort of do with in TableMapReduceUtils#addDependencyJars. This is probably the simplest but most fragile and least future-proof option.&lt;/p&gt;</comment>
                            <comment id="13822075" author="ndimiduk" created="Thu, 14 Nov 2013 01:24:56 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sushanth&quot; class=&quot;user-hover&quot; rel=&quot;sushanth&quot;&gt;Sushanth Sowmyan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;See my latest patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8438&quot; title=&quot;Extend bin/hbase to print a &amp;quot;mapreduce classpath&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8438&quot;&gt;&lt;del&gt;HBASE-8438&lt;/del&gt;&lt;/a&gt;. It provides a new command to the hbase bin script that prints out the jars our existing addDependencyJars detects. It&apos;s not perfect as it includes 2 unnecessary hadoop jars, but it&apos;s a lot better than blindly calling `hbase classpath`. Does this meet your expectations regarding environment variable length limitations?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ hbase mapredcp 2&amp;gt;/dev/null | tr &apos;:&apos; &apos;\n&apos; | wc
     12      12     660
$ hbase classpath 2&amp;gt;/dev/null | tr &apos;:&apos; &apos;\n&apos; | wc
    116     115    5459
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13822627" author="ashutoshc" created="Thu, 14 Nov 2013 17:09:21 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; for picking this up. Hadoop jar version could be a source of problems later, can you get rid of that in your hbase command. Also, for documentation purposes it will be good if you can paste here output of that command to list what deps are there at the moment.&lt;/p&gt;</comment>
                            <comment id="13822835" author="ndimiduk" created="Thu, 14 Nov 2013 20:03:54 +0000"  >&lt;p&gt;Here&apos;s my &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8438?focusedCommentId=13822074&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13822074&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment&lt;/a&gt; on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8438&quot; title=&quot;Extend bin/hbase to print a &amp;quot;mapreduce classpath&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8438&quot;&gt;&lt;del&gt;HBASE-8438&lt;/del&gt;&lt;/a&gt; with a listing of the jars picked up.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ ./bin/hbase mapredcp 2&amp;gt;/dev/null | tr &apos;:&apos; &apos;\n&apos;
/Users/ndimiduk/.m2/repository/org/apache/zookeeper/zookeeper/3.4.5/zookeeper-3.4.5.jar
/Users/ndimiduk/repos/hbase/hbase-common/target/hbase-common-0.96.0.jar
/Users/ndimiduk/.m2/repository/org/cloudera/htrace/htrace-core/2.01/htrace-core-2.01.jar
/Users/ndimiduk/repos/hbase/hbase-client/target/hbase-client-0.96.0.jar
/Users/ndimiduk/.m2/repository/io/netty/netty/3.6.6.Final/netty-3.6.6.Final.jar
/Users/ndimiduk/repos/hbase/hbase-protocol/target/hbase-protocol-0.96.0.jar
/Users/ndimiduk/repos/hbase/hbase-hadoop-compat/target/hbase-hadoop-compat-0.96.0.jar
/Users/ndimiduk/repos/hbase/hbase-server/target/hbase-server-0.96.0.jar
/Users/ndimiduk/.m2/repository/com/google/protobuf/protobuf-java/2.5.0/protobuf-java-2.5.0.jar
/Users/ndimiduk/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/2.1.0-beta/hadoop-mapreduce-client-core-2.1.0-beta.jar
/Users/ndimiduk/.m2/repository/org/apache/hadoop/hadoop-common/2.1.0-beta/hadoop-common-2.1.0-beta.jar
/Users/ndimiduk/.m2/repository/com/google/guava/guava/12.0.1/guava-12.0.1.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The hadoop jar chosen is based on what hadoop itself puts into the classpath, so I think it won&apos;t be an issue in practice. However, Pig has a similar need (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3285&quot; title=&quot;Jobs using HBaseStorage fail to ship dependency jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3285&quot;&gt;&lt;del&gt;PIG-3285&lt;/del&gt;&lt;/a&gt;) so my patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9165&quot; title=&quot;Improvements to addDependencyJars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9165&quot;&gt;&lt;del&gt;HBASE-9165&lt;/del&gt;&lt;/a&gt; implements a new method which will exclude the Hadoop pieces. We can modify this patch to call that new method if you prefer.&lt;/p&gt;</comment>
                            <comment id="13823338" author="ashutoshc" created="Fri, 15 Nov 2013 06:15:06 +0000"  >&lt;p&gt;Lets use the new method. Also, since zk, protobuf and guava are already hive&apos;s dep and will be in classpath, in the hive script we can exclude them from getting included via this command.&lt;/p&gt;</comment>
                            <comment id="13823907" author="ndimiduk" created="Fri, 15 Nov 2013 18:25:48 +0000"  >&lt;p&gt;Here&apos;s the output of the latest version of the patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8438&quot; title=&quot;Extend bin/hbase to print a &amp;quot;mapreduce classpath&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8438&quot;&gt;&lt;del&gt;HBASE-8438&lt;/del&gt;&lt;/a&gt;, what you will get when running from HBase &amp;gt; 0.96.1. I intend to backport the feature in time for the 0.94.14 release as well.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ ./bin/hbase mapredcp | tr &apos;:&apos; &apos;\n&apos;
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/netty-3.6.6.Final.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/hbase-hadoop-compat-0.97.0-SNAPSHOT.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/protobuf-java-2.5.0.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/guava-12.0.1.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/htrace-core-2.01.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/hbase-protocol-0.97.0-SNAPSHOT.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/hbase-client-0.97.0-SNAPSHOT.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/zookeeper-3.4.5.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/hbase-server-0.97.0-SNAPSHOT.jar
/private/tmp/hbase-0.97.0-SNAPSHOT/lib/hbase-common-0.97.0-SNAPSHOT.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13824025" author="ashutoshc" created="Fri, 15 Nov 2013 19:54:25 +0000"  >&lt;p&gt;List looks good. As I suggested in previous comment, within hive script we can exclude zk,protobuf, guava (obtained via hbase cmd) to avoid adding them twice.&lt;/p&gt;</comment>
                            <comment id="13824558" author="hudson" created="Sat, 16 Nov 2013 18:22:02 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1203 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1203/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1203/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9165&quot; title=&quot;Improvements to addDependencyJars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9165&quot;&gt;&lt;del&gt;HBASE-9165&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;mapreduce&amp;#93;&lt;/span&gt; Modularize building dependency jars&lt;/p&gt;

&lt;p&gt;Separate adding HBase and dependencies from adding other job dependencies, and&lt;br/&gt;
expose it as a separate method that other projects can use (for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3285&quot; title=&quot;Jobs using HBaseStorage fail to ship dependency jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3285&quot;&gt;&lt;del&gt;PIG-3285&lt;/del&gt;&lt;/a&gt;,&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2055&quot; title=&quot;Hive should add HBase classpath dependencies when available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2055&quot;&gt;&lt;del&gt;HIVE-2055&lt;/del&gt;&lt;/a&gt;). (ndimiduk: rev 1542414)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapred/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/mapreduce/TestTableMapReduce.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13824586" author="hudson" created="Sat, 16 Nov 2013 19:08:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #337 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/337/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/337/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9165&quot; title=&quot;Improvements to addDependencyJars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9165&quot;&gt;&lt;del&gt;HBASE-9165&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;mapreduce&amp;#93;&lt;/span&gt; Modularize building dependency jars&lt;/p&gt;

&lt;p&gt;Separate adding HBase and dependencies from adding other job dependencies, and&lt;br/&gt;
expose it as a separate method that other projects can use (for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3285&quot; title=&quot;Jobs using HBaseStorage fail to ship dependency jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3285&quot;&gt;&lt;del&gt;PIG-3285&lt;/del&gt;&lt;/a&gt;,&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2055&quot; title=&quot;Hive should add HBase classpath dependencies when available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2055&quot;&gt;&lt;del&gt;HIVE-2055&lt;/del&gt;&lt;/a&gt;). (ndimiduk: rev 1542414)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapred/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/mapreduce/TestTableMapReduce.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13824955" author="ndimiduk" created="Sun, 17 Nov 2013 21:05:46 +0000"  >&lt;p&gt;Backport to 0.94 is also complete. For reference, here&apos;s its output:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ ./bin/hbase mapredcp | tr &apos;:&apos; &apos;\n&apos;
/private/tmp/hbase-0.94.14-SNAPSHOT/hbase-0.94.14-SNAPSHOT.jar
/private/tmp/hbase-0.94.14-SNAPSHOT/lib/protobuf-java-2.4.0a.jar
/private/tmp/hbase-0.94.14-SNAPSHOT/lib/zookeeper-3.4.5.jar
/private/tmp/hbase-0.94.14-SNAPSHOT/lib/guava-11.0.2.jar
/private/tmp/hbase-0.94.14-SNAPSHOT/lib/hadoop-core-1.0.4.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13825647" author="rvs" created="Mon, 18 Nov 2013 19:21:06 +0000"  >&lt;p&gt;Sorry for dropping by somewhat late but it looks like you&apos;ve got a pretty reasonable solution with mapredcp.&lt;/p&gt;</comment>
                            <comment id="13825664" author="ndimiduk" created="Mon, 18 Nov 2013 19:33:49 +0000"  >&lt;p&gt;Here&apos;s an updated patch to the launch script based on the new hbase command. Please excuse my bash scripting; I&apos;m not a native speaker.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rvs&quot; class=&quot;user-hover&quot; rel=&quot;rvs&quot;&gt;Roman Shaposhnik&lt;/a&gt; you&apos;re just in time &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13825734" author="ashutoshc" created="Mon, 18 Nov 2013 20:21:13 +0000"  >&lt;p&gt;We dont want hbase conf and jars to take precedence over rest of classpath.  So, instead of &lt;br/&gt;
+  export HADOOP_CLASSPATH=&quot;${HBASE_CONF_DIR}:${HADOOP_CLASSPATH}&quot;&lt;br/&gt;
+    export HADOOP_CLASSPATH=&quot;${x}:${HADOOP_CLASSPATH}&quot;&lt;/p&gt;

&lt;p&gt;do&lt;br/&gt;
+  export HADOOP_CLASSPATH=&quot;${HADOOP_CLASSPATH}:${HBASE_CONF_DIR}:&quot;&lt;br/&gt;
+    export HADOOP_CLASSPATH=&quot;${HADOOP_CLASSPATH}:${x}&quot;&lt;/p&gt;

&lt;p&gt;Rest of patch looks good.&lt;/p&gt;</comment>
                            <comment id="13825745" author="ndimiduk" created="Mon, 18 Nov 2013 20:28:38 +0000"  >&lt;p&gt;Updating patch according to Ashutosh&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="13825758" author="ashutoshc" created="Mon, 18 Nov 2013 20:38:54 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13826244" author="rvs" created="Tue, 19 Nov 2013 06:34:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; LGTM +1&lt;/p&gt;</comment>
                            <comment id="13826917" author="ashutoshc" created="Tue, 19 Nov 2013 20:44:55 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Nick!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12633076">HCATALOG-621</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12644643">HBASE-8438</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12614479" name="0001-HIVE-2055-include-hbase-dependencies-in-launch-scrip.patch" size="2111" author="ndimiduk" created="Mon, 18 Nov 2013 20:28:38 +0000"/>
                            <attachment id="12614457" name="0001-HIVE-2055-include-hbase-dependencies-in-launch-scrip.patch" size="2111" author="ndimiduk" created="Mon, 18 Nov 2013 19:33:49 +0000"/>
                            <attachment id="12580082" name="0001-HIVE-2055-include-hbase-dependencies-in-launch-scrip.patch" size="1274" author="ndimiduk" created="Tue, 23 Apr 2013 17:17:17 +0000"/>
                            <attachment id="12579449" name="HIVE-2055.patch" size="1457" author="gkesavan" created="Thu, 18 Apr 2013 23:06:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 28 Jan 2013 05:39:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42292</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 9 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123604</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HBase will be detected via HBASE_HOME and HBASE_CONF_DIR. HBASE_HOME defaults to BigTop path /usr/lib/hbase.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2056] Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2056</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12501480">HIVE-2056</key>
            <summary>Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amareshwari">Amareshwari Sriramadasu</assignee>
                                    <reporter username="amareshwari">Amareshwari Sriramadasu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 16:26:49 +0000</created>
                <updated>Mon, 7 Apr 2014 04:45:50 +0000</updated>
                            <resolved>Wed, 11 May 2011 20:52:23 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13006995" author="amareshwari" created="Tue, 15 Mar 2011 16:27:59 +0000"  >&lt;p&gt;Here is a request from one of our customers:&lt;/p&gt;

&lt;p&gt;here is a real example of need to have multi group by with 1 M/R. If&lt;br/&gt;
you look at the query below, we have two aggregates being generated out of single fact table. The 1st aggregate&lt;br/&gt;
generates unique count by date and the 2nd one generates unique count by date and gender. We have lot of&lt;br/&gt;
these aggregates to be built. We would like this to be done in 1 M/R job as against three below. Is it possible to do&lt;br/&gt;
this in Hive?&lt;/p&gt;

&lt;p&gt;// created two intermediate tables&lt;/p&gt;

&lt;p&gt;hive&amp;gt; create table test_1 (dt string, bc_cnt bigint);&lt;/p&gt;

&lt;p&gt;OK&lt;/p&gt;

&lt;p&gt;Time taken: 9.004 seconds&lt;/p&gt;

&lt;p&gt;hive&amp;gt; create table test_2 (dt string, gender string, bc_cnt bigint);&lt;/p&gt;

&lt;p&gt;OK&lt;/p&gt;



&lt;p&gt;// multi group by in insert statement&lt;/p&gt;



&lt;p&gt;hive&amp;gt; from fact_table f&lt;/p&gt;

&lt;p&gt;    &amp;gt; insert overwrite table test_1 select dt, count(distinct id) group by dt&lt;/p&gt;

&lt;p&gt;    &amp;gt; insert overwrite table test_2 select dt,gender,count(distinct id) group by dt,gender;&lt;/p&gt;

&lt;p&gt;Total MapReduce jobs = 3&lt;/p&gt;

&lt;p&gt;Launching Job 1 out of 3&lt;/p&gt;

&lt;p&gt;Number of reduce tasks not specified. Estimated from input data size: 999&lt;/p&gt;

&lt;p&gt;In order to change the average load for a reducer (in bytes):&lt;/p&gt;

&lt;p&gt;  set hive.exec.reducers.bytes.per.reducer=&amp;lt;number&amp;gt;&lt;/p&gt;

&lt;p&gt;In order to limit the maximum number of reducers:&lt;/p&gt;

&lt;p&gt;  set hive.exec.reducers.max=&amp;lt;number&amp;gt;&lt;/p&gt;

&lt;p&gt;In order to set a constant number of reducers:&lt;/p&gt;

&lt;p&gt;  set mapred.reduce.tasks=&amp;lt;number&amp;gt;&lt;/p&gt;



&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Sudhish&lt;/p&gt;
</comment>
                            <comment id="13013938" author="amareshwari" created="Thu, 31 Mar 2011 12:04:23 +0000"  >&lt;p&gt;For a query of the form,&lt;br/&gt;
&quot;From table T&lt;br/&gt;
 insert overwrite table test1 select col1, count(distinct colx) group by col1&lt;br/&gt;
 insert overwrite table test2 select col2, count(distinct colx) group by col2;&quot; &lt;br/&gt;
it is not possible to generate a single M/R job, because partitioning the input row by both col1 and col2 in a single stage does not work here. &lt;br/&gt;
If the groupby keys are such that one keyset is a subset of the other, i.e. of the following form: &lt;br/&gt;
&quot;From table T &lt;br/&gt;
insert overwrite table test1 select col1, count(distinct colx) group by col1 &lt;br/&gt;
insert overwrite table test2 select col1, col2, count(distinct colx) group by col1, col2;&quot;, &lt;br/&gt;
we can run it in a single MR job by spraying over common groupby keyset( i.e. col1). Will implement this and see if it reduces query execution time.&lt;/p&gt;

&lt;p&gt;Thoughts? &lt;/p&gt;
</comment>
                            <comment id="13030728" author="amareshwari" created="Mon, 9 May 2011 13:32:14 +0000"  >&lt;p&gt;Attached patch generates a single M/R job for multi group by query with non-null common group by key set. Added configuration hive.multigroupby.singlemr to turn on and off the optimization. &lt;br/&gt;
It considers no-distinct or single common distinct expression; did not multi distinct expressions yet. Will do in a follow up if required.&lt;/p&gt;

&lt;p&gt;Performance numbers:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Number of rows in table&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Query &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Time taken by 3 M/R jobs plan &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Time taken by Single M/R job plan&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;100 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; query1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 58.416 seconds &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;22.099 seconds&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;33682 million &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; query1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Did not succeed &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 11434.308 seconds&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;33682 million &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; query2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 2hrs, 48mins, 15sec &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;16mins, 3sec.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;Query1 did not succeed with 33682 million row table with existing plan. Reducers failed with OOM after 12 hours. I tried many combinations of number of reducers and Xmx values, but in vain.&lt;br/&gt;
Verified the correctness for 100 row table row by row; and number of rows in the result for 33682 million rows table. &lt;/p&gt;</comment>
                            <comment id="13030729" author="jiraposter@reviews.apache.org" created="Mon, 9 May 2011 13:38:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/700/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Attached patch generates a single M/R job for multi group by query with non-null common group by key set. Added configuration hive.multigroupby.singlemr to turn on and off the optimization. &lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; title=&quot;Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2056&quot;&gt;&lt;del&gt;HIVE-2056&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2056&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1100910 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby10.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby8.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby8_noskew.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby9.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby10.q.out 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby8.q.out 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby9.q.out 1100910 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/700/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated jira with performance tests.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Amareshwari&lt;/p&gt;
</comment>
                            <comment id="13030802" author="namit" created="Mon, 9 May 2011 16:46:13 +0000"  >&lt;p&gt;Great work, Amareshwari - I will take a look.&lt;/p&gt;

&lt;p&gt;This should be very useful.&lt;/p&gt;</comment>
                            <comment id="13030814" author="jiraposter@reviews.apache.org" created="Mon, 9 May 2011 17:07:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/700/#review651&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/#review651&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Change hive-default.xml with the new parameter.&lt;br/&gt;
Add the new parameter in the name of the jira.&lt;/p&gt;


&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/700/#comment1306&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/#comment1306&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Add a comment - this optimization is not enabled&lt;br/&gt;
    if one of the sub-queries does not involve a &lt;br/&gt;
    aggregation&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/700/#comment1307&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/#comment1307&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The code is not preforming a prefix match.&lt;br/&gt;
    I mean,&lt;/p&gt;

&lt;p&gt;    if the query is:&lt;/p&gt;

&lt;p&gt;    from T&lt;br/&gt;
    insert overwrite T1 select ... group by c1&lt;br/&gt;
    insert overwrite T1 select ... group by c2, c1&lt;/p&gt;


&lt;p&gt;    c1 will still be returned.&lt;/p&gt;

&lt;p&gt;    Is that desirable ?&lt;/p&gt;

&lt;p&gt;    I dont think this will work - can you add a testcase&lt;br/&gt;
    for this - I mean, with a explain which shows that&lt;br/&gt;
    the parameter does not make a difference&lt;/p&gt;



&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;namit&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-05-09 13:36:28, Amareshwari Sriramadasu wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/700/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-05-09 13:36:28)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Attached patch generates a single M/R job for multi group by query with non-null common group by key set. Added configuration hive.multigroupby.singlemr to turn on and off the optimization. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; title=&quot;Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2056&quot;&gt;&lt;del&gt;HIVE-2056&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2056&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby10.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby8.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby8_noskew.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby9.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby10.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby8.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby9.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/700/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Updated jira with performance tests.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Amareshwari&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13030816" author="namit" created="Mon, 9 May 2011 17:08:52 +0000"  >&lt;p&gt;Changed to &apos;Cancel Patch&apos; for the comments above&lt;/p&gt;</comment>
                            <comment id="13031671" author="amareshwari" created="Wed, 11 May 2011 12:54:48 +0000"  >&lt;p&gt;Thanks Namit for the review.&lt;/p&gt;

&lt;p&gt;Updated the patch to do prefix matching and added a testcase.&lt;/p&gt;</comment>
                            <comment id="13031683" author="amareshwari" created="Wed, 11 May 2011 13:15:47 +0000"  >&lt;p&gt;Earlier patch missed a comment. Updated this diff on review board.&lt;/p&gt;</comment>
                            <comment id="13031684" author="jiraposter@reviews.apache.org" created="Wed, 11 May 2011 13:15:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/700/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-05-11 13:14:36.754720)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated the patch to do prefix matching and added a testcase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Attached patch generates a single M/R job for multi group by query with non-null common group by key set. Added configuration hive.multigroupby.singlemr to turn on and off the optimization. &lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; title=&quot;Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2056&quot;&gt;&lt;del&gt;HIVE-2056&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2056&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1100910 &lt;br/&gt;
  trunk/conf/hive-default.xml 1100910 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby10.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby8.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby8_noskew.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/groupby9.q 1100910 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/multigroupby_singlemr.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby10.q.out 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby8.q.out 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/groupby9.q.out 1100910 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/700/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated jira with performance tests.&lt;/p&gt;

&lt;p&gt;All unit tests passed with the patch&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Amareshwari&lt;/p&gt;
</comment>
                            <comment id="13031685" author="jiraposter@reviews.apache.org" created="Wed, 11 May 2011 13:15:48 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-05-09 17:07:16, namit jain wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Change hive-default.xml with the new parameter.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Add the new parameter in the name of the jira.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-05-09 17:07:16, namit jain wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java, line 5518&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/700/diff/1/?file=18439#file18439line5518&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff/1/?file=18439#file18439line5518&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Add a comment - this optimization is not enabled&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     if one of the sub-queries does not involve a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     aggregation&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-05-09 17:07:16, namit jain wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java, line 5524&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/700/diff/1/?file=18439#file18439line5524&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff/1/?file=18439#file18439line5524&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     The code is not preforming a prefix match.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I mean,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     if the query is:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     from T&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     insert overwrite T1 select ... group by c1&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     insert overwrite T1 select ... group by c2, c1&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     c1 will still be returned.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Is that desirable ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I dont think this will work - can you add a testcase&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     for this - I mean, with a explain which shows that&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     the parameter does not make a difference&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed. I missed this.&lt;br/&gt;
Updated the patch with prefix matching&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Amareshwari&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/700/#review651&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/#review651&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-05-11 13:14:36, Amareshwari Sriramadasu wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/700/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-05-11 13:14:36)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Attached patch generates a single M/R job for multi group by query with non-null common group by key set. Added configuration hive.multigroupby.singlemr to turn on and off the optimization. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; title=&quot;Generate single MR job for multi groupby query if hive.multigroupby.singlemr is enabled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2056&quot;&gt;&lt;del&gt;HIVE-2056&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2056&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/conf/hive-default.xml 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby10.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby8.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby8_noskew.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/groupby9.q 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/multigroupby_singlemr.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby10.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby8.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/groupby9.q.out 1100910 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/700/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/700/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Updated jira with performance tests.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;All unit tests passed with the patch&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Amareshwari&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13031779" author="namit" created="Wed, 11 May 2011 15:25:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13032054" author="namit" created="Wed, 11 May 2011 20:52:23 +0000"  >&lt;p&gt;Committed. Thanks Amareshwari&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12533560">HIVE-2621</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12478812" name="patch-2056-1.txt" size="179451" author="amareshwari" created="Wed, 11 May 2011 12:54:48 +0000"/>
                            <attachment id="12478814" name="patch-2056-2.txt" size="180507" author="amareshwari" created="Wed, 11 May 2011 13:15:47 +0000"/>
                            <attachment id="12478595" name="patch-2056.txt" size="89588" author="amareshwari" created="Mon, 9 May 2011 13:32:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 May 2011 13:38:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72569</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0li8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123605</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2057] eliminate parser warning for &quot;Identifier DOT Identifier&quot;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2057</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I noticed this warning in recent builds:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;build-grammar:
     [echo] Building Grammar /data/users/jsichi/open/hive-trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g  ....
     [java] ANTLR Parser Generator  Version 3.0.1 (August 13, 2007)  1989-2007
     [java] warning(200): /data/users/jsichi/open/hive-trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:1503:5: Decision can match input such as &quot;Identifier DOT Identifier&quot; using multiple alternatives: 1, 2
     [java] As a result, alternative(s) 2 were disabled for that input
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1517&quot; title=&quot;ability to select across a database&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1517&quot;&gt;&lt;del&gt;HIVE-1517&lt;/del&gt;&lt;/a&gt;.  Is there a way to get rid of it?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501516">HIVE-2057</key>
            <summary>eliminate parser warning for &quot;Identifier DOT Identifier&quot;</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Mar 2011 21:47:52 +0000</created>
                <updated>Fri, 18 Nov 2011 19:47:12 +0000</updated>
                                                                            <component>Diagnosability</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13153083" author="ashutoshc" created="Fri, 18 Nov 2011 19:47:12 +0000"  >&lt;p&gt;In recent builds, I sometimes get:&lt;br/&gt;
&lt;tt&gt;noformat&lt;/tt&gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2283:1: Multiple token rules can match input such as &quot;&apos;H&apos;&quot;: KW_HAVING, KW_HOLD_DDLTIME, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_HOLD_DDLTIME were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2222:1: Multiple token rules can match input such as &quot;&apos;B&apos;&quot;: KW_BY, KW_BOOLEAN, KW_BIGINT, KW_BUCKETS, KW_BUCKET, KW_BEFORE, KW_BETWEEN, KW_BOTH, KW_BINARY, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_BOTH,KW_BOOLEAN,KW_BINARY,KW_BIGINT,KW_BUCKET,KW_BETWEEN,KW_BEFORE,KW_BUCKETS were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2170:1: Multiple token rules can match input such as &quot;&apos;R&apos;&quot;: KW_RIGHT, KW_REBUILD, KW_REPAIR, KW_RENAME, KW_REDUCE, KW_ROW, KW_RCFILE, KW_READONLY, KW_REPLACE, KW_RLIKE, KW_REGEXP, KW_REVOKE, KW_READ, KW_READS, KW_RANGE, KW_RECORDREADER, KW_RECORDWRITER, KW_RESTRICT, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) KW_READONLY,KW_REGEXP,Identifier,KW_RENAME,KW_RECORDREADER,KW_RANGE,KW_RESTRICT,KW_REDUCE,KW_RCFILE,KW_RLIKE,KW_REVOKE,KW_ROW,KW_RECORDWRITER,KW_REPLACE,KW_READS,KW_REPAIR,KW_READ,KW_REBUILD were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2150:1: Multiple token rules can match input such as &quot;&apos;F&apos;&quot;: KW_FALSE, KW_FROM, KW_FULL, KW_FUNCTIONS, KW_FIRST, KW_FLOAT, KW_FORMAT, KW_FIELDS, KW_FILEFORMAT, KW_FUNCTION, KW_FORMATTED, KW_FETCH, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_FIELDS,KW_FORMATTED,KW_FUNCTION,KW_FETCH,KW_FUNCTIONS,KW_FILEFORMAT,KW_FORMAT,KW_FIRST,KW_FULL,KW_FLOAT,KW_FROM were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2359:1: Multiple token rules can match input such as &quot;&apos;!&apos;&quot;: KW_NOT, NOTEQUAL&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) NOTEQUAL were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2277:1: Multiple token rules can match input such as &quot;&apos;W&apos;&quot;: KW_WHERE, KW_WITH, KW_WHEN, KW_WHILE, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_WITH,KW_WHILE,KW_WHEN were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2428:1: Multiple token rules can match input such as &quot;&apos;0&apos;&quot;: CharSetLiteral, BigintLiteral, SmallintLiteral, TinyintLiteral, Number, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Number,BigintLiteral,Identifier,TinyintLiteral,SmallintLiteral were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2417:1: Multiple token rules can match input such as &quot;&apos;&quot;&apos;&quot;: StringLiteral, CharSetLiteral&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) CharSetLiteral were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2443:1: Multiple token rules can match input such as &quot;&apos;V&apos;&quot;: KW_VIEW, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2300:1: Multiple token rules can match input such as &quot;&apos;G&apos;&quot;: KW_GROUP, KW_GRANT, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_GRANT were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2314:1: Multiple token rules can match input such as &quot;&apos;P&apos;&quot;: KW_PRESERVE, KW_PARTITION, KW_PARTITIONS, KW_PARTITIONED, KW_PERCENT, KW_PLUS, KW_PROCEDURE, KW_PURGE, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_PLUS,KW_PARTITION,KW_PARTITIONS,KW_PARTITIONED,KW_PERCENT,KW_PROCEDURE,KW_PURGE were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2287:1: Multiple token rules can match input such as &quot;&apos;L&apos;&quot;: KW_LIKE, KW_LEFT, KW_LOCAL, KW_LOAD, KW_LINES, KW_LOCATION, KW_LIMIT, KW_LONG, KW_LOCK, KW_LOCKS, KW_LATERAL, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) Identifier,KW_LOCK,KW_LOCAL,KW_LEFT,KW_LOCKS,KW_LATERAL,KW_LOCATION,KW_LOAD,KW_LINES,KW_LIMIT,KW_LONG were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2200:1: Multiple token rules can match input such as &quot;&apos;T&apos;&quot;: KW_TRUE, KW_TABLE, KW_TABLES, KW_TRANSFORM, KW_TO, KW_TINYINT, KW_TIMESTAMP, KW_TERMINATED, KW_TEXTFILE, KW_TABLESAMPLE, KW_TEMPORARY, KW_TBLPROPERTIES, KW_THEN, KW_TRIGGER, KW_TOUCH, Identifier&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) KW_TIMESTAMP,KW_TRIGGER,KW_TEXTFILE,KW_TRANSFORM,KW_TERMINATED,Identifier,KW_TABLES,KW_TABLE,KW_TOUCH,KW_TABLESAMPLE,KW_TBLPROPERTIES,KW_TINYINT,KW_THEN,KW_TEMPORARY,KW_TO were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(209): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2363:1: Multiple token rules can match input such as &quot;&apos;&amp;gt;&apos;&quot;: GREATERTHANOREQUALTO, GREATERTHAN&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; As a result, tokens(s) GREATERTHAN were disabled for that input&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; warning(208): /home/ashutosh/workspace/hive-2542/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g:2457:1: The following token definitions are unreachable: KW_AND,KW_ASC,KW_ORDER,KW_FROM,KW_AS,KW_DISTINCT,KW_INSERT,KW_OVERWRITE,KW_OUTER,KW_LEFT,KW_FULL,KW_ON,KW_PARTITION,KW_PARTITIONS,KW_TABLE,KW_TABLES,KW_INDEX,KW_INDEXES,KW_REBUILD,KW_FUNCTIONS,KW_SHOW,KW_REPAIR,KW_DIRECTORY,KW_LOCAL,KW_TRANSFORM,KW_USING,KW_DISTRIBUTE,KW_SORT,KW_UNION,KW_LOAD,KW_EXPORT,KW_IMPORT,KW_DATA,KW_INPATH,KW_IS,KW_NULL,KW_CREATE,KW_EXTERNAL,KW_ALTER,KW_CHANGE,KW_COLUMN,KW_FIRST,KW_AFTER,KW_DESCRIBE,KW_DROP,KW_RENAME,KW_TO,KW_COMMENT,KW_BOOLEAN,KW_TINYINT,KW_SMALLINT,KW_INT,KW_BIGINT,KW_FLOAT,KW_DOUBLE,KW_DATE,KW_DATETIME,KW_TIMESTAMP,KW_STRING,KW_ARRAY,KW_STRUCT,KW_MAP,KW_UNIONTYPE,KW_REDUCE,KW_PARTITIONED,KW_CLUSTERED,KW_SORTED,KW_INTO,KW_BUCKETS,KW_ROW,KW_FORMAT,KW_DELIMITED,KW_FIELDS,KW_TERMINATED,KW_ESCAPED,KW_COLLECTION,KW_ITEMS,KW_LINES,KW_STORED,KW_FILEFORMAT,KW_SEQUENCEFILE,KW_TEXTFILE,KW_RCFILE,KW_INPUTFORMAT,KW_OUTPUTFORMAT,KW_INPUTDRIVER,KW_OUTPUTDRIVER,KW_OFFLINE,KW_ENABLE,KW_DISABLE,KW_READONLY,KW_NO_DROP,KW_LOCATION,KW_TABLESAMPLE,KW_BUCKET,KW_OUT,KW_OF,KW_PERCENT,KW_CAST,KW_ADD,KW_REPLACE,KW_COLUMNS,KW_RLIKE,KW_REGEXP,KW_TEMPORARY,KW_FUNCTION,KW_EXPLAIN,KW_EXTENDED,KW_FORMATTED,KW_SERDE,KW_WITH,KW_DEFERRED,KW_SERDEPROPERTIES,KW_DBPROPERTIES,KW_LIMIT,KW_SET,KW_TBLPROPERTIES,KW_IDXPROPERTIES,KW_VALUE_TYPE,KW_ELEM_TYPE,KW_CASE,KW_WHEN,KW_THEN,KW_ELSE,KW_END,KW_MAPJOIN,KW_STREAMTABLE,KW_HOLD_DDLTIME,KW_CLUSTERSTATUS,KW_UTC,KW_UTCTIMESTAMP,KW_LONG,KW_DELETE,KW_PLUS,KW_MINUS,KW_FETCH,KW_INTERSECT,KW_IN,KW_DATABASE,KW_DATABASES,KW_MATERIALIZED,KW_SCHEMA,KW_SCHEMAS,KW_GRANT,KW_REVOKE,KW_SSL,KW_UNDO,KW_LOCK,KW_LOCKS,KW_UNLOCK,KW_SHARED,KW_EXCLUSIVE,KW_PROCEDURE,KW_UNSIGNED,KW_WHILE,KW_READ,KW_READS,KW_PURGE,KW_RANGE,KW_ANALYZE,KW_BEFORE,KW_BETWEEN,KW_BOTH,KW_BINARY,KW_CROSS,KW_CONTINUE,KW_CURSOR,KW_TRIGGER,KW_RECORDREADER,KW_RECORDWRITER,KW_SEMI,KW_LATERAL,KW_TOUCH,KW_ARCHIVE,KW_UNARCHIVE,KW_COMPUTE,KW_STATISTICS,KW_USE,KW_OPTION,KW_CONCATENATE,KW_SHOW_DATABASE,KW_UPDATE,KW_RESTRICT,KW_CASCADE,LESSTHANOREQUALTO,LESSTHAN,GREATERTHAN,DIV,DOLLAR,SmallintLiteral,TinyintLiteral,Number,COMMENT&lt;/p&gt;


&lt;p&gt;&lt;tt&gt;noformat&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;which looks to me like inconsistent behavior from antlr. Pig dealt with similar antlr vagaries in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2055&quot; title=&quot;inconsistent behavior in parser generated during build &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2055&quot;&gt;&lt;del&gt;PIG-2055&lt;/del&gt;&lt;/a&gt; at which point they decided to upgrade to 3.4 to get rid of inconsistent antlr behavior. We should consider to upgrade antlr version too.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 18 Nov 2011 19:47:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42291</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08nfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48397</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>
