<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:14:42 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2009-11-24+AND+created+%3C%3D+2009-12-1+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="7" total="7"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-951] Selectively include EXTERNAL TABLE source files via REGEX</title>
                <link>https://issues.apache.org/jira/browse/HIVE-951</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;CREATE EXTERNAL TABLE should allow users to cherry-pick files via regular expression. &lt;br/&gt;
CREATE EXTERNAL TABLE was designed to allow users to access data that exists outside of Hive, and&lt;br/&gt;
currently makes the assumption that all of the files located under the supplied path should be included&lt;br/&gt;
in the new table. Users frequently encounter directories containing multiple&lt;br/&gt;
datasets, or directories that contain data in heterogeneous schemas, and it&apos;s often&lt;br/&gt;
impractical or impossible to adjust the layout of the directory to meet the requirements of &lt;br/&gt;
CREATE EXTERNAL TABLE. A good example of this problem is creating an external table based&lt;br/&gt;
on the contents of an S3 bucket. &lt;/p&gt;

&lt;p&gt;One way to solve this problem is to extend the syntax of CREATE EXTERNAL TABLE&lt;br/&gt;
as follows:&lt;/p&gt;

&lt;p&gt;CREATE EXTERNAL TABLE&lt;br/&gt;
...&lt;br/&gt;
LOCATION path &lt;span class=&quot;error&quot;&gt;&amp;#91;file_regex&amp;#93;&lt;/span&gt;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; mytable1 ( &lt;span class=&quot;code-keyword&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;, b &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt; )
STORED &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; TEXTFILE
&lt;span class=&quot;code-keyword&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;s3://my.bucket/&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;folder/2009.*\.bz2$&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Creates mytable1 which includes all files in s3:/my.bucket with a filename matching &apos;folder/2009*.bz2&apos;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;EXTERNAL&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;TABLE&lt;/span&gt; mytable2 ( d &lt;span class=&quot;code-keyword&quot;&gt;string&lt;/span&gt;, e &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, f &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;int&lt;/span&gt; )
STORED &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; TEXTFILE 
&lt;span class=&quot;code-keyword&quot;&gt;LOCATION&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;hdfs://&lt;span class=&quot;code-keyword&quot;&gt;data&lt;/span&gt;/&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;xyz.*2009????.bz2$&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Creates mytable2 including all files matching &apos;xyz*2009????.bz2&apos; located under hdfs://data/&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12441541">HIVE-951</key>
            <summary>Selectively include EXTERNAL TABLE source files via REGEX</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Nov 2009 03:09:54 +0000</created>
                <updated>Mon, 17 Dec 2018 21:53:02 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>34</votes>
                                    <watches>46</watches>
                                                                <comments>
                            <comment id="12781792" author="namit" created="Tue, 24 Nov 2009 06:05:02 +0000"  >&lt;p&gt;I am not sure this is a good idea - this will make it very complicated - what if new files get added later.&lt;br/&gt;
Isnt a possible workaround to move/copy the relevant files in a new directory and create a external table on top&lt;br/&gt;
of that ?&lt;/p&gt;</comment>
                            <comment id="12781803" author="cwsteinbach" created="Tue, 24 Nov 2009 07:13:28 +0000"  >&lt;p&gt;If the files you are trying to access are in an S3 bucket, copying them to a new location&lt;br/&gt;
can be extremely inconvenient. I think most people in this position would gladly accept&lt;br/&gt;
a little extra complexity if it allowed them to access their data without first spending an hour&lt;br/&gt;
or two staging it. I&apos;m also not sure why you think this is complex. Are you concerned about &lt;br/&gt;
details of the implementation or additional demands that this places on the user?&lt;/p&gt;

</comment>
                            <comment id="12782019" author="namit" created="Tue, 24 Nov 2009 16:41:21 +0000"  >&lt;p&gt;I don&apos;t think implementation will present a major problem, I am just concerned about the &lt;br/&gt;
user demand on this. Many times, the users use hive and hadoop interchangeably to access&lt;br/&gt;
the data, and this might be difficult for them.&lt;/p&gt;</comment>
                            <comment id="12782213" author="avram" created="Tue, 24 Nov 2009 22:35:30 +0000"  >&lt;p&gt;I want to echo Carl&apos;s point about copying to a new location being *&lt;b&gt;extremely&lt;/b&gt;* inconvenient.  &lt;/p&gt;

&lt;p&gt;Sometimes this inconvenience is impossible and a clear show stopper.  &lt;/p&gt;

&lt;p&gt;In my mind, Namit&apos;s point about interchangeability can be resolved by clear documentation, whereas it is not always possible to copy data around from bucket to bucket especially if the data is quite large.  In my case, being forced to stage large volumes of existing S3 data to other S3 data buckets (copying the same data) for the purpose of Hive analysis has really slowed Hive adoption.  &lt;/p&gt;

&lt;p&gt;Engineers output data to S3 with their own map/reduce efficiencies in mind without regard for Hive&apos;s preferred data organization so analysts are looking forward to having this feature so we can use Hive again.&lt;/p&gt;

&lt;p&gt;Can&apos;t wait for this feature!  &lt;/p&gt;</comment>
                            <comment id="12782510" author="namit" created="Wed, 25 Nov 2009 17:12:34 +0000"  >&lt;p&gt;There was a jira on virtual columns - I will pull out the jira number soon.&lt;br/&gt;
One of the virtual columns proposed was filename.&lt;/p&gt;

&lt;p&gt;Do you think the same use case can be solved if filename was present - &lt;br/&gt;
create a external table on the directory, and filter using the file name. &lt;br/&gt;
The performance should be exactly same - pruning should take care of that&lt;br/&gt;
(after some changes).&lt;/p&gt;
</comment>
                            <comment id="12782511" author="namit" created="Wed, 25 Nov 2009 17:13:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-837&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-837&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;is the jira number for virtual columns I was referring to above&lt;/p&gt;</comment>
                            <comment id="12782529" author="avram" created="Wed, 25 Nov 2009 17:44:17 +0000"  >&lt;p&gt;I think the filename can contain important information (e.g. datestamp, name of the type of data it represents, etc...) that it is desirable to be able to parse out and then group by.   &lt;/p&gt;

&lt;p&gt;Imagine a few year&apos;s worth of data where there are 4 or more filetypes (each filetype having a different set of columns) output to a bucket every day (e.g. 20091125_type_A.gz, 20091125_type_B.gz, 20091125_type_C.gz, 20091125_type_D.gz).  In fact, each day can contain 20 or more large files per filetype (e.g. 20091125_type_A_01.gz, 20091125_type_A_02.gz, 20091125_type_A_03.gz, ..., 20091125_type_A_20.gz, repeat for B,C,D, etc... ). &lt;/p&gt;

&lt;p&gt;It would be nice to be able to parse out new variables for date, type, and type_number (e.g. 01, 02, ..., 20 ) and be able to compute various aggregated metrics via a group by of these variables parsed from the filenames. Hopefully this parsing out would not be too much of a performance bottleneck..&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So, I think there is a need both for a way to select certain files that match a regex from an S3 bucket, and also a need for capturing filename information such that it can subsequently be available for parsing and grouping.  It may be possible to achieve both needs in one use case, but I don&apos;t know enough about Hive/Hadoop internals to judge myself.&lt;/p&gt;</comment>
                            <comment id="12782548" author="prasadc" created="Wed, 25 Nov 2009 18:33:45 +0000"  >&lt;p&gt;@namit,  I agree with others that this would be very convenient and useful functionality for external tables. external table data and location consistency is left to be managed by users. so changing the fileset in that location is not a Hive problem. Hive will query the location and get the list of paths at the time the query is being executed. if a file gets removed or added and query fails because of a  deleted file, it is user&apos;s responsibility.&lt;/p&gt;</comment>
                            <comment id="12782556" author="avram" created="Wed, 25 Nov 2009 19:03:49 +0000"  >&lt;p&gt;Another consideration I&apos;d like to mention that motivates the selection of files by regex, is the unfortunate occurrence that different filetypes (within a bucket) may or may not share the same record delimiter within a row line of a file.  &lt;/p&gt;

&lt;p&gt;I have seen cases where some filetypes are tab delimited and other filetypes are comma delimited, and even cases where files of a type are not even columns but key-value pairings, requiring a map structure in Hive create-table time.&lt;/p&gt;

&lt;p&gt;This feature allowing selection of files by regex will be quite powerful in that it will be flexible enough to be able to read in each table once at a time per filetype. &lt;/p&gt;</comment>
                            <comment id="12782561" author="namit" created="Wed, 25 Nov 2009 19:12:22 +0000"  >&lt;p&gt;I am not questioning the utility of this - I dont like the fact that some of the files in a directory belong on one table.&lt;br/&gt;
What if hive supported views, and you can create a view on the required files ?&lt;br/&gt;
Just a thought..&lt;/p&gt;

&lt;p&gt;Having said that, I know it would take more time to implement views than the proposed feature, but just wanted&lt;br/&gt;
to see everyone&apos;s opinions.&lt;/p&gt;</comment>
                            <comment id="12782580" author="avram" created="Wed, 25 Nov 2009 19:47:54 +0000"  >&lt;p&gt;I am not sure I understand the benefit of implementing a view here.  Would it impact performance?&lt;/p&gt;</comment>
                            <comment id="12782629" author="namit" created="Wed, 25 Nov 2009 21:31:04 +0000"  >&lt;p&gt;No, it is only at compile time - we can find the files either when the view is created or when the query referencing the view is&lt;br/&gt;
executed. The same decision needs to be made for the current proposal also.&lt;/p&gt;

&lt;p&gt;The only benefit of a view is it seems cleaner.&lt;/p&gt;</comment>
                            <comment id="12782634" author="avram" created="Wed, 25 Nov 2009 21:42:04 +0000"  >&lt;p&gt;Interesting.  As a user, I suppose I have no preference other than what can be available sooner to fill the current need.  &lt;/p&gt;</comment>
                            <comment id="12803212" author="cwsteinbach" created="Thu, 21 Jan 2010 07:30:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-951&quot; title=&quot;Selectively include EXTERNAL TABLE source files via REGEX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-951&quot;&gt;HIVE-951&lt;/a&gt;.patch implements filename input filtering for external tables using the following syntax:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CREATE EXTERNAL TABLE ext_tab (
...
)
STORED AS TEXTFILE
LOCATION &lt;span class=&quot;code-quote&quot;&gt;&quot;/user/bob/ext_table_dir&quot;&lt;/span&gt;
FILENAME_FILTER &lt;span class=&quot;code-quote&quot;&gt;&apos;^b.*&apos;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this example ext_tab will refer to all files in the directory /user/bob/ext_table_dir that begin with the letter &apos;b&apos;.&lt;/p&gt;</comment>
                            <comment id="12803388" author="namit" created="Thu, 21 Jan 2010 17:49:36 +0000"  >&lt;p&gt;Can you regenerate the patch - it is not applying cleanly &lt;/p&gt;</comment>
                            <comment id="12803645" author="zshao" created="Fri, 22 Jan 2010 09:06:26 +0000"  >&lt;p&gt;Can we extend this patch to solve the issue for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1083&quot; title=&quot;allow sub-directories for an external table/partition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1083&quot;&gt;HIVE-1083&lt;/a&gt; as well?&lt;/p&gt;</comment>
                            <comment id="12828329" author="namit" created="Mon, 1 Feb 2010 23:27:45 +0000"  >&lt;p&gt;It would be a good idea to let the user specify a partition on a bunch of files as well.&lt;/p&gt;</comment>
                            <comment id="12828330" author="zshao" created="Mon, 1 Feb 2010 23:29:38 +0000"  >&lt;p&gt;With regex, the user can just give us a list like this: &quot;(file1|file2|file3)&quot;&lt;/p&gt;</comment>
                            <comment id="12828381" author="namit" created="Tue, 2 Feb 2010 01:10:16 +0000"  >&lt;p&gt;I meant:&lt;/p&gt;

&lt;p&gt;alter table T add partition (..) files (regex)&lt;/p&gt;</comment>
                            <comment id="12828772" author="cwsteinbach" created="Tue, 2 Feb 2010 21:32:23 +0000"  >&lt;p&gt;Namit&apos;s suggestion makes sense to me. I will add the ability to specify regex &lt;br/&gt;
filename filters per partition. I will assume that a partition inherits the parent&lt;br/&gt;
table&apos;s filter if it exists and none is specified for the partition. How does that&lt;br/&gt;
sound?&lt;/p&gt;</comment>
                            <comment id="12829944" author="zshao" created="Fri, 5 Feb 2010 03:41:46 +0000"  >&lt;p&gt;Sounds good to me. Can we support multiple-levels as well? (&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;^/&amp;#93;&lt;/span&gt;&lt;b&gt;/&lt;span class=&quot;error&quot;&gt;&amp;#91;^/&amp;#93;&lt;/span&gt;&lt;/b&gt;/.*)&lt;/p&gt;</comment>
                            <comment id="12829947" author="zshao" created="Fri, 5 Feb 2010 03:45:14 +0000"  >&lt;p&gt;If it&apos;s not easy to do, we can still work on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1083&quot; title=&quot;allow sub-directories for an external table/partition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1083&quot;&gt;HIVE-1083&lt;/a&gt; separately by adding a &quot;recursive&quot; property for a table.&lt;/p&gt;</comment>
                            <comment id="12829961" author="zshao" created="Fri, 5 Feb 2010 04:39:31 +0000"  >&lt;p&gt;Hi Carl, please ignore the comment about &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1083&quot; title=&quot;allow sub-directories for an external table/partition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1083&quot;&gt;HIVE-1083&lt;/a&gt; - we can do that by adding a &quot;recursive&quot; boolean attribute to the storage descriptor.&lt;/p&gt;

&lt;p&gt;I assume now we can have 2 partitions of the same external table (or 2 external tables) pointing to the same directory having different filename filters (may overlap in files). Also I assume in the future we want to support tables that are not based on files, e.g., HBase tables.&lt;/p&gt;

&lt;p&gt;Do you agree with these 2 assumptions?&lt;/p&gt;</comment>
                            <comment id="12879143" author="namit" created="Tue, 15 Jun 2010 22:18:38 +0000"  >&lt;p&gt;Different tables which are linked to each other implicitly here and not known to the metastore.&lt;/p&gt;

&lt;p&gt;A house-cleaning operation like :  archive partition or something else, can invalidate this new table.&lt;br/&gt;
Unless we have this, this seems risky&lt;/p&gt;</comment>
                            <comment id="12972324" author="appodictic" created="Fri, 17 Dec 2010 01:08:01 +0000"  >&lt;p&gt;I think this a pretty cool feature but this is very close to symlink input format.&lt;/p&gt;</comment>
                            <comment id="12986664" author="avram" created="Tue, 25 Jan 2011 20:24:03 +0000"  >&lt;p&gt;I am searching for sufficient documentation on symlink input format to construct an example where this functionality would work absent &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-951&quot; title=&quot;Selectively include EXTERNAL TABLE source files via REGEX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-951&quot;&gt;HIVE-951&lt;/a&gt;, but I am not finding docs nor examples. &lt;/p&gt;

&lt;p&gt;Is there documentation on symlink input format for the case where both the symlink file and data bucket is on s3 ? &lt;/p&gt;</comment>
                            <comment id="13253079" author="mengchunzhi@jike.com" created="Fri, 13 Apr 2012 03:31:10 +0000"  >&lt;p&gt;I also think this function is very necessary&#12290;&lt;/p&gt;</comment>
                            <comment id="13748492" author="pandeesh" created="Fri, 23 Aug 2013 12:04:02 +0000"  >&lt;p&gt;Yes This feature will be really useful for loading data from S3.&lt;/p&gt;</comment>
                            <comment id="13748613" author="appodictic" created="Fri, 23 Aug 2013 15:12:16 +0000"  >&lt;p&gt;This is being handle via another jira I think. This will be done via virtual column support. The file name will be a string that can be used as part of a where clause.&lt;/p&gt;</comment>
                            <comment id="13753163" author="indrajeetapache" created="Thu, 29 Aug 2013 01:26:06 +0000"  >&lt;p&gt;CREATE EXTERNAL TABLE allow users to us the table on the top of HDFS , &lt;br/&gt;
Its good feature and it does not look for the path whether it is created or not ,&lt;br/&gt;
After creation of table you can lazily create the path &lt;/p&gt;</comment>
                            <comment id="13753454" author="indrajeetapache" created="Thu, 29 Aug 2013 09:25:51 +0000"  >&lt;p&gt;External table really gives power to use the different tools on top of table . So you can get chance to do data mining. Its really very fast and easy to create&lt;/p&gt;</comment>
                            <comment id="13794404" author="mindstatic1976" created="Mon, 14 Oct 2013 19:56:57 +0000"  >&lt;p&gt;Agreed. I came across this ticket while trying to solve an exactly the same problem. I have got GBs worth of files in a folder in S3, and moving them to individual sub folders is a housekeeping I will gladly trade in favor of an added complexity of CREATE TABLE command.&lt;/p&gt;</comment>
                            <comment id="14278274" author="mandusm" created="Thu, 15 Jan 2015 05:22:41 +0000"  >&lt;p&gt;This patch is no longer working with the Latest version of Hive. &lt;br/&gt;
Has there since been some kind of change in the way that Hive works that will allows us to do this? &lt;/p&gt;</comment>
                            <comment id="15000996" author="rafadaguiar" created="Wed, 11 Nov 2015 20:08:47 +0000"  >&lt;p&gt;Any updates? This would make a lot of sense to work on AWS.&lt;/p&gt;</comment>
                            <comment id="16723408" author="amitban" created="Mon, 17 Dec 2018 21:53:02 +0000"  >&lt;p&gt;This doesn&apos;t seem to work anymore. Was this feature discontinued somewhere as I have the same requirement.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12455384">HIVE-1133</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12474757">HIVE-1662</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12446279">HIVE-1083</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12431011" name="HIVE-951.patch" size="96572" author="cwsteinbach" created="Thu, 21 Jan 2010 07:25:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Nov 2009 06:05:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42674</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08nmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48428</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>external table regex</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-952] Support analytic NTILE function</title>
                <link>https://issues.apache.org/jira/browse/HIVE-952</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The NTILE function divides a set of ordered rows into equally sized buckets and assigns a bucket number to each row.&lt;br/&gt;
Useful for calculating tertiles, quartiles, quintiles, etc.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-sql&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;SELECT&lt;/span&gt; last_name, salary,
NTILE(4) &lt;span class=&quot;code-keyword&quot;&gt;OVER&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;BY&lt;/span&gt; salary &lt;span class=&quot;code-keyword&quot;&gt;DESC&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;AS&lt;/span&gt; quartile
&lt;span class=&quot;code-keyword&quot;&gt;FROM&lt;/span&gt; employees
&lt;span class=&quot;code-keyword&quot;&gt;WHERE&lt;/span&gt; department_id = 100;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12441553">HIVE-952</key>
            <summary>Support analytic NTILE function</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Nov 2009 08:21:03 +0000</created>
                <updated>Wed, 10 Sep 2014 06:58:16 +0000</updated>
                            <resolved>Mon, 8 Sep 2014 08:29:50 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>OLAP</component>
                    <component>Query Processor</component>
                    <component>UDF</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14125300" author="lars_francke" created="Mon, 8 Sep 2014 08:29:50 +0000"  >&lt;p&gt;This has been fixed in the meantime.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                                                <inwardlinks description="is superceded by">
                                        <issuelink>
            <issuekey id="12438744">HIVE-896</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Sep 2014 08:29:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42673</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lcm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122694</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>NTILE analytic function RANK DENSE_RANK</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-953] script_broken_pipe3.q broken</title>
                <link>https://issues.apache.org/jira/browse/HIVE-953</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The negative test script_broken_pipe3.q is broken if we allow partial consumption.&lt;br/&gt;
For now, I have disabled partial consumption. Can you take a look ?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441640">HIVE-953</key>
            <summary>script_broken_pipe3.q broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pauly">Paul Yang</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Nov 2009 05:48:01 +0000</created>
                <updated>Sat, 17 Dec 2011 00:06:16 +0000</updated>
                            <resolved>Tue, 1 Dec 2009 02:37:20 +0000</resolved>
                                    <version>0.5.0</version>
                                    <fixVersion>0.5.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12782581" author="pauly" created="Wed, 25 Nov 2009 19:50:44 +0000"  >&lt;p&gt;Strange, that test is working fine on my end. Inside script_broken_pipe3.q, partial consumption is enabled with a set command, so it should work regardless of what the setting for partial consumption was beforehand. &lt;/p&gt;

&lt;p&gt;However, script_broken_pipe1.q and script_broken_pipe2.q, were written with having partial consumption disabled as per defaults and lack a set command. So those tests should fail if partial consumption is enabled by default - can you check if that is the case?&lt;/p&gt;</comment>
                            <comment id="12782587" author="pauly" created="Wed, 25 Nov 2009 19:55:54 +0000"  >&lt;p&gt;Just to clarify - on my end, script_broken_pipe1.q and script_broken_pipe2.q are failing with partial consumption enabled by default. I wanted to see if that&apos;s the case with your setup.&lt;/p&gt;</comment>
                            <comment id="12782627" author="namit" created="Wed, 25 Nov 2009 21:29:10 +0000"  >&lt;p&gt;They are run as part of negative tests - for me 1/2 are broken as expected - I mean, they dont lead to diffs&lt;/p&gt;

&lt;p&gt;3 as it stood before I changed it yesterday was leading to diffs&lt;/p&gt;</comment>
                            <comment id="12782674" author="pauly" created="Wed, 25 Nov 2009 23:22:06 +0000"  >&lt;p&gt;Could I take a look at your log files? When I say &apos;failed&apos;, I don&apos;t necessarily see diffs - I see something like the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    [junit] Exception: Client Execution failed with error code = 0
    [junit] junit.framework.AssertionFailedError: Client Execution failed with error code = 0
    [junit]     at junit.framework.Assert.fail(Assert.java:47)
    [junit]     at org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_script_broken_pipe2(TestNegativeCliDriver.java:51)
    [junit]     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    [junit]     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    [junit]     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    [junit]     at java.lang.reflect.Method.invoke(Method.java:597)
    [junit]     at junit.framework.TestCase.runTest(TestCase.java:154)
    [junit]     at junit.framework.TestCase.runBare(TestCase.java:127)
    [junit]     at junit.framework.TestResult$1.protect(TestResult.java:106)
    [junit]     at junit.framework.TestResult.runProtected(TestResult.java:124)
    [junit]     at junit.framework.TestResult.run(TestResult.java:109)
    [junit]     at junit.framework.TestCase.run(TestCase.java:118)
    [junit]     at junit.framework.TestSuite.runTest(TestSuite.java:208)
    [junit]     at junit.framework.TestSuite.run(TestSuite.java:203)
    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:420)
    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:911)
    [junit]     at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:768)
    [junit] Tests run: 1, Failures: 1, Errors: 0, Time elapsed: 12.676 sec
    [junit] Test org.apache.hadoop.hive.cli.TestNegativeCliDriver FAILED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12782689" author="namit" created="Thu, 26 Nov 2009 00:03:14 +0000"  >&lt;p&gt;I dont have them anymore - but run with&lt;br/&gt;
test.silent=false&lt;/p&gt;


&lt;p&gt;ant test ..... -Dtest.silent=false&lt;/p&gt;


&lt;p&gt;It will print more info.&lt;/p&gt;
</comment>
                            <comment id="12782720" author="pauly" created="Thu, 26 Nov 2009 01:53:29 +0000"  >&lt;p&gt;With respect to pipe3, I still was not able to produce an error. I&apos;ve attached the output of the test run on my checkout. Can you try running that test again?&lt;/p&gt;

&lt;p&gt;In any case, I&apos;ve fixed the tests for pipe1 and pipe2 to run correctly with partial consumption enabled in the attached patch.&lt;/p&gt;</comment>
                            <comment id="12783939" author="pauly" created="Mon, 30 Nov 2009 23:26:16 +0000"  >&lt;p&gt;Sorry for the confusion - there were changes to the open source repository that weren&apos;t propagated to the FB repository.&lt;/p&gt;

&lt;p&gt;Anyway, the problem is that there was a change to ScriptOperator that broke the test. The change always reported the exit value of the script as 0, meaning that it was always successful. Since the test was expecting the script to fail with an error code, the negative test broke. Removing &apos;set hive.exec.script.allow.partial.consumption = true&apos; allowed the negative test to pass as disallowing partial consumption would result in a broken pipe exception and masked the fact that the error code was incorrect.&lt;/p&gt;

&lt;p&gt;In the 2nd patch, I fixed this and included the modifications for the other two tests as well.&lt;/p&gt;</comment>
                            <comment id="12783981" author="namit" created="Tue, 1 Dec 2009 01:22:04 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;will merge if the tests pass&lt;/p&gt;</comment>
                            <comment id="12784020" author="namit" created="Tue, 1 Dec 2009 02:37:20 +0000"  >&lt;p&gt;Committed. Thanks Paul&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12426175" name="HIVE-953.1.patch" size="2404" author="pauly" created="Thu, 26 Nov 2009 01:54:27 +0000"/>
                            <attachment id="12426469" name="HIVE-953.2.patch" size="3526" author="pauly" created="Mon, 30 Nov 2009 23:26:16 +0000"/>
                            <attachment id="12426174" name="script_broken_pipe3_output.txt" size="73524" author="pauly" created="Thu, 26 Nov 2009 01:54:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Nov 2009 19:50:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73193</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lcmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-954] tmp files created by mapjoin not cleaned up if process is killed</title>
                <link>https://issues.apache.org/jira/browse/HIVE-954</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12441691">HIVE-954</key>
            <summary>tmp files created by mapjoin not cleaned up if process is killed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Nov 2009 17:08:50 +0000</created>
                <updated>Sat, 17 Dec 2011 00:06:15 +0000</updated>
                            <resolved>Thu, 17 Dec 2009 23:17:31 +0000</resolved>
                                                    <fixVersion>0.5.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12792211" author="namit" created="Thu, 17 Dec 2009 23:17:31 +0000"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-954&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-954&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73192</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lcmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122696</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-955] Passing columns needed onto ColumnarStruct</title>
                <link>https://issues.apache.org/jira/browse/HIVE-955</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This can avoid unneeded loop cycle in ColumnarStruct&apos;s init method. This can saves a lot when the table&apos;s column number is big.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441800">HIVE-955</key>
            <summary>Passing columns needed onto ColumnarStruct</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Nov 2009 00:24:44 +0000</created>
                <updated>Wed, 20 Apr 2011 23:58:15 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12783043" author="namit" created="Fri, 27 Nov 2009 06:43:09 +0000"  >&lt;p&gt;Can you add more comments - I am not sure I understand this change&lt;/p&gt;</comment>
                            <comment id="12783786" author="he yongqiang" created="Mon, 30 Nov 2009 18:46:22 +0000"  >&lt;p&gt;The basic idea is to pass column needed into ColumnarStruct, and let the init method of ColumnarStruct only init those columns. The columns needed by the query is stored in TBS, so we need to get them out and set into the configuration. We did that when we call getRecordReader, where we clone a conf, and set column ids into the conf, and then pass the conf into native RecordReader. We need to do it over again when we init the operator tree. At this time, we need to pass a conf with these column information into the serde layer. &lt;/p&gt;

&lt;p&gt;thanks, Namit!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12426255" name="ColumnarStruct_columnids_2009-11-25.2.patch" size="6030" author="he yongqiang" created="Fri, 27 Nov 2009 00:25:13 +0000"/>
                            <attachment id="12426438" name="hive-955-2009-11-30.patch" size="6350" author="he yongqiang" created="Mon, 30 Nov 2009 18:46:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 27 Nov 2009 06:43:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08n53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48348</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-956] Add support of columnar binary serde</title>
                <link>https://issues.apache.org/jira/browse/HIVE-956</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12441801">HIVE-956</key>
            <summary>Add support of columnar binary serde</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="n_krishna_kumar">Krishna Kumar</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Nov 2009 00:26:33 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:53 +0000</updated>
                            <resolved>Tue, 26 Jul 2011 03:22:58 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13041501" author="n_krishna_kumar" created="Tue, 31 May 2011 09:37:09 +0000"  >&lt;p&gt;Initial patch for lazy binary columnar serde. Reuses elements of columnar serde and lazy binary serde. &lt;/p&gt;
</comment>
                            <comment id="13041502" author="n_krishna_kumar" created="Tue, 31 May 2011 09:41:27 +0000"  >&lt;p&gt;Initial patch for lazy binary columnar serde. Reuses elements of columnar serde and lazy binary serde. &lt;/p&gt;

&lt;p&gt;I used 0-length value for null indicator for all types (columnar uses a special sequence, lazybinary uses a byte for every 8 fields), but this meant that to distinguish empty strings, I need to encode string length as part of the serialized data, which then causes an additional cost for every string. Because of this, the results of this serialization did not impress on a specific dataset I used for testing. Thoughts?  &lt;/p&gt;</comment>
                            <comment id="13041505" author="jiraposter@reviews.apache.org" created="Tue, 31 May 2011 09:51:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/806/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add LazyBinaryColumnarSerDe&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; title=&quot;Add support of columnar binary serde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-956&quot;&gt;&lt;del&gt;HIVE-956&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-956&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 77a6dc6 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStruct.java b062460 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStructBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarSerDe.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarStruct.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFactory.java e927547 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObject.java 2e2896c &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObjectBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryFactory.java 1440472 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryObject.java ea20b34 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinarySerDe.java 5e6bb0a &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ColumnarStructObjectInspector.java 66f4f8d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/CrossMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/MapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java 90561a1 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2b77072 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/SimpleMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/test/org/apache/hadoop/hive/serde2/columnar/TestLazyBinaryColumnarSerDe.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/806/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tests added&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Krishna&lt;/p&gt;
</comment>
                            <comment id="13041506" author="n_krishna_kumar" created="Tue, 31 May 2011 09:52:24 +0000"  >&lt;p&gt;Review board: &lt;a href=&quot;https://reviews.apache.org/r/806/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13042721" author="n_krishna_kumar" created="Thu, 2 Jun 2011 11:55:42 +0000"  >&lt;p&gt;Patch with a change on how null vs empty strings are handled. This patch uses a special single-byte marker (which is not a valid utf-8 byte sequence) to mark empty strings. With this patch, this serde is better than the default serde&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for all primitive types&lt;/li&gt;
	&lt;li&gt;also when null values preponderate&lt;br/&gt;
while performing about the same for complex structures such as list of structs et al. Please review.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13042723" author="jiraposter@reviews.apache.org" created="Thu, 2 Jun 2011 12:00:48 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/806/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-02 12:00:23.653491)&lt;/p&gt;


&lt;p&gt;Review request for hive and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Uses a special marker for empty strings, thereby incurring no additional cost for normal (non-null, non-empty) strings.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add LazyBinaryColumnarSerDe&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; title=&quot;Add support of columnar binary serde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-956&quot;&gt;&lt;del&gt;HIVE-956&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-956&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 77a6dc6 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStruct.java b062460 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStructBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarSerDe.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarStruct.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFactory.java e927547 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObject.java 2e2896c &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObjectBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryFactory.java 1440472 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryObject.java ea20b34 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinarySerDe.java 5e6bb0a &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ColumnarStructObjectInspector.java 66f4f8d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/CrossMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/MapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java 90561a1 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2b77072 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/SimpleMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/test/org/apache/hadoop/hive/serde2/columnar/TestLazyBinaryColumnarSerDe.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/806/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tests added&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Krishna&lt;/p&gt;
</comment>
                            <comment id="13044968" author="he yongqiang" created="Mon, 6 Jun 2011 17:23:30 +0000"  >&lt;p&gt;will take a look.&lt;/p&gt;</comment>
                            <comment id="13045839" author="he yongqiang" created="Wed, 8 Jun 2011 08:38:10 +0000"  >&lt;p&gt;i got one conflict when trying to apply this patch to my local. Can you rebase?&lt;/p&gt;

&lt;p&gt;a few minor comments:&lt;br/&gt;
1. is getLength() only for null check? if yes, can you call it &apos;isNull()&apos;? And if the only difference in ColumnarStruct and BinaryColumnarStruct is null check, just curious, how difficult is it to avoid this new BinaryColumnarStruct class?&lt;br/&gt;
2. can you add a &apos;toString()&apos; for new binary columnar serde, just the same as columnar serde&lt;br/&gt;
3. why do you need to handle empty string specially? &quot;serializeStream.write(INVALID_UTF__SINGLE_BYTE, 0, 1);&quot; i thought for empty data, we just store data length 0 in rcfile.&lt;br/&gt;
I thought since there is no NULLSequence in the new serde, the null should be handled specially.  i am missing sth, How do you handle null here?&lt;br/&gt;
4. can LazyBinaryColumnarSerDe share some code with LazyBinarySerde?&lt;br/&gt;
5. how warnedOnceNullMapKey is used? &lt;br/&gt;
originally the map comparison is not supported, but this patch added a mapEqualComparer. can we put this in a separate patch? It seems the logic in CrossMapEqualComparer is not correct. (how do you make sure you will get the keys from a map in some kind of same order?)&lt;/p&gt;


&lt;p&gt;Thanks for this great work! Pls resubmit the patch after rebase&lt;/p&gt;</comment>
                            <comment id="13046039" author="jiraposter@reviews.apache.org" created="Wed, 8 Jun 2011 16:04:58 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/806/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-08 16:04:08.811137)&lt;/p&gt;


&lt;p&gt;Review request for hive and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updating review comments re toString()&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add LazyBinaryColumnarSerDe&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; title=&quot;Add support of columnar binary serde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-956&quot;&gt;&lt;del&gt;HIVE-956&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-956&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 77a6dc6 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStruct.java e79021d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStructBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarSerDe.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarStruct.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFactory.java e927547 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObject.java 2e2896c &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObjectBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryFactory.java 1440472 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryObject.java ea20b34 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinarySerDe.java 4285ab3 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ColumnarStructObjectInspector.java 66f4f8d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/CrossMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/MapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java 90561a1 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2b77072 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/SimpleMapEqualComparer.java PRE-CREATION &lt;br/&gt;
  serde/src/test/org/apache/hadoop/hive/serde2/columnar/TestLazyBinaryColumnarSerDe.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/806/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tests added&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Krishna&lt;/p&gt;
</comment>
                            <comment id="13046040" author="n_krishna_kumar" created="Wed, 8 Jun 2011 16:08:24 +0000"  >&lt;p&gt;Re-ordering my responses;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;can LazyBinaryColumnarSerDe share some code with LazyBinarySerde?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	Yes, it does. For instance, the serialization of LazyBinaryColumnarSerde forwards to LazyBinarySerde.serialize for each field (except for one special case of empty string described below). Similarly the deserialization happens in both cases eventually via LazyBinaryXXX.init. The objectinspector is the same, while the common parts of the object class (ColumnarStruct and BinaryColumnarStruct) has been refactored into a ColumnarStructBase class.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;how warnedOnceNullMapKey is used?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	To enable the above (reuse of LazyBinarySerde.serialize()), I have made it a static method of LazyBinarySerde. The only member variable which was used in that method was a boolean which was used to issue a LOG warning the first time a null map key is encountered. So, I made that into a parameter so that the existing behaviour for LazyBinarySerde is unchanged (that is a warning is issued once per instance).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;why do you need to handle empty string specially? &quot;serializeStream.write(INVALID_UTF__SINGLE_BYTE, 0, 1);&quot; i thought for empty data, we just store data length 0 in rcfile. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I thought since there is no NULLSequence in the new serde, the null should be handled specially.  i am missing sth, How do you handle null here?	&lt;/p&gt;

&lt;p&gt;	As you know, column values&apos; length are stored in the key part of rcfile (after run-length encoding, and an optional compressing). A 0 in this recorded length is used as the null indicator. This means that non-null values should occupy one or more bytes when serialized. That was ok with the original LazyBinarySerde.serialize, as primitive numeric types, strings (with their datalength) and complex types (with their datalength) do occupy non-zero bytes. But this is too much redundancy and overhead for the typical case (non-empty strings), so I added an extra parameter &quot;skipLengthPrefix&quot; which skips prefixing string/list/map/struct types with a length prefix. But with this, empty strings become a problem since they need to differentiated from nulls. So I used this special single-byte marker for denoting empty strings. (As a side note, for completeness&apos; sake, I should point out that an instance of a struct which has no fields will be encoded with zero bytes. But this is not allowed by the language so I think we are fine here.)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;is getLength() only for null check? if yes, can you call it &apos;isNull()&apos;? And if the only difference in ColumnarStruct and BinaryColumnarStruct is null check, just curious, how difficult is it to avoid this new BinaryColumnarStruct class?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	See above. In general, the length recorded in the key part of rcfile reflects the length of the bytesequence with which the lazyobject should be initialized. The only exception is in the case of empty strings, where the recorded length is 1 (the special marker), but the lazyobject needs be initialized with a 0-length byte sequence. 	&lt;/p&gt;

&lt;p&gt;	Recorded length being 0 indicates nulls for lazybinarycolumnar and data being the nullsequence indicates null for lazybinary. The difference between ColumnarStruct and BinaryColumnarStruct is this length/null handling, and the object creation itself, which are now the abstract methods of the common base class.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;originally the map comparison is not supported, but this patch added a mapEqualComparer. can we put this in a separate patch? It seems the logic in CrossMapEqualComparer is not correct. (how do you make sure you will get the keys from a map in some kind of same order?)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	I put this in this patch since I needed that for the tests that I had added. Do you think I should create a dependant jira and extract this part of the patch to that jira?&lt;/p&gt;

&lt;p&gt;	Hmm, the logic in crossmapequalcomparer looks ok to me (given the caveats mentioned in the javadoc about broken transitivity of greater-than/less-than.) I am not accessing the keys in tandem, but in a nested loop. Since the number of keys are the same, and the keys are unique, both keys and values matching (as declared by ObjectInspectorUtils.compare) is taken as a match for that pair of key-value pairs.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;can you add a &apos;toString()&apos; for new binary columnar serde, just the same as columnar serde&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	Done, and patch regenerated after rebasing.&lt;/p&gt;</comment>
                            <comment id="13046043" author="n_krishna_kumar" created="Wed, 8 Jun 2011 16:09:50 +0000"  >&lt;p&gt;Re-ordering my responses;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;can LazyBinaryColumnarSerDe share some code with LazyBinarySerde?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	Yes, it does. For instance, the serialization of LazyBinaryColumnarSerde forwards to LazyBinarySerde.serialize for each field (except for one special case of empty string described below). Similarly the deserialization happens in both cases eventually via LazyBinaryXXX.init. The objectinspector is the same, while the common parts of the object class (ColumnarStruct and BinaryColumnarStruct) has been refactored into a ColumnarStructBase class.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;how warnedOnceNullMapKey is used?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	To enable the above (reuse of LazyBinarySerde.serialize()), I have made it a static method of LazyBinarySerde. The only member variable which was used in that method was a boolean which was used to issue a LOG warning the first time a null map key is encountered. So, I made that into a parameter so that the existing behaviour for LazyBinarySerde is unchanged (that is a warning is issued once per instance).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;why do you need to handle empty string specially? &quot;serializeStream.write(INVALID_UTF__SINGLE_BYTE, 0, 1);&quot; i thought for empty data, we just store data length 0 in rcfile. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I thought since there is no NULLSequence in the new serde, the null should be handled specially.  i am missing sth, How do you handle null here?	&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	As you know, column values&apos; length are stored in the key part of rcfile (after run-length encoding, and an optional compressing). A 0 in this recorded length is used as the null indicator. This means that non-null values should occupy one or more bytes when serialized. That was ok with the original LazyBinarySerde.serialize, as primitive numeric types, strings (with their datalength) and complex types (with their datalength) do occupy non-zero bytes. But this is too much redundancy and overhead for the typical case (non-empty strings), so I added an extra parameter &quot;skipLengthPrefix&quot; which skips prefixing string/list/map/struct types with a length prefix. But with this, empty strings become a problem since they need to differentiated from nulls. So I used this special single-byte marker for denoting empty strings. (As a side note, for completeness&apos; sake, I should point out that an instance of a struct which has no fields will be encoded with zero bytes. But this is not allowed by the language so I think we are fine here.)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;is getLength() only for null check? if yes, can you call it &apos;isNull()&apos;? And if the only difference in ColumnarStruct and BinaryColumnarStruct is null check, just curious, how difficult is it to avoid this new BinaryColumnarStruct class?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	See above. In general, the length recorded in the key part of rcfile reflects the length of the bytesequence with which the lazyobject should be initialized. The only exception is in the case of empty strings, where the recorded length is 1 (the special marker), but the lazyobject needs be initialized with a 0-length byte sequence. 	&lt;/p&gt;

&lt;p&gt;	Recorded length being 0 indicates nulls for lazybinarycolumnar and data being the nullsequence indicates null for lazybinary. The difference between ColumnarStruct and BinaryColumnarStruct is this length/null handling, and the object creation itself, which are now the abstract methods of the common base class.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;originally the map comparison is not supported, but this patch added a mapEqualComparer. can we put this in a separate patch? It seems the logic in CrossMapEqualComparer is not correct. (how do you make sure you will get the keys from a map in some kind of same order?)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	I put this in this patch since I needed that for the tests that I had added. Do you think I should create a dependant jira and extract this part of the patch to that jira?&lt;/p&gt;

&lt;p&gt;	Hmm, the logic in crossmapequalcomparer looks ok to me (given the caveats mentioned in the javadoc about broken transitivity of greater-than/less-than.) I am not accessing the keys in tandem, but in a nested loop. Since the number of keys are the same, and the keys are unique, both keys and values matching (as declared by ObjectInspectorUtils.compare) is taken as a match for that pair of key-value pairs.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;can you add a &apos;toString()&apos; for new binary columnar serde, just the same as columnar serde&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;	Done, and patch regenerated after rebasing.&lt;/p&gt;</comment>
                            <comment id="13046355" author="he yongqiang" created="Thu, 9 Jun 2011 06:12:58 +0000"  >&lt;p&gt;Maybe i can be more specific,&lt;/p&gt;


&lt;p&gt;LazyBinaryColumnarSerDe and LazyBinarySerde share a lot of code when doing serialization. can warnedOnceNullMapKey be removed?&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;A 0 in this recorded length is used as the null indicator.&lt;br/&gt;
A 0 should mean an empty string. &apos;\N&apos; means null in Hive. Can you take a look at how LazyBinarySerde handles null value, and do the same thing here?&lt;/p&gt;

&lt;p&gt;I prefer to remove getLength(), it will make the code more clean. In the implementation, it is actually only checks for primitives, which actually can produce wrong results.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt;Do you think I should create a dependant jira and extract this part of the patch to that jira?&lt;br/&gt;
Yes, pls do that.&lt;/p&gt;
</comment>
                            <comment id="13046362" author="n_krishna_kumar" created="Thu, 9 Jun 2011 07:01:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;can warnedOnceNullMapKey be removed?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is easy to remove warnedOnceNullMapKey&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if it is ok to log a warning message every time a null map key is encountered&lt;/li&gt;
	&lt;li&gt;if it is ok to log a warning message only once per process execution (by making it a class static)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The current behavior is to log a warning message once per instance of LazyBinarySerde. If we want to retain the same behavior, it should either be a parameter? (or more complicated mechanisms as callback/thread-local)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A 0 should mean an empty string. &apos;\N&apos; means null in Hive. Can you take a look at how LazyBinarySerde handles null value, and do the same thing here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not sure I understand. The serde is free to implement the mechanism to encode null/empty values anyway it sees fit? &apos;\N&apos; means null only in the context of specific serde - for instance columnar serde. Lazybinaryserde uses a null byte for every 8 fields to encode nulls, (and a string length as part of the data for encoding empty strings). IMO, neither of these options is best suited for lazybinarycolumnar, the former as it means escaping complexities, and the latter as the storage is now by columns, not by rows. I have taken the approach that a 0-length column cell value indicates nulls (nulls being a very common case, should have minimal overheads.). For empty strings, while the option to encode string length as part of the cell value is still an option, I think that is too much overhead (as shown in my tests for the same specific dataset) for the non-empty cells. &lt;/p&gt;

&lt;p&gt;The implementation is fine, I think. It first checks whether the field is a primitive (for non-primitives, input byte stream length is also the data length), and then on the field is a string of length 1 with the value being the special marker etc.&lt;/p&gt;

&lt;p&gt;will do the mapequalcomparer splitting.&lt;/p&gt;</comment>
                            <comment id="13051219" author="franklinhu" created="Fri, 17 Jun 2011 17:51:07 +0000"  >&lt;p&gt;I&apos;ve been doing some testing with this patch and it seems that tables using LazyBinaryColumnarSerDe are not outputting the rawDataSize stat that &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2185&quot; title=&quot;extend table statistics to store the size of uncompressed data (+extend interfaces for collecting other types of statistics)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2185&quot;&gt;&lt;del&gt;HIVE-2185&lt;/del&gt;&lt;/a&gt; added (setting that field to 0).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2185&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2185&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13051962" author="jiraposter@reviews.apache.org" created="Mon, 20 Jun 2011 12:57:47 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/806/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-06-20 12:56:38.943799)&lt;/p&gt;


&lt;p&gt;Review request for hive and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;After separating out mapcomparer changes to its own patch&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add LazyBinaryColumnarSerDe&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; title=&quot;Add support of columnar binary serde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-956&quot;&gt;&lt;del&gt;HIVE-956&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-956&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 77a6dc6 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStruct.java e79021d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStructBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarSerDe.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarStruct.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFactory.java e927547 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObject.java 2e2896c &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObjectBase.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryFactory.java 1440472 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryObject.java ea20b34 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinarySerDe.java 4285ab3 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ColumnarStructObjectInspector.java 66f4f8d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java 90561a1 &lt;br/&gt;
  serde/src/test/org/apache/hadoop/hive/serde2/columnar/TestLazyBinaryColumnarSerDe.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/806/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/806/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tests added&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Krishna&lt;/p&gt;
</comment>
                            <comment id="13051963" author="n_krishna_kumar" created="Mon, 20 Jun 2011 12:58:06 +0000"  >&lt;p&gt;After separating mapcomparer changes to its own jira/patch - &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2209&quot; title=&quot;Provide a way by which ObjectInspectorUtils.compare can be extended by the caller for comparing maps which are part of the object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2209&quot;&gt;&lt;del&gt;HIVE-2209&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13051966" author="n_krishna_kumar" created="Mon, 20 Jun 2011 13:00:21 +0000"  >&lt;p&gt;I have tested the setting of rawDataSize with a &quot;ANALYZE TABLE COMPUTE STATISTICS&quot;/&quot;DESCRIBE FORMATTED&quot; set of commands with this patch, and it works. Can you please check it again? Please note that you need to apply the patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2209&quot; title=&quot;Provide a way by which ObjectInspectorUtils.compare can be extended by the caller for comparing maps which are part of the object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2209&quot;&gt;&lt;del&gt;HIVE-2209&lt;/del&gt;&lt;/a&gt; before applying the patch from this one, since this jira is dependent on that one.&lt;/p&gt;</comment>
                            <comment id="13067345" author="franklinhu" created="Mon, 18 Jul 2011 22:02:04 +0000"  >&lt;p&gt;@Krishna looks like it works now with some simple tests&lt;/p&gt;</comment>
                            <comment id="13067453" author="he yongqiang" created="Tue, 19 Jul 2011 02:22:53 +0000"  >&lt;p&gt;The patch looks good. One minor comments about LazyBinaryColumnarSerDe is that could some code be moved to some utils or some base class to share with ColumnarSerDe and/or LazyBinarySerde?&lt;/p&gt;

&lt;p&gt;Can you confirm that it is safe to remove &apos;nullSequence&apos; from ColumnarStructObjectInspector and ObjectInspectorFactory?&lt;/p&gt;</comment>
                            <comment id="13067587" author="n_krishna_kumar" created="Tue, 19 Jul 2011 09:02:35 +0000"  >&lt;p&gt;Please note that &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2209&quot; title=&quot;Provide a way by which ObjectInspectorUtils.compare can be extended by the caller for comparing maps which are part of the object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2209&quot;&gt;&lt;del&gt;HIVE-2209&lt;/del&gt;&lt;/a&gt; is a pre-requisite for this patch.&lt;/p&gt;</comment>
                            <comment id="13067588" author="n_krishna_kumar" created="Tue, 19 Jul 2011 09:06:22 +0000"  >&lt;p&gt;Common code moved to a base class to that columnarserde and LazyBinaryColumnarSerDe share it. &lt;/p&gt;

&lt;p&gt;Yes. The object inspector itself had no use for the null sequence. The ColumnarStruct itself knows the nullSequence and uses it as required.&lt;/p&gt;

&lt;p&gt;Have not run a complete test on this patch.&lt;/p&gt;</comment>
                            <comment id="13070839" author="he yongqiang" created="Mon, 25 Jul 2011 22:46:02 +0000"  >&lt;p&gt;+1, looks good, will commit after tests pass.&lt;/p&gt;</comment>
                            <comment id="13070917" author="he yongqiang" created="Tue, 26 Jul 2011 03:22:58 +0000"  >&lt;p&gt;committed, thanks Krishna Kumar!&lt;/p&gt;</comment>
                            <comment id="13071016" author="hudson" created="Tue, 26 Jul 2011 09:11:10 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #849 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/849/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/849/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-956&quot; title=&quot;Add support of columnar binary serde&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-956&quot;&gt;&lt;del&gt;HIVE-956&lt;/del&gt;&lt;/a&gt;: add support of columnar binary serde (Krishna Kumar via He Yongqiang)&lt;/p&gt;

&lt;p&gt;heyongqiang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1150978&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1150978&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDe.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinarySerDe.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ColumnarStructObjectInspector.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStruct.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObjectBase.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarSerDeBase.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarStruct.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/columnar&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazySimpleSerDe.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/LazyBinaryColumnarSerDe.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/columnar/ColumnarStructBase.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/columnar/TestLazyBinaryColumnarSerDe.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyObject.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazybinary/LazyBinaryObject.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12483152" name="HIVE-956v3.patch" size="66441" author="n_krishna_kumar" created="Mon, 20 Jun 2011 12:58:06 +0000"/>
                            <attachment id="12486981" name="HIVE-956v4.patch" size="75641" author="n_krishna_kumar" created="Tue, 19 Jul 2011 09:02:35 +0000"/>
                            <attachment id="12480920" name="HIVE.956.patch.0" size="72813" author="n_krishna_kumar" created="Tue, 31 May 2011 09:37:09 +0000"/>
                            <attachment id="12481222" name="HIVE.956.patch.1" size="73419" author="n_krishna_kumar" created="Thu, 2 Jun 2011 11:55:42 +0000"/>
                            <attachment id="12481830" name="HIVE.956.patch.2" size="74732" author="n_krishna_kumar" created="Wed, 8 Jun 2011 16:08:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 31 May 2011 09:37:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66867</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lcmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-957] Partition Metadata and Table Metadata</title>
                <link>https://issues.apache.org/jira/browse/HIVE-957</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Right now, we choose to use partition lever metadata. All metadata (column names, column types, fileformat, serde class, serde properties) right now are from partition level metadata. But hive does not support a method now to alter all existing partitions&apos; metadata, so users mostly choose to alter table metadata, and think hive will use the new  table level metadata. &lt;br/&gt;
One approach is that we may need to provide a way to let user alter all partitions&apos; metadata with one simple command. Right now a short term solution is to only get fileformat, serde class metadata from paritition level metadata, and use all other metadata from table.&lt;/p&gt;

&lt;p&gt;any comments?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12442003">HIVE-957</key>
            <summary>Partition Metadata and Table Metadata</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Nov 2009 22:37:46 +0000</created>
                <updated>Sat, 17 Dec 2011 00:06:12 +0000</updated>
                            <resolved>Tue, 1 Dec 2009 06:25:42 +0000</resolved>
                                                    <fixVersion>0.5.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12783946" author="zshao" created="Mon, 30 Nov 2009 23:42:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;Right now, we choose to use partition lever metadata. All metadata (column names, column types, fileformat, serde class, serde properties) right now are from partition level metadata. But hive does not support a method now to alter all existing partitions&apos; metadata, so users mostly choose to alter table metadata, and think hive will use the new table level metadata.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In our environment, we have been seeing users calling &quot;alter table&quot; on table-level meta data to:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Replace the column separator for all partitions (because they created the table with wrong separator)&lt;/li&gt;
	&lt;li&gt;Append additional columns&lt;/li&gt;
	&lt;li&gt;Rename existing columns&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12783950" author="prasadc" created="Mon, 30 Nov 2009 23:59:11 +0000"  >&lt;p&gt;it is not that much code to write a new command to alter all the partitions. the metadata calls already exist, only grammar needs to be enhanced.&lt;/p&gt;</comment>
                            <comment id="12783966" author="he yongqiang" created="Tue, 1 Dec 2009 00:36:12 +0000"  >&lt;p&gt;upload a quick fix to let hive always get column names, column types, serde parameters from table metadata. And get others from partition level metadata. &lt;/p&gt;

&lt;p&gt;Agree with Prasad, we should support a command to alter all partitions&apos; metadata. But is there a need to maintain partition metadata for column names, column types? &lt;/p&gt;</comment>
                            <comment id="12783988" author="namit" created="Tue, 1 Dec 2009 01:29:43 +0000"  >&lt;p&gt;Unless we change the query plan to work with different partitions - why should we allow the user to change the partition metadata ?&lt;br/&gt;
Agreed, it will work for some cases (file format, separator etc,), but it will not work for others (columns).&lt;/p&gt;

&lt;p&gt;Anyway, the patch looks good to me. But, I don&apos;t see the problem it is solving.&lt;/p&gt;</comment>
                            <comment id="12783996" author="zshao" created="Tue, 1 Dec 2009 01:39:37 +0000"  >&lt;p&gt;A. Replace the column separator for all partitions (because they created the table with wrong separator)&lt;br/&gt;
Users need to change partition metadata.&lt;/p&gt;

&lt;p&gt;B. Append additional columns&lt;br/&gt;
In the long term, users don&apos;t want to change partition metadata for this - We should fix Hive execution time to support missing columns (returning NULL) ( S1: Currently Hive execution time will output an error if the column in the expression is missing from the row object)&lt;/p&gt;

&lt;p&gt;C. Rename existing columns&lt;br/&gt;
Users need to change partition metadata.&lt;/p&gt;


&lt;p&gt;This patch will solve the problem caused by the following 3 items:&lt;br/&gt;
1. &quot;S1&quot; above&lt;br/&gt;
2. Hive execution time using partition metadata&lt;br/&gt;
3. User append additional columns by changing table metadata only&lt;/p&gt;</comment>
                            <comment id="12784009" author="namit" created="Tue, 1 Dec 2009 02:06:43 +0000"  >&lt;p&gt;OK - but can you add a new test :&lt;/p&gt;

&lt;p&gt;create table T &amp;#8211; 3 cols&lt;br/&gt;
create partition P1 --&amp;gt; will have 3 columns&lt;br/&gt;
alter table T add column 4&lt;br/&gt;
create partition P4 --&amp;gt; will have 4 columns&lt;/p&gt;


&lt;p&gt;select c1,c2,c3,c4 from T (include both P1 and P2).&lt;/p&gt;
</comment>
                            <comment id="12784013" author="he yongqiang" created="Tue, 1 Dec 2009 02:22:38 +0000"  >&lt;p&gt;Added a testcase for it. &lt;/p&gt;</comment>
                            <comment id="12784018" author="namit" created="Tue, 1 Dec 2009 02:34:12 +0000"  >&lt;p&gt;In the new test, can you drop the table that you created at the end ?&lt;/p&gt;</comment>
                            <comment id="12784024" author="he yongqiang" created="Tue, 1 Dec 2009 02:54:14 +0000"  >&lt;p&gt; Added the drop statement in the new patch. Thanks, Namit!&lt;/p&gt;</comment>
                            <comment id="12784080" author="namit" created="Tue, 1 Dec 2009 06:25:42 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12440347">HIVE-922</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12440347">HIVE-922</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12426488" name="hive-957-2009-11-30-2.patch" size="387723" author="he yongqiang" created="Tue, 1 Dec 2009 02:22:38 +0000"/>
                            <attachment id="12426490" name="hive-957-2009-11-30-3.patch" size="387951" author="he yongqiang" created="Tue, 1 Dec 2009 02:54:14 +0000"/>
                            <attachment id="12426475" name="hive-957-2009-11-30.patch" size="367363" author="he yongqiang" created="Tue, 1 Dec 2009 00:36:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 Nov 2009 23:42:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73191</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lcn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122698</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
