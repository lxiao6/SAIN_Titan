<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:18:43 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2011-8-3+AND+created+%3C%3D+2011-8-10+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="27" total="27"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-2337] Predicate pushdown erroneously conservative with outer joins</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2337</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The predicate pushdown filter is not applying left associativity of joins correctly in determining possible aliases for pushing predicates.&lt;/p&gt;

&lt;p&gt;In hive.ql.ppd.OpProcFactory.JoinPPD.getQualifiedAliases, the criteria for pushing aliases is specified as:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    /**
     * Figures out the aliases for whom it is safe to push predicates based on
     * ANSI SQL semantics For inner join, all predicates for all aliases can be
     * pushed For full outer join, none of the predicates can be pushed as that
     * would limit the number of rows for join For left outer join, all the
     * predicates on the left side aliases can be pushed up For right outer
     * join, all the predicates on the right side aliases can be pushed up Joins
     * chain containing both left and right outer joins are treated as full
     * outer join. [...]
     *
     * @param op
     *          Join Operator
     * @param rr
     *          Row resolver
     * @return set of qualified aliases
     */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since hive joins are left associative, something like &quot;a RIGHT OUTER JOIN b LEFT OUTER JOIN c&#160;INNER JOIN d&quot; should be interpreted as &quot;((a RIGHT OUTER JOIN b) LEFT OUTER JOIN c) INNER JOIN d&quot;, so there would be cases where joins with both left and right outer joins can have aliases that can be pushed.  Here, aliases b and d are eligible to be pushed up while the current criteria provide that none are eligible.&lt;/p&gt;

&lt;p&gt;Using:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create table t1 (id int, key string, value string);
create table t2 (id int, key string, value string);
create table t3 (id int, key string, value string);
create table t4 (id int, key string, value string);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, the query&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 full outer join t2 on t1.id=t2.id join t3 on t2.id=t3.id where t3.id=20; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;currently gives&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        t1 
          TableScan
            alias: t1
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 0
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t2 
          TableScan
            alias: t2
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 1
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t3 
          TableScan
            alias: t3
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 2
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
               Inner Join 1 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            1 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            2 {VALUE._col0} {VALUE._col1} {VALUE._col2}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col5, _col6, _col7, _col10, _col11, _col12
          Filter Operator
            predicate:
                expr: (_col10 = 20)
                type: boolean
            Select Operator
              expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col5
                    type: int
                    expr: _col6
                    type: string
                    expr: _col7
                    type: string
                    expr: _col10
                    type: int
                    expr: _col11
                    type: string
                    expr: _col12
                    type: string
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while the correct behavior is to push the filter &quot;t3.id=20&quot; down:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        t1 
          TableScan
            alias: t1
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 0
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t2 
          TableScan
            alias: t2
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 1
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t3 
          TableScan
            alias: t3
            Filter Operator
              predicate:
                  expr: (id = 20)
                  type: boolean
              Reduce Output Operator
                key expressions:
                      expr: id
                      type: int
                sort order: +
                Map-reduce partition columns:
                      expr: id
                      type: int
                tag: 2
                value expressions:
                      expr: id
                      type: int
                      expr: key
                      type: string
                      expr: value
                      type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
               Inner Join 1 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            1 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            2 {VALUE._col0} {VALUE._col1} {VALUE._col2}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col5, _col6, _col7, _col10, _col11, _col12
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col1
                  type: string
                  expr: _col2
                  type: string
                  expr: _col5
                  type: int
                  expr: _col6
                  type: string
                  expr: _col7
                  type: string
                  expr: _col10
                  type: int
                  expr: _col11
                  type: string
                  expr: _col12
                  type: string
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The current behavior is actually stranger than this: for a left outer join (similarly for a right outer join), hive finds the leftmost alias referred to in the &lt;b&gt;predicates&lt;/b&gt; of left outer joins and rejects any alias to the right of it for pushdown.  So in this query the filter &quot;t2.id=20&quot; pushed down:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 join t2 on (t1.id=t2.id) left outer join t3 on (t2.id=t3.id) where t2.id=20;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while it isn&apos;t here:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 join t2 on (t1.id=t2.id) left outer join t3 on (t1.id=t3.id) where t2.id=20;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12517731">HIVE-2337</key>
            <summary>Predicate pushdown erroneously conservative with outer joins</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="charleschen">Charles Chen</assignee>
                                    <reporter username="charleschen">Charles Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 01:16:09 +0000</created>
                <updated>Mon, 16 Dec 2013 11:38:19 +0000</updated>
                            <resolved>Fri, 2 Sep 2011 03:27:43 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13078551" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 01:22:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Initial patch&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1153293 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13078688" author="amareshwari" created="Wed, 3 Aug 2011 10:43:43 +0000"  >&lt;p&gt;Charles, Can you add a test case including explain plans?&lt;/p&gt;</comment>
                            <comment id="13078906" author="charleschen" created="Wed, 3 Aug 2011 18:31:58 +0000"  >&lt;p&gt;Using:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;create table t1 (id int, key string, value string);
create table t2 (id int, key string, value string);
create table t3 (id int, key string, value string);
create table t4 (id int, key string, value string);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example, the query&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 full outer join t2 on t1.id=t2.id join t3 on t2.id=t3.id where t3.id=20; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;currently gives&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        t1 
          TableScan
            alias: t1
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 0
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t2 
          TableScan
            alias: t2
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 1
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t3 
          TableScan
            alias: t3
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 2
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
               Inner Join 1 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            1 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            2 {VALUE._col0} {VALUE._col1} {VALUE._col2}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col5, _col6, _col7, _col10, _col11, _col12
          Filter Operator
            predicate:
                expr: (_col10 = 20)
                type: boolean
            Select Operator
              expressions:
                    expr: _col0
                    type: int
                    expr: _col1
                    type: string
                    expr: _col2
                    type: string
                    expr: _col5
                    type: int
                    expr: _col6
                    type: string
                    expr: _col7
                    type: string
                    expr: _col10
                    type: int
                    expr: _col11
                    type: string
                    expr: _col12
                    type: string
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while the correct behavior is to push the filter &quot;t3.id=20&quot; down:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -&amp;gt; Map Operator Tree:
        t1 
          TableScan
            alias: t1
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 0
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t2 
          TableScan
            alias: t2
            Reduce Output Operator
              key expressions:
                    expr: id
                    type: int
              sort order: +
              Map-reduce partition columns:
                    expr: id
                    type: int
              tag: 1
              value expressions:
                    expr: id
                    type: int
                    expr: key
                    type: string
                    expr: value
                    type: string
        t3 
          TableScan
            alias: t3
            Filter Operator
              predicate:
                  expr: (id = 20)
                  type: boolean
              Reduce Output Operator
                key expressions:
                      expr: id
                      type: int
                sort order: +
                Map-reduce partition columns:
                      expr: id
                      type: int
                tag: 2
                value expressions:
                      expr: id
                      type: int
                      expr: key
                      type: string
                      expr: value
                      type: string
      Reduce Operator Tree:
        Join Operator
          condition map:
               Outer Join 0 to 1
               Inner Join 1 to 2
          condition expressions:
            0 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            1 {VALUE._col0} {VALUE._col1} {VALUE._col2}
            2 {VALUE._col0} {VALUE._col1} {VALUE._col2}
          handleSkewJoin: false
          outputColumnNames: _col0, _col1, _col2, _col5, _col6, _col7, _col10, _col11, _col12
          Select Operator
            expressions:
                  expr: _col0
                  type: int
                  expr: _col1
                  type: string
                  expr: _col2
                  type: string
                  expr: _col5
                  type: int
                  expr: _col6
                  type: string
                  expr: _col7
                  type: string
                  expr: _col10
                  type: int
                  expr: _col11
                  type: string
                  expr: _col12
                  type: string
            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
            File Output Operator
              compressed: false
              GlobalTableId: 0
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The current behavior is actually stranger than this: for a left outer join (similarly for a right outer join), hive finds the leftmost alias referred to in the &lt;b&gt;predicates&lt;/b&gt; of left outer joins and rejects any alias to the right of it for pushdown.  So in this query the filter &quot;t2.id=20&quot; pushed down:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 join t2 on (t1.id=t2.id) left outer join t3 on (t2.id=t3.id) where t2.id=20;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;while it isn&apos;t here:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;explain select * from t1 join t2 on (t1.id=t2.id) left outer join t3 on (t1.id=t3.id) where t2.id=20;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13079023" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 21:03:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-03 21:03:23.393902)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1153598 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13079024" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 21:03:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-03 21:02:11.625203)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added test cases, fixed comment&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Initial patch&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1153598 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13079030" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 21:13:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-03 21:13:25.076077)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix testcase&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1153598 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13081788" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 17:43:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-09 17:41:41.427733)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1153598 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13089252" author="cwsteinbach" created="Tue, 23 Aug 2011 03:45:48 +0000"  >&lt;p&gt;@Charles: There&apos;s a test failure in ppd_outer_join4. Can you please take a look? Thanks.&lt;/p&gt;</comment>
                            <comment id="13095013" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 00:09:10 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-01 00:08:37.474019)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fixed ppd_outer_join4.q.out&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1163856 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/a&gt; 1163856 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13095015" author="charleschen" created="Thu, 1 Sep 2011 00:10:37 +0000"  >&lt;p&gt;I&apos;ve fixed the test output--it seems to be an improvement.&lt;/p&gt;</comment>
                            <comment id="13095022" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 00:21:09 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-01 00:19:17.176704)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Rebased to current trunk&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1163875 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/a&gt; 1163875 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13095104" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 03:55:09 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/#review1710&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/#review1710&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt;&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1275/#comment3884&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/#comment3884&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    There is a weird non-ASCII character on this line.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-09-01 00:19:17, Charles Chen wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-09-01 00:19:17)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1163875 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/a&gt; 1163875 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Unit tests passed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Charles&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13095105" author="jvs" created="Thu, 1 Sep 2011 03:58:27 +0000"  >&lt;p&gt;Charles, did you intentionally omit the new ppd_outer_join5.q from the latest patch?&lt;/p&gt;

&lt;p&gt;Also, there&apos;s a weird non-ASCII character in the Javadoc.&lt;/p&gt;</comment>
                            <comment id="13095110" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 04:27:09 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-01 04:26:59.076177)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Oops fixed dropped unit test, javadoc character&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1163875 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/a&gt; 1163875 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13095116" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 04:43:10 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1275/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-01 04:42:25.815081)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added TestParse changes ??&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2337&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/a&gt; 1163875 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/a&gt; 1163875 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/compiler/plan/input4.q.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/compiler/plan/input4.q.xml&lt;/a&gt; 1163875 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/compiler/plan/join8.q.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/compiler/plan/join8.q.xml&lt;/a&gt; 1163875 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1275/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1275/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Charles&lt;/p&gt;
</comment>
                            <comment id="13095607" author="jvs" created="Thu, 1 Sep 2011 21:16:19 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13095744" author="jvs" created="Fri, 2 Sep 2011 03:27:43 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Charles!&lt;/p&gt;</comment>
                            <comment id="13095919" author="hudson" created="Fri, 2 Sep 2011 11:28:05 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #928 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/928/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/928/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2337&quot; title=&quot;Predicate pushdown erroneously conservative with outer joins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2337&quot;&gt;&lt;del&gt;HIVE-2337&lt;/del&gt;&lt;/a&gt;. Predicate pushdown erroneously conservative with outer joins&lt;br/&gt;
(Charles Chen via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1164340&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1164340&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ppd_outer_join5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input4.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join8.q.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12498567">HIVE-1989</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12414282">HIVE-279</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489149" name="HIVE-2337v1.patch" size="4329" author="charleschen" created="Wed, 3 Aug 2011 01:21:11 +0000"/>
                            <attachment id="12489252" name="HIVE-2337v2.patch" size="20088" author="charleschen" created="Wed, 3 Aug 2011 21:02:35 +0000"/>
                            <attachment id="12489255" name="HIVE-2337v3.patch" size="21061" author="charleschen" created="Wed, 3 Aug 2011 21:13:30 +0000"/>
                            <attachment id="12492550" name="HIVE-2337v4.patch" size="26064" author="charleschen" created="Thu, 1 Sep 2011 00:08:44 +0000"/>
                            <attachment id="12492552" name="HIVE-2337v5.patch" size="9413" author="charleschen" created="Thu, 1 Sep 2011 00:19:26 +0000"/>
                            <attachment id="12492573" name="HIVE-2337v6.patch" size="25354" author="charleschen" created="Thu, 1 Sep 2011 04:27:35 +0000"/>
                            <attachment id="12492576" name="HIVE-2337v7.patch" size="55058" author="charleschen" created="Thu, 1 Sep 2011 04:43:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Aug 2011 01:22:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35797</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123818</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2338] Alter table always throws an unhelpful error on failure</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2338</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Every failure in an alter table function always return a MetaException. When altering tables and catching exceptions, we throw a MetaException in the &quot;finally&quot; part of a try-catch-finally block, which overrides any other exceptions thrown.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517744">HIVE-2338</key>
            <summary>Alter table always throws an unhelpful error on failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sohanjain">Sohan Jain</assignee>
                                    <reporter username="sohanjain">Sohan Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 03:41:24 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:50 +0000</updated>
                            <resolved>Tue, 23 Aug 2011 05:37:19 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Diagnosability</component>
                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13078572" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 04:13:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1276/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1276/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Paul Yang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Every failure in an alter table function always return a MetaException. When altering tables and catching exceptions, we throw a MetaException in the &quot;finally&quot; part of a try-catch-finally block, which overrides any other exceptions thrown.&lt;/p&gt;

&lt;p&gt;This patch moves the code to throw an error on a commit failure outside of the try-catch-finally block.  So any errors within the try block are thrown properly.  Only when success == false will we throw a MetaException.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2338&quot; title=&quot;Alter table always throws an unhelpful error on failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2338&quot;&gt;&lt;del&gt;HIVE-2338&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2338&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2338&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1152020 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1276/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1276/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tested failing alter table metastore commands; they threw InvalidOperationExceptions as they should, instead of meaningless MetaExceptions.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13079127" author="jghoman" created="Wed, 3 Aug 2011 23:54:26 +0000"  >&lt;p&gt;+1 with the nit that the comment about that code being reached only if the try-catch-finally isn&apos;t triggered isn&apos;t particularly helpful since it describes the obvious path through the code and won&apos;t be interesting once this patch goes in.&lt;/p&gt;</comment>
                            <comment id="13079130" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 23:59:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1276/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1276/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-03 23:59:06.774216)&lt;/p&gt;


&lt;p&gt;Review request for hive and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;-remove unecessary comment&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Every failure in an alter table function always return a MetaException. When altering tables and catching exceptions, we throw a MetaException in the &quot;finally&quot; part of a try-catch-finally block, which overrides any other exceptions thrown.&lt;/p&gt;

&lt;p&gt;This patch moves the code to throw an error on a commit failure outside of the try-catch-finally block.  So any errors within the try block are thrown properly.  Only when success == false will we throw a MetaException.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2338&quot; title=&quot;Alter table always throws an unhelpful error on failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2338&quot;&gt;&lt;del&gt;HIVE-2338&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2338&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2338&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1152020 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1276/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1276/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tested failing alter table metastore commands; they threw InvalidOperationExceptions as they should, instead of meaningless MetaExceptions.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13089279" author="cwsteinbach" created="Tue, 23 Aug 2011 05:37:19 +0000"  >&lt;p&gt;Committed to trunk. Thanks Sohan!&lt;/p&gt;</comment>
                            <comment id="13089422" author="hudson" created="Tue, 23 Aug 2011 12:33:23 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #910 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/910/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/910/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2338&quot; title=&quot;Alter table always throws an unhelpful error on failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2338&quot;&gt;&lt;del&gt;HIVE-2338&lt;/del&gt;&lt;/a&gt;. Alter table always throws an unhelpful error on failure (Sohan Jain via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160551&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160551&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489155" name="HIVE-2338.1.patch" size="921" author="sohanjain" created="Wed, 3 Aug 2011 04:11:56 +0000"/>
                            <attachment id="12489280" name="HIVE-2338.2.patch" size="793" author="sohanjain" created="Wed, 3 Aug 2011 23:59:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Aug 2011 04:13:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43498</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2339] Preserve RS key columns in columnExprMap after CP optimization, which might be useful to other optimizers</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2339</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In ColumnPrunerProcFactory#pruneReduceSinkOperator, only VALUE parts are retained from columnExprMap. Doesn&apos;t anyone want KEY parts to retained, either? In my case, it was very useful for backtracking column names and removing RS in &lt;b&gt;&lt;del&gt;RS&lt;/del&gt;&lt;/b&gt;-RS-GBY case.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517750">HIVE-2339</key>
            <summary>Preserve RS key columns in columnExprMap after CP optimization, which might be useful to other optimizers</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12514143">HIVE-2283</parent>
                                    <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="navis">Navis</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 05:45:05 +0000</created>
                <updated>Wed, 13 Feb 2013 08:04:44 +0000</updated>
                            <resolved>Fri, 20 Apr 2012 19:05:29 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13078596" author="navis" created="Wed, 3 Aug 2011 05:47:42 +0000"  >&lt;p&gt;walk around&lt;/p&gt;</comment>
                            <comment id="13124689" author="navis" created="Tue, 11 Oct 2011 04:59:11 +0000"  >&lt;p&gt;duplicated with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1989&quot; title=&quot;recognize transitivity of predicates on join keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1989&quot;&gt;&lt;del&gt;HIVE-1989&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="13160649" author="navis" created="Thu, 1 Dec 2011 05:25:59 +0000"  >&lt;p&gt;It seemed to be fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1989&quot; title=&quot;recognize transitivity of predicates on join keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1989&quot;&gt;&lt;del&gt;HIVE-1989&lt;/del&gt;&lt;/a&gt;. It was true for join cases but for group-by cases, mapping information of keys are still missing.&lt;/p&gt;</comment>
                            <comment id="13258475" author="ashutoshc" created="Fri, 20 Apr 2012 19:05:29 +0000"  >&lt;p&gt;Fixed starting 0.8 by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1989&quot; title=&quot;recognize transitivity of predicates on join keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1989&quot;&gt;&lt;del&gt;HIVE-1989&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13576683" author="yhuai" created="Tue, 12 Feb 2013 15:31:31 +0000"  >&lt;p&gt;should we reopen this one? From the discussion of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt;, seems &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1989&quot; title=&quot;recognize transitivity of predicates on join keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1989&quot;&gt;&lt;del&gt;HIVE-1989&lt;/del&gt;&lt;/a&gt; has not completely resolve the issue. Also, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2206&quot; title=&quot;add a new optimizer for query correlation discovery and optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2206&quot;&gt;&lt;del&gt;HIVE-2206&lt;/del&gt;&lt;/a&gt; needs to use mapping of column names to track common keys among ReduceSinkOperators. Since the mapping of column names of keys are missing, if &quot;hive.map.aggr=false&quot;, the current patch of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2206&quot; title=&quot;add a new optimizer for query correlation discovery and optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2206&quot;&gt;&lt;del&gt;HIVE-2206&lt;/del&gt;&lt;/a&gt; cannot detect common keys. &quot;hive.map.aggr=true&quot; will not be a problem since I still generate a reduce-side aggregation which is not in the plan tree and thus, will not go through CP optimization&lt;/p&gt;</comment>
                            <comment id="13577399" author="navis" created="Wed, 13 Feb 2013 08:04:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yhuai&quot; class=&quot;user-hover&quot; rel=&quot;yhuai&quot;&gt;Yin Huai&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; modified CPFactory to retain key parts in colExprMap of RS. But I&apos;m not sure if it would be enough for your use cases.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489161" name="HIVE-2339.1.patch" size="1738" author="navis" created="Wed, 3 Aug 2011 05:47:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Apr 2012 19:05:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljkn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123821</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2340] optimize orderby followed by a groupby</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2340</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Before implementing optimizer for JOIN-GBY, try to implement RS-GBY optimizer(cluster-by following group-by).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517762">HIVE-2340</key>
            <summary>optimize orderby followed by a groupby</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12479272">HIVE-1772</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="navis">Navis</reporter>
                        <labels>
                            <label>perfomance</label>
                    </labels>
                <created>Wed, 3 Aug 2011 07:49:04 +0000</created>
                <updated>Sat, 3 Feb 2018 20:23:55 +0000</updated>
                            <resolved>Mon, 8 Apr 2013 18:54:26 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13078625" author="navis" created="Wed, 3 Aug 2011 07:50:45 +0000"  >&lt;p&gt;I need the key.&lt;/p&gt;</comment>
                            <comment id="13078636" author="navis" created="Wed, 3 Aug 2011 08:10:54 +0000"  >&lt;p&gt;initial patch&lt;/p&gt;</comment>
                            <comment id="13079216" author="navis" created="Thu, 4 Aug 2011 04:40:35 +0000"  >&lt;p&gt;extended to accept general key expressions including UDFs&lt;/p&gt;</comment>
                            <comment id="13162689" author="navis" created="Mon, 5 Dec 2011 09:33:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2991/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2991/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13163523" author="jiraposter@reviews.apache.org" created="Tue, 6 Dec 2011 11:03:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2991/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2991/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-12-06 11:02:00.777597)&lt;/p&gt;


&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I&apos;ve overrode existing optimizer by mistake. Fixed it.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Mostly copied from existing code. Not tested intensively yet, but it is seemed to be used frequently for us.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2340&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java 82a141d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java e91b4d5 &lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2991/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2991/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;new test cases added : reduce_deduplicate_extended.q&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Navis&lt;/p&gt;
</comment>
                            <comment id="13184767" author="phabricator@reviews.facebook.net" created="Thu, 12 Jan 2012 06:53:39 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-592 optimize orderby followed by a groupby&lt;/p&gt;

&lt;p&gt;  Before implementing optimizer for JOIN-GBY, try to implement RS-GBY optimizer(cluster-by following group-by).&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/2499/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/2499/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13184771" author="phabricator@reviews.facebook.net" created="Thu, 12 Jan 2012 06:59:39 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Fixed failure of join18.q (was RS-GBY-RS-JOIN case).&lt;br/&gt;
  Also implemented JOIN-GBY optimizer with map aggregation which improved performace for TPC-H Q13 slightly.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;/p&gt;</comment>
                            <comment id="13189747" author="phabricator@reviews.facebook.net" created="Fri, 20 Jan 2012 11:40:38 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  fix test failures : auto_join26.q, ql_rewrite_gbtoidx.q, udtf_json_tuple.q, union24.q&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/ql_rewrite_gbtoidx.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/udtf_json_tuple.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/union24.q&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;/p&gt;</comment>
                            <comment id="13193765" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 11:57:39 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Deduplicates RS-RS more aggressively.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join10.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join15.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join30.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;/p&gt;</comment>
                            <comment id="13194780" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 14:24:33 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Optimizer for GroupBy-GroupBy case added and several bug fixes.&lt;/p&gt;

&lt;p&gt;  Updated test results are affected by this optimizer, reducing MR stages. Confirmed query result values are same.&lt;br/&gt;
  Except that, all tests are passes, except ppr_pudown.q (I&apos;m working on it, too)&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join10.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join15.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join30.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input39.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/metadataonly1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;</comment>
                            <comment id="13540603" author="ashutoshc" created="Fri, 28 Dec 2012 21:32:40 +0000"  >&lt;p&gt;Navis,&lt;br/&gt;
This is a useful optimization. Patch doesn&apos;t apply cleanly. If you update the patch, I will take a look.&lt;/p&gt;</comment>
                            <comment id="13541214" author="navis" created="Mon, 31 Dec 2012 01:25:08 +0000"  >&lt;p&gt;@Ashutosh&lt;br/&gt;
I&apos;ve abandoned working on this cause &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2206&quot; title=&quot;add a new optimizer for query correlation discovery and optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2206&quot;&gt;&lt;del&gt;HIVE-2206&lt;/del&gt;&lt;/a&gt; is superset of it. Would it be better to do this as a brief mending before that?&lt;/p&gt;</comment>
                            <comment id="13555573" author="ashutoshc" created="Wed, 16 Jan 2013 23:01:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; I played with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2206&quot; title=&quot;add a new optimizer for query correlation discovery and optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2206&quot;&gt;&lt;del&gt;HIVE-2206&lt;/del&gt;&lt;/a&gt; over last couple of days and I think your work is complimentary and useful because there are several cases which this patch is already optimizing which &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2206&quot; title=&quot;add a new optimizer for query correlation discovery and optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2206&quot;&gt;&lt;del&gt;HIVE-2206&lt;/del&gt;&lt;/a&gt; doesn&apos;t currently. For e.g., order-by followed by groupby, RS followed by GBY, JOIN-GROUPBY, RS-RS, GBY-GBY. This covers a lot of ground, so I suggest we move forward with this.&lt;/p&gt;</comment>
                            <comment id="13555803" author="yhuai" created="Thu, 17 Jan 2013 03:25:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt; Can you let me know cases of JOIN-GROUPBY and GBY-GBY which 2206 does not optimize? Also, does RS refer to those queries with &quot;cluster by&quot;, &quot;sort by&quot; or &quot;distributed by&quot;? Thanks.&lt;/p&gt;</comment>
                            <comment id="13556513" author="ashutoshc" created="Thu, 17 Jan 2013 19:34:41 +0000"  >&lt;p&gt;Yeah, correct JOIN-GBY and GBY-GBY are taken care of in ysmart also. Its the group-by followed by order-by case which is also of interest to me, which this already covers. &lt;/p&gt;

&lt;p&gt;Besides the scenario covered by these two patches, I am also comparing the approaches taken in these two. I have just briefly looked at this patch, but fundamental difference which I can make out in this approach Vs ysmart approach is that here RS is deduplicated that is completely removed from operator pipeline, wherever it could be (i.e. when keys of subsequent RS is superset of the earlier one) thus fusing multiple MR jobs. Ysmart on the other hand instead replaces the second RS with a new operator its introducing (LocalSimulatedReduceSink?) which fakes the RS but doesn&apos;t let the plan split in 2 MR jobs and thus generating one MR job. I haven&apos;t thought through completely on this, but on initial pass it seems like approach of this patch is better than ysmart because:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Here you don&apos;t need a new operator.&lt;/li&gt;
	&lt;li&gt;Here you are simplifying the plan by eliminating the operators as oppose to ysmart which is replacing the operator thereby increasing the complexity of plan (by having a new type of operator)&lt;/li&gt;
	&lt;li&gt;In that new operator ysmart currently serializes and deserializes the data through that operator, thereby unnecessarily introducing performance penalty. Granted this could be improved, but problem doesn&apos;t exist in patch proposed on this jira to begin with.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Though there are certainly other scenarios which ysmart can cover (Yin, can you list those) which this patch is not covering, but for the scenarios that are common this approach seems to be better. &lt;/p&gt;

&lt;p&gt;There might be other differences in the approach, please feel free to raise those.&lt;/p&gt;</comment>
                            <comment id="13556608" author="yhuai" created="Thu, 17 Jan 2013 21:21:09 +0000"  >&lt;p&gt;Let me explain the reason that I introduced the fake RS operator instead of just removing the original RS. When I was developing the patch for 2206, I found that the aggregation operator (GBY) and the join operator (JOIN) use different logic on processing rows forwarded to it. Although they both buffer rows, a GBY determines if it need to forward results to its children in processOp. While, a JOIN replies on endGroup to know when it should forward results. When we have plans like GBY-GBY or JOIN-GBY, that difference on processing logic is fine. However, when we have plan like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;GBY----                    GBY----
       \                          \
        ----JOIN    or             ----JOIN
       /                          /
GBY----                    JOIN---
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We need operators between the child JOIN and parent GBYs and JOINs to make sure JOIN process rows in a correct way. This is also the reason that in CorrelationLocalSimulativeReduceSinkOperator, it determines when to start the group of its children in processOp and leave a empty startGroup and endGroup.&lt;/p&gt;

&lt;p&gt;Also, by replacing RSs with those fake RSs, I do not need to touch those GBYs and JOINs which will be merged into the same Reduce phase. Since the input of the first operator in the Reduce side is in the format of &lt;span class=&quot;error&quot;&gt;&amp;#91;key, value, tag&amp;#93;&lt;/span&gt;, so I use those fake RSs to generate rows in the same format.&lt;/p&gt;

&lt;p&gt;But this part of work was implemented about almost 2 years ago. Definitely let me know if anything has been changed and this fake RS is no longer needed.&lt;/p&gt;</comment>
                            <comment id="13556620" author="yhuai" created="Thu, 17 Jan 2013 21:33:01 +0000"  >&lt;p&gt;The current implementation of the patch of YSmart covers scenarios when a join or aggregation operator share the same partition keys with its all parents (join or aggregation operators). &lt;br/&gt;
For example, a single MR job will be generated if all operators in the following plan share the same partition keys.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;JOIN----                    
       \                          
        ----JOIN----  
       /            \              
GBY----              \
                      ----JOIN
                     /
GBY--- -------------/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Also, it requires that the bottom join or aggregation operators which will be processed in the same MR job take input tables instead of intermediate tables. In future, it should be extended to cover scenarios that involve intermediate tables, that correlated operators share common partition keys (not exactly the same keys), and that a join or aggregation operator share common keys with some of its parents. &lt;/p&gt;</comment>
                            <comment id="13556651" author="ashutoshc" created="Thu, 17 Jan 2013 22:13:55 +0000"  >&lt;p&gt;Thanks Yin for explaining. Your ASCII art helped in understanding the differences : ) I better understand the reason for the fake new operator now. I think in cases you have pointed out when there is such kind of trees, this reduce deduplication approach won&apos;t help, since it looks at linear chain of RS and eliminates the one where it could. You would need a fake operator in such case because you don&apos;t want to modify the GBY or Join operators which make sense. I see the merits of Ysmart better now.&lt;/p&gt;

&lt;p&gt;Though, on the other hand patch on this jira is still useful and complementary to ysmart. Since, it will collapse linear RS, instead of adding fake ones. In addition to collapsing of those operators, it will also make the life of ysmart easier because than ysmart will be dealing with simpler plans with reduce sinks already deduplicated. We need to make sure reducededup rule fires before ysmart for both optimizations to play nicely. So, I think we should make progress on both these patches.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; Will you like to refresh this patch?&lt;/p&gt;</comment>
                            <comment id="13556660" author="yhuai" created="Thu, 17 Jan 2013 22:23:26 +0000"  >&lt;p&gt;Yes, I agree.&lt;/p&gt;</comment>
                            <comment id="13559608" author="phabricator@reviews.facebook.net" created="Tue, 22 Jan 2013 13:02:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Rebased to trunk but I can&apos;t sure of this&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join10.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join15.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join30.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/metadataonly1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13559914" author="ashutoshc" created="Tue, 22 Jan 2013 19:25:56 +0000"  >&lt;p&gt;Thanks, Navis for updating the patch. I haven&apos;t looked the patch in detail, but some comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In the latest patch, you have removed rule &lt;tt&gt;RS%.&lt;b&gt;RS%GBY%&lt;/tt&gt; and &lt;tt&gt;RS%GBY%.*RS%GBY%&lt;/tt&gt; and have modified rule &lt;tt&gt;JOIN%.*RS%GBY%&lt;/tt&gt; to &lt;tt&gt;JOIN%.&lt;/b&gt;%RS%&lt;/tt&gt; Can you shed some light on thinking behind picking these rules? Were those rules not stable or you think they are not useful?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;auto_join_26.q.out is incorrect, its generating wrong results. Looks like aggregation is not happening correctly.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I haven&apos;t ran full suite, but queries groupby_grouping_sets5.q and smb_mapjoin_14.q are failing after applying this patch.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13560424" author="navis" created="Wed, 23 Jan 2013 06:30:58 +0000"  >&lt;p&gt;These are not removed but just merged with other rules. For example RS-&lt;b&gt;&lt;del&gt;RS/GBY is currently handled by RS&lt;/del&gt;&lt;/b&gt;-RS which is now diverged by type of child of child RS. It&apos;s more simple and seemed safer because this optimizer removes or replaces child RS and following GBY if possible. But this means child RS can be removed/replaced before accessed by graph walker.&lt;/p&gt;

&lt;p&gt;I&apos;ve ran about twenty tests before submitting. I wish I had some time to run all pending tests but a little busy recently, sorry.&lt;/p&gt;</comment>
                            <comment id="13560598" author="phabricator@reviews.facebook.net" created="Wed, 23 Jan 2013 11:50:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  1. Does not try RS dedup when child GBY is for grouping set.&lt;br/&gt;
  2. Prevent converting deduped parent JOIN to MAPJOIN (by hive.auto.convert.join=true)&lt;/p&gt;

&lt;p&gt;  For case 2, I don&apos;t knww what is better to choose deduped-JOIN or MAPJOIN+RS&lt;br/&gt;
  With auto_join31.q, deduped-JOIN took 50sec and MAPJOIN+RS took 57sec. But it would be dependent to situation.&lt;/p&gt;

&lt;p&gt;  Running test.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join16.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join22.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join24.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join30.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join31.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join10.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join15.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join18_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join30.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/metadataonly1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/smb_mapjoin_14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udtf_json_tuple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13561485" author="phabricator@reviews.facebook.net" created="Thu, 24 Jan 2013 08:01:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  1. Fixed big of JOIN-RS cases and prevent deduped join converted to skew-join&lt;br/&gt;
  2. Do not try merging RS with defined number of reducers(ORDER BY, etc)&lt;br/&gt;
  3. Fixed test results (rolled back some tests)&lt;/p&gt;

&lt;p&gt;  Running test&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13562477" author="phabricator@reviews.facebook.net" created="Fri, 25 Jan 2013 07:03:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  1. Fixed test result (miniMR)&lt;br/&gt;
  2. Added config setting min number of reducer for merged RS&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13566810" author="hagleitn" created="Wed, 30 Jan 2013 19:26:27 +0000"  >&lt;p&gt;FYI: Ran all unit tests on patch .9. Failing tests are: groupby_distinct_samekey.q,join31.q,reduce_deduplicate_extended.q (TestCliDriver). Failures look like outdated golden files (explain output changed). Uploaded testclidriver.txt for reference.&lt;/p&gt;</comment>
                            <comment id="13566812" author="hagleitn" created="Wed, 30 Jan 2013 19:27:13 +0000"  >&lt;p&gt;just the diff of the latest unit test run.&lt;/p&gt;</comment>
                            <comment id="13566898" author="phabricator@reviews.facebook.net" created="Wed, 30 Jan 2013 21:07:11 +0000"  >&lt;p&gt;hagleitn has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Partial review&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:521 Not sure why this is needed or why this defaults to 4. From comment below it seems this is just to avoid the single reducer order-by case for performance reasons, is that correct?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:787 Is this required or extra protection? Comment at the top of the file says mapjoin optimization happens before this (and probably should for performance reasons). Also, if I understand it correctly &quot;joinAndSort&quot; might be a better name than &quot;fixed&quot;. You&apos;re basically saying that if an optimization wants to change the join after this they need to make sure the ordering of the keys is preserved, right?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java:136 seems orthogonal to this patch.&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q:7 There are not a lot of tests, for min.reducer=1. No order by case for instance. Maybe the reduce_deduplicate_extended.q should run with both default and min.reducer=1.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn&lt;/p&gt;</comment>
                            <comment id="13566902" author="hagleitn" created="Wed, 30 Jan 2013 21:09:10 +0000"  >&lt;p&gt;Partial review on phabricator. Biggest question is around &quot;hive.optimize.reducededuplication.min.reducer&quot;. That basically disables the &quot;orderby followed by groupby&quot; optimization which was the original motivation for the jira. Navis, can you explain this some more?&lt;/p&gt;

&lt;p&gt;Might be another ticket, but would it be possible to optimize group by/sort by as well with this?&lt;/p&gt;</comment>
                            <comment id="13568361" author="navis" created="Fri, 1 Feb 2013 01:39:22 +0000"  >&lt;p&gt;@Gunther Hagleitner,&lt;br/&gt;
This optimization copies configuration of childRS to parentRS, which can lead to performance problems if childRS is run on single or small number of RSs (bucketing, etc), especially when parentRS is for JOIN or GBY. Thresholding it by &quot;min.reducer&quot; conf seemed not good enough. Do you have some better idea?&lt;/p&gt;</comment>
                            <comment id="13568466" author="phabricator@reviews.facebook.net" created="Fri, 1 Feb 2013 04:25:12 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:521 Yes, it is. There should be a better configuration if possible.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:787 Yes, should be &apos;fixed&apos; as sorted state. I&apos;ll rename it.&lt;br/&gt;
  I think there should be a configuration preventing MAPJOINable JOIN from being merged with next RS. But seemed hard to know if it&apos;s mapjoinable. Any idea?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java:136 Yes, typos. I&apos;ll remove this from patch.&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q:7 ok.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn&lt;/p&gt;</comment>
                            <comment id="13568479" author="phabricator@reviews.facebook.net" created="Fri, 1 Feb 2013 04:55:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=26343&amp;amp;id=27027#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=26343&amp;amp;id=27027#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/join31.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn&lt;/p&gt;</comment>
                            <comment id="13570645" author="hagleitn" created="Mon, 4 Feb 2013 21:31:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: I think in general the logic should be to copy numReducers from parent to child not the other way around. If hive makes a decent estimate of reducers for the parent, that&apos;s probably the number you want to carry into the combined reduce stage, because that means each reducer is doing the desired amount of work. Buckets and order by are the only special cases I can think of, where the number needs to be fixed.&lt;/p&gt;

&lt;p&gt;For those special cases without knowing the cardinalities of join/group by/tables, it&apos;s indeed difficult to guess if the optimization should be on or off. However, what do you think of using a max ratio of parent reducers/child reducers instead of a fixed minimum number of reducers for the child? With a default of 4 maybe. I.e.: If there are less than 4 times as many reducers in the parent than in the child collapse (assuming another job will be more expensive than the lower number of reducers), else leave it alone. The optimization is only good if the input sizes of the child and parent reducers are similar and expressing this as a ratio of number of reducers is probably the closest we can get right now.&lt;/p&gt;

&lt;p&gt;This would enable the optimization for a larger body of queries (small tables, single input split, empty group by expr, etc).&lt;/p&gt;</comment>
                            <comment id="13570813" author="navis" created="Tue, 5 Feb 2013 00:57:38 +0000"  >&lt;p&gt;@Gunther Hagleitner: I also considered ratio thing, but number of reducers is calculated based on input size just before submitted to hadoop and cannot be known in optimizer layer. &lt;br/&gt;
Except those special cases with order by and bucketing, number of reducers for both RS is -1. So generally speaking, it&apos;s safe.&lt;/p&gt;</comment>
                            <comment id="13571130" author="hagleitn" created="Tue, 5 Feb 2013 08:05:53 +0000"  >&lt;p&gt;Ah, that&apos;s good info. Makes sense now. The patch is useful as is, but is the only way to actually optimize the groupby/orderby case to do the ratio thing as a conditional task? And if so would that be this or a follow up jira?&lt;/p&gt;</comment>
                            <comment id="13571168" author="phabricator@reviews.facebook.net" created="Tue, 5 Feb 2013 09:16:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  A general question ???&lt;/p&gt;

&lt;p&gt;  How does it work with hive.optimize.reducededuplication ?&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  conf/hive-default.xml.template:1034 Sorry for joining late: Can you explain this more clearly ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13571176" author="namit" created="Tue, 5 Feb 2013 09:22:37 +0000"  >&lt;p&gt;comments&lt;/p&gt;</comment>
                            <comment id="13571177" author="phabricator@reviews.facebook.net" created="Tue, 5 Feb 2013 09:24:11 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Do you think it might be a good idea to get &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3972&quot; title=&quot;Support using multiple reducer for fetching order by results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3972&quot;&gt;HIVE-3972&lt;/a&gt; first ?&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:99 Isn&apos;t it true that R1 and R2 will have the same cost for&lt;/p&gt;

&lt;p&gt;  RS -&amp;gt; GBY --&amp;gt; anything --&amp;gt; RS ?&lt;/p&gt;

&lt;p&gt;  If yes, how do you know which rule will be fired ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13572126" author="phabricator@reviews.facebook.net" created="Wed, 6 Feb 2013 04:03:12 +0000"  >&lt;p&gt;hagleitn has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:138 HashSet?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:251 I think the &quot;number of reducers&quot; story deserves more comments (similar to what you&apos;ve explained on the jira)&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:787 I think if you just run this optimization &lt;b&gt;after&lt;/b&gt; CommonJoinResolver everything should be fine. It will either already have converted joins to mapjoins and this optimization won&apos;t apply or you still have a regular join and you can merge it without worrying about missing out on a mapjoin conversion. You could still have the &quot;sorted&quot; flag to express intent, but there isn&apos;t any optimization that will pull the rug out under you at the moment. Am I missing something?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13572273" author="phabricator@reviews.facebook.net" created="Wed, 6 Feb 2013 08:59:11 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:138 ok.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:787 I wish I could but CommonJoinResolver is a physical optimizer, which means there is no RS-RS operator tree which could me merged on that stage.&lt;/p&gt;

&lt;p&gt;  I&apos;m thinking of disabling this optimization if user configured hive.auto.convert.join=true or hive.auto.convert.join.noconditionaltask=true.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:251 I&apos;ll add more explanations on hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:99 For rules with same cost, DefaultRuleDispatcher selects last one, something like this,&lt;/p&gt;
  &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((cost &amp;gt;= 0) &amp;amp;&amp;amp; (cost &amp;lt;= minCost)) {
      minCost = cost;
      rule = r;
  }
  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;  So R2 will be selected.&lt;br/&gt;
  conf/hive-default.xml.template:1034 It&apos;s commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340?focusedCommentId=13568361&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13568361&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2340?focusedCommentId=13568361&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13568361&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  This optimization merges two RSs by moving key/parts/num-reducers of child-RS to parent-RS, which means if num-reducer of child-RS is fixed (order by or forced bucketing) and small, it can resulted to very slow, single MR. For preventing this, the configuration makes min threshold for applying this optimization. It&apos;s not good enough, but I cannot think of better idea.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13572277" author="phabricator@reviews.facebook.net" created="Wed, 6 Feb 2013 09:15:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;br/&gt;
  Disabled JOIN-RS dedup if user specified any of &quot;auto.convert.join&quot;s&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=27027&amp;amp;id=27315#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=27027&amp;amp;id=27315#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/ppd/PredicateTransitivePropagate.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/join31.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join31.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13574224" author="hagleitn" created="Fri, 8 Feb 2013 04:16:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: Disabling the join merge when auto.convert is on should work.&lt;/p&gt;

&lt;p&gt;I ran unit tests for patch11 and for me these TestCliDriver tests are failing: auto_join13.q,auto_join26.q,infer_bucket_sort.q,join13.q,partition_wise_fileformat14.q&lt;/p&gt;</comment>
                            <comment id="13576309" author="navis" created="Tue, 12 Feb 2013 02:41:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;Gunther Hagleitner&lt;/a&gt;: Thanks for your help. &lt;/p&gt;

&lt;p&gt;Tests are failed by modifications of ColumnPrunerProcFactory, which was based on very old version of it. After removing that all tests have passed except infer_bucket_sort.q, which is affected by this optimization. Disabling the optimization made it work, too.&lt;/p&gt;</comment>
                            <comment id="13576337" author="hagleitn" created="Tue, 12 Feb 2013 03:14:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: Are you suggesting to just revert the changes in ColumnPrunerProcFactory? I&apos;ve tried that, but when I do that reduce_deduplicate_extended.q is failing. I&apos;ve started to debug into that problem - it seems backtracking fails at that point because it can&apos;t find the source of &quot;KEY._col0&quot; etc. Seems there should be entries for that in the colExprMap of the RS, but that&apos;s not there. Are you getting different results?&lt;/p&gt;</comment>
                            <comment id="13576343" author="navis" created="Tue, 12 Feb 2013 03:22:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;Gunther Hagleitner&lt;/a&gt;: Yes, it was &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2339&quot; title=&quot;Preserve RS key columns in columnExprMap after CP optimization, which might be useful to other optimizers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2339&quot;&gt;&lt;del&gt;HIVE-2339&lt;/del&gt;&lt;/a&gt; and I&apos;m not sure that it&apos;s fixed. And.. recently added GBY related operations(multi-GBY, cube, etc) are not making mappings for key from start. So that should be fixed also.&lt;/p&gt;</comment>
                            <comment id="13576484" author="hagleitn" created="Tue, 12 Feb 2013 09:23:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: Thanks that pointer helped. The column pruning did indeed not carry over the some of the columns in the colExprMap. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2339&quot; title=&quot;Preserve RS key columns in columnExprMap after CP optimization, which might be useful to other optimizers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2339&quot;&gt;&lt;del&gt;HIVE-2339&lt;/del&gt;&lt;/a&gt; is in, but it was missing handling of the &quot;KEY.*&quot; columns.&lt;/p&gt;

&lt;p&gt;I&apos;ve also looked at infer_bucket_sort and see what you&apos;re saying. Seems ok to have additional sort columns/buckets as long as the ones that are explicitly asked for are there. I&apos;ve updated the golden file for that test.&lt;/p&gt;

&lt;p&gt;Running full test suite on .12 now.&lt;/p&gt;</comment>
                            <comment id="13577147" author="hagleitn" created="Tue, 12 Feb 2013 23:14:02 +0000"  >&lt;p&gt;Clean bill of health on 12, except for incorrect golden files in TestParse_join2 and TestMinimrCliDriver_reduce_deduplicate. I&apos;ve updated the golden files in patch .13.&lt;/p&gt;</comment>
                            <comment id="13577395" author="phabricator@reviews.facebook.net" created="Wed, 13 Feb 2013 07:58:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  1. Changed policy of creating new metadatas(colExprMap, etc) in ColumnPrunerProcFactory.pruneReduceSinkOperator()&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove not retained values from RowResolver, colExprMap and schema (instead of creating new entities by adding retained values)&lt;br/&gt;
  2. Changed order of applying CP and PPD. Now PPD applies first and CP next (which was CP-PPD)&lt;/li&gt;
	&lt;li&gt;CP removes some expr mappings which was not yet propagated by PPD&lt;/li&gt;
	&lt;li&gt;Also removed pruning schema of FilterOperator, which seemed not right (It&apos;s not certain that TS will actually prune columns)&lt;br/&gt;
  3. Refactored to share same code base in ExprNodeDescUtils which was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2839&quot; title=&quot;Filters on outer join with mapjoin hint is not applied correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2839&quot;&gt;&lt;del&gt;HIVE-2839&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Will run full test tonight&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=27315&amp;amp;id=27669#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=27315&amp;amp;id=27669#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/input2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample7.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13578178" author="phabricator@reviews.facebook.net" created="Thu, 14 Feb 2013 05:56:11 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Rolled back removing schema of FIL on CP optimization (made problem with some joins)&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=27669&amp;amp;id=27729#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=27669&amp;amp;id=27729#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/Optimizer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join19.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/bucketmapjoin1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/filter_join_breaktask.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input39_hadoop20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join38.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join_map_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/lateral_view_ppd.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_repeated_alias.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/smb_mapjoin9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sort_merge_join_desc_1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sort_merge_join_desc_2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sort_merge_join_desc_3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/sort_merge_join_desc_4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/stats11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union26.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union_view.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/case_sensitivity.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/cast1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input9.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_part1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_testxpath2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join8.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/sample7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/subq.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/udf1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/union.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13578825" author="navis" created="Thu, 14 Feb 2013 23:59:34 +0000"  >&lt;p&gt;Passed all tests&lt;/p&gt;</comment>
                            <comment id="13591995" author="hagleitn" created="Mon, 4 Mar 2013 05:11:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: I&apos;ve tried the latest patch (.13) and it doesn&apos;t apply cleanly anymore. I rebased it, but after doing so I got an NPE from auto_join19.q. Something must have changed in the meantime.&lt;/p&gt;

&lt;p&gt;I was however able to get the previous version of the patch to apply and work with just a minor change. Tests pass for me on that one. I&apos;ll upload, in case you want to take a look. Feel free to ignore.&lt;/p&gt;</comment>
                            <comment id="13591996" author="hagleitn" created="Mon, 4 Mar 2013 05:13:08 +0000"  >&lt;p&gt;As mentioned. Based on .12. This one applys and works for me.&lt;/p&gt;</comment>
                            <comment id="13591997" author="hagleitn" created="Mon, 4 Mar 2013 05:14:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt;.14.patch that is.&lt;/p&gt;</comment>
                            <comment id="13592046" author="navis" created="Mon, 4 Mar 2013 07:44:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;Gunther Hagleitner&lt;/a&gt;: It seemed affected by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-948&quot; title=&quot;more query plan optimization rules &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-948&quot;&gt;&lt;del&gt;HIVE-948&lt;/del&gt;&lt;/a&gt;, which is recently committed. Thank for your help. I&apos;ll check that.&lt;/p&gt;</comment>
                            <comment id="13595647" author="navis" created="Thu, 7 Mar 2013 07:40:07 +0000"  >&lt;p&gt;Seemed heavily broken by recent changes.&lt;/p&gt;</comment>
                            <comment id="13599574" author="phabricator@reviews.facebook.net" created="Tue, 12 Mar 2013 01:33:12 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Rebased to trunk&lt;/p&gt;

&lt;p&gt;Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=27729&amp;amp;id=29571#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=27729&amp;amp;id=29571#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/NonBlockingOpDeDupProc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join3.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13600413" author="hagleitn" created="Tue, 12 Mar 2013 20:08:55 +0000"  >&lt;p&gt;Ran unit tests as well. All passed. Still going through the review.&lt;/p&gt;</comment>
                            <comment id="13600482" author="phabricator@reviews.facebook.net" created="Tue, 12 Mar 2013 21:19:12 +0000"  >&lt;p&gt;hagleitn has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13621675" author="hagleitn" created="Thu, 4 Apr 2013 02:28:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: The patch doesn&apos;t apply cleanly anymore: Culprit is &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4186&quot; title=&quot;NPE in ReduceSinkDeDuplication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4186&quot;&gt;&lt;del&gt;HIVE-4186&lt;/del&gt;&lt;/a&gt;, but the fix is no longer actually needed with your changes in ReduceSinkDeDuplication. &lt;/p&gt;

&lt;p&gt;After rebasing it, I found it to fail &quot;ptf.q&quot; - a new testcase for windowing. The problem seems to be that something in the ptf code is hanging on to the schema/signature of the reducesink. Before your change we cloned it, now you&apos;re modifying it. When I added code to clone the signature it passed all windowing tests.&lt;/p&gt;

&lt;p&gt;Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13621677" author="ashutoshc" created="Thu, 4 Apr 2013 02:31:07 +0000"  >&lt;p&gt;Would love to see this make it in 0.11. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;Gunther Hagleitner&lt;/a&gt; Let me know if its ready to go in.&lt;/p&gt;</comment>
                            <comment id="13621678" author="hagleitn" created="Thu, 4 Apr 2013 02:31:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt;: In case you want to take a look, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt;.14.rebased_and_schema_clone.patch applies cleanly and has the signature cloning code.&lt;/p&gt;</comment>
                            <comment id="13621819" author="navis" created="Thu, 4 Apr 2013 05:36:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hagleitn&quot; class=&quot;user-hover&quot; rel=&quot;hagleitn&quot;&gt;Gunther Hagleitner&lt;/a&gt; Thanks. I&apos;ll check that.&lt;/p&gt;</comment>
                            <comment id="13621953" author="navis" created="Thu, 4 Apr 2013 09:14:22 +0000"  >&lt;p&gt;I think CP for PTF is broken. Especially for single sourced multi-insert query.&lt;/p&gt;</comment>
                            <comment id="13622473" author="ashutoshc" created="Thu, 4 Apr 2013 16:22:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; I am not sure which test case you have in mind, but I ran following test and it worked for me.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;hive&amp;gt; create table t1 (a1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, b1 string); 
hive&amp;gt; create table t2 (a1 &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, b1 string);
hive&amp;gt; from (select sum(i) over (), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select * ;
hive&amp;gt; select * from t1 limit 3;
hive&amp;gt; select * from t2 limit 3; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I got expected results. If you run explain on that query you will see it has PTFOperator. You can check windowing_udaf.q to see the schema and data for over10k table. Let me know which query have in mind, for which CP for PTF may be broken.&lt;/p&gt;</comment>
                            <comment id="13622927" author="navis" created="Thu, 4 Apr 2013 23:00:40 +0000"  >&lt;p&gt;CP for RS is correctly modifies schema of RS, and it makes CP tests for PTF fail. But as suggested by Hagleitner, after making schema of RS intact even after CP, those tests are resulted to success. I believe there is some assumption on schema in CP for PTF.&lt;/p&gt;</comment>
                            <comment id="13622946" author="ashutoshc" created="Thu, 4 Apr 2013 23:11:52 +0000"  >&lt;p&gt;In PTF handling we do keep a copy of schema in Desc object to be used later at runtime. This could be improved. Me and Harish are exploring that. But I think Gunther&apos;s fix gets us around that, so for this patch I would recommend to go ahead with Gunther&apos;s fix, since this is hanging on for more than 6 months and no point in delaying it further. So, Navis if you are on board I will like to get .14 patch in trunk.&lt;/p&gt;</comment>
                            <comment id="13623113" author="navis" created="Fri, 5 Apr 2013 00:23:14 +0000"  >&lt;p&gt;Got it. I&apos;ve updated patch (added small comment on this). Thanks.&lt;/p&gt;</comment>
                            <comment id="13623115" author="phabricator@reviews.facebook.net" created="Fri, 5 Apr 2013 00:24:14 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;  Keep schema of RS intact in CP&lt;/p&gt;

&lt;p&gt;Reviewers: hagleitn, JIRA&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CHANGE SINCE LAST DIFF&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209?vs=29571&amp;amp;id=31179#toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209?vs=29571&amp;amp;id=31179#toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  conf/hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/NonBlockingOpDeDupProc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/auto_join26.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_gby_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/join1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join3.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13623262" author="ashutoshc" created="Fri, 5 Apr 2013 02:14:36 +0000"  >&lt;p&gt;Cool. Running test on latest patch. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13624131" author="rhbutani" created="Fri, 5 Apr 2013 22:25:16 +0000"  >&lt;p&gt;The problem with PTF is in plan generation. In SemanticAnalyzer::genReduceSinkPlanForWindowing line 10778, we are setting the RowSchema of the ReduceSinkOp that precedes a PTF to be the same one as the Op that precedes it. In the e.g. that was failing the preceding Op was another PTFOp. The fix is to set both the RowSchema and RowResolver by not pointing to the &apos;input&apos; Op&apos;s structures(same issue in genPTFPlanForComponentQuery). Will fix in the separate Jira. Will add back &apos;schema.getSignature().remove(colInfo);&apos; to ColumnPrunerProcFactory. Sorry about this.&lt;/p&gt;</comment>
                            <comment id="13624314" author="ashutoshc" created="Sat, 6 Apr 2013 03:35:56 +0000"  >&lt;p&gt;Following tests failed on latest patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;TestCliDriver.auto_join26.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.index_bitmap3.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.index_bitmap_auto.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.infer_bucket_sort.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.ppd_gby_join.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.semijoin.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.union24.q&lt;/li&gt;
	&lt;li&gt;TestCliDriver.cluster.q&lt;/li&gt;
	&lt;li&gt;TestMinimrCliDriver.infer_bucket_sort_reducers_power_two.q&lt;/li&gt;
	&lt;li&gt;TestParse.join1&lt;/li&gt;
	&lt;li&gt;TestParse.join2&lt;/li&gt;
	&lt;li&gt;TestParse.join3&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13624794" author="navis" created="Sun, 7 Apr 2013 09:03:09 +0000"  >&lt;p&gt;When auto.convert.join is true(default for now), RSDedup cannot try to merge following RS, effectively disabling the code part. I think physical planning should be postponed to completion time of each task. I&apos;ll update test results.&lt;/p&gt;</comment>
                            <comment id="13624938" author="ashutoshc" created="Sun, 7 Apr 2013 15:12:51 +0000"  >&lt;p&gt;Also, &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4302&quot; title=&quot;Fix how RowSchema and RowResolver are set on ReduceSinkOp that precedes PTFOp&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4302&quot;&gt;&lt;del&gt;HIVE-4302&lt;/del&gt;&lt;/a&gt; is resolved now, so workaround put in by Gunther should now longer be required. &lt;/p&gt;</comment>
                            <comment id="13625071" author="navis" created="Mon, 8 Apr 2013 01:32:22 +0000"  >&lt;p&gt;Phabricator seemed gone.&lt;/p&gt;</comment>
                            <comment id="13625663" author="ashutoshc" created="Mon, 8 Apr 2013 18:54:26 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Gunther and Navis for this cool optimization!&lt;/p&gt;</comment>
                            <comment id="13626434" author="hudson" created="Tue, 9 Apr 2013 09:58:08 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #147 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/147/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/147/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; : optimize orderby followed by a groupby (Navis via Ashutosh Chauhan) (Revision 1465721)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465721&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465721&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/NonBlockingOpDeDupProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_join26.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join2.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join3.q.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13626937" author="hudson" created="Tue, 9 Apr 2013 18:44:28 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #2053 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2053/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2053/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; : optimize orderby followed by a groupby (Navis via Ashutosh Chauhan) (Revision 1465721)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465721&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1465721&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml.template&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ColumnPrunerProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/NonBlockingOpDeDupProc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/CommonJoinResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/SkewJoinProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/JoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/auto_join26.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_distinct_samekey.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/reduce_deduplicate.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby2_map_skew.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_cube1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_rollup1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/infer_bucket_sort.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/reduce_deduplicate_extended.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join2.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join3.q.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13635314" author="phabricator@reviews.facebook.net" created="Thu, 18 Apr 2013 16:35:13 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:181 nit: spelling Abstract&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:103 The order in which the rules are specified matter, since in case of exact match for costs,&lt;br/&gt;
  the last rule is invoked.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:122 What are the semantics of trustScript ?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:359 can you add more comments ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13636073" author="phabricator@reviews.facebook.net" created="Fri, 19 Apr 2013 05:09:14 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:122 When ScriptOperator exists between RSs, it might possible to dedup only if the script does not change schema, order of rows and values of the RS related columns. It seemed added for that case by He Yongqiang, initial developer of this optimizer.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:103 Added comments&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:359 ok.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:181 done.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13637847" author="phabricator@reviews.facebook.net" created="Mon, 22 Apr 2013 08:59:15 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate_extended.q:5 can you add some comments in this test ???&lt;/p&gt;

&lt;p&gt;  RS + GBY + RS is optimized to remove the last RS etc.&lt;br/&gt;
  before the case&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                            <comment id="13637860" author="phabricator@reviews.facebook.net" created="Mon, 22 Apr 2013 09:23:15 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2340&quot; title=&quot;optimize orderby followed by a groupby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2340&quot;&gt;&lt;del&gt;HIVE-2340&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; optimize orderby followed by a groupby&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/reduce_deduplicate.q:26 can you add more comments here ??&lt;/p&gt;

&lt;p&gt;  who sets trustScript ?&lt;br/&gt;
  As a user, how can i do that&lt;br/&gt;
  What is supposed to happen.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/ReduceSinkDeDuplication.java:124 Can you add more comments here ?&lt;/p&gt;

&lt;p&gt;  Is minReducer only set for order By ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1209&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1209&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  DPAL-592&lt;/p&gt;

&lt;p&gt;ARCANIST PROJECT&lt;br/&gt;
  hive&lt;/p&gt;

&lt;p&gt;To: JIRA, hagleitn, navis&lt;br/&gt;
Cc: hagleitn, njain&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12634336">HIVE-4078</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12670424">HIVE-5357</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12509546">HIVE-2206</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12510315" name="ASF.LICENSE.NOT.GRANTED--HIVE-2340.D1209.1.patch" size="59591" author="phabricator@reviews.facebook.net" created="Thu, 12 Jan 2012 06:53:39 +0000"/>
                            <attachment id="12510316" name="ASF.LICENSE.NOT.GRANTED--HIVE-2340.D1209.2.patch" size="58819" author="phabricator@reviews.facebook.net" created="Thu, 12 Jan 2012 06:59:39 +0000"/>
                            <attachment id="12511255" name="ASF.LICENSE.NOT.GRANTED--HIVE-2340.D1209.3.patch" size="60417" author="phabricator@reviews.facebook.net" created="Fri, 20 Jan 2012 11:40:39 +0000"/>
                            <attachment id="12511974" name="ASF.LICENSE.NOT.GRANTED--HIVE-2340.D1209.4.patch" size="254984" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 11:57:40 +0000"/>
                            <attachment id="12512160" name="ASF.LICENSE.NOT.GRANTED--HIVE-2340.D1209.5.patch" size="306520" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 14:24:36 +0000"/>
                            <attachment id="12505860" name="HIVE-2340.1.patch.txt" size="31270" author="navis" created="Fri, 2 Dec 2011 08:34:04 +0000"/>
                            <attachment id="12568944" name="HIVE-2340.12.patch" size="233959" author="hagleitn" created="Tue, 12 Feb 2013 09:23:33 +0000"/>
                            <attachment id="12569094" name="HIVE-2340.13.patch" size="247668" author="hagleitn" created="Tue, 12 Feb 2013 23:14:02 +0000"/>
                            <attachment id="12571843" name="HIVE-2340.14.patch" size="244672" author="hagleitn" created="Mon, 4 Mar 2013 05:13:08 +0000"/>
                            <attachment id="12576910" name="HIVE-2340.14.rebased_and_schema_clone.patch" size="219855" author="hagleitn" created="Thu, 4 Apr 2013 02:31:17 +0000"/>
                            <attachment id="12577475" name="HIVE-2340.15.patch" size="221618" author="navis" created="Mon, 8 Apr 2013 01:32:22 +0000"/>
                            <attachment id="12567515" name="HIVE-2340.D1209.10.patch" size="212963" author="phabricator@reviews.facebook.net" created="Fri, 1 Feb 2013 04:55:11 +0000"/>
                            <attachment id="12568187" name="HIVE-2340.D1209.11.patch" size="208035" author="phabricator@reviews.facebook.net" created="Wed, 6 Feb 2013 09:15:12 +0000"/>
                            <attachment id="12569157" name="HIVE-2340.D1209.12.patch" size="293176" author="phabricator@reviews.facebook.net" created="Wed, 13 Feb 2013 07:58:11 +0000"/>
                            <attachment id="12569313" name="HIVE-2340.D1209.13.patch" size="431707" author="phabricator@reviews.facebook.net" created="Thu, 14 Feb 2013 05:56:11 +0000"/>
                            <attachment id="12573228" name="HIVE-2340.D1209.14.patch" size="217015" author="phabricator@reviews.facebook.net" created="Tue, 12 Mar 2013 01:33:12 +0000"/>
                            <attachment id="12577120" name="HIVE-2340.D1209.15.patch" size="217226" author="phabricator@reviews.facebook.net" created="Fri, 5 Apr 2013 00:24:14 +0000"/>
                            <attachment id="12565942" name="HIVE-2340.D1209.6.patch" size="314138" author="phabricator@reviews.facebook.net" created="Tue, 22 Jan 2013 13:02:12 +0000"/>
                            <attachment id="12566116" name="HIVE-2340.D1209.7.patch" size="361625" author="phabricator@reviews.facebook.net" created="Wed, 23 Jan 2013 11:50:11 +0000"/>
                            <attachment id="12566272" name="HIVE-2340.D1209.8.patch" size="195271" author="phabricator@reviews.facebook.net" created="Thu, 24 Jan 2013 08:01:11 +0000"/>
                            <attachment id="12566469" name="HIVE-2340.D1209.9.patch" size="200651" author="phabricator@reviews.facebook.net" created="Fri, 25 Jan 2013 07:03:11 +0000"/>
                            <attachment id="12567192" name="testclidriver.txt" size="27236" author="hagleitn" created="Wed, 30 Jan 2013 19:27:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 6 Dec 2011 11:03:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42163</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123822</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2341] SemanticAnalyzer.genJoinReduceSinkChild fails with NPE unless you specify an un-necessary table alias</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2341</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Following query:&lt;/p&gt;

&lt;p&gt;        select * from&lt;br/&gt;
        V_EMF_LEARNING_ACTUAL_CHURN&lt;br/&gt;
        join&lt;br/&gt;
        (select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; as total from standard_connections) b&lt;/p&gt;

&lt;p&gt;fails with the NPE listed below. It doesn&apos;t if you add an alias to the table like so:&lt;/p&gt;

&lt;p&gt;        select * from&lt;br/&gt;
        V_EMF_LEARNING_ACTUAL_CHURN a&lt;br/&gt;
        join&lt;br/&gt;
        (select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; as total from standard_connections) b&lt;/p&gt;

&lt;p&gt;The exception I&apos;m getting:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genJoinReduceSinkChild(SemanticAnalyzer.java:4440)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genJoinOperator(SemanticAnalyzer.java:4545)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genJoinPlan(SemanticAnalyzer.java:4704)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.genPlan(SemanticAnalyzer.java:6011)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.SemanticAnalyzer.analyzeInternal(SemanticAnalyzer.java:6603)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:238)&lt;br/&gt;
        at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:340)&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12517787">HIVE-2341</key>
            <summary>SemanticAnalyzer.genJoinReduceSinkChild fails with NPE unless you specify an un-necessary table alias</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ihadanny">Ido Hadanny</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 12:47:53 +0000</created>
                <updated>Wed, 26 Oct 2011 05:18:57 +0000</updated>
                            <resolved>Wed, 26 Oct 2011 05:18:57 +0000</resolved>
                                    <version>0.7.1</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13135715" author="ashutoshc" created="Wed, 26 Oct 2011 05:18:57 +0000"  >&lt;p&gt;This is not reproducible on trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Oct 2011 05:18:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123823</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2342] mirror.facebook.net is 404ing</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2342</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;http://mirror.facebook.net/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mirror.facebook.net/&lt;/a&gt; and everything under it is 404ing, which is blocking any attempt to build Hive from working.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517820">HIVE-2342</key>
            <summary>mirror.facebook.net is 404ing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="abayer">Andrew Bayer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 18:10:17 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:49 +0000</updated>
                            <resolved>Thu, 4 Aug 2011 00:31:09 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Build Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13078899" author="cwsteinbach" created="Wed, 3 Aug 2011 18:25:16 +0000"  >&lt;p&gt;You have to flush your Ivy cache in order to see this problem, which is why the Hudson job is currently unaffected. Here&apos;s the error I get:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
ivy-retrieve-hadoop-source:
[ivy:retrieve] :: Ivy 2.0.0-rc2 - 20081028224207 :: http://ant.apache.org/ivy/ ::
:: loading settings :: file = /Users/carl/Work/repos/hive3/ivy/ivysettings.xml
[ivy:retrieve] :: resolving dependencies :: org.apache.hive#hive-shims;0.8.0-SNAPSHOT
[ivy:retrieve] 	confs: [default]
[ivy:retrieve] 	found hadoop#core;0.20.3-CDH3-SNAPSHOT in hadoop-source
[ivy:retrieve] downloading http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz ...
[ivy:retrieve] downloading http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz ...
[ivy:retrieve] downloading http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz ...
[ivy:retrieve] downloading http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz ...
[ivy:retrieve] :: resolution report :: resolve 2879ms :: artifacts dl 359ms
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   2   |   1   |   0   |   0   ||   1   |   0   |
	---------------------------------------------------------------------
[ivy:retrieve] 
[ivy:retrieve] :: problems summary ::
[ivy:retrieve] :::: WARNINGS
[ivy:retrieve] 		module not found: hadoop#core;0.20.1
[ivy:retrieve] 	==== hadoop-source: tried
[ivy:retrieve] 	  -- artifact hadoop#core;0.20.1!hadoop.tar.gz(source):
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.1/hadoop-0.20.1.tar.gz
[ivy:retrieve] 	==== apache-snapshot: tried
[ivy:retrieve] 	  https://repository.apache.org/content/repositories/snapshots/hadoop/core/0.20.1/core-0.20.1.pom
[ivy:retrieve] 	  -- artifact hadoop#core;0.20.1!hadoop.tar.gz(source):
[ivy:retrieve] 	  https://repository.apache.org/content/repositories/snapshots/hadoop/core/0.20.1/hadoop-0.20.1.tar.gz
[ivy:retrieve] 	==== maven2: tried
[ivy:retrieve] 	  http://repo1.maven.org/maven2/hadoop/core/0.20.1/core-0.20.1.pom
[ivy:retrieve] 	  -- artifact hadoop#core;0.20.1!hadoop.tar.gz(source):
[ivy:retrieve] 	  http://repo1.maven.org/maven2/hadoop/core/0.20.1/core-0.20.1.tar.gz
[ivy:retrieve] 	==== datanucleus-repo: tried
[ivy:retrieve] 	  -- artifact hadoop#core;0.20.1!hadoop.tar.gz(source):
[ivy:retrieve] 	  http://www.datanucleus.org/downloads/maven2/hadoop/core/0.20.1/core-0.20.1.tar.gz
[ivy:retrieve] 		[FAILED     ] hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source): The HTTP response code for http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz did not indicate a success. See log for more detail. (80ms)
[ivy:retrieve] 		[FAILED     ] hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source): The HTTP response code for http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz did not indicate a success. See log for more detail. (75ms)
[ivy:retrieve] 		[FAILED     ] hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source): The HTTP response code for http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz did not indicate a success. See log for more detail. (110ms)
[ivy:retrieve] 		[FAILED     ] hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source): The HTTP response code for http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz did not indicate a success. See log for more detail. (90ms)
[ivy:retrieve] 		[FAILED     ] hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source):  (0ms)
[ivy:retrieve] 	==== hadoop-source: tried
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	==== apache-snapshot: tried
[ivy:retrieve] 	  https://repository.apache.org/content/repositories/snapshots/hadoop/core/0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	==== maven2: tried
[ivy:retrieve] 	  http://repo1.maven.org/maven2/hadoop/core/0.20.3-CDH3-SNAPSHOT/core-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	==== datanucleus-repo: tried
[ivy:retrieve] 	  http://www.datanucleus.org/downloads/maven2/hadoop/core/0.20.3-CDH3-SNAPSHOT/core-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 	  http://mirror.facebook.net/facebook/hive-deps/hadoop/core/hadoop-0.20.3-CDH3-SNAPSHOT/hadoop-0.20.3-CDH3-SNAPSHOT.tar.gz
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 		::          UNRESOLVED DEPENDENCIES         ::
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 		:: hadoop#core;0.20.1: not found
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 		::              FAILED DOWNLOADS            ::
[ivy:retrieve] 		:: ^ see resolution messages for details  ^ ::
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 		:: hadoop#core;0.20.3-CDH3-SNAPSHOT!hadoop.tar.gz(source)
[ivy:retrieve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:retrieve] 
[ivy:retrieve] :: USE VERBOSE OR DEBUG MESSAGE LEVEL FOR MORE DETAILS

BUILD FAILED
/Users/carl/Work/repos/hive3/build.xml:196: The following error occurred while executing this line:
/Users/carl/Work/repos/hive3/build.xml:130: The following error occurred while executing this line:
/Users/carl/Work/repos/hive3/shims/build.xml:62: The following error occurred while executing this line:
/Users/carl/Work/repos/hive3/build-common.xml:205: impossible to resolve dependencies:
	resolve failed - see output for details
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13078907" author="jvs" created="Wed, 3 Aug 2011 18:32:35 +0000"  >&lt;p&gt;There was some failure last night which hasn&apos;t been recovered yet; I&apos;ll post more info here when I have it.  Workaround is to edit build.properties to point to other mirrors.&lt;/p&gt;</comment>
                            <comment id="13079047" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 21:43:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1280/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1280/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Review for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; title=&quot;mirror.facebook.net is 404ing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2342&quot;&gt;&lt;del&gt;HIVE-2342&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; title=&quot;mirror.facebook.net is 404ing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2342&quot;&gt;&lt;del&gt;HIVE-2342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  build.properties f85221f &lt;br/&gt;
  ivy/ivysettings.xml 9e8dfe6 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1280/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1280/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13079051" author="cwsteinbach" created="Wed, 3 Aug 2011 21:45:23 +0000"  >&lt;p&gt;We made the two hadoop tarball dependencies available on archive.cloudera.com.&lt;br/&gt;
This patch updates the Hive build to use archive.cloudera.com as a backup&lt;br/&gt;
for mirrors.facebook.net.&lt;/p&gt;

&lt;p&gt;I tested this patch by flushing my local Ivy repo and building Hive from scratch.&lt;br/&gt;
I also verified that TestHadoop20SAuthBridge works.&lt;/p&gt;</comment>
                            <comment id="13079117" author="jvs" created="Wed, 3 Aug 2011 23:27:05 +0000"  >&lt;p&gt;We don&apos;t need to do anything about the other reference to mirror.facebook.net in hadoop.security.url (build.properties, referenced by shims/ivy.xml)?&lt;/p&gt;</comment>
                            <comment id="13079133" author="jiraposter@reviews.apache.org" created="Thu, 4 Aug 2011 00:05:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1280/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1280/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-04 00:04:48.084171)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;removed hadoop.security.url property from build.properties and shims/ivy.xml&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Review for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; title=&quot;mirror.facebook.net is 404ing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2342&quot;&gt;&lt;del&gt;HIVE-2342&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; title=&quot;mirror.facebook.net is 404ing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2342&quot;&gt;&lt;del&gt;HIVE-2342&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  build.properties f85221f &lt;br/&gt;
  ivy/ivysettings.xml 9e8dfe6 &lt;br/&gt;
  shims/ivy.xml a94ac1f &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1280/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1280/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13079145" author="jvs" created="Thu, 4 Aug 2011 00:31:09 +0000"  >&lt;p&gt;Committed.  Thanks Carl!&lt;/p&gt;

&lt;p&gt;Update on mirror.facebook.net:  ETA for recovery is between one and five days.&lt;/p&gt;</comment>
                            <comment id="13079232" author="hudson" created="Thu, 4 Aug 2011 05:41:33 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #871 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/871/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/871/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2342&quot; title=&quot;mirror.facebook.net is 404ing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2342&quot;&gt;&lt;del&gt;HIVE-2342&lt;/del&gt;&lt;/a&gt;. mirror.facebook.net is 404ing&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1153706&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1153706&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ivy/ivysettings.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.properties&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489257" name="HIVE-2342.1.patch.txt" size="1367" author="cwsteinbach" created="Wed, 3 Aug 2011 21:41:04 +0000"/>
                            <attachment id="12489281" name="HIVE-2342.2.patch.txt" size="2595" author="cwsteinbach" created="Thu, 4 Aug 2011 00:03:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Aug 2011 18:25:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37480</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05imf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30114</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2343] stats not updated for non &quot;load table desc&quot; operations</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2343</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Bug introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-306&quot; title=&quot;Support &amp;quot;INSERT [INTO] destination&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-306&quot;&gt;&lt;del&gt;HIVE-306&lt;/del&gt;&lt;/a&gt; so that stats are updated only for LoadTableDesc operations. For other operations (analyze table), null ptr is thrown and stats are not updated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517826">HIVE-2343</key>
            <summary>stats not updated for non &quot;load table desc&quot; operations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="franklinhu">Franklin Hu</assignee>
                                    <reporter username="franklinhu">Franklin Hu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 18:48:53 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:08 +0000</updated>
                            <resolved>Fri, 5 Aug 2011 00:12:19 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13078936" author="franklinhu" created="Wed, 3 Aug 2011 19:15:32 +0000"  >&lt;p&gt;Fix NPE, add unit test&lt;/p&gt;</comment>
                            <comment id="13078963" author="nzhang" created="Wed, 3 Aug 2011 19:51:15 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13079004" author="jiraposter@reviews.apache.org" created="Wed, 3 Aug 2011 20:47:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1279/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1279/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;table stats were not being updated for non &quot;load table desc&quot; plans due to NPE.&lt;/p&gt;


&lt;p&gt;This addresses bug hive-2343.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/hive-2343&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hive-2343&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1153601 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/stats16.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/stats16.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1279/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1279/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;all clientpositive/stats* unit tests pass&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Franklin&lt;/p&gt;
</comment>
                            <comment id="13079306" author="hudson" created="Thu, 4 Aug 2011 10:08:58 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #872 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/872/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/872/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2343&quot; title=&quot;stats not updated for non &amp;quot;load table desc&amp;quot; operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2343&quot;&gt;&lt;del&gt;HIVE-2343&lt;/del&gt;&lt;/a&gt;. stats are not updated for non &quot;load table desc&quot; operations&quot; (Franklin Hu via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1153753&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1153753&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/stats16.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/stats16.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13079696" author="nzhang" created="Fri, 5 Aug 2011 00:12:19 +0000"  >&lt;p&gt;Committed. Thanks Franklin!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489231" name="hive-2343.1.patch" size="6527" author="franklinhu" created="Wed, 3 Aug 2011 19:15:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Aug 2011 19:51:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43497</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123824</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2344] filter is removed due to regression of HIVE-1538</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2344</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt; select * from &lt;br/&gt;
 (&lt;br/&gt;
 select type_bucket,randum123&lt;br/&gt;
 from (SELECT *, cast(rand() as double) AS randum123 FROM tbl where ds = ...) a&lt;br/&gt;
 where randum123 &amp;lt;=0.1)s where s.randum123&amp;gt;0.1 limit 20;&lt;/p&gt;

&lt;p&gt;This is returning results...&lt;/p&gt;

&lt;p&gt;and &lt;/p&gt;

&lt;p&gt; explain&lt;br/&gt;
 select type_bucket,randum123&lt;br/&gt;
 from (SELECT *, cast(rand() as double) AS randum123 FROM tbl where ds = ...) a&lt;br/&gt;
 where randum123 &amp;lt;=0.1&lt;/p&gt;

&lt;p&gt;shows that there is no filter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517852">HIVE-2344</key>
            <summary>filter is removed due to regression of HIVE-1538</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amareshwari">Amareshwari Sriramadasu</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Aug 2011 21:44:35 +0000</created>
                <updated>Wed, 9 Jan 2013 10:23:15 +0000</updated>
                            <resolved>Thu, 11 Aug 2011 20:08:56 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13079131" author="jvs" created="Thu, 4 Aug 2011 00:00:59 +0000"  >&lt;p&gt;Workaround is&lt;/p&gt;

&lt;p&gt;set hive.ppd.remove.duplicatefilters=false&lt;/p&gt;</comment>
                            <comment id="13079226" author="amareshwari" created="Thu, 4 Aug 2011 05:22:31 +0000"  >&lt;p&gt;Looking into.&lt;/p&gt;</comment>
                            <comment id="13081531" author="amareshwari" created="Tue, 9 Aug 2011 09:16:02 +0000"  >&lt;p&gt;The problem is that the select operator chooses to push down the filter &apos;random123 &amp;lt;0.1&apos;, though it is non deterministic. And the filter is discarded to be pushed down since it is non deterministic later. Will upload a patch with the fix shortly.&lt;/p&gt;

&lt;p&gt;Any other filter on &apos;udf selected as column alias in select&apos; will also be pushed down always. Do we want to do this? Might address in a separate jira.&lt;/p&gt;</comment>
                            <comment id="13081562" author="amareshwari" created="Tue, 9 Aug 2011 11:01:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;Any other filter on &apos;udf selected as column alias in select&apos; will also be pushed down always.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Attaching test output with faulty explain plans. &lt;/p&gt;</comment>
                            <comment id="13081563" author="amareshwari" created="Tue, 9 Aug 2011 11:02:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;Any other filter on &apos;udf selected as column alias in select&apos; will also be pushed down always. Do we want to do this? Might address in a separate jira.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Addressing this also in the patch.&lt;/p&gt;</comment>
                            <comment id="13081567" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 11:09:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1404/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1404/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, John Sichi and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Any filter on &apos;udf selected as column alias in select&apos; will be pushed down through the select operator, which it should not. Patch addresses this by walking through the udf expression again.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; title=&quot;filter is removed due to regression of HIVE-1538&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2344&quot;&gt;&lt;del&gt;HIVE-2344&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2344&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java 1153812 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java 1153812 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/ppd_udf_col.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ppd_udf_col.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1404/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1404/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Amareshwari&lt;/p&gt;
</comment>
                            <comment id="13081991" author="jvs" created="Tue, 9 Aug 2011 23:27:02 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13082004" author="jvs" created="Wed, 10 Aug 2011 00:01:17 +0000"  >&lt;p&gt;I&apos;m getting many regression test failures due to EXPLAIN plan changes.&lt;/p&gt;</comment>
                            <comment id="13082006" author="jvs" created="Wed, 10 Aug 2011 00:02:57 +0000"  >&lt;p&gt;Whoops, reassigned to Ido accidentally; reassigning to Amareshwari.&lt;/p&gt;</comment>
                            <comment id="13082293" author="amareshwari" created="Wed, 10 Aug 2011 11:43:39 +0000"  >&lt;p&gt;Sorry John. Earlier patch has a bug. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Any other filter on &apos;udf selected as column alias in select&apos; will also be pushed down always. Do we want to do this?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;More on this: Here, currently the filter (along with udf) is pushed till TableScan. So essentially, we would apply the udf twice for the qualified rows. And it is expensive, if udf is expensive. So, I propose we should not push it beyond the select. Thoughts?&lt;/p&gt;</comment>
                            <comment id="13082469" author="jvs" created="Wed, 10 Aug 2011 16:57:09 +0000"  >&lt;p&gt;It&apos;s possible to avoid the double computation (by pushing the selection down too, similar to column pruning), but I&apos;m fine with skipping that and not pushing the expression beyond the select.&lt;/p&gt;</comment>
                            <comment id="13082473" author="amareshwari" created="Wed, 10 Aug 2011 17:01:55 +0000"  >&lt;p&gt;Here is a patch doing the change. Not pushing the filter on &apos;udf as column in select&apos; beyond select.&lt;/p&gt;

&lt;p&gt;All tests passed with the patch.&lt;/p&gt;</comment>
                            <comment id="13082481" author="jiraposter@reviews.apache.org" created="Wed, 10 Aug 2011 17:08:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1404/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1404/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-10 17:06:46.444966)&lt;/p&gt;


&lt;p&gt;Review request for hive, John Sichi and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;The filter on &apos;udf selected as column alias in select&apos; is no more pushed beyond the select.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Any filter on &apos;udf selected as column alias in select&apos; will be pushed down through the select operator, which it should not. &lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; title=&quot;filter is removed due to regression of HIVE-1538&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2344&quot;&gt;&lt;del&gt;HIVE-2344&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2344&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/ExprWalkerProcFactory.java 1156069 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java 1156069 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/ppd_udf_col.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ppd_udf_col.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1404/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1404/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;All tests pass with the patch.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Amareshwari&lt;/p&gt;
</comment>
                            <comment id="13083457" author="jvs" created="Thu, 11 Aug 2011 20:08:56 +0000"  >&lt;p&gt;Committed.  Thanks Amareshwari!&lt;/p&gt;</comment>
                            <comment id="13212986" author="hudson" created="Tue, 21 Feb 2012 21:42:02 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1268 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1268/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1268/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2791&quot; title=&quot;filter is still removed due to regression of HIVE-1538 althougth HIVE-2344&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2791&quot;&gt;&lt;del&gt;HIVE-2791&lt;/del&gt;&lt;/a&gt;: filter is still removed due to regression of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1538&quot; title=&quot;FilterOperator is applied twice with ppd on.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1538&quot;&gt;&lt;del&gt;HIVE-1538&lt;/del&gt;&lt;/a&gt; althougth &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; title=&quot;filter is removed due to regression of HIVE-1538&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2344&quot;&gt;&lt;del&gt;HIVE-2344&lt;/del&gt;&lt;/a&gt; (binlijin via hashutosh) (Revision 1291916)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1291916&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1291916&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ppd2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13547838" author="hudson" created="Wed, 9 Jan 2013 10:23:15 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2791&quot; title=&quot;filter is still removed due to regression of HIVE-1538 althougth HIVE-2344&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2791&quot;&gt;&lt;del&gt;HIVE-2791&lt;/del&gt;&lt;/a&gt;: filter is still removed due to regression of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1538&quot; title=&quot;FilterOperator is applied twice with ppd on.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1538&quot;&gt;&lt;del&gt;HIVE-1538&lt;/del&gt;&lt;/a&gt; althougth &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2344&quot; title=&quot;filter is removed due to regression of HIVE-1538&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2344&quot;&gt;&lt;del&gt;HIVE-2344&lt;/del&gt;&lt;/a&gt; (binlijin via hashutosh) (Revision 1291916)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1291916&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1291916&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ppd2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12471503">HIVE-1538</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12490007" name="hive-patch-2344-2.txt" size="26037" author="amareshwari" created="Wed, 10 Aug 2011 17:01:55 +0000"/>
                            <attachment id="12489828" name="hive-patch-2344.txt" size="22512" author="amareshwari" created="Tue, 9 Aug 2011 11:02:53 +0000"/>
                            <attachment id="12489827" name="ppd_udf_col.q.out.txt" size="14645" author="amareshwari" created="Tue, 9 Aug 2011 11:01:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 Aug 2011 00:00:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43496</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>When predicate pushdown is enabled, Hive would previously incorrectly push down predicates on non-deterministic function invocations when those were indirectly referenced via a nested SELECT list rather than directly in the filter expression.  After this change, Hive no longer pushes down filters over indirect references to function invocations of any kind (regardless of determinism).  Note that in Hive, even builtin operators such as + and CAST are treated as function invocations.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2345] NPE in reducer when using cross join with order by in sub select.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2345</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When running the following query:&lt;br/&gt;
select  * from &lt;br/&gt;
(select * from temp_table order by (id)) t&lt;br/&gt;
Join&lt;br/&gt;
(select * from temp_table) b&lt;/p&gt;


&lt;p&gt;We get the exceptions below:&lt;/p&gt;

&lt;p&gt;In stage 1:&lt;br/&gt;
2011-08-03 23:54:33,214 WARN org.apache.hadoop.mapred.Child: Error running child&lt;br/&gt;
java.lang.RuntimeException: Error in configuring object&lt;br/&gt;
at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)&lt;br/&gt;
at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)&lt;br/&gt;
at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:431)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:416)&lt;br/&gt;
at org.apache.hadoop.mapred.Child$4.run(Child.java:268)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at javax.security.auth.Subject.doAs(Subject.java:396)&lt;br/&gt;
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1115)&lt;br/&gt;
at org.apache.hadoop.mapred.Child.main(Child.java:262)&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)&lt;br/&gt;
... 9 more&lt;br/&gt;
Caused by: java.lang.RuntimeException: java.lang.NullPointerException&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecReducer.configure(ExecReducer.java:144)&lt;br/&gt;
... 14 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecReducer.configure(ExecReducer.java:129)&lt;br/&gt;
... 14 more&lt;br/&gt;
2011-08-03 23:54:33,217 INFO org.apache.hadoop.mapred.Task: Runnning cleanup for the task&lt;/p&gt;


&lt;p&gt;In stage 2:&lt;br/&gt;
2011-08-03 23:55:18,905 INFO org.apache.hadoop.hive.ql.exec.ExtractOperator: Initialization Done 3 OP&lt;br/&gt;
2011-08-03 23:55:18,908 FATAL ExecReducer: java.lang.NullPointerException&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.startGroup(CommonJoinOperator.java:341)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.Operator.startGroup(Operator.java:489)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.Operator.startGroup(Operator.java:489)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecReducer.reduce(ExecReducer.java:213)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:468)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:416)&lt;br/&gt;
at org.apache.hadoop.mapred.Child$4.run(Child.java:268)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at javax.security.auth.Subject.doAs(Subject.java:396)&lt;br/&gt;
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1115)&lt;br/&gt;
at org.apache.hadoop.mapred.Child.main(Child.java:262)&lt;/p&gt;

&lt;p&gt;2011-08-03 23:55:18,911 INFO org.apache.hadoop.mapred.TaskLogsTruncater: Initializing logs&apos; truncater with mapRetainSize=-1 and reduceRetainSize=-1&lt;br/&gt;
2011-08-03 23:55:18,913 WARN org.apache.hadoop.mapred.Child: Error running child&lt;br/&gt;
java.lang.RuntimeException: java.lang.NullPointerException&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecReducer.reduce(ExecReducer.java:268)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:468)&lt;br/&gt;
at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:416)&lt;br/&gt;
at org.apache.hadoop.mapred.Child$4.run(Child.java:268)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at javax.security.auth.Subject.doAs(Subject.java:396)&lt;br/&gt;
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1115)&lt;br/&gt;
at org.apache.hadoop.mapred.Child.main(Child.java:262)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.CommonJoinOperator.startGroup(CommonJoinOperator.java:341)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.Operator.startGroup(Operator.java:489)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.Operator.startGroup(Operator.java:489)&lt;br/&gt;
at org.apache.hadoop.hive.ql.exec.ExecReducer.reduce(ExecReducer.java:213)&lt;br/&gt;
... 7 more&lt;br/&gt;
2011-08-03 23:55:18,916 INFO org.apache.hadoop.mapred.Task: Runnning cleanup for the task&lt;/p&gt;


&lt;p&gt;The query succeeds when:&lt;/p&gt;

&lt;p&gt;We add the mapjoin :&lt;/p&gt;

&lt;p&gt;select /*+ MAPJOIN(b) */  * from &lt;br/&gt;
(select * from temp_table order by (id)) t&lt;br/&gt;
Join&lt;br/&gt;
(select * from temp_table) b&lt;/p&gt;

&lt;p&gt;or &lt;/p&gt;


&lt;p&gt;select /*+ MAPJOIN(t) */  * from &lt;br/&gt;
(select * from temp_table order by (id)) t&lt;br/&gt;
Join&lt;br/&gt;
(select * from temp_table) b&lt;/p&gt;


&lt;p&gt;Or use equi join:&lt;/p&gt;

&lt;p&gt;select   * from &lt;br/&gt;
(select * from temp_table order by (id)) t&lt;br/&gt;
Join&lt;br/&gt;
(select * from temp_table) b&lt;br/&gt;
on (b.id=t.id)&lt;/p&gt;

&lt;p&gt;Note: The size of the table temp_table doesn&apos;t matter.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12517891">HIVE-2345</key>
            <summary>NPE in reducer when using cross join with order by in sub select.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="inbalroze">Inbal Rosenshtock</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2011 07:07:07 +0000</created>
                <updated>Thu, 4 Aug 2011 07:07:07 +0000</updated>
                                            <version>0.7.1</version>
                                                        <due></due>
                            <votes>3</votes>
                                    <watches>3</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42161</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d30v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74266</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2346] Add hooks to run when execution fails.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2346</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently, when a query fails, the Post Execution Hooks are not run.&lt;/p&gt;

&lt;p&gt;Adding hooks to be run when a query fails could allow for better logging etc.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517941">HIVE-2346</key>
            <summary>Add hooks to run when execution fails.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2011 17:31:45 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:00 +0000</updated>
                            <resolved>Thu, 11 Aug 2011 04:18:41 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13079533" author="kevinwilfong" created="Thu, 4 Aug 2011 19:06:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13079534" author="jiraposter@reviews.apache.org" created="Thu, 4 Aug 2011 19:08:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a new type of hook, which will be run when a job fails.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2346&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1153966 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1153966 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java 1153966 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1295/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;

&lt;p&gt;In addition, I created a sample hook, which simply logged that it was run.  I verified it was run on a failure, but not when a job succeeded.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13081944" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 21:34:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1295/#review1364&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/#review1364&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1295/#comment3082&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/#comment3082&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    As a convention, we should declare the variable as interface (List in this case) rather than implementation (ArrayList). &lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1295/#comment3086&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/#comment3086&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    comments are not correct: post execution --&amp;gt; failure&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ning&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-08-04 19:06:43, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-08-04 19:06:43)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added a new type of hook, which will be run when a job fails.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2346&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1153966 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1153966 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java 1153966 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1295/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;In addition, I created a sample hook, which simply logged that it was run.  I verified it was run on a failure, but not when a job succeeded.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13081960" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 22:01:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-09 22:01:28.619424)&lt;/p&gt;


&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Made the changes requested by nzhang.&lt;/p&gt;

&lt;p&gt;Regarding the change ArrayList --&amp;gt; List, I had copied that code from the analogous methods for Post and Pre Exec hooks.  So I made the corresponding changes in those methods too.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a new type of hook, which will be run when a job fails.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2346&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1155569 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1155569 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java 1155569 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1295/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;

&lt;p&gt;In addition, I created a sample hook, which simply logged that it was run.  I verified it was run on a failure, but not when a job succeeded.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13081993" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 23:29:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1295/#review1370&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/#review1370&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1295/#comment3144&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/#comment3144&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Kevin, can you add this parameter to conf/hive-default.xml? We should add all newly introduced parameters to that file. &lt;/p&gt;

&lt;p&gt;    Otherwise it looks good to me. &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ning&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-08-09 22:01:28, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-08-09 22:01:28)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added a new type of hook, which will be run when a job fails.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2346&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1155569 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1155569 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java 1155569 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1295/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;In addition, I created a sample hook, which simply logged that it was run.  I verified it was run on a failure, but not when a job succeeded.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13081998" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 23:45:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1295/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-09 23:44:00.972625)&lt;/p&gt;


&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added the hive.exec.failure.hooks property to hive-default.xml&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a new type of hook, which will be run when a job fails.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2346&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1155569 &lt;br/&gt;
  trunk/conf/hive-default.xml 1155569 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1155569 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java 1155569 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1295/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1295/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;

&lt;p&gt;In addition, I created a sample hook, which simply logged that it was run.  I verified it was run on a failure, but not when a job succeeded.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13082145" author="nzhang" created="Wed, 10 Aug 2011 05:49:47 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13082898" author="nzhang" created="Thu, 11 Aug 2011 04:18:41 +0000"  >&lt;p&gt;Committed. Thanks Kevin!&lt;/p&gt;</comment>
                            <comment id="13083013" author="hudson" created="Thu, 11 Aug 2011 08:48:09 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #887 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/887/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/887/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2346&quot; title=&quot;Add hooks to run when execution fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2346&quot;&gt;&lt;del&gt;HIVE-2346&lt;/del&gt;&lt;/a&gt;. Add hooks to run when execution fails. (Kevin Wilfong via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1156480&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1156480&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/hooks/HookContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489383" name="HIVE-2346.1.patch.txt" size="3105" author="kevinwilfong" created="Thu, 4 Aug 2011 19:07:15 +0000"/>
                            <attachment id="12489912" name="HIVE-2346.2.patch.txt" size="4098" author="kevinwilfong" created="Tue, 9 Aug 2011 23:16:24 +0000"/>
                            <attachment id="12489915" name="HIVE-2346.3.patch.txt" size="4802" author="kevinwilfong" created="Tue, 9 Aug 2011 23:44:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 Aug 2011 19:08:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65484</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123826</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2347] Make Hadoop Job ID available after task finishes executing</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2347</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;After Map Reduce tasks finish the execute method (ExecDriver and BlockMergeTask) the Hadoop Job ID is inaccessible to the Driver, and hence the hooks it runs.  Expose this information could help to improve logging, debugging, etc.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517947">HIVE-2347</key>
            <summary>Make Hadoop Job ID available after task finishes executing</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2011 17:46:28 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:45 +0000</updated>
                            <resolved>Tue, 9 Aug 2011 19:05:17 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13079548" author="kevinwilfong" created="Thu, 4 Aug 2011 19:45:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1296/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1296/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13079549" author="jiraposter@reviews.apache.org" created="Thu, 4 Aug 2011 19:46:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1296/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1296/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a field for the Hadoop Job ID to the Task class.  This will make it accessible to the Driver and hence to the hooks for logging/debugging purposes.  By including it in the Task, we only need to check that the type of the task is MAPRED, before getting the job ID.&lt;/p&gt;

&lt;p&gt;I considered adding it to several places:&lt;/p&gt;

&lt;p&gt;as separate fields in ExecDriver and BlockMergeTask: this would require duplicating code, require conditions to determine the type of a task and casting to either ExecDriver or BlockMergeTask in order to get the JobID from them&lt;/p&gt;

&lt;p&gt;in the MapRedWork: this would require modifying a field in MapRedWork in the execute function, and I could not find a precedent for this&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2347&quot; title=&quot;Make Hadoop Job ID available after task finishes executing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2347&quot;&gt;&lt;del&gt;HIVE-2347&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2347&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2347&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 1153966 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java 1153966 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java 1153966 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1296/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1296/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran the TestCliDriver and TestNegativeCliDriver test suites and verified they passed.&lt;/p&gt;

&lt;p&gt;Also, created a sample post exec hook which simply logged the JobID for every map reduce task, and verified it.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13080289" author="nzhang" created="Fri, 5 Aug 2011 23:16:42 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13081041" author="nzhang" created="Mon, 8 Aug 2011 16:40:50 +0000"  >&lt;p&gt;Kevin, there are 2 failed unit tests: udtf_explode.q and udf_explode.q, both are in TestCliDriver. Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13081079" author="kevinwilfong" created="Mon, 8 Aug 2011 17:37:59 +0000"  >&lt;p&gt;I checked out a fresh copy of the source without my changes, and I&apos;m still seeing those tests fail.&lt;/p&gt;</comment>
                            <comment id="13081088" author="kevinwilfong" created="Mon, 8 Aug 2011 17:50:37 +0000"  >&lt;p&gt;It looks like it&apos;s just white space differences in the .q.out file.  The final diff in issue &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1735&quot; title=&quot;Extend Explode UDTF to handle Maps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1735&quot;&gt;&lt;del&gt;HIVE-1735&lt;/del&gt;&lt;/a&gt; has the spacing that matches the output I see, but the commit, for some reason, does not.&lt;/p&gt;</comment>
                            <comment id="13081357" author="kevinwilfong" created="Tue, 9 Aug 2011 01:28:32 +0000"  >&lt;p&gt;The .out files for those two unit tests were updated today, and they are passing for me now.&lt;/p&gt;</comment>
                            <comment id="13081843" author="nzhang" created="Tue, 9 Aug 2011 19:05:17 +0000"  >&lt;p&gt;Committed. Thanks Kevin!&lt;/p&gt;</comment>
                            <comment id="13082010" author="hudson" created="Wed, 10 Aug 2011 00:05:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #884 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/884/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/884/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2347&quot; title=&quot;Make Hadoop Job ID available after task finishes executing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2347&quot;&gt;&lt;del&gt;HIVE-2347&lt;/del&gt;&lt;/a&gt;. Make Hadoop Job ID available after task finish executing (Kevin Wilfong via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155493&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155493&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/rcfile/merge/BlockMergeTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Task.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489389" name="HIVE-2347.1.patch.txt" size="2051" author="kevinwilfong" created="Thu, 4 Aug 2011 19:46:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 Aug 2011 19:46:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65638</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2348] Group by and order by of the same columns fails semantic analysis</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2348</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;select offer, level_id, sum_cl_score as sumcl_floor&lt;br/&gt;
FROM xxx&lt;br/&gt;
GROUP BY offer, level_id, sumcl_floor &lt;br/&gt;
ORDER BY offer, level_id, sumcl_floor limit 1000000;&lt;br/&gt;
FAILED: Error in semantic analysis: Invalid Table Alias or Column Reference sumcl_floor&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517948">HIVE-2348</key>
            <summary>Group by and order by of the same columns fails semantic analysis</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="appodictic">Edward Capriolo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2011 17:47:54 +0000</created>
                <updated>Wed, 6 Feb 2013 09:23:51 +0000</updated>
                                            <version>0.7.1</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13125036" author="chinnalalam" created="Tue, 11 Oct 2011 13:54:59 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;The same query is not working in oracle and it is throwing below message&lt;/p&gt;

&lt;p&gt; Error: ORA-00904: &quot;SUMCL_FLOOR&quot;: invalid identifier&lt;/p&gt;

&lt;p&gt;But same query is working fine in MySql&lt;/p&gt;

&lt;p&gt;This type of queries should support in HIVE?&lt;br/&gt;
because in oracle it is not working and mysql it is working (Need some suggestions)&lt;/p&gt;

&lt;p&gt;Here problem may be the column alias. This query is not throwing any exception..&lt;/p&gt;

&lt;p&gt;select offer, level_id, sum_cl_score FROM xxx GROUP BY offer, level_id, sum_cl_score ORDER BY offer, level_id, sum_cl_score limit 1000000;&lt;/p&gt;

&lt;p&gt;Column Alias with group by is failing :&lt;/p&gt;

&lt;p&gt;select offer, level_id, sum_cl_score as sumcl_floor FROM xxx GROUP BY offer, level_id, sumcl_floor limit 1000000;&lt;/p&gt;

&lt;p&gt;FAILED: Error in semantic analysis: Line 1:89 Invalid table alias or column reference &apos;sumcl_floor&apos;: (possible column names are: offer, level_id, sum_cl_score)&lt;/p&gt;

&lt;p&gt;Column Alias with order by is passing :&lt;/p&gt;

&lt;p&gt;select offer, level_id, sum_cl_score as sumcl_floor FROM xxx ORDER BY offer, level_id, sumcl_floor limit 1000000;&lt;/p&gt;</comment>
                            <comment id="13125204" author="appodictic" created="Tue, 11 Oct 2011 17:23:38 +0000"  >&lt;p&gt;@Chinna&lt;br/&gt;
Thank you for looking. My problem is compounded because we are using multiple catalogs at times so many tables and columns are aliased. So I can not just drop aliases because then I would get failures with ambiguous column references &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; From an end user prospective this makes things difficult.&lt;/p&gt;</comment>
                            <comment id="13125611" author="chinnalalam" created="Wed, 12 Oct 2011 05:51:21 +0000"  >&lt;p&gt;@Edward&lt;br/&gt;
For above use case you can change the query like this it will work. No need to drop the aliases&lt;/p&gt;

&lt;p&gt;select offer, level_id, sum_cl_score as sumcl_floor&lt;br/&gt;
FROM xxx&lt;br/&gt;
GROUP BY offer, level_id, sum_cl_score &lt;br/&gt;
ORDER BY offer, level_id, sumcl_floor limit 1000000;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12631027">HIVE-3991</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 11 Oct 2011 13:54:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42160</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2349] Define semantics for --auxpath</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2349</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2269&quot; title=&quot;Hive --auxpath option can&amp;#39;t handle multiple colon separated values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2269&quot;&gt;&lt;del&gt;HIVE-2269&lt;/del&gt;&lt;/a&gt; it was discovered that there is some confusion as to exactly what the auxpath paramter can contain.  Pertinent questions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Can the entries just be directories (with all of the jars within the directory included), or a mix of directories and jars?&lt;/li&gt;
	&lt;li&gt;Can URIs specify the directories and/or files? If so, this will prevent a colon from being a delimiter of the list entries.  Can semicolons be included?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This blocks &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2269&quot; title=&quot;Hive --auxpath option can&amp;#39;t handle multiple colon separated values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2269&quot;&gt;&lt;del&gt;HIVE-2269&lt;/del&gt;&lt;/a&gt;.  At the very least, the official spec for this option should be added to the documentation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517990">HIVE-2349</key>
            <summary>Define semantics for --auxpath</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jghoman">Jakob Homan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2011 02:32:07 +0000</created>
                <updated>Fri, 5 Aug 2011 02:32:43 +0000</updated>
                                                                                <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12513071">HIVE-2269</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42159</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08ocf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48543</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2350] Improve RCFile Read Speed</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2350</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;By tweaking the RCFile$Reader implementation to allow more efficient memory access I was able to reduce CPU usage.  I measured the speed required to scan a gzipped RCFile, decompress and assemble into records.  CPU time was reduced by about 7% for a full table scan,  An improvement of about 2% was realised when a smaller subset of columns (3-5 out of tens) were selected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12517994">HIVE-2350</key>
            <summary>Improve RCFile Read Speed</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tarmstrong">Tim Armstrong</assignee>
                                    <reporter username="tarmstrong">Tim Armstrong</reporter>
                        <labels>
                            <label>performance</label>
                            <label>rcfile</label>
                    </labels>
                <created>Fri, 5 Aug 2011 03:01:48 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:54 +0000</updated>
                            <resolved>Tue, 23 Aug 2011 02:26:50 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Serializers/Deserializers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <timeoriginalestimate seconds="0">0h</timeoriginalestimate>
                            <timeestimate seconds="0">0h</timeestimate>
                                        <comments>
                            <comment id="13080056" author="nzhang" created="Fri, 5 Aug 2011 16:34:40 +0000"  >&lt;p&gt;Tim, can you post the diff to the review board (reviews.apache.org)? It&apos;s much easier to review and adding comments for large diffs. &lt;/p&gt;</comment>
                            <comment id="13080059" author="nzhang" created="Fri, 5 Aug 2011 16:36:39 +0000"  >&lt;p&gt;Also is this patch read for review? If so you can set the JIRA&apos;s status to &quot;Patch Available&quot;.&lt;/p&gt;</comment>
                            <comment id="13080091" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 17:17:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1309/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;By tweaking the RCFile$Reader implementation to allow more efficient memory access I was able to reduce CPU usage. I measured the speed required to scan a gzipped RCFile, decompress and assemble into records. CPU time was reduced by about 7% for a full table scan, An improvement of about 2% was realised when a smaller subset of columns (3-5 out of tens) were selected.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; title=&quot;Improve RCFile Read Speed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2350&quot;&gt;&lt;del&gt;HIVE-2350&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2350&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java 1154070 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1309/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran TestRCFile unit test.  Manually tested reading from warehouse table.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tim&lt;/p&gt;
</comment>
                            <comment id="13080180" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 19:59:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1309/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-05 19:58:03.986031)&lt;/p&gt;


&lt;p&gt;Review request for hive and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Made some further optimisations to reduce branches and condition checks in the innermost loop, reducing CPU usage in getCurrentRow by about 20-25%, giving a few % more improvement overall for table scans.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;By tweaking the RCFile$Reader implementation to allow more efficient memory access I was able to reduce CPU usage. I measured the speed required to scan a gzipped RCFile, decompress and assemble into records. CPU time was reduced by about 7% for a full table scan, An improvement of about 2% was realised when a smaller subset of columns (3-5 out of tens) were selected.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; title=&quot;Improve RCFile Read Speed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2350&quot;&gt;&lt;del&gt;HIVE-2350&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2350&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java 1154070 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1309/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran TestRCFile unit test.  Manually tested reading from warehouse table.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tim&lt;/p&gt;
</comment>
                            <comment id="13081042" author="jiraposter@reviews.apache.org" created="Mon, 8 Aug 2011 16:42:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1309/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-08 16:42:28.947782)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;By tweaking the RCFile$Reader implementation to allow more efficient memory access I was able to reduce CPU usage. I measured the speed required to scan a gzipped RCFile, decompress and assemble into records. CPU time was reduced by about 7% for a full table scan, An improvement of about 2% was realised when a smaller subset of columns (3-5 out of tens) were selected.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; title=&quot;Improve RCFile Read Speed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2350&quot;&gt;&lt;del&gt;HIVE-2350&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2350&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java 1154070 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1309/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran TestRCFile unit test.  Manually tested reading from warehouse table.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tim&lt;/p&gt;
</comment>
                            <comment id="13081061" author="he yongqiang" created="Mon, 8 Aug 2011 17:03:57 +0000"  >&lt;p&gt;sure, i will also take a look.&lt;/p&gt;</comment>
                            <comment id="13083793" author="jiraposter@reviews.apache.org" created="Thu, 11 Aug 2011 23:08:36 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1309/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-11 23:07:05.774106)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Minor change to avoid a compilation problem.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;By tweaking the RCFile$Reader implementation to allow more efficient memory access I was able to reduce CPU usage. I measured the speed required to scan a gzipped RCFile, decompress and assemble into records. CPU time was reduced by about 7% for a full table scan, An improvement of about 2% was realised when a smaller subset of columns (3-5 out of tens) were selected.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; title=&quot;Improve RCFile Read Speed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2350&quot;&gt;&lt;del&gt;HIVE-2350&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2350&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java 1156839 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1309/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1309/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran TestRCFile unit test.  Manually tested reading from warehouse table.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tim&lt;/p&gt;
</comment>
                            <comment id="13085351" author="cwsteinbach" created="Mon, 15 Aug 2011 21:44:31 +0000"  >&lt;p&gt;Committed to trunk. Thanks Tim!&lt;/p&gt;</comment>
                            <comment id="13087352" author="tarmstrong" created="Thu, 18 Aug 2011 22:25:32 +0000"  >&lt;p&gt;Hi Carl, &lt;br/&gt;
  Was this committed to trunk?  I&apos;m not seeing it there&lt;/p&gt;</comment>
                            <comment id="13088969" author="cwsteinbach" created="Mon, 22 Aug 2011 20:01:35 +0000"  >&lt;p&gt;@Tim: Yes, looks like closing this was a mistake on my part. Your latest patch looks good, but you forgot to click the box that gives license rights to the ASF. Can you please attach the patch again and this time click the box? Thanks.&lt;/p&gt;</comment>
                            <comment id="13088978" author="tarmstrong" created="Mon, 22 Aug 2011 20:22:02 +0000"  >&lt;p&gt;Oops - my mistake.&lt;/p&gt;</comment>
                            <comment id="13089024" author="cwsteinbach" created="Mon, 22 Aug 2011 21:22:56 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13089224" author="cwsteinbach" created="Tue, 23 Aug 2011 02:26:50 +0000"  >&lt;p&gt;Committed to trunk (for real this time!). Thanks Tim!&lt;/p&gt;</comment>
                            <comment id="13089329" author="hudson" created="Tue, 23 Aug 2011 07:45:28 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #909 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/909/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/909/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2350&quot; title=&quot;Improve RCFile Read Speed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2350&quot;&gt;&lt;del&gt;HIVE-2350&lt;/del&gt;&lt;/a&gt;. Improve RCFile Read Speed (Tim Armstrong via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160525&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1160525&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/io/RCFile.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489437" name="rcfile-2011-08-04.diff" size="8300" author="tarmstrong" created="Fri, 5 Aug 2011 03:06:35 +0000"/>
                            <attachment id="12489497" name="rcfile_opt_2011-08-05.diff" size="8374" author="tarmstrong" created="Fri, 5 Aug 2011 17:08:43 +0000"/>
                            <attachment id="12489541" name="rcfile_opt_2011-08-05b.diff" size="11197" author="tarmstrong" created="Fri, 5 Aug 2011 21:22:40 +0000"/>
                            <attachment id="12491255" name="rcfile_opt_2011-08-11.patch" size="10783" author="tarmstrong" created="Mon, 22 Aug 2011 20:21:08 +0000"/>
                            <attachment id="12490187" name="rcfile_opt_2011-08-11.patch" size="10783" author="tarmstrong" created="Thu, 11 Aug 2011 23:07:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Aug 2011 16:34:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123829</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2351] Partition names are not printed when hive.cli.print.header is set to &apos;true&apos; </title>
                <link>https://issues.apache.org/jira/browse/HIVE-2351</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When hive.cli.print.header is set to true, header information gets printed along with the query output. With &lt;em&gt;select *&lt;/em&gt;, the partition information also gets printed along with the query result but the partition header (label) is missing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518003">HIVE-2351</key>
            <summary>Partition names are not printed when hive.cli.print.header is set to &apos;true&apos; </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="amar_kamat">Amar Kamat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2011 07:51:58 +0000</created>
                <updated>Sat, 26 May 2012 00:31:14 +0000</updated>
                            <resolved>Sat, 26 May 2012 00:31:14 +0000</resolved>
                                                                    <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13169982" author="priyadarshini.r" created="Thu, 15 Dec 2011 05:57:05 +0000"  >&lt;p&gt;With the partitioned table, after setting hive.cli.print.header to true partition header is printed..&lt;br/&gt;
I think this issue is invalid&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 15 Dec 2011 05:57:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2352] create empty files if and only if table is bucketed and hive.enforce.bucketing=true</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2352</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;create table t1 (key int, value string) stored as rcfile;&lt;br/&gt;
insert overwrite table t1 select * from src where false;&lt;/p&gt;

&lt;p&gt;Creates an empty RCFile with no rows and size 151B. The file not should be created since there are no rows.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518065">HIVE-2352</key>
            <summary>create empty files if and only if table is bucketed and hive.enforce.bucketing=true</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="franklinhu">Franklin Hu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Aug 2011 18:34:29 +0000</created>
                <updated>Tue, 13 Sep 2011 21:09:32 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13080243" author="franklinhu" created="Fri, 5 Aug 2011 21:34:08 +0000"  >&lt;p&gt;Patch abides by &quot;Fix&quot; conditions in JIRA description.&lt;/p&gt;</comment>
                            <comment id="13080248" author="nzhang" created="Fri, 5 Aug 2011 21:43:50 +0000"  >&lt;p&gt;Franklin, a simpler description of your fix would be: create empty files if and only if table is bucketed and hive.enforce.bucketing=true, right? &lt;/p&gt;</comment>
                            <comment id="13080262" author="franklinhu" created="Fri, 5 Aug 2011 22:21:32 +0000"  >&lt;p&gt;fix var initialization, unit test styling&lt;/p&gt;</comment>
                            <comment id="13080276" author="nzhang" created="Fri, 5 Aug 2011 22:48:38 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13081044" author="nzhang" created="Mon, 8 Aug 2011 16:42:46 +0000"  >&lt;p&gt;Franklink, load_dyn_part*.q failed. Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13081093" author="franklinhu" created="Mon, 8 Aug 2011 18:00:33 +0000"  >&lt;p&gt;fixed null ptr, passes load_dyn_part*.q now&lt;/p&gt;</comment>
                            <comment id="13081809" author="nzhang" created="Tue, 9 Aug 2011 18:18:21 +0000"  >&lt;p&gt;Franklink there are 2 more diffs are the last change. input26.q. and bucketmapjoin2.q. It seems the changes are more involved than what we expect, can you run the whole unit tests before submitting the next fix? &lt;/p&gt;</comment>
                            <comment id="13089575" author="sdong" created="Tue, 23 Aug 2011 16:49:05 +0000"  >&lt;p&gt;Franklin&apos;s internship ended. Let me apply his patch and see whether there is any failed tests.&lt;/p&gt;</comment>
                            <comment id="13090399" author="sdong" created="Wed, 24 Aug 2011 18:45:17 +0000"  >&lt;p&gt;I ran tests twice. Both crashed. I think it is an important patch and will improve latency of some queries (like scanning a large dataset for one or two rows) dramatically (Currently I sometimes do a &quot;ORDER BY LIMIT BY&quot; to speed it up if I know the data set is small). We should raise the priority.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489542" name="hive-2352.1.patch" size="27793" author="franklinhu" created="Fri, 5 Aug 2011 21:34:08 +0000"/>
                            <attachment id="12489545" name="hive-2352.2.patch" size="27851" author="franklinhu" created="Fri, 5 Aug 2011 22:21:32 +0000"/>
                            <attachment id="12489719" name="hive-2352.3.patch" size="27874" author="franklinhu" created="Mon, 8 Aug 2011 18:00:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Aug 2011 21:43:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42157</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08ocn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2353] Optimize UDF LIKE</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2353</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12518097">HIVE-2353</key>
            <summary>Optimize UDF LIKE</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Aug 2011 01:13:26 +0000</created>
                <updated>Mon, 8 Sep 2014 09:09:51 +0000</updated>
                                                                            <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="14125331" author="lars_francke" created="Mon, 8 Sep 2014 09:09:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cwsteinbach&quot; class=&quot;user-hover&quot; rel=&quot;cwsteinbach&quot;&gt;Carl Steinbach&lt;/a&gt; do you have more details on what you meant here?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Sep 2014 09:09:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42156</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08oc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48542</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2354] Support automatic rebuilding of indexes when they go stale</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2354</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Support a mode where indexes will be automatically rebuilt when the table/partition they are based on is modified. So if index foo is built on table bar, and bar has it&apos;s contents overwritten, we should support a mode where index foo will automatically rebuild itself.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518125">HIVE-2354</key>
            <summary>Support automatic rebuilding of indexes when they go stale</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="salbiz">Syed S. Albiz</assignee>
                                    <reporter username="salbiz">Syed S. Albiz</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Aug 2011 22:22:00 +0000</created>
                <updated>Fri, 3 Mar 2017 09:41:38 +0000</updated>
                            <resolved>Wed, 24 Aug 2011 04:19:27 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Indexing</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13082227" author="jiraposter@reviews.apache.org" created="Wed, 10 Aug 2011 08:29:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, John Sichi and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b46976f &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cec0d46 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13082232" author="salbiz" created="Wed, 10 Aug 2011 08:40:18 +0000"  >&lt;p&gt;just realized this does not cover the case where indexes go stale due to LOAD DATA/ALTER TABLE/ALTER PARTITION invocations&lt;/p&gt;</comment>
                            <comment id="13085364" author="salbiz" created="Mon, 15 Aug 2011 21:59:24 +0000"  >&lt;p&gt;added clause for updating on LOAD DATA commands&lt;/p&gt;</comment>
                            <comment id="13085365" author="jiraposter@reviews.apache.org" created="Mon, 15 Aug 2011 22:01:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-15 22:01:14.270380)&lt;/p&gt;


&lt;p&gt;Review request for hive, John Sichi and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;added a clause for LOAD DATA&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b46976f &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cec0d46 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13085366" author="salbiz" created="Mon, 15 Aug 2011 22:01:39 +0000"  >&lt;p&gt;oops, wrong patch&lt;/p&gt;</comment>
                            <comment id="13086850" author="he yongqiang" created="Thu, 18 Aug 2011 07:22:02 +0000"  >&lt;p&gt;can u do an explain on &quot;INSERT OVERWRITE TABLE temp SELECT * FROM src;&quot; ?&lt;/p&gt;</comment>
                            <comment id="13086851" author="he yongqiang" created="Thu, 18 Aug 2011 07:23:10 +0000"  >&lt;p&gt;please add more explain statements to cover all cases where a indexupdater task may added.&lt;br/&gt;
otherwise it looks good.&lt;/p&gt;</comment>
                            <comment id="13086933" author="salbiz" created="Thu, 18 Aug 2011 10:27:42 +0000"  >&lt;p&gt;updated testcase with EXPLAIN statement on INSERT command&lt;/p&gt;</comment>
                            <comment id="13086934" author="jiraposter@reviews.apache.org" created="Thu, 18 Aug 2011 10:28:28 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-18 10:28:02.416294)&lt;/p&gt;


&lt;p&gt;Review request for hive, John Sichi and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b46976f &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cec0d46 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13086935" author="jiraposter@reviews.apache.org" created="Thu, 18 Aug 2011 10:30:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-18 10:28:36.489366)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He, John Sichi, and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;updated testcases to include an EXPLAIN statement on the INSERT command to show the auto-update jobs&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b46976f &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cec0d46 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13087520" author="he yongqiang" created="Fri, 19 Aug 2011 04:19:19 +0000"  >&lt;p&gt;running tests&lt;/p&gt;</comment>
                            <comment id="13087823" author="he yongqiang" created="Fri, 19 Aug 2011 17:36:16 +0000"  >&lt;p&gt;index_auto_update.q and index_stale.q failed. Can u take a look?&lt;/p&gt;</comment>
                            <comment id="13087903" author="salbiz" created="Fri, 19 Aug 2011 19:09:19 +0000"  >&lt;p&gt;I was setting the default setting on the AUTOUPDATE configuration variable to true, which was why the testcase was screwing up. Changed it to false by default, and explicitly set it in index_auto_update.q&lt;/p&gt;</comment>
                            <comment id="13087905" author="jiraposter@reviews.apache.org" created="Fri, 19 Aug 2011 19:10:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-19 19:10:10.969158)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He, John Sichi, and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Made the configuration variable false by default, and set it to true in the relevant tests&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 815f15a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cb7a542 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out 24900a1 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13087908" author="jiraposter@reviews.apache.org" created="Fri, 19 Aug 2011 19:20:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-19 19:20:00.521433)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He, John Sichi, and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 815f15a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cb7a542 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out 24900a1 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13087910" author="salbiz" created="Fri, 19 Aug 2011 19:32:59 +0000"  >&lt;p&gt;Actually, looking more closely at the testcase output, there is an issue with this patch. The timestamps set when the index is rebuilt are still coming up stale, so we don&apos;t see index usage in the EXPLAIN plan of the SELECT query. I will investigate further&lt;/p&gt;</comment>
                            <comment id="13087938" author="salbiz" created="Fri, 19 Aug 2011 20:21:21 +0000"  >&lt;p&gt;Moved a bunch of the logic to update index timestamps into the AlterIndex DDLTask rather than the DDLSemanticAnalyzer, so that the timestamp is guaranteed to be updated &lt;b&gt;after&lt;/b&gt; the base table is touched. This change is reflected in index_auto_update.q, as now we see that the check for index staleness in the SELECT passes and we use the index in index_auto_update.q as desired.&lt;/p&gt;</comment>
                            <comment id="13087939" author="jiraposter@reviews.apache.org" created="Fri, 19 Aug 2011 20:21:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1456/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-19 20:20:22.217903)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He, John Sichi, and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Moves a bunch of the logic to update index timestamps into the AlterIndex DDLTask rather than the DDLSemanticAnalyzer, so that the timestamp is guaranteed to be updated &lt;b&gt;after&lt;/b&gt; the base table is touched. This change is reflected in index_auto_update.q, as now we see that the check for index staleness in the SELECT passes and we use the index in index_auto_update.q as desired.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Chain a second set of tasks to the MoveTask for INSERT statements.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; title=&quot;Support automatic rebuilding of indexes when they go stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2354&quot;&gt;&lt;del&gt;HIVE-2354&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2354&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2354&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 815f15a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java c031f40 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java c17891c &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/IndexUpdater.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/LoadSemanticAnalyzer.java 6f311c6 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java cb7a542 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/AlterIndexDesc.java f0dfd00 &lt;br/&gt;
  ql/src/test/queries/clientpositive/index_auto_update.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out 24900a1 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1456/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1456/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Added testcase &quot;index_auto_update.q&quot;&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Syed&lt;/p&gt;
</comment>
                            <comment id="13089792" author="he yongqiang" created="Tue, 23 Aug 2011 21:47:18 +0000"  >&lt;p&gt;+1, doing another run of tests&lt;/p&gt;</comment>
                            <comment id="13090000" author="he yongqiang" created="Wed, 24 Aug 2011 04:19:27 +0000"  >&lt;p&gt;Committed, thanks Syed!&lt;/p&gt;</comment>
                            <comment id="15893081" author="icook" created="Thu, 2 Mar 2017 21:46:05 +0000"  >&lt;p&gt;The config property hive.optimize.index.autoupdate was missing from the &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Configuration Properties wiki doc&lt;/a&gt;. I added it.&lt;/p&gt;</comment>
                            <comment id="15894002" author="lefty@hortonworks.com" created="Fri, 3 Mar 2017 09:41:38 +0000"  >&lt;p&gt;Thanks for the documentation, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=icook&quot; class=&quot;user-hover&quot; rel=&quot;icook&quot;&gt;Ian Cook&lt;/a&gt;!  Here&apos;s a direct link:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.optimize.index.autoupdate&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Configuration Properties &amp;#8211; hive.optimize.index.autoupdate &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489951" name="HIVE-2354.1.patch" size="21723" author="salbiz" created="Wed, 10 Aug 2011 08:20:57 +0000"/>
                            <attachment id="12490476" name="HIVE-2354.2.patch" size="6353" author="salbiz" created="Mon, 15 Aug 2011 21:59:24 +0000"/>
                            <attachment id="12490477" name="HIVE-2354.3.patch" size="23459" author="salbiz" created="Mon, 15 Aug 2011 22:01:39 +0000"/>
                            <attachment id="12490781" name="HIVE-2354.4.patch" size="30040" author="salbiz" created="Thu, 18 Aug 2011 10:27:42 +0000"/>
                            <attachment id="12490989" name="HIVE-2354.5.patch" size="29402" author="salbiz" created="Fri, 19 Aug 2011 19:09:18 +0000"/>
                            <attachment id="12490999" name="HIVE-2354.6.patch" size="38973" author="salbiz" created="Fri, 19 Aug 2011 20:20:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Aug 2011 08:29:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i010bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2355] hiveserver doesn&apos;t accept --auxpath option</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2355</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I tried to run hiveserver with --auxpath using following command line:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/hive --auxpath /Users/achi/git/hive/build/dist/lib/hive-hbase-handler-0.8.0-SNAPSHOT.jar --service hiveserver
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, it is not transformed into -hiveconf in the final command:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-hiveconf hive.aux.jars.path=file:&lt;span class=&quot;code-comment&quot;&gt;///Users/achi/git/hive/build/dist/lib/hive-hbase-handler-0.8.0-SNAPSHOT.jar&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2139&quot; title=&quot;Enables HiveServer to accept -hiveconf option&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2139&quot;&gt;&lt;del&gt;HIVE-2139&lt;/del&gt;&lt;/a&gt; has enabled HiveServer to accept -hiveconf option. It seems reasonable to allow --auxpath specified in command line.&lt;/p&gt;</description>
                <environment>&lt;p&gt;MacOS Lion &#65291; Hive 0.8.0&lt;/p&gt;</environment>
        <key id="12518185">HIVE-2355</key>
            <summary>hiveserver doesn&apos;t accept --auxpath option</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="achichen">Achi Chen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 09:09:05 +0000</created>
                <updated>Mon, 21 Jan 2013 07:51:39 +0000</updated>
                                            <version>0.8.0</version>
                    <version>0.9.0</version>
                                                    <component>CLI</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13080860" author="achichen" created="Mon, 8 Aug 2011 09:23:16 +0000"  >&lt;p&gt;This patch simply add @HIVE_OPTS into /bin/ext/hiveserver.sh to solve this problem&lt;/p&gt;</comment>
                            <comment id="13080863" author="jiraposter@reviews.apache.org" created="Mon, 8 Aug 2011 09:32:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1315/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1315/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch simply add @HIVE_OPTS into /bin/ext/hiveserver.sh to solve this problem&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2355&quot; title=&quot;hiveserver doesn&amp;#39;t accept --auxpath option&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2355&quot;&gt;HIVE-2355&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2355&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2355&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  bin/ext/hiveserver.sh d83be46 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1315/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1315/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Achi&lt;/p&gt;
</comment>
                            <comment id="13548553" author="gabriel.reid" created="Wed, 9 Jan 2013 15:00:04 +0000"  >&lt;p&gt;I&apos;ve tested the attached patch, and it appears to work exactly as it should (also meaning that extension SerDes and StorageHandlers now work via hiveserver). Any chance of getting this committed?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489666" name="HIVE-2355.1.patch" size="349" author="achichen" created="Mon, 8 Aug 2011 09:23:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Aug 2011 09:32:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42155</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hiveserver </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2356] Fix udtf_explode.q and udf_explode.q test failures</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2356</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12518228">HIVE-2356</key>
            <summary>Fix udtf_explode.q and udf_explode.q test failures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 18:07:30 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:58 +0000</updated>
                            <resolved>Tue, 9 Aug 2011 00:44:51 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13081125" author="cwsteinbach" created="Mon, 8 Aug 2011 18:48:28 +0000"  >&lt;p&gt;@Amareshwari: Can you please take a look at this? Thanks.&lt;/p&gt;</comment>
                            <comment id="13081331" author="jvs" created="Tue, 9 Aug 2011 00:27:43 +0000"  >&lt;p&gt;+1.  Will commit.&lt;/p&gt;</comment>
                            <comment id="13081333" author="sohanjain" created="Tue, 9 Aug 2011 00:36:12 +0000"  >&lt;p&gt;@Carl: out of curiosity, what was the fix here?  I was trying to trace this error for a little while.&lt;/p&gt;</comment>
                            <comment id="13081337" author="jvs" created="Tue, 9 Aug 2011 00:44:51 +0000"  >&lt;p&gt;Committed.  Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13081394" author="cwsteinbach" created="Tue, 9 Aug 2011 03:13:51 +0000"  >&lt;p&gt;@Sohan: The test failures were a result of some trailing whitespace getting excluded from the updates for udtf_explode.q.out and udf_exlode.q.out, but I&apos;m still not exactly sure how this happened.&lt;/p&gt;</comment>
                            <comment id="13081437" author="hudson" created="Tue, 9 Aug 2011 04:47:04 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #882 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/882/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/882/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2356&quot; title=&quot;Fix udtf_explode.q and udf_explode.q test failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2356&quot;&gt;&lt;del&gt;HIVE-2356&lt;/del&gt;&lt;/a&gt;. Fix udtf_explode.q and udf_explode.q test failures&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155176&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_explode.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udtf_explode.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489726" name="HIVE-2356-fix-explode.1.patch.txt" size="46867" author="cwsteinbach" created="Mon, 8 Aug 2011 18:47:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 9 Aug 2011 00:27:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123832</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2357] Support connection timeout in hive JDBC</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2357</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12518231">HIVE-2357</key>
            <summary>Support connection timeout in hive JDBC</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="vaggarw">Vaibhav Aggarwal</assignee>
                                    <reporter username="vaggarw">Vaibhav Aggarwal</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 18:47:12 +0000</created>
                <updated>Thu, 11 Aug 2016 05:08:30 +0000</updated>
                                                                                <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12996524">HIVE-14517</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42154</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123833</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2358] JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2358</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;My patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1631&quot; title=&quot;JDBC driver returns wrong precision, scale, or column size for some data types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1631&quot;&gt;&lt;del&gt;HIVE-1631&lt;/del&gt;&lt;/a&gt; did not ensure the following (from comment on 1631):&lt;br/&gt;
-------------&lt;br/&gt;
Mythili Gopalakrishnan added a comment - 08/Aug/11 08:42&lt;/p&gt;

&lt;p&gt;Just tested this fix and does NOT work correctly. Here are my findings on a FLOAT column&lt;/p&gt;

&lt;p&gt;Without Patch on a FLOAT Column&lt;br/&gt;
--------------------------------&lt;br/&gt;
DatabaseMetaData.getColumns () COLUMN_SIZE returns 12&lt;br/&gt;
DatabaseMetaData.getColumns () DECIMAL_DIGITS - returns 0&lt;/p&gt;

&lt;p&gt;ResultSetMetaData.getPrecision() returns 0&lt;br/&gt;
ResultSetMetaData.getScale() returns 0&lt;/p&gt;

&lt;p&gt;With Patch on a FLOAT Column&lt;br/&gt;
----------------------------&lt;br/&gt;
DatabaseMetaData.getColumns () COLUMN_SIZE returns 24&lt;br/&gt;
DatabaseMetaData.getColumns () DECIMAL_DIGITS - returns 0&lt;/p&gt;

&lt;p&gt;ResultSetMetaData.getPrecision() returns 7&lt;br/&gt;
ResultSetMetaData.getScale() returns 7&lt;/p&gt;

&lt;p&gt;Also both DatabaseMetadata and ResultSetMetaData must return the same information for Precision and Scale for FLOAT,DOUBLE types.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518249">HIVE-2358</key>
            <summary>JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phunt">Patrick Hunt</assignee>
                                    <reporter username="phunt">Patrick Hunt</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 21:43:51 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:45 +0000</updated>
                            <resolved>Mon, 15 Aug 2011 07:23:48 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13081225" author="phunt" created="Mon, 8 Aug 2011 21:45:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; title=&quot;JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2358&quot;&gt;&lt;del&gt;HIVE-2358&lt;/del&gt;&lt;/a&gt; addresses a problem identified in patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1631&quot; title=&quot;JDBC driver returns wrong precision, scale, or column size for some data types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1631&quot;&gt;&lt;del&gt;HIVE-1631&lt;/del&gt;&lt;/a&gt; (post commit).&lt;/p&gt;</comment>
                            <comment id="13081234" author="phunt" created="Mon, 8 Aug 2011 21:58:37 +0000"  >&lt;p&gt;This patch fixes the problem identified by Mythili and also adds testing to verify.&lt;/p&gt;</comment>
                            <comment id="13081610" author="mgk.424@gmail.com" created="Tue, 9 Aug 2011 13:17:31 +0000"  >&lt;p&gt;Tested this patch and here are my results.&lt;/p&gt;

&lt;p&gt;With Patch  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; title=&quot;JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2358&quot;&gt;&lt;del&gt;HIVE-2358&lt;/del&gt;&lt;/a&gt; on a FLOAT Column&lt;br/&gt;
---------------------------------------&lt;br/&gt;
DatabaseMetaData.getColumns () COLUMN_SIZE returns 7&lt;br/&gt;
DatabaseMetaData.getColumns () DECIMAL_DIGITS - returns 7&lt;/p&gt;

&lt;p&gt;ResultSetMetaData.getPrecision() returns 7&lt;br/&gt;
ResultSetMetaData.getScale() returns 7&lt;/p&gt;

&lt;p&gt;With Patch  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; title=&quot;JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2358&quot;&gt;&lt;del&gt;HIVE-2358&lt;/del&gt;&lt;/a&gt; on a DOUBLE Column&lt;br/&gt;
---------------------------------------&lt;br/&gt;
DatabaseMetaData.getColumns () COLUMN_SIZE returns 15&lt;br/&gt;
DatabaseMetaData.getColumns () DECIMAL_DIGITS - returns 15&lt;/p&gt;

&lt;p&gt;ResultSetMetaData.getPrecision() returns 15&lt;br/&gt;
ResultSetMetaData.getScale() returns 15&lt;/p&gt;

&lt;p&gt;--Mythili&lt;/p&gt;</comment>
                            <comment id="13081744" author="phunt" created="Tue, 9 Aug 2011 16:33:03 +0000"  >&lt;p&gt;Thanks Mythili, based on your previous comment you consider this valid output? (i.e. consistent). Do the values themselves seem reasonable to you? Are you ok for this patch to get committed?&lt;/p&gt;</comment>
                            <comment id="13082135" author="mgk.424@gmail.com" created="Wed, 10 Aug 2011 04:58:15 +0000"  >&lt;p&gt;Yes Patrick, I am OK for this patch to get committed. &lt;/p&gt;</comment>
                            <comment id="13082697" author="jiraposter@reviews.apache.org" created="Wed, 10 Aug 2011 21:41:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1459/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1459/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and Carl Steinbach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;make the returned values consistent.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; title=&quot;JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2358&quot;&gt;&lt;del&gt;HIVE-2358&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2358&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSetMetaData.java 2aa7727 &lt;br/&gt;
  jdbc/src/java/org/apache/hadoop/hive/jdbc/JdbcColumn.java 43cc2a3 &lt;br/&gt;
  jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java d72cf43 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1459/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1459/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;added new unit tests&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Patrick&lt;/p&gt;
</comment>
                            <comment id="13084946" author="cwsteinbach" created="Mon, 15 Aug 2011 02:38:40 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13084980" author="cwsteinbach" created="Mon, 15 Aug 2011 07:23:48 +0000"  >&lt;p&gt;Committed to trunk. Thanks Patrick!&lt;/p&gt;</comment>
                            <comment id="13085044" author="hudson" created="Mon, 15 Aug 2011 11:55:40 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #896 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/896/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/896/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2358&quot; title=&quot;JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2358&quot;&gt;&lt;del&gt;HIVE-2358&lt;/del&gt;&lt;/a&gt;. JDBC DatabaseMetaData and ResultSetMetaData need to match for particular types (Patrick Hunt via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1157728&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1157728&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/src/java/org/apache/hadoop/hive/jdbc/JdbcColumn.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/src/java/org/apache/hadoop/hive/jdbc/HiveResultSetMetaData.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12473884">HIVE-1631</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489754" name="HIVE-2358.patch" size="16612" author="phunt" created="Mon, 8 Aug 2011 21:58:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 9 Aug 2011 13:17:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05il3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2359] DESCRIBE FUNCTION EXTENDED should print name of implementing class</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2359</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12518257">HIVE-2359</key>
            <summary>DESCRIBE FUNCTION EXTENDED should print name of implementing class</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 23:13:34 +0000</created>
                <updated>Sat, 6 Dec 2014 05:23:27 +0000</updated>
                                                                            <component>UDF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42153</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08nh3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48402</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2360] create dynamic partition if and only if intermediate source has files</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2360</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;There are some conditions under which a partition description is created due to insert overwriting a table using dynamic partitioning for partitions that that are empty (have no files).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518267">HIVE-2360</key>
            <summary>create dynamic partition if and only if intermediate source has files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="franklinhu">Franklin Hu</assignee>
                                    <reporter username="franklinhu">Franklin Hu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Aug 2011 01:00:27 +0000</created>
                <updated>Mon, 17 Aug 2015 18:38:21 +0000</updated>
                            <resolved>Mon, 17 Aug 2015 18:38:21 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13081780" author="nzhang" created="Tue, 9 Aug 2011 17:29:21 +0000"  >&lt;p&gt;Franklin, can you create a review request? That&apos;s much easier to comment. Two comments here: &lt;/p&gt;

&lt;p&gt; 1) in dynamic partition inserts, a subquery corresponding to a partition is created only if there is a row that should be inserted into that partition, which means the directory should not be empty. If the directory is empty, most likely there is a bug there and we should fix that bug instead. &lt;br/&gt;
 2) the function Utilities.getFileStatusRecurse() is quite expensive. We should avoid using it and use cached results (it&apos;s called somewhere else before). &lt;/p&gt;</comment>
                            <comment id="13081992" author="franklinhu" created="Tue, 9 Aug 2011 23:28:22 +0000"  >&lt;p&gt;refactor to use one call to Utilities.getFileStatusRecurse()&lt;/p&gt;</comment>
                            <comment id="13081995" author="jiraposter@reviews.apache.org" created="Tue, 9 Aug 2011 23:31:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1442/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1442/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Ning Zhang and Siying Dong.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;There are some conditions under which partition descriptions are created in memory and committed to the metastore despite there being no intermediate or final finals in that directory (due to dynamic partitioning).&lt;br/&gt;
In this change, a check is done to only call loadPartitions that have files in them.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2360&quot; title=&quot;create dynamic partition if and only if intermediate source has files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2360&quot;&gt;&lt;del&gt;HIVE-2360&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2360&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2360&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1155968 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1442/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1442/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests pass&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Franklin&lt;/p&gt;
</comment>
                            <comment id="13103145" author="sdong" created="Mon, 12 Sep 2011 22:43:08 +0000"  >&lt;p&gt;Franklin finished his internship and left. We should find another one to finish the task.&lt;/p&gt;</comment>
                            <comment id="13132289" author="kaushik" created="Fri, 21 Oct 2011 02:40:38 +0000"  >&lt;p&gt;The patch (&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12489913/hive-2360.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12489913/hive-2360.2.patch&lt;/a&gt;) passes all the unit tests.&lt;/p&gt;</comment>
                            <comment id="13135732" author="hudson" created="Wed, 26 Oct 2011 05:46:11 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1035 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1035/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1035/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2360&quot; title=&quot;create dynamic partition if and only if intermediate source has files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2360&quot;&gt;&lt;del&gt;HIVE-2360&lt;/del&gt;&lt;/a&gt; create dynamic partition if and only if intermediate source has files (Franklin Hu, Kaushik Lakshminarayanan via Siying Dong)&lt;/p&gt;

&lt;p&gt;sdong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1188989&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1188989&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489789" name="hive-2360.1.patch" size="1261" author="franklinhu" created="Tue, 9 Aug 2011 01:04:32 +0000"/>
                            <attachment id="12489913" name="hive-2360.2.patch" size="3592" author="franklinhu" created="Tue, 9 Aug 2011 23:28:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 9 Aug 2011 17:29:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35796</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2361]  Add some UDFs which help to migrate Oracle to Hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2361</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Here some UDFs which can be matched to oracle functions:&lt;br/&gt;
There are two kinds of oracle functions. one is scalar function and another is analytic function.&lt;br/&gt;
Most scalar functions in Oracle can be converted to hive&apos;s udf directly.  &lt;/p&gt;

&lt;p&gt;Oracle Scalar Function&lt;/p&gt;

&lt;p&gt;GenericUDFDecode : Compares first argument to each other value one by one. e.g., DECODE(x,0,&apos;zero&apos;,1,&apos;one&apos;) will return &apos;zero&apos; if x is 0&lt;br/&gt;
GenericUDFGreatest : Return the greatest of the list of one or more expressions. e.g., GREATEST(2,5,12,3) will return 12&lt;br/&gt;
GenericUDFInstr : Return the location of a substring in a string. e.g., INSTR(&apos;next&apos;, &apos;e&apos;) will return 2&lt;br/&gt;
GenericUDFLnnvl : Evaluate a condition when one or both operands of the condition may be null. e.g., LNNVL(2 &amp;gt; 4) will return true&lt;br/&gt;
GenericUDFNVL : Replace null with a string in the results of a query. e.g., NVL(null,&apos;hive&apos;) will return hive&lt;br/&gt;
GenericUDFNVL2 : Determine the value returned by a query based on whether a specified expression is null or not null. e.g., NVL2(null,&apos;not null&apos;,&apos;null value&apos;) will return &apos;null value&apos;&lt;br/&gt;
GenericUDFToNumber : Convert a string to a number. e.g., TO_NUMBER(&apos;112&apos;,&apos;999&apos;) will return 112&lt;br/&gt;
GenericUDFTrunc : Returns a date truncated to a specific unit of measure. e.g., TRUNC(&apos;2002-11-02 01:01:01&apos;,&apos;YYYY&apos;) will return &apos;2002-01-01 00:00:00&apos;&lt;/p&gt;


&lt;p&gt;Oracle Analytic Function&lt;/p&gt;

&lt;p&gt;Most analytic functions in Oracle can&apos;t be converted to hive&apos;s query and udf directly.&lt;br/&gt;
Following udfs should be used with DISTRIBUTED, SORT BY and HASH of hive to support analytic functions &lt;/p&gt;

&lt;p&gt;e.q., SELECT &lt;em&gt;FUNC&lt;/em&gt;(hash(col1), col2, ...) FROM SELECT ~ FROM table DISTRIBUTED BY hash(col1) SORT BY col1, col2 ...&lt;/p&gt;

&lt;p&gt;GenericUDFSum : Calculate a cumulative sum.&lt;br/&gt;
GenericUDFRank : Assign a sequential order, or rank within some group based on key.&lt;br/&gt;
GenericUDFDenseRank : Act like RANK function except that it assigns consecutive ranks.&lt;br/&gt;
GenericUDFRowNumber : Return sequence integer value within some group based on key.&lt;br/&gt;
GenericUDFMax : Determine the highest value within some group based on key.&lt;br/&gt;
GenericUDFMin : Determine the lowest value within some group based on key.&lt;br/&gt;
GenericUDFLag : Access data from a previous row.&lt;/p&gt;

&lt;p&gt;This udfs was developed with hive-pdk&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518270">HIVE-2361</key>
            <summary> Add some UDFs which help to migrate Oracle to Hive</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="miloveme">JunHo Cho</assignee>
                                    <reporter username="miloveme">JunHo Cho</reporter>
                        <labels>
                            <label>features</label>
                    </labels>
                <created>Tue, 9 Aug 2011 01:24:37 +0000</created>
                <updated>Fri, 14 Nov 2014 12:25:16 +0000</updated>
                                            <version>0.8.0</version>
                                                    <component>UDF</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>13</watches>
                                                                <comments>
                            <comment id="13142542" author="aniket486" created="Wed, 2 Nov 2011 21:13:35 +0000"  >&lt;p&gt;This issue depends on Hive-2524 for better utility functions. I suggest to commit these UDFs on 0.8. I will create a patch for the same.&lt;/p&gt;</comment>
                            <comment id="13458257" author="cwsteinbach" created="Tue, 18 Sep 2012 22:44:02 +0000"  >&lt;p&gt;@JunHo: It would be great to get these committed. Do you have time to modify the patch so that they are added as standard UDFs? Thanks.&lt;/p&gt;</comment>
                            <comment id="13578207" author="dilbuzz" created="Thu, 14 Feb 2013 07:51:01 +0000"  >&lt;p&gt;New to using UDF&apos;s on hive. But implemented these on hive 0.9.0 and hadoop 1.1.1. Was able to add jar to hive and kicked the sample sql&lt;br/&gt;
SELECT t.empno, t.deptno, t.sal, nexr_sum(hash(t.deptno),t.sal) as sal_sum&lt;br/&gt;
FROM (&lt;br/&gt;
select a.empno, a.deptno, a.sal from emp a&lt;br/&gt;
distribute by hash(a.deptno)&lt;br/&gt;
sort BY a.deptno, a.empno&lt;br/&gt;
) t;&lt;/p&gt;

&lt;p&gt;The sql failed with errors &lt;/p&gt;


&lt;p&gt;2013-02-13 23:30:18,925 INFO org.apache.hadoop.mapred.JobTracker: Adding task (REDUCE) &apos;attempt_201302132324_0002_r_000000_3&apos; to tip task_201302132324_0002_r_000000, for tracker &apos;tracker_192.168.0.151:localhost/127.0.0.1:50099&apos;&lt;br/&gt;
2013-02-13 23:30:18,925 INFO org.apache.hadoop.mapred.JobTracker: Removing task &apos;attempt_201302132324_0002_r_000000_2&apos;&lt;br/&gt;
2013-02-13 23:30:26,484 INFO org.apache.hadoop.mapred.TaskInProgress: Error from attempt_201302132324_0002_r_000000_3: java.lang.RuntimeException: Error in configuring object&lt;br/&gt;
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)&lt;br/&gt;
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)&lt;br/&gt;
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)&lt;br/&gt;
	at org.apache.hadoop.mapred.ReduceTask.runOldReducer(ReduceTask.java:486)&lt;br/&gt;
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:421)&lt;br/&gt;
	at org.apache.hadoop.mapred.Child$4.run(Child.java:255)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:396)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1136)&lt;br/&gt;
	at org.apache.hadoop.mapred.Child.main(Child.java:249)&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:88)&lt;br/&gt;
	... 9 more&lt;br/&gt;
Caused by: java.lang.RuntimeException: Reduce operator initialization failed&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.ExecReducer.configure(ExecReducer.java:157)&lt;br/&gt;
	... 14 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.ExprNodeGenericFuncEvaluator.initialize(ExprNodeGenericFuncEvaluator.java:137)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluators(Operator.java:896)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initEvaluatorsAndReturnStruct(Operator.java:922)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.SelectOperator.initializeOp(SelectOperator.java:60)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:357)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:433)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initializeChildren(Operator.java:389)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.ExtractOperator.initializeOp(ExtractOperator.java:40)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.Operator.initialize(Operator.java:357)&lt;br/&gt;
	at org.apache.hadoop.hive.ql.exec.ExecReducer.configure(ExecReducer.java:150)&lt;br/&gt;
	... 14 more&lt;/p&gt;

&lt;p&gt;2013-02-13 23:30:29,819 INFO org.apache.hadoop.mapred.TaskInProgress: TaskInProgress task_201302132324_0002_r_000000 has failed 4 times.&lt;br/&gt;
2013-02-13 23:30:29,820 INFO org.apache.hadoop.mapred.JobInProgress: TaskTracker at &apos;192.168.0.151&apos; turned &apos;flaky&apos;&lt;br/&gt;
.... 12 more lines..&lt;/p&gt;


&lt;p&gt;Tried different function &quot;GenericUDFMax&quot;.. same error.&lt;/p&gt;

&lt;p&gt;Any pointers/advise, what could be wrong?&lt;/p&gt;</comment>
                            <comment id="13578209" author="aniket486" created="Thu, 14 Feb 2013 07:57:29 +0000"  >&lt;p&gt;Please post this discussion to hive-user mailing list for faster help.&lt;/p&gt;</comment>
                            <comment id="13578222" author="dilbuzz" created="Thu, 14 Feb 2013 08:20:45 +0000"  >&lt;p&gt;can you post the url for discussion/forum for  hive-user mailing list?. or is it just the email address I need to send the details about the issue?&lt;/p&gt;</comment>
                            <comment id="13853089" author="kostiantyn" created="Thu, 19 Dec 2013 18:10:16 +0000"  >&lt;p&gt;It seems useful, specially Scalar functions... does this code available somewhere?&lt;/p&gt;</comment>
                            <comment id="14212223" author="mylogin13" created="Fri, 14 Nov 2014 12:25:16 +0000"  >&lt;p&gt;hi Neelesh,&lt;/p&gt;

&lt;p&gt;were you able to resolve this issue?, let me know how, I am currently getting the same stack trace while running an UDF.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12528591">HIVE-2524</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489791" name="nexr-udf.tar" size="189440" author="miloveme" created="Tue, 9 Aug 2011 01:25:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 2 Nov 2011 21:13:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42152</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0a45z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56948</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2362] HiveConf properties not appearing in the output of &apos;set&apos; or &apos;set -v&apos;</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2362</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12518279">HIVE-2362</key>
            <summary>HiveConf properties not appearing in the output of &apos;set&apos; or &apos;set -v&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Aug 2011 03:30:32 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:00 +0000</updated>
                            <resolved>Wed, 7 Dec 2011 01:29:47 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                    <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13081401" author="cwsteinbach" created="Tue, 9 Aug 2011 03:32:48 +0000"  >&lt;p&gt;HiveConf currently includes definitions for the following Hadoop properties:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    MAPREDMAXSPLITSIZE(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapred.max.split.size&quot;&lt;/span&gt;, 256000000L),
    MAPREDMINSPLITSIZE(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapred.min.split.size&quot;&lt;/span&gt;, 1L),
    MAPREDMINSPLITSIZEPERNODE(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapred.min.split.size.per.rack&quot;&lt;/span&gt;, 1L),
    MAPREDMINSPLITSIZEPERRACK(&lt;span class=&quot;code-quote&quot;&gt;&quot;mapred.min.split.size.per.node&quot;&lt;/span&gt;, 1L),
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13081405" author="cwsteinbach" created="Tue, 9 Aug 2011 03:37:42 +0000"  >&lt;p&gt;However, only &lt;tt&gt;mapred.min.split.size&lt;/tt&gt; appears in the output of &lt;tt&gt;set -v&lt;/tt&gt;,&lt;br/&gt;
and none of these properties appear in the output of &lt;tt&gt;set&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;% hive -e &apos;set&apos; | egrep &apos;^mapred.(min|max).*&apos;
% hive -e &apos;set -v&apos; | egrep &apos;^mapred.(min|max).*&apos;
mapred.min.split.size=0
%
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like mapred.min.split.size is showing up because it&apos;s set in&lt;br/&gt;
build/hadoopcore/hadoop-0.20.1/src/mapred/mapred-default.xml&lt;/p&gt;</comment>
                            <comment id="13154446" author="jvs" created="Mon, 21 Nov 2011 20:20:55 +0000"  >&lt;p&gt;Carl, are we deferring this for 0.8?&lt;/p&gt;</comment>
                            <comment id="13159570" author="jiraposter@reviews.apache.org" created="Tue, 29 Nov 2011 21:59:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2960/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2362&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 94e68b4 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2960/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13159625" author="jvs" created="Tue, 29 Nov 2011 23:10:12 +0000"  >&lt;p&gt;Need a testcase, right?&lt;/p&gt;</comment>
                            <comment id="13163044" author="jiraposter@reviews.apache.org" created="Mon, 5 Dec 2011 21:16:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2960/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-12-05 21:15:13.146776)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated diff including a new testcase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2362&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  eclipse-templates/.classpath b020907 &lt;br/&gt;
  common/src/test/resources/hive-site.xml PRE-CREATION &lt;br/&gt;
  conf/hive-default.xml 53eca0e &lt;br/&gt;
  common/src/test/org/apache/hadoop/hive/conf/TestHiveConf.java PRE-CREATION &lt;br/&gt;
  build-common.xml 1d162de &lt;br/&gt;
  common/build.xml 432eba5 &lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java d9b6fd5 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2960/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13163098" author="cwsteinbach" created="Mon, 5 Dec 2011 22:11:34 +0000"  >&lt;p&gt;Running tests now, but the code is ready for review. Thanks.&lt;/p&gt;</comment>
                            <comment id="13163134" author="jvs" created="Mon, 5 Dec 2011 22:59:14 +0000"  >&lt;p&gt;(BTW patch applies cleanly to trunk but not 0.8)&lt;/p&gt;</comment>
                            <comment id="13163177" author="jiraposter@reviews.apache.org" created="Mon, 5 Dec 2011 23:40:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2960/#review3648&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/#review3648&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2960/#comment8142&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/#comment8142&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Carl, there is an addResource overload which takes an InputStream.  Can&apos;t we use that plus ByteArrayOutputStream to avoid having to create a temporary file?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-12-05 21:15:13, Carl Steinbach wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2960/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-05 21:15:13)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2362&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;eclipse-templates/.classpath b020907 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/test/resources/hive-site.xml PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;conf/hive-default.xml 53eca0e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/test/org/apache/hadoop/hive/conf/TestHiveConf.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;build-common.xml 1d162de &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/build.xml 432eba5 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/java/org/apache/hadoop/hive/conf/HiveConf.java d9b6fd5 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2960/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Carl&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13163342" author="cwsteinbach" created="Tue, 6 Dec 2011 04:48:23 +0000"  >&lt;p&gt;All tests pass for me on trunk.&lt;/p&gt;</comment>
                            <comment id="13163343" author="jiraposter@reviews.apache.org" created="Tue, 6 Dec 2011 04:49:39 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-12-05 23:39:18, John Sichi wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; common/src/java/org/apache/hadoop/hive/conf/HiveConf.java, line 776&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2960/diff/2/?file=61977#file61977line776&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/diff/2/?file=61977#file61977line776&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Carl, there is an addResource overload which takes an InputStream.  Can&apos;t we use that plus ByteArrayOutputStream to avoid having to create a temporary file?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I tried this approach originally, but o.a.h.conf.Configuration.addResource(InputStream) is broken. Anything you add using this method gets added to a list which is reloaded on every subsequent call to addResource, which results in an unexpected EOF exception on the first reload.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2960/#review3648&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/#review3648&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-12-05 21:15:13, Carl Steinbach wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2960/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-05 21:15:13)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2362&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;eclipse-templates/.classpath b020907 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/test/resources/hive-site.xml PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;conf/hive-default.xml 53eca0e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/test/org/apache/hadoop/hive/conf/TestHiveConf.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;build-common.xml 1d162de &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/build.xml 432eba5 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;common/src/java/org/apache/hadoop/hive/conf/HiveConf.java d9b6fd5 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2960/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2960/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Carl&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13163803" author="jvs" created="Tue, 6 Dec 2011 20:25:34 +0000"  >&lt;p&gt;+1, will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13164040" author="jvs" created="Wed, 7 Dec 2011 01:29:47 +0000"  >&lt;p&gt;Committed to trunk, thanks Carl!  I&apos;ve marked this as 0.9 only for now...please re-add 0.8 when you cut the new branch.&lt;/p&gt;</comment>
                            <comment id="13164081" author="hudson" created="Wed, 7 Dec 2011 02:34:20 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.23.0 #4 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.23.0/4/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.23.0/4/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;. HiveConf properties not appearing in the output of &apos;set&apos; or &apos;set -v&apos;&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211261&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive/conf&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive/conf/TestHiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/resources&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/resources/hive-site.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/eclipse-templates/.classpath&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164171" author="hudson" created="Wed, 7 Dec 2011 06:09:19 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1128 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1128/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1128/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2362&quot; title=&quot;HiveConf properties not appearing in the output of &amp;#39;set&amp;#39; or &amp;#39;set -v&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2362&quot;&gt;&lt;del&gt;HIVE-2362&lt;/del&gt;&lt;/a&gt;. HiveConf properties not appearing in the output of &apos;set&apos; or &apos;set -v&apos;&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211261&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211261&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive/conf&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/org/apache/hadoop/hive/conf/TestHiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/resources&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/src/test/resources/hive-site.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/eclipse-templates/.classpath&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12534587">HIVE-2643</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12505543" name="HIVE-2362.1.patch.txt" size="4451" author="cwsteinbach" created="Tue, 29 Nov 2011 21:56:23 +0000"/>
                            <attachment id="12506163" name="HIVE-2362.2.patch.txt" size="18360" author="cwsteinbach" created="Mon, 5 Dec 2011 21:14:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 21 Nov 2011 20:20:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ljnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2363] Implicitly CLUSTER BY when dynamically partitioning</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2363</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Whenever someone is dynamically creating partitions, the underlying implementation is to look at the output data, write it to a file so long as the partition columns are contiguous, then to close that file and open a new one if the partition column changes. This leads to potentially way too many files generated.&lt;/p&gt;

&lt;p&gt;The solution is to ensure that a partition column&apos;s data all appears in a row and on the same reducer. I.e., to cluster by the partitioning columns on the way out.&lt;/p&gt;

&lt;p&gt;This improvement is to detect whether a query is clustering by the eventual partition columns, and if not, to do so as an additional step at the end of the query. This will potentially save lots of space.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12518382">HIVE-2363</key>
            <summary>Implicitly CLUSTER BY when dynamically partitioning</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="akramer">Adam Kramer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Aug 2011 22:52:42 +0000</created>
                <updated>Tue, 9 Aug 2011 22:52:42 +0000</updated>
                                                                            <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08n4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48345</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>
