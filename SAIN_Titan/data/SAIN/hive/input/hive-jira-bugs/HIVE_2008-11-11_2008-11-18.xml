<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:12:18 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2008-11-11+AND+created+%3C%3D+2008-11-18+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="9" total="9"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-53] Hive should turn newline into a space for multi-line queries</title>
                <link>https://issues.apache.org/jira/browse/HIVE-53</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In the current Hive release, using the Hive shell, a trailing space must be added to multiline queries that don&apos;t indent; e.g.:&lt;/p&gt;

&lt;p&gt;hive&amp;gt; SELECT &lt;br/&gt;
    &amp;gt; n1.userid AS user1,&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;Results in:&lt;/p&gt;

&lt;p&gt;FAILED: Parse Error: line 1:0 cannot recognize input &apos;SELECTn1&apos;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12408230">HIVE-53</key>
            <summary>Hive should turn newline into a space for multi-line queries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hammer">Jeff Hammerbacher</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Nov 2008 10:12:20 +0000</created>
                <updated>Mon, 1 Dec 2008 16:34:32 +0000</updated>
                            <resolved>Mon, 1 Dec 2008 16:34:32 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12650835" author="besquared" created="Wed, 26 Nov 2008 01:40:04 +0000"  >&lt;p&gt;This caused me pretty large amounts of pain today before I found it here, it makes the query parser seem really flaky and cryptic to someone who is relatively new and trying to figure out the various stuff in the query language. Just my $0.02.&lt;/p&gt;</comment>
                            <comment id="12652051" author="athusoo" created="Mon, 1 Dec 2008 16:34:32 +0000"  >&lt;p&gt;This is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-47&quot; title=&quot;[Hive] CLI not supporting multiline queries from an input file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-47&quot;&gt;&lt;del&gt;HIVE-47&lt;/del&gt;&lt;/a&gt;. We are still working on fixing the issues with the patch that Jeremey submitted as part of Hive-47.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Nov 2008 01:40:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73814</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7l3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121879</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-54] Create a release notes file CHANGES.txt</title>
                <link>https://issues.apache.org/jira/browse/HIVE-54</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;A files CHANGES.txt (similar to Hadoop core) that lists all bug fixes in a particular release.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408285">HIVE-54</key>
            <summary>Create a release notes file CHANGES.txt</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dhruba">dhruba borthakur</assignee>
                                    <reporter username="dhruba">dhruba borthakur</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Nov 2008 19:49:06 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:32 +0000</updated>
                            <resolved>Tue, 11 Nov 2008 20:16:50 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12646649" author="dhruba" created="Tue, 11 Nov 2008 19:52:58 +0000"  >&lt;p&gt;1. Create the initial CHANGES.txt.&lt;br/&gt;
2. Rename README to be README.txt&lt;/p&gt;

&lt;p&gt;Both these changes make Hive compatible with Hadoop Core build environment.&lt;/p&gt;</comment>
                            <comment id="12646652" author="athusoo" created="Tue, 11 Nov 2008 20:02:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;looks good to me.&lt;/p&gt;</comment>
                            <comment id="12646655" author="dhruba" created="Tue, 11 Nov 2008 20:16:50 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393727" name="hiveChanges.txt" size="15606" author="dhruba" created="Tue, 11 Nov 2008 19:52:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 11 Nov 2008 20:02:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73813</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 11 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121880</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-60] Fix the build scripts for the new hive tree</title>
                <link>https://issues.apache.org/jira/browse/HIVE-60</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Fix hive builds to reflect the hive subproject branch structure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408306">HIVE-60</key>
            <summary>Fix the build scripts for the new hive tree</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Nov 2008 02:43:11 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:58 +0000</updated>
                            <resolved>Tue, 18 Nov 2008 02:58:20 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Build Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12646781" author="athusoo" created="Wed, 12 Nov 2008 02:52:44 +0000"  >&lt;p&gt;patch that fixes the build issues with the new tree.&lt;/p&gt;</comment>
                            <comment id="12647144" author="prasadc" created="Thu, 13 Nov 2008 00:52:53 +0000"  >&lt;p&gt;+1&lt;br/&gt;
reviewed manually. looks good for now.&lt;/p&gt;

&lt;p&gt;though we need to move to a directory structure that is similar to that of hadoop. (hive/trunk/src/ql hive/trunk/src/metastore)&lt;/p&gt;</comment>
                            <comment id="12648467" author="athusoo" created="Tue, 18 Nov 2008 02:58:20 +0000"  >&lt;p&gt;This was checked in by Zheng.&lt;/p&gt;</comment>
                            <comment id="12652042" author="electrum" created="Mon, 1 Dec 2008 16:08:20 +0000"  >&lt;p&gt;Why are we including a snapshot Hadoop build?  Shouldn&apos;t we use HADOOP_HOME?&lt;/p&gt;</comment>
                            <comment id="12652045" author="athusoo" created="Mon, 1 Dec 2008 16:15:46 +0000"  >&lt;p&gt;You can point to an existing hadoop build using the -Dhadoop.jar to point to the location of the hadoop jar also setting hadoop.bin.path and hadoop.config.dir while running the tests.&lt;/p&gt;

&lt;p&gt;We decided to bundle hadoop jars (similar to what hbase and pig have done) in order to make it easy to check out hive and test it without having to build and deploy hadoop as well.&lt;/p&gt;

&lt;p&gt;However, we are going to move away from this model and use ivy to handle the dependencies and then all these jars will go away.&lt;/p&gt;</comment>
                            <comment id="12652055" author="electrum" created="Mon, 1 Dec 2008 16:47:43 +0000"  >&lt;p&gt;I checked HBase and Pig and they both include the Hadoop jar, so I guess that&apos;s the accepted way.  Seems like we only need a single Hadoop jar in lib?&lt;/p&gt;

&lt;p&gt;svn mv hadoopcore/lib/hadoop-0.20.0-dev-core.jar lib/&lt;br/&gt;
svn rm hadoopcore&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393759" name="patch-60.txt" size="2666515" author="athusoo" created="Wed, 12 Nov 2008 02:52:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 13 Nov 2008 00:52:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121882</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-61] Implment ORDER BY</title>
                <link>https://issues.apache.org/jira/browse/HIVE-61</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;ORDER BY is in the query language reference but currently is a no-op. We should make it an op.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408391">HIVE-61</key>
            <summary>Implment ORDER BY</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zshao">Zheng Shao</assignee>
                                    <reporter username="hammer">Jeff Hammerbacher</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Nov 2008 01:26:33 +0000</created>
                <updated>Sat, 17 Dec 2011 00:07:18 +0000</updated>
                            <resolved>Tue, 21 Apr 2009 03:37:31 +0000</resolved>
                                                    <fixVersion>0.4.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="12647226" author="zshao" created="Thu, 13 Nov 2008 08:28:17 +0000"  >&lt;p&gt;We recently added the &quot;SORT BY&quot; clause which sorts the data in each reducer. An example query is:&lt;br/&gt;
insert overwrite table table2 select city, state where city = &apos;Chicago&apos; from table sort by state;&lt;/p&gt;

&lt;p&gt;If you set number of reducers to 1, then &quot;sort by&quot; will have the same result as &quot;order by&quot; (Do trim down the data size first - otherwise it will be very slow).&lt;/p&gt;


&lt;p&gt;&quot;ORDER BY&quot; is not supported yet but we have a plan to support it shortly. The implementation of order by in our mind will be based on sort by: we run the query with sort by, and then mark the table as sorted with these columns in the table meta data.&lt;br/&gt;
Then we will be able to &quot;merge&quot; the sorted files from each reducer and produce a total order.&lt;/p&gt;</comment>
                            <comment id="12647484" author="zshao" created="Fri, 14 Nov 2008 00:32:40 +0000"  >&lt;p&gt;Some more details about the implementation of ORDER BY:&lt;/p&gt;

&lt;p&gt;We will store on what columns a table (or a partition) is partitioned, and sorted (in asc/desc order), right after we insert data into that table. We will also store whether the table is ordered or not.&lt;/p&gt;

&lt;p&gt;If a table/partition is ordered and if we do a select (that outputs the data to console) from that table, then we will need to merge-sort all files in that table/partition based on the sort order.&lt;/p&gt;
</comment>
                            <comment id="12689683" author="zshao" created="Thu, 26 Mar 2009 21:39:08 +0000"  >&lt;p&gt;Most of the use cases with total ordering is to get the top 10.&lt;/p&gt;

&lt;p&gt;For getting the top 10, the current work-around is:&lt;/p&gt;

&lt;p&gt;First store the top 10 from each partition to some temp table:&lt;br/&gt;
INSERT OVERWRITE tableB&lt;br/&gt;
REDUCE a.*&lt;br/&gt;
USING &apos;head -n 10&apos;&lt;br/&gt;
AS (col1, col2, col3, col4, ...)&lt;br/&gt;
FROM (SELECT * FROM tableA SORT BY col3 DESC, col4 ASC) a&lt;/p&gt;

&lt;p&gt;Second, set the #reducer to 1 and get the top 10 globally.&lt;br/&gt;
set mapred.reduce.tasks=1;&lt;br/&gt;
SELECT * FROM tableB SORT BY col3 DESC, col4 ASC LIMIT 10&lt;/p&gt;</comment>
                            <comment id="12700525" author="akramer" created="Sat, 18 Apr 2009 18:45:23 +0000"  >&lt;p&gt;While this issue is open, it would be lovely to have Hive throw a syntax error when a user asks it to ORDER BY...lots of people are using it and being unhappy/confused when it fails.&lt;/p&gt;</comment>
                            <comment id="12700712" author="hammer" created="Mon, 20 Apr 2009 09:30:52 +0000"  >&lt;p&gt;+1 to a verbose comment when the user attempts an ORDER BY.&lt;/p&gt;</comment>
                            <comment id="12700998" author="zshao" created="Tue, 21 Apr 2009 00:26:20 +0000"  >&lt;p&gt;Nit: Can you move the definition of numReducers inside the &quot;if (qbp.getClusterByForClause(dest) != null ... &quot;? In case the &quot;if&quot; is not executed, the variables don&apos;t get used, so they should not be exposed outside the &quot;if&quot;s.&lt;/p&gt;

&lt;p&gt;There are 2 places that you assign values to extraMRStep - I think it&apos;s cleaner to split them into 2 different variables, each defined and assigned in the &quot;then&quot; and &quot;else&quot; clause of &quot;if (qbp.getIsSubQ())&quot;. That makes the logic cleaner. What do you think?&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@@ -2944,21 +2958,36 @@
       curr = genSelectPlan(dest, qb, curr);
       &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; limit = qbp.getDestLimit(dest);
 
+      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; extraMRStep = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numReducers = -1;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qbp.getOrderByForClause(dest) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        numReducers = 1;
+        extraMRStep = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+      }
+
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qbp.getClusterByForClause(dest) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
           || qbp.getDistributeByForClause(dest) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
+          || qbp.getOrderByForClause(dest) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
           || qbp.getSortByForClause(dest) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
-        curr = genReduceSinkPlan(dest, qb, curr, -1);
+        curr = genReduceSinkPlan(dest, qb, curr, numReducers);
       }
 
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qbp.getIsSubQ()) {
         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (limit != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
-          curr = genLimitMapRedPlan(dest, qb, curr, limit.intValue(), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
+          curr = genLimitMapRedPlan(dest, qb, curr, limit.intValue(), extraMRStep);
         }
       } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
         curr = genConversionOps(dest, qb, curr);
         &lt;span class=&quot;code-comment&quot;&gt;// exact limit can be taken care of by the fetch &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt;
&lt;/span&gt;         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (limit != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
-          curr = genLimitMapRedPlan(dest, qb, curr, limit.intValue(), qb.getIsQuery());
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (qb.getIsQuery() &amp;amp;&amp;amp;
+              qbp.getClusterByForClause(dest) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp;
+              qbp.getSortByForClause(dest) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
+            extraMRStep = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+          &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
+            extraMRStep = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+
+          curr = genLimitMapRedPlan(dest, qb, curr, limit.intValue(), extraMRStep);
           qb.getParseInfo().setOuterQueryLimit(limit.intValue());
         }
         curr = genFileSinkPlan(dest, qb, curr);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12701006" author="namit" created="Tue, 21 Apr 2009 00:48:44 +0000"  >&lt;p&gt;incorporated zheng&apos;s comments&lt;/p&gt;</comment>
                            <comment id="12701035" author="zshao" created="Tue, 21 Apr 2009 03:37:31 +0000"  >&lt;p&gt;Committed to both branch-0.3 and trunk. Thanks Namit!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12409861">HIVE-113</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12466807">HIVE-1402</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12423959">HIVE-451</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12405972" name="hive.61.1.patch" size="16825" author="namit" created="Tue, 21 Apr 2009 00:11:27 +0000"/>
                            <attachment id="12405977" name="hove.61.2.patch" size="16843" author="namit" created="Tue, 21 Apr 2009 00:48:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 13 Nov 2008 08:28:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73810</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121883</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-61&quot; title=&quot;Implment ORDER BY&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-61&quot;&gt;&lt;strike&gt;HIVE-61&lt;/strike&gt;&lt;/a&gt;. Implement Group-By. (Namit Jain via zshao)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-62] Add ability to describe nested types</title>
                <link>https://issues.apache.org/jira/browse/HIVE-62</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Add ability to describe nested types.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408464">HIVE-62</key>
            <summary>Add ability to describe nested types</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Nov 2008 23:16:47 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:36 +0000</updated>
                            <resolved>Tue, 18 Nov 2008 19:23:44 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12647456" author="athusoo" created="Thu, 13 Nov 2008 23:21:27 +0000"  >&lt;p&gt;In hive we can do a describe on the table to get the top level columns of the table. However, there is no way of describing the types within the column in the case when the column is an object.&lt;/p&gt;

&lt;p&gt;e.g. &lt;/p&gt;

&lt;p&gt;one cannot do &lt;/p&gt;

&lt;p&gt;describe tab.c1.f1 &lt;/p&gt;

&lt;p&gt;to get field f1 of an object columns c1 of table tab.&lt;/p&gt;

&lt;p&gt;the syntax is fairly straightforward for nested objects but becomes more complex for lists and maps.&lt;/p&gt;

&lt;p&gt;So in order to inspect within the list we can do&lt;/p&gt;

&lt;p&gt;describe tab.c1.f1.__elem.f2 where in __elem means that an element of the list f1 is being inspected.&lt;/p&gt;

&lt;p&gt;similarly&lt;/p&gt;

&lt;p&gt;describe tab.c1.f1.__key.f2&lt;br/&gt;
and&lt;/p&gt;

&lt;p&gt;describe tab.c1.f1.__value.f2&lt;/p&gt;

&lt;p&gt;would be the corresponding things for the key and values parts of a map.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="12647459" author="athusoo" created="Thu, 13 Nov 2008 23:25:11 +0000"  >&lt;p&gt;This becomes a bit complex in case a partition of a table is being described.&lt;/p&gt;

&lt;p&gt;today we can describe a partition simply by&lt;/p&gt;

&lt;p&gt;describe tab partspec...&lt;/p&gt;

&lt;p&gt;we could still do that by doing&lt;/p&gt;

&lt;p&gt;describe typeexpr partspec...&lt;/p&gt;</comment>
                            <comment id="12647480" author="zshao" created="Fri, 14 Nov 2008 00:14:00 +0000"  >&lt;p&gt;Another way is to allow describe on types but not columns.&lt;/p&gt;

&lt;p&gt;Basically if &quot;describe table&quot; says the column is of type x. Then we can do &quot;describe type x&quot;, and it tells us the internal structure of x, either &quot;map&amp;lt;y,z&amp;gt;&quot;, &quot;list&amp;lt;e&amp;gt;&quot;, &quot;struct &lt;/p&gt;
{ ... }
&lt;p&gt;&quot;, &quot;primitive&quot; or whatever.&lt;/p&gt;

&lt;p&gt;This &quot;describe type&quot; grammar looks consistent to &quot;create type&quot;.&lt;/p&gt;</comment>
                            <comment id="12647498" author="athusoo" created="Fri, 14 Nov 2008 01:57:43 +0000"  >&lt;p&gt;yes that is a possibility. One problem from a usability angle though is that even if I know the path to the field I would have to go though multiple describe types to get to the member that I am interested in finding the type of. e.g.&lt;/p&gt;

&lt;p&gt;{int a;&lt;br/&gt;
 lObj b;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Obj {&lt;br/&gt;
  int c;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;In order to find the type for c I would have to&lt;/p&gt;

&lt;p&gt;describe T;&lt;/p&gt;

&lt;p&gt;which would give me &lt;/p&gt;

&lt;p&gt;int a&lt;br/&gt;
Obj b;&lt;/p&gt;

&lt;p&gt;then I would have to&lt;/p&gt;

&lt;p&gt;describe type Obj;&lt;/p&gt;

&lt;p&gt;which would give me&lt;/p&gt;

&lt;p&gt;int c;&lt;/p&gt;

&lt;p&gt;instead of just saying&lt;/p&gt;

&lt;p&gt;describe T.b&lt;/p&gt;

&lt;p&gt;Having a TYPE keyword though is a good idea, though Oracle and other OORDBMS do not make this explict.&lt;/p&gt;

&lt;p&gt;Check out the Oracle type syntax at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://download.oracle.com/docs/cd/B19306_01/server.102/b14357/ch12019.htm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.oracle.com/docs/cd/B19306_01/server.102/b14357/ch12019.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;though Oracle itself does not support the dotted notation to find the type of an element represented by an xpath expression as far as I know.&lt;/p&gt;



</comment>
                            <comment id="12647738" author="zshao" created="Fri, 14 Nov 2008 22:10:51 +0000"  >&lt;p&gt;Talked with Ashish face-to-face. I agree both approaches have values.&lt;/p&gt;

&lt;p&gt;We can have &quot;describe type&quot; after we added &quot;create type&quot; support.&lt;/p&gt;</comment>
                            <comment id="12647768" author="athusoo" created="Sat, 15 Nov 2008 00:33:23 +0000"  >&lt;p&gt;Patch added.&lt;/p&gt;</comment>
                            <comment id="12647791" author="namit" created="Sat, 15 Nov 2008 01:59:18 +0000"  >&lt;p&gt;Can you add more comments - specially around the test case : describe_xpath.q ?&lt;br/&gt;
Otherwise, it looks OK.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12647861" author="athusoo" created="Sat, 15 Nov 2008 15:32:46 +0000"  >&lt;p&gt;Added comments to the test case.&lt;/p&gt;</comment>
                            <comment id="12647862" author="athusoo" created="Sat, 15 Nov 2008 15:33:04 +0000"  >&lt;p&gt;submit patch.&lt;/p&gt;</comment>
                            <comment id="12648712" author="dhruba" created="Tue, 18 Nov 2008 19:23:44 +0000"  >&lt;p&gt;I just committed this. Thanks Ashish!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393973" name="patch-62.txt" size="22421" author="athusoo" created="Sat, 15 Nov 2008 00:33:21 +0000"/>
                            <attachment id="12393984" name="patch-62_2.txt" size="22228" author="athusoo" created="Sat, 15 Nov 2008 15:32:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 14 Nov 2008 00:14:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>619</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121884</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-63] Record of Hive checkins so far</title>
                <link>https://issues.apache.org/jira/browse/HIVE-63</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;For a long time Hive was developed internally at facebook before becoming a contrib project. As a result a record of checkins made to hive was not available externally and there was not much visibility on who had contributed what in the development. With this JIRA we will be attaching that record.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408516">HIVE-63</key>
            <summary>Record of Hive checkins so far</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Nov 2008 18:56:21 +0000</created>
                <updated>Sun, 14 Dec 2008 23:12:37 +0000</updated>
                                                                            <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12647866" author="athusoo" created="Sat, 15 Nov 2008 15:54:10 +0000"  >&lt;p&gt;svn log of the internal facebook tree.&lt;/p&gt;

&lt;p&gt;Still working on getting the elaborate design discussions that we have had internally into the public forum.&lt;/p&gt;</comment>
                            <comment id="12656503" author="hammer" created="Sun, 14 Dec 2008 23:12:37 +0000"  >&lt;p&gt;Adding to &quot;Documentation&quot; component.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393985" name="checkins_hive2" size="177367" author="athusoo" created="Sat, 15 Nov 2008 15:54:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 14 Dec 2008 23:12:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121885</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-64] CREATE TABLE should default to DynamicSerDe with TCTLSeparatedProtocol</title>
                <link>https://issues.apache.org/jira/browse/HIVE-64</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently CREATE TABLE by default uses MetadataTypedColumnsetSerDe which only allow string typed columns. However the user is still free to specify types of the columns like &quot;col1 int, col2 string&quot; which has no effect. This confuses a lot of users.&lt;/p&gt;

&lt;p&gt;We should make the default DynamicSerDe with TCTLSeparatedProtocol so that simple types like int, string, etc are automatically supported.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408540">HIVE-64</key>
            <summary>CREATE TABLE should default to DynamicSerDe with TCTLSeparatedProtocol</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="namit">Namit Jain</assignee>
                                    <reporter username="zshao">Zheng Shao</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Nov 2008 22:13:55 +0000</created>
                <updated>Thu, 17 Dec 2009 23:11:02 +0000</updated>
                            <resolved>Thu, 17 Dec 2009 23:11:02 +0000</resolved>
                                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12655822" author="zshao" created="Fri, 12 Dec 2008 00:30:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-104&quot; title=&quot;Tables with at least 1 non-string columns should use DynamicSerDe instead of MetadataTypedColumnsetSerDe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-104&quot;&gt;&lt;del&gt;HIVE-104&lt;/del&gt;&lt;/a&gt; will partially fix the problem.&lt;/p&gt;</comment>
                            <comment id="12792203" author="namit" created="Thu, 17 Dec 2009 23:11:02 +0000"  >&lt;p&gt;As of 0.4, the default is to use LazySerDe&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12409713">HIVE-104</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Dec 2009 23:11:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-65] Implict conversion from integer to long broken for Dynamic Serde tables</title>
                <link>https://issues.apache.org/jira/browse/HIVE-65</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;For a dynamic serde table that has a bigint column, implict conversion from int to bigint seems to be broken. I have not verified this for other tables.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408665">HIVE-65</key>
            <summary>Implict conversion from integer to long broken for Dynamic Serde tables</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Nov 2008 18:28:21 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:37 +0000</updated>
                            <resolved>Wed, 22 Jul 2009 23:59:28 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12648230" author="athusoo" created="Mon, 17 Nov 2008 18:29:23 +0000"  >&lt;p&gt;Test case is as follows:&lt;/p&gt;

&lt;p&gt;CREATE TABLE implicit_test1(a BIGINT, b STRING) ROW FORMAT SERDE &apos;org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe&apos; WITH SERDEPROPERTIES(&apos;serialization.format&apos;= &apos;org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol&apos;) STORED AS TEXTFILE;&lt;/p&gt;


&lt;p&gt;SELECT implicit_test1.*&lt;br/&gt;
FROM implicit_test1&lt;br/&gt;
WHERE implicit_test1.a &amp;lt;&amp;gt; 0;&lt;/p&gt;


&lt;p&gt;Fails to do implicit conversion in the predicate implicit_test1.a &amp;lt;&amp;gt; 0 &lt;/p&gt;</comment>
                            <comment id="12652111" author="athusoo" created="Mon, 1 Dec 2008 19:32:33 +0000"  >&lt;p&gt;Zheng, I was actually fixing this. I have a partial fix ready for this. One major problem with this is the fact that the implict conversion stuff is broken because of circular dependencies in the implict conversion graph (this should be a tree) when string to number types are involved..&lt;/p&gt;</comment>
                            <comment id="12652133" author="zshao" created="Mon, 1 Dec 2008 19:59:13 +0000"  >&lt;p&gt;Yep. The problem with this test case is an ambiguous call: evaluate(String, Number), evaluate(Number, String), and evaluate(Long, Long) all fit with one implicit conversion.&lt;/p&gt;

&lt;p&gt;I think we have to disallow the circular conversion.&lt;/p&gt;

&lt;p&gt;This is what we discussed on the mailing list long time ago (This disallows number -&amp;gt; string implicit conversion)&lt;br/&gt;
String -&amp;gt; byte -&amp;gt; int -&amp;gt; long -&amp;gt; double&lt;br/&gt;
int -&amp;gt; float -&amp;gt; double&lt;/p&gt;

&lt;p&gt;Is this your plan for the fix?&lt;/p&gt;</comment>
                            <comment id="12652141" author="athusoo" created="Mon, 1 Dec 2008 20:26:16 +0000"  >&lt;p&gt;yes.&lt;/p&gt;

&lt;p&gt;basically what I have done is move string to be at the bottom of the hierarchy and disallow the implicit conversion from number to string and some of the tests fail because of that as we need to change them to do explicit conversion now.&lt;/p&gt;

&lt;p&gt;On looking at some of the test cases that fail, I think it would make sense to convert from various types to strings as well, though I had thought otherwise in the discussion that we had originally on the email thread. We have actually some queries in our tests that do that .e.g&lt;/p&gt;

&lt;p&gt;concat(&apos;My total: &apos;, sum(t.c))&lt;/p&gt;

&lt;p&gt;A user could do that very easily to generate reporting strings with that kind of a sql. Without implict conversion, they would have to write a cast operator.&lt;/p&gt;

&lt;p&gt;In light of that, I think we should revisit the decisions that we made.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="12652182" author="jsensarma" created="Mon, 1 Dec 2008 22:12:53 +0000"  >&lt;p&gt;if u can go both ways (string -&amp;gt; number and number -&amp;gt; string) - which way would u go? any rules we would come up with (perhaps based on context etc.) would become complicated. mysql does something even simpler than we proposed and people seem ok with that ..&lt;/p&gt;

&lt;p&gt;regarding the concat example - can&apos;t we make the function polymorphic? concat can take responsibilty for converting everything to string. &lt;/p&gt;</comment>
                            <comment id="12652192" author="athusoo" created="Mon, 1 Dec 2008 22:55:42 +0000"  >&lt;p&gt;Actually mysql supports implicit conversions in both directions and that is what got me thinking that perhaps we should also be supporting both.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If we go the polymorphism route we would have to be very careful while adding UDFs. The UDF writers will have to really understand how for implicit conversion they have to implement functions with different signatures and that would just make it that much harder for them to write UDFs that can take advantage of implicit conversion. In fact polymorphism in the comparison function is the reason why we are hitting this problem in the&lt;br/&gt;
first place. &lt;/p&gt;


&lt;p&gt;The problem with going both ways is truly the one that caused us a lot of pain initially. However, that does not get solved by restricting the conversion possibilities. If for example we have a udf that takes two forms:&lt;/p&gt;

&lt;p&gt;a) evaluate(string, string, int)&lt;br/&gt;
b) evaluate(int, string, string)&lt;/p&gt;

&lt;p&gt;then even if we only allow string to be converted to int and not vice versa we have an ambiguous match for&lt;/p&gt;

&lt;p&gt;evaluate(1, &apos;abc&apos;, 2)&lt;/p&gt;

&lt;p&gt;and we would not know which one to pick. This is what I mean by polymorphism causing these issues. The comparison functions are&lt;br/&gt;
polymorphic and they are the ones that lead to the problem of ambiguity.&lt;/p&gt;</comment>
                            <comment id="12652332" author="zshao" created="Tue, 2 Dec 2008 10:31:49 +0000"  >&lt;p&gt;&amp;gt; a) evaluate(string, string, int)&lt;br/&gt;
&amp;gt; b) evaluate(int, string, string)&lt;/p&gt;

&lt;p&gt;This problem even happens for strict-typed languages (replace string with double). So I don&apos;t think this is something we need to fix.&lt;/p&gt;


&lt;p&gt;If we agree in most cases people convert string &lt;del&gt;&amp;gt; numeric, then all numeric&lt;/del&gt;&amp;gt;string can be done by udf itself through polymorphism.&lt;br/&gt;
I think this is much cleaner than circular conversion.&lt;/p&gt;

&lt;p&gt;I am +1 to stick to the original solution (and leave the author of concat to implement Number-&amp;gt;String conversion).&lt;/p&gt;</comment>
                            <comment id="12652341" author="athusoo" created="Tue, 2 Dec 2008 11:42:27 +0000"  >&lt;p&gt;I am not sure what you mean by saying that the problem also happens with strict-typed languages. Can you elaborate?&lt;/p&gt;</comment>
                            <comment id="12652342" author="zshao" created="Tue, 2 Dec 2008 11:44:47 +0000"  >&lt;p&gt;I mean, strict-typed languages will have ambiguity if the user calls evaluate(int, double, int), while there are 2 overloaded implementations: evaluate(double, double, int) and evaluate(int, double, double).&lt;/p&gt;</comment>
                            <comment id="12652681" author="zshao" created="Wed, 3 Dec 2008 04:53:09 +0000"  >&lt;p&gt;Namit&apos;s experiment with Oracle shows Oracle outputs ambiguity if UDF has both evaluate(double, double) and evaluate(string,string), and users calls udf(double, string).&lt;/p&gt;

&lt;p&gt;Let&apos;s stick with the following implicit conversion hierarchy and special-case comparison operators (they will prefer evaluate(double, double) to evaluate(string,string)):&lt;br/&gt;
byte -&amp;gt; short -&amp;gt; int -&amp;gt; long -&amp;gt; float -&amp;gt; double -&amp;gt; string, string -&amp;gt; double&lt;/p&gt;

&lt;p&gt;In order to allow the special case, we can add a tag to the methods. If there are multiple methods with the same number of implicit conversions, then we choose the one with the maximum tag (if there are still many then we say ambiguity).&lt;/p&gt;

&lt;p&gt;The reason that I think long -&amp;gt; float should be allowed is &lt;a href=&quot;http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#25214&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#25214&lt;/a&gt; This of course also simplify the code since it&apos;s a single line instead of a DAG.&lt;/p&gt;</comment>
                            <comment id="12652683" author="zshao" created="Wed, 3 Dec 2008 04:57:10 +0000"  >&lt;p&gt;By using tag, we can get rid of the current hack (the evaluate(String, Number) and evaluate(Number, String) methods in the parent class) which caused the problem in this issue.&lt;/p&gt;</comment>
                            <comment id="12652988" author="athusoo" created="Wed, 3 Dec 2008 21:46:53 +0000"  >&lt;p&gt;I guess the following outlines how conversions are done for comparison operators for mysql&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dev.mysql.com/doc/refman/5.0/en/type-conversion.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think we should just follow that for comparisons.&lt;/p&gt;</comment>
                            <comment id="12653005" author="jsensarma" created="Wed, 3 Dec 2008 22:22:39 +0000"  >&lt;p&gt;@Zheng - i don&apos;t follow. i thought we discussed a while back that double-&amp;gt;string conversion is non-intuitive in a comparison between double and string. it&apos;s almost always the case that the user in such a case would like the string to be treated as a double and hence we had talked about putting string at the base of the partial order. mysql type conversion agrees with this approach.&lt;/p&gt;

&lt;p&gt;i am ok with using mysql type conversion semantics as well - but i think what we had agreed was better (in terms of partial order and finding least common super-type to convert to). this actually has space consequences - for example in mysql string + int will produce double. which consumes double the space of int (which is the least common super-type).&lt;/p&gt;

&lt;p&gt;i still don&apos;t see the problem with this approach (and letting udf polymorphism take care of ambiguities)&lt;/p&gt;</comment>
                            <comment id="12653090" author="zshao" created="Thu, 4 Dec 2008 00:52:21 +0000"  >&lt;p&gt;@joydeep: There are 2 drawbacks:&lt;/p&gt;

&lt;p&gt;1. Authors of udf need to be aware of that.  In oracle, the system does take care of double -&amp;gt; string in udf so authors don&apos;t have to do it.&lt;br/&gt;
2. string -&amp;gt; int is lossy. The result of &apos;1.1&apos; = 1 will be true under our agreed conversion partial order (string -&amp;gt; byte -&amp;gt; short -&amp;gt; int -&amp;gt; ... -&amp;gt; double). But both mysql and oracle output that as FALSE.&lt;/p&gt;
</comment>
                            <comment id="12653151" author="athusoo" created="Thu, 4 Dec 2008 03:56:19 +0000"  >&lt;p&gt;Description of implicit conversions in PL/SQL&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www-camden.rutgers.edu/HELP/Documentation/Oracle/server.815/a67842/02_funds.htm#3435&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www-camden.rutgers.edu/HELP/Documentation/Oracle/server.815/a67842/02_funds.htm#3435&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Description of implicit conversion in Postgres&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.postgresql.org/docs/7.3/static/typeconv.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.postgresql.org/docs/7.3/static/typeconv.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In light of this and the mysql implicit conversion for comparison types&lt;/p&gt;

&lt;p&gt;I think fundamentally the model is as follows:&lt;/p&gt;

&lt;p&gt;1. For overloaded comparison operators (&amp;gt;,&amp;lt;, &amp;gt;=, &amp;lt;=, &amp;lt;&amp;gt;, =):&lt;br/&gt;
      If both the operands have the same type, then we have an exact match&lt;br/&gt;
      otherwise, If one of the operands is a date and the other is not, then convert the other to a date.&lt;br/&gt;
      otherwise, If the two arguments are not of the same type, convert them both to double and do the comparison.&lt;br/&gt;
      Note that we do not do this for LIKE, RLIKE and REGEXP as those operators are not overloaded and every type is convertible to string&lt;/p&gt;

&lt;p&gt;2. For overloaded arithmetic operators (+, -, *, /, %, &amp;amp;, |, ^):&lt;br/&gt;
      If both the operands have the same types then we have an exact match&lt;br/&gt;
      otherwise we convert everything to double&lt;br/&gt;
      In this case the logical operators will just work as is as they are not overloaded in the sense that they do not have multiple evaluate functions.&lt;/p&gt;

&lt;p&gt;We allow seemless conversions within numbers, from string to numbers and vice versa as well as from date to string and vice versa. We may allow seemless conversion between date and int at some point (once we support date more formally)&lt;/p&gt;

&lt;p&gt;When looking for a match in a generic overloaded function (which is user defined and not one of the cases enumerated above as we have already addressed those), we use the current mechanism of picking up an evaluate function that needs&lt;br/&gt;
least number of conversions, otherwise we throw an ambiguity.&lt;/p&gt;

&lt;p&gt;So instead of encoding hierarchies, in the UDFTo... classes we will encode the conversion rules and then use the above to figure out the matches.&lt;/p&gt;

&lt;p&gt;I think this will give us the same results as mysql and other DBs as well.&lt;/p&gt;

&lt;p&gt;One thing that is still not very clean in this is the bit operators...&lt;/p&gt;

&lt;p&gt;I think this somewhat addresses all the concerns except the storage one which Joy raised, but even Oracle there warns about the same issue and asks the user to casting properly. These set of rules are also hopefully much simpler to code and to explain to the users.&lt;/p&gt;

&lt;p&gt;Thoughts? &lt;/p&gt;</comment>
                            <comment id="12657650" author="athusoo" created="Thu, 18 Dec 2008 02:03:34 +0000"  >&lt;p&gt;The expression node generation code needs changes to fix this bug and that in turn depends on the unified graph traversal and rules framework.&lt;/p&gt;</comment>
                            <comment id="12664266" author="athusoo" created="Thu, 15 Jan 2009 21:11:31 +0000"  >&lt;p&gt;Uploading the patch for refactoing typechecking and fixing implict conversion problems. This is a rather big patch with a number of changes relating to:&lt;br/&gt;
1. How we resolve udf and udaf evaluation functions or evaluators given the argument types.&lt;br/&gt;
2. Changes to how we implement UDAFs to support overloaded UDAFs.&lt;br/&gt;
3. Tree walker, dispatcher and processor code to make it more amenable to expression creation.&lt;br/&gt;
etc...&lt;/p&gt;

&lt;p&gt;Will update with a more detailed description of the changes after lunch.&lt;/p&gt;</comment>
                            <comment id="12664297" author="athusoo" created="Thu, 15 Jan 2009 22:33:25 +0000"  >&lt;p&gt;The patch contains the following changes: &lt;/p&gt;

&lt;p&gt;1. Interfaces to be able to plugin your own resolvers for UDFs and UDAFs. These are: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;UDFMethodResolver for udfs -&amp;gt; Given the types of the arguments, this interface allows the compiler to retrieve which evaluate function to use.&lt;/li&gt;
	&lt;li&gt;UDAFEvaluatorResolver for udafs -&amp;gt; Given the types of the arguments, this interface allows the compiler to retrieve which UDAFEvaluator to use.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;What was UDAF previously in now the UDAFEvaluator interface. The function names have been changed somewhat. These are: &lt;br/&gt;
1. init which was also init in the UDAF abstract class - for initializaing the state &lt;br/&gt;
2. iterate which was aggregate in the UDAF abstract class - for updating the state for each passed in value of the arguments &lt;br/&gt;
3. terminatePartial which was evaluatePartial in the UDAF abstract class - for returning the state after the partial aggregation has been done &lt;br/&gt;
4. merge which was aggregatePartial in the UDAF abstract class - for merging the results of the terminatePartial while doing the final aggregation &lt;br/&gt;
5. terminate which was evaluate in the UDAF abstract class - for retruning the final result of the aggregation. &lt;/p&gt;

&lt;p&gt;The UDF and UDAF classes now encapsulate a resolver which is used for resolution for that particular class. &lt;br/&gt;
The different types of resolver implementation for UDFMethodResolver are: &lt;br/&gt;
1. DefaultUDFMethodResolver - This is the default resolver and it uses the old rule of finding the evaluate function in the UDF that needs least number of &lt;br/&gt;
    argument conversions. &lt;br/&gt;
2. NumericOpMethodResolver - This is the resolver used by overloaded numeric operators (+, -, %, /, *). This implements the following resolution logic: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If any of the arguments is Void (null) or String, then the evaluate(Double, Double) method is used.&lt;/li&gt;
	&lt;li&gt;otherwise, if both the arguments are of the same type, then the evaluate(&amp;lt;arg Type&amp;gt;, &amp;lt;arg Type&amp;gt;) method is used.&lt;/li&gt;
	&lt;li&gt;otherwise, evaluate(Double, Double) method is used.&lt;br/&gt;
3. ComparisonOpMethodResolver - This is the resolver used by oveloaded comparison operators (&amp;gt;, &amp;lt;. &amp;gt;=. &amp;lt;=. =. &amp;lt;&amp;gt;). This implements the following resolution logic: &lt;/li&gt;
	&lt;li&gt;If any of the arguments in Void (null), then the evaluate(Double, Double) method is used.&lt;/li&gt;
	&lt;li&gt;otherwise, if both the arguments are of the same type, then the evaluate(&amp;lt;arg Type&amp;gt;, &amp;lt;arg Type&amp;gt;) method is used.&lt;/li&gt;
	&lt;li&gt;otherwise, if one of the arguments is a Date, then evaluate(Date, Date) method is used.&lt;/li&gt;
	&lt;li&gt;otherwise, evaluate(Double, Double) method is used.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Abstract base classes for UDFs that use each of these resolvers are provided. These are: &lt;br/&gt;
1. UDF has been modified to use DefaultUDFMethodResolver. &lt;br/&gt;
2. UDFNumericOp is a new class which uses NumericOpMethodResolver. &lt;br/&gt;
3. UDFBaseCompare has been modified to use ComparisonOpMethodResolver. &lt;/p&gt;

&lt;p&gt;Similar to the UDFMethodResolvers decribed above, there are 2 implementation available for the UDAFEvaluatorResolvers. These are: &lt;br/&gt;
1. DefaultUDAFEvaluatorResolver - on similar lines as DefaultUDFMethodResolver. &lt;br/&gt;
2. NumericUDAFEvaluatorResolver - on similar lines as NumericOpMethodResolver. &lt;/p&gt;

&lt;p&gt;The UDAF resolution logic is in getUDAF where as the UDF resolution logic is in getExprNodeDesc. This logic is the same as previously, though &lt;br/&gt;
I think we should change this to allow conversions from any thing to any thing. I have change the UDF conversion operators to reflect that. In both &lt;br/&gt;
these locations, conversion operators are appropriately added for the arguments that need conversion. &lt;/p&gt;

&lt;p&gt;I have also moved the code to create exprNodeDesc to start using the tree walker infrastructure. Note the code in SemanticAnalyzer still remains &lt;br/&gt;
because PartitionPruner depends on it and we can get rid of that only after we have refactored partition pruning which iteself depends on predicate &lt;br/&gt;
push down - I will file a separate JIRA for this work. &lt;br/&gt;
In the Tree Walker framework, I have added the ability for the processor to return objects and I have also added the ability for the walker to pass &lt;br/&gt;
what was returned for objects walked so far to the processor. This is usefull while creating expression node descriptors for a node from the &lt;br/&gt;
expression node descriptors of the children that have been visited preorder. Also I have removed the NodeProcessorCtx (this was Joy&apos;s comment &lt;br/&gt;
in the previous review), it was anyway an empty abstract class and having that around was making it more involved to write the type checker &lt;br/&gt;
because of Java&apos;s lack of support for multiple class inheritance. &lt;br/&gt;
Accordingly, the type check processor and factory are implemented in: &lt;br/&gt;
1. TypeCheckProcFactory &lt;br/&gt;
2. TypeCheckCtx &lt;/p&gt;

&lt;p&gt;I have so far added 1 test relating to this JIRA. I am also going to add more tests for this. &lt;/p&gt;

&lt;p&gt;As a result of the UDAFEvaluator framework, we are now able to support overloaded aggregate functions like max and min for strings as well. &lt;br/&gt;
One of the existing tests which was returning null previously (a wrong result!!) now outputs the correct result.&lt;/p&gt;</comment>
                            <comment id="12665506" author="prasadc" created="Tue, 20 Jan 2009 19:11:24 +0000"  >&lt;p&gt;haven&apos;t finished looking at all of them&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/exec/UDAFEvaluator.java:21	nit: that encapsulates?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:128	can you put a comment explaining what is going on here&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:255	does this work for complex columns? i think this should use getColAlias or some such function&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:393	how do UDFs read struct object? how does it know the class?&lt;br/&gt;
ql/src/java/org/apache/hadoop/hive/ql/lib/NodeProcessorCtx.java:23	why is this removed? wouldn&apos;t it be useful so that arbitrary context objects are not passed around. or is that a requirement?&lt;/p&gt;</comment>
                            <comment id="12665680" author="athusoo" created="Wed, 21 Jan 2009 01:53:15 +0000"  >&lt;p&gt;I did not get the first comment. Can you elaborate on UDAFEvaluator.java:21?&lt;/p&gt;

&lt;p&gt;I removed NodeProcessorCtx.java because this was initially an abstract class with nothing inside it, so it was not serving any purpose as such (Joy had pointed that out in the previous JIRA code review)...&lt;/p&gt;

&lt;p&gt;Looking at other comments...&lt;/p&gt;</comment>
                            <comment id="12666485" author="athusoo" created="Fri, 23 Jan 2009 11:23:15 +0000"  >&lt;p&gt;For TypeCheckProcFactory.java:255 - This is the same code as the one that appears in genExprNodeDescFromColRef today. Don;t completely understand how getColAlias helps here?&lt;/p&gt;

&lt;p&gt;For 393: structs are just read to be of type Object. The only UDAF that I know of that does this is count.&lt;/p&gt;</comment>
                            <comment id="12666490" author="athusoo" created="Fri, 23 Jan 2009 11:33:25 +0000"  >&lt;p&gt;Resolved conflicts with latest changes from Prasad&apos;s checkin and cleaned out more stuff from SemanticAnalyzer&lt;/p&gt;

&lt;p&gt;There was one comment in the code review of converting the MethodResolver into a static variable in the UDF class. Can someone refresh my memory as to what was needed there. I tried doing that but it seems that there is not much benefit there.&lt;/p&gt;

&lt;p&gt;Another comment during the code review was with respect to the date type in the NumericOpMethodResolver. That code was actually in CompareOpMethodResolver and not in NumericOpMethodResolver as I had originally stated in the code review. So I did not have to change anything there..&lt;/p&gt;
</comment>
                            <comment id="12666817" author="athusoo" created="Sat, 24 Jan 2009 01:07:13 +0000"  >&lt;p&gt;Added NodeProcessorCtx back due to popular demand &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Also addressed other review comments from Prasad and Zheng..&lt;/p&gt;</comment>
                            <comment id="12666818" author="zshao" created="Sat, 24 Jan 2009 01:10:33 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12734394" author="zshao" created="Wed, 22 Jul 2009 23:59:28 +0000"  >&lt;p&gt;Fixed long time ago. Thanks Ashish!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12410943">HIVE-186</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12398012" name="patch-65.txt" size="592587" author="athusoo" created="Thu, 15 Jan 2009 21:11:30 +0000"/>
                            <attachment id="12398546" name="patch-65_2.txt" size="614274" author="athusoo" created="Fri, 23 Jan 2009 11:33:25 +0000"/>
                            <attachment id="12398622" name="patch-65_3.txt" size="625731" author="athusoo" created="Sat, 24 Jan 2009 01:07:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Dec 2008 19:59:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121887</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-65&quot; title=&quot;Implict conversion from integer to long broken for Dynamic Serde tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-65&quot;&gt;&lt;strike&gt;HIVE-65&lt;/strike&gt;&lt;/a&gt;. Rewrite typechecking to use the walker interface and add Resolvers to UDF and UDAF to support proper implicit casting in a manner similar to other RDBMSs. (athusoo)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-66] Insert into a dynamic serde table from a MetadataTypedColumnSetSerDe</title>
                <link>https://issues.apache.org/jira/browse/HIVE-66</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Fails with column mismatch error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408666">HIVE-66</key>
            <summary>Insert into a dynamic serde table from a MetadataTypedColumnSetSerDe</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="athusoo">Ashish Thusoo</assignee>
                                    <reporter username="athusoo">Ashish Thusoo</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Nov 2008 18:32:14 +0000</created>
                <updated>Sat, 17 Dec 2011 00:08:43 +0000</updated>
                            <resolved>Wed, 22 Jul 2009 23:58:02 +0000</resolved>
                                                    <fixVersion>0.3.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12648232" author="athusoo" created="Mon, 17 Nov 2008 18:33:06 +0000"  >&lt;p&gt;Test case is as follows:&lt;/p&gt;

&lt;p&gt;CREATE TABLE implicit_test1(a BIGINT, b STRING) ROW FORMAT SERDE &apos;org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe&apos; WITH SERDEPROPERTIES(&apos;serialization.format&apos;= &apos;org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol&apos;) STORED AS TEXTFILE;&lt;/p&gt;

&lt;p&gt;DESCRIBE src;&lt;/p&gt;

&lt;p&gt;INSERT OVERWRITE TABLE implicit_test1&lt;br/&gt;
SELECT src.key, src.value&lt;br/&gt;
FROM src;&lt;/p&gt;


&lt;p&gt;where src is the MetadataTypedColumnSetSerDe table created in QTestUtil.java&lt;/p&gt;</comment>
                            <comment id="12648233" author="athusoo" created="Mon, 17 Nov 2008 18:34:11 +0000"  >&lt;p&gt;Also the following fails.&lt;/p&gt;

&lt;p&gt;INSERT OVERWRITE TABLE implicit_test1&lt;br/&gt;
SELECT src.*&lt;br/&gt;
FROM src;&lt;/p&gt;</comment>
                            <comment id="12734393" author="zshao" created="Wed, 22 Jul 2009 23:58:02 +0000"  >&lt;p&gt;I believe this issue is fixed long time ago.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Jul 2009 23:58:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66882</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l7n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
