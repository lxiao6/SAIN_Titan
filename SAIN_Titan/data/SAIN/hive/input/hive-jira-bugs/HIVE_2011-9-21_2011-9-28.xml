<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:19:05 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2011-9-21+AND+created+%3C%3D+2011-9-28+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="13" total="13"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-2459] remove all @author tags from source</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2459</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;$  grep --exclude-dir=build --exclude-dir=.svn -r &quot;@author &quot; .&lt;br/&gt;
./ql/src/java/org/apache/hadoop/hive/ql/parse/ASTNode.java: * @author athusoo&lt;br/&gt;
./ql/src/java/org/apache/hadoop/hive/ql/index/IndexSearchCondition.java: * @author John Sichi&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523819">HIVE-2459</key>
            <summary>remove all @author tags from source</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashutoshc">Ashutosh Chauhan</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Sep 2011 06:32:59 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:58 +0000</updated>
                            <resolved>Wed, 21 Sep 2011 23:14:08 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13109298" author="ashutoshc" created="Wed, 21 Sep 2011 06:33:54 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-1147&quot; title=&quot;remove all @author tags from source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-1147&quot;&gt;&lt;del&gt;HADOOP-1147&lt;/del&gt;&lt;/a&gt; for reference.&lt;/p&gt;</comment>
                            <comment id="13109300" author="ashutoshc" created="Wed, 21 Sep 2011 06:39:08 +0000"  >&lt;p&gt;Patch which removes @author I could find in sources.&lt;/p&gt;</comment>
                            <comment id="13112213" author="jvs" created="Wed, 21 Sep 2011 23:14:08 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Ashutosh!&lt;/p&gt;</comment>
                            <comment id="13112299" author="hudson" created="Thu, 22 Sep 2011 03:31:55 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #970 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/970/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/970/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2459&quot; title=&quot;remove all @author tags from source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2459&quot;&gt;&lt;del&gt;HIVE-2459&lt;/del&gt;&lt;/a&gt;. remove all @author tags from source&lt;br/&gt;
(Ashutosh Chauhan via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1173885&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1173885&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/index/IndexSearchCondition.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ASTNode.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12495325" name="hive-2459.patch" size="1004" author="ashutoshc" created="Wed, 21 Sep 2011 06:39:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Sep 2011 23:14:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35770</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09zmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2460] Add an internal namespace for Hive configuration properties</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2460</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12524321">HIVE-2460</key>
            <summary>Add an internal namespace for Hive configuration properties</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 19:03:19 +0000</created>
                <updated>Thu, 22 Sep 2011 19:05:57 +0000</updated>
                                                                            <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13112829" author="cwsteinbach" created="Thu, 22 Sep 2011 19:05:57 +0000"  >&lt;p&gt;Some of the configuration properties that appear in hive-default.xml are&lt;br/&gt;
not intended to be set by users. These properties should only appear&lt;br/&gt;
in HiveConf, should not be listed in the output of &apos;set -v&apos;, and should&lt;br/&gt;
not be modifiable either from the CLI or via the hive-site.xml file.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42110</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123904</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2461] Add method to PerfLogger to perform cleanup/final steps.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2461</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I think a method added to PerfLogger to perform cleanup/final steps would be very useful.  For example, it could be used to close any database connections created as part of a PerfLogger subclass, or to perform logging that requires all perf values to first be calculated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524324">HIVE-2461</key>
            <summary>Add method to PerfLogger to perform cleanup/final steps.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 19:25:34 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:41 +0000</updated>
                            <resolved>Fri, 23 Sep 2011 17:24:46 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13112850" author="jiraposter@reviews.apache.org" created="Thu, 22 Sep 2011 19:35:25 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a method called finishPerfLogger, which is called at the end of the run method in Driver to allow PerfLogger subclasses to perform any cleanup tasks or logging that requires all the perf stats to have been calculated.  It takes as parameters a Log, to be consistent with the other methods in PerfLogger, as well as the QueryPlan from Driver in order to allow information such as the query ID to be logged.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; title=&quot;Add method to PerfLogger to perform cleanup/final steps.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2461&quot;&gt;&lt;del&gt;HIVE-2461&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2461&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1173881 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java 1173881 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2023/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I created a subclass of PerfLogger which implemented the finishPerfLogger method, and verified it was successfully called and executed.&lt;/p&gt;

&lt;p&gt;I also ran some of the unit tests to verify nothing was broken.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13113042" author="jiraposter@reviews.apache.org" created="Thu, 22 Sep 2011 23:55:25 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-22 23:54:37.554390)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a method called finishPerfLogger, which is called at the end of the run method in Driver to allow PerfLogger subclasses to perform any cleanup tasks or logging that requires all the perf stats to have been calculated.  It takes as parameters a Log, to be consistent with the other methods in PerfLogger, as well as the QueryPlan from Driver in order to allow information such as the query ID to be logged.&lt;/p&gt;

&lt;p&gt;I should note that finishPerfLogger is not guaranteed to run.  This was my intention.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; title=&quot;Add method to PerfLogger to perform cleanup/final steps.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2461&quot;&gt;&lt;del&gt;HIVE-2461&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2461&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1173881 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java 1173881 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2023/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I created a subclass of PerfLogger which implemented the finishPerfLogger method, and verified it was successfully called and executed.&lt;/p&gt;

&lt;p&gt;I also ran some of the unit tests to verify nothing was broken.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13113047" author="jiraposter@reviews.apache.org" created="Fri, 23 Sep 2011 00:05:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2023/#review2030&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/#review2030&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2023/#comment4579&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/#comment4579&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    one nitpick is that do you think call this function a &apos;close&apos; will be more clear? we already have a PerfLogEnd().&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Yongqiang&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-09-22 23:54:37, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-09-22 23:54:37)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added a method called finishPerfLogger, which is called at the end of the run method in Driver to allow PerfLogger subclasses to perform any cleanup tasks or logging that requires all the perf stats to have been calculated.  It takes as parameters a Log, to be consistent with the other methods in PerfLogger, as well as the QueryPlan from Driver in order to allow information such as the query ID to be logged.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I should note that finishPerfLogger is not guaranteed to run.  This was my intention.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; title=&quot;Add method to PerfLogger to perform cleanup/final steps.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2461&quot;&gt;&lt;del&gt;HIVE-2461&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2461&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1173881 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java 1173881 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2023/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I created a subclass of PerfLogger which implemented the finishPerfLogger method, and verified it was successfully called and executed.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I also ran some of the unit tests to verify nothing was broken.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13113048" author="jiraposter@reviews.apache.org" created="Fri, 23 Sep 2011 00:09:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-23 00:08:56.319090)&lt;/p&gt;


&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Thanks Yongqiang.  I didn&apos;t like the name either, but the only other one I could come up with was finalize which I didn&apos;t want to use for obvious reasons.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a method called finishPerfLogger, which is called at the end of the run method in Driver to allow PerfLogger subclasses to perform any cleanup tasks or logging that requires all the perf stats to have been calculated.  It takes as parameters a Log, to be consistent with the other methods in PerfLogger, as well as the QueryPlan from Driver in order to allow information such as the query ID to be logged.&lt;/p&gt;

&lt;p&gt;I should note that finishPerfLogger is not guaranteed to run.  This was my intention.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; title=&quot;Add method to PerfLogger to perform cleanup/final steps.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2461&quot;&gt;&lt;del&gt;HIVE-2461&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2461&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1173881 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java 1173881 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2023/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2023/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I created a subclass of PerfLogger which implemented the finishPerfLogger method, and verified it was successfully called and executed.&lt;/p&gt;

&lt;p&gt;I also ran some of the unit tests to verify nothing was broken.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13113068" author="he yongqiang" created="Fri, 23 Sep 2011 00:37:21 +0000"  >&lt;p&gt;+1, will commit after tests pass&lt;/p&gt;</comment>
                            <comment id="13113581" author="he yongqiang" created="Fri, 23 Sep 2011 17:24:46 +0000"  >&lt;p&gt;committed, thanks Kevin Wilfong!&lt;/p&gt;</comment>
                            <comment id="13113864" author="hudson" created="Sat, 24 Sep 2011 01:38:03 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #974 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/974/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/974/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2461&quot; title=&quot;Add method to PerfLogger to perform cleanup/final steps.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2461&quot;&gt;&lt;del&gt;HIVE-2461&lt;/del&gt;&lt;/a&gt;: Add method to PerfLogger to perform cleanup/final steps. (Kevin Wilfong via He Yongqiang)&lt;/p&gt;

&lt;p&gt;heyongqiang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1174897&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1174897&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/log/PerfLogger.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12496167" name="HIVE-2461.1.patch.txt" size="2036" author="kevinwilfong" created="Thu, 22 Sep 2011 19:35:06 +0000"/>
                            <attachment id="12496202" name="HIVE-2461.2.patch.txt" size="1460" author="kevinwilfong" created="Fri, 23 Sep 2011 00:09:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Sep 2011 19:35:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2462] make INNER a non-reserved keyword</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2462</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2191&quot; title=&quot;Allow optional [inner] on equi-join.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2191&quot;&gt;&lt;del&gt;HIVE-2191&lt;/del&gt;&lt;/a&gt; introduced the INNER keyword as reserved, which breaks backwards compatibility for queries which were using it as an identifier.  This patch addresses that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524326">HIVE-2462</key>
            <summary>make INNER a non-reserved keyword</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvs">John Sichi</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 19:41:29 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:47 +0000</updated>
                            <resolved>Fri, 23 Sep 2011 06:02:06 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13112860" author="jiraposter@reviews.apache.org" created="Thu, 22 Sep 2011 19:50:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2024/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2024/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2462&quot; title=&quot;make INNER a non-reserved keyword&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2462&quot;&gt;&lt;del&gt;HIVE-2462&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2462&quot; title=&quot;make INNER a non-reserved keyword&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2462&quot;&gt;&lt;del&gt;HIVE-2462&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2462&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2462&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g&lt;/a&gt; 1174316 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/innerjoin.q&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/queries/clientpositive/innerjoin.q&lt;/a&gt; 1174316 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/innerjoin.q.out&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/ql/src/test/results/clientpositive/innerjoin.q.out&lt;/a&gt; 1174316 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2024/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2024/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;John&lt;/p&gt;
</comment>
                            <comment id="13112861" author="jvs" created="Thu, 22 Sep 2011 19:51:07 +0000"  >&lt;p&gt;Not sure whether we want/need this, but if so, here&apos;s the patch.&lt;/p&gt;</comment>
                            <comment id="13113027" author="he yongqiang" created="Thu, 22 Sep 2011 23:42:45 +0000"  >&lt;p&gt;The patch looks good, we should have it. running test&lt;/p&gt;</comment>
                            <comment id="13113176" author="he yongqiang" created="Fri, 23 Sep 2011 06:02:06 +0000"  >&lt;p&gt;committed, thanks John!&lt;/p&gt;</comment>
                            <comment id="13113330" author="hudson" created="Fri, 23 Sep 2011 11:08:00 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #972 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/972/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/972/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2462&quot; title=&quot;make INNER a non-reserved keyword&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2462&quot;&gt;&lt;del&gt;HIVE-2462&lt;/del&gt;&lt;/a&gt;:make INNER a non-reserved keyword (John Sichi via He Yongqiang)&lt;/p&gt;

&lt;p&gt;heyongqiang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1174531&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1174531&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/innerjoin.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/innerjoin.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12509199">HIVE-2191</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12496169" name="HIVE-2462.1.patch" size="8769" author="jvs" created="Thu, 22 Sep 2011 19:45:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Sep 2011 19:50:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123906</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2463] fix Eclipse for javaewah upgrade</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2463</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I always forget this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524358">HIVE-2463</key>
            <summary>fix Eclipse for javaewah upgrade</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvs">John Sichi</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2011 00:47:19 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:54 +0000</updated>
                            <resolved>Mon, 3 Oct 2011 22:28:11 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Build Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13119692" author="cwsteinbach" created="Mon, 3 Oct 2011 22:28:11 +0000"  >&lt;p&gt;Committed to trunk. Thanks John!&lt;/p&gt;</comment>
                            <comment id="13119909" author="hudson" created="Tue, 4 Oct 2011 05:41:23 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #989 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/989/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/989/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2463&quot; title=&quot;fix Eclipse for javaewah upgrade&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2463&quot;&gt;&lt;del&gt;HIVE-2463&lt;/del&gt;&lt;/a&gt;. Fix Eclipse for javaewah upgrade (John Sichi via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178621&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178621&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/eclipse-templates/.classpath&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12523257">HIVE-2448</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12496208" name="HIVE-2463.1.patch" size="870" author="jvs" created="Fri, 23 Sep 2011 00:48:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 3 Oct 2011 22:28:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35769</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123908</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2464] report progress in MapOperator</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2464</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12524361">HIVE-2464</key>
            <summary>report progress in MapOperator</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2011 01:01:05 +0000</created>
                <updated>Fri, 23 Sep 2011 18:43:28 +0000</updated>
                            <resolved>Fri, 23 Sep 2011 18:43:28 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2465] Primitive Data Types returning null if the data is out of range of the data type.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2465</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Primitive Data Types returning null if the input data is out of range of the data type. In this case it is better to log the message with the proper message and actual data then user get to know some data is missing.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.9.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5)&lt;/p&gt;</environment>
        <key id="12524387">HIVE-2465</key>
            <summary>Primitive Data Types returning null if the data is out of range of the data type.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2011 08:28:10 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:36 +0000</updated>
                            <resolved>Thu, 3 Nov 2011 17:17:22 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13115694" author="jiraposter@reviews.apache.org" created="Tue, 27 Sep 2011 16:39:45 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2066/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Primitive Data Types returning null if the data is out of range of the data type. Added log message while returning null to know some of the data is out of range.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; title=&quot;Primitive Data Types returning null if the data is out of range of the data type.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2465&quot;&gt;&lt;del&gt;HIVE-2465&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2465&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBoolean.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyByte.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyDouble.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFloat.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyInteger.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyLong.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyPrimitive.java 1174035 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyShort.java 1174035 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2066/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;All tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;chinna&lt;/p&gt;
</comment>
                            <comment id="13125616" author="ashutoshc" created="Wed, 12 Oct 2011 06:08:39 +0000"  >&lt;p&gt;Patch needs to be refreshed now that we also have LazyTimeStamp and LazyBinary. Also where will these messages will appear? I assume in task tracker log, which is useful but not a whole lot since users in most cases just looks at client side logs. Is it possible to channel these messages back to client side to make this logging more useful ?&lt;/p&gt;</comment>
                            <comment id="13126608" author="jiraposter@reviews.apache.org" created="Thu, 13 Oct 2011 14:22:11 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2066/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-13 14:22:04.812761)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Patch is refreshed with the  LazyTimeStamp and LazyBinary.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Primitive Data Types returning null if the data is out of range of the data type. Added log message while returning null to know some of the data is out of range.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; title=&quot;Primitive Data Types returning null if the data is out of range of the data type.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2465&quot;&gt;&lt;del&gt;HIVE-2465&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2465&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBinary.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBoolean.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyByte.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyDouble.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFloat.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyInteger.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyLong.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyPrimitive.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyShort.java 1182263 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyTimestamp.java 1182263 &lt;br/&gt;
  trunk/serde/src/test/org/apache/hadoop/hive/serde2/lazy/TestLazyPrimitive.java 1182263 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2066/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;All tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;chinna&lt;/p&gt;
</comment>
                            <comment id="13126616" author="chinnalalam" created="Thu, 13 Oct 2011 14:28:09 +0000"  >&lt;p&gt;patch updated with the LazyTimeStamp and LazyBinary.&lt;br/&gt;
The log will come in Task tracker log when the query execute done by MR job and query like select * from table(Non MR jobs) log will come in the hive itself.&lt;/p&gt;</comment>
                            <comment id="13135238" author="namit" created="Tue, 25 Oct 2011 17:10:53 +0000"  >&lt;p&gt;The changes look good to me.&lt;br/&gt;
However, it might be better to use LOG.warn or LOG.debug instead of LOG.info - &lt;br/&gt;
this might generate a lot of logs.&lt;/p&gt;</comment>
                            <comment id="13138339" author="chinnalalam" created="Fri, 28 Oct 2011 13:44:30 +0000"  >&lt;p&gt;Log level is changed to Log.debug instead of  Log.info. If it is warn also it might generate lot of log because by default log level Log.INFO is configured.&lt;/p&gt;</comment>
                            <comment id="13138341" author="jiraposter@reviews.apache.org" created="Fri, 28 Oct 2011 13:44:33 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2066/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-28 13:45:50.702623)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Log level is changed to Log.debug instead of  Log.info. If it is warn also it might generate lot of log because by default log level Log.INFO is configured&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Primitive Data Types returning null if the data is out of range of the data type. Added log message while returning null to know some of the data is out of range.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; title=&quot;Primitive Data Types returning null if the data is out of range of the data type.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2465&quot;&gt;&lt;del&gt;HIVE-2465&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2465&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBinary.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBoolean.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyByte.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyDouble.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFloat.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyInteger.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyLong.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyPrimitive.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyShort.java 1190202 &lt;br/&gt;
  trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyTimestamp.java 1190202 &lt;br/&gt;
  trunk/serde/src/test/org/apache/hadoop/hive/serde2/lazy/TestLazyPrimitive.java 1190202 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2066/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2066/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;All tests passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;chinna&lt;/p&gt;
</comment>
                            <comment id="13142847" author="namit" created="Thu, 3 Nov 2011 05:20:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13143328" author="namit" created="Thu, 3 Nov 2011 17:17:22 +0000"  >&lt;p&gt;Committed. Thanks Chinna&lt;/p&gt;</comment>
                            <comment id="13143595" author="hudson" created="Thu, 3 Nov 2011 23:14:15 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1056 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1056/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1056/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2465&quot; title=&quot;Primitive Data Types returning null if the data is out of range of the data type.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2465&quot;&gt;&lt;del&gt;HIVE-2465&lt;/del&gt;&lt;/a&gt; Primitive Data Types returning null if the data is out of range of&lt;br/&gt;
the data type. (Ashutosh Chauhan via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197227&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197227&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBinary.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyBoolean.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyByte.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyDouble.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyFloat.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyInteger.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyLong.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyPrimitive.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyShort.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/lazy/LazyTimestamp.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/test/org/apache/hadoop/hive/serde2/lazy/TestLazyPrimitive.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12498883" name="HIVE-2465.1.patch" size="11043" author="chinnalalam" created="Thu, 13 Oct 2011 14:19:50 +0000"/>
                            <attachment id="12501294" name="HIVE-2465.2.patch" size="11050" author="chinnalalam" created="Fri, 28 Oct 2011 13:40:12 +0000"/>
                            <attachment id="12496764" name="HIVE-2465.patch" size="7256" author="chinnalalam" created="Tue, 27 Sep 2011 16:31:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Sep 2011 16:39:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123910</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2466] mapjoin_subquery  dump small table (mapjoin table) to the same file</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2466</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;in mapjoin_subquery.q  there is a query&#65306;&lt;br/&gt;
SELECT /*+ MAPJOIN(z) */ subq.key1, z.value&lt;br/&gt;
FROM&lt;br/&gt;
(SELECT /*+ MAPJOIN&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; */ x.key as key1, x.value as value1, y.key as key2, y.value as value2 &lt;br/&gt;
 FROM src1 x JOIN src y ON (x.key = y.key)) subq&lt;br/&gt;
 JOIN srcpart z ON (subq.key1 = z.key and z.ds=&apos;2008-04-08&apos; and z.hr=11);&lt;br/&gt;
when dump x and z to a local file,there all dump to the same file, so we lost the data of x&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524434">HIVE-2466</key>
            <summary>mapjoin_subquery  dump small table (mapjoin table) to the same file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aoxiang">binlijin</assignee>
                                    <reporter username="aoxiang">binlijin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Sep 2011 16:39:01 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:10 +0000</updated>
                            <resolved>Tue, 8 Nov 2011 05:53:22 +0000</resolved>
                                    <version>0.7.1</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13133815" author="he yongqiang" created="Mon, 24 Oct 2011 03:15:45 +0000"  >&lt;p&gt;can you add a testcase?&lt;/p&gt;</comment>
                            <comment id="13134041" author="aoxiang" created="Mon, 24 Oct 2011 13:02:42 +0000"  >&lt;p&gt;Add a testcase in hive-2466.2.patch&lt;/p&gt;</comment>
                            <comment id="13134321" author="namit" created="Mon, 24 Oct 2011 18:22:31 +0000"  >&lt;p&gt;reviewing now&lt;/p&gt;</comment>
                            <comment id="13134440" author="namit" created="Mon, 24 Oct 2011 20:19:00 +0000"  >&lt;p&gt;A few high level comments:&lt;/p&gt;

&lt;p&gt;Instead of making the dump prefix optional - why dont you always have it in hashtablesinkdesc and&lt;br/&gt;
mapjoindesc. &lt;/p&gt;

&lt;p&gt;This way, you can get rid of all the checks : if dumpdescriptor is not null.&lt;br/&gt;
The logic will be simpler - the names of map files will be :&lt;/p&gt;

&lt;p&gt;mapfile1&lt;br/&gt;
mapfile2&lt;br/&gt;
..&lt;br/&gt;
etc&lt;/p&gt;

&lt;p&gt;Also, it might be nicer to add the static function in PlanUtils.java instead of QBJoinTree.java.&lt;/p&gt;</comment>
                            <comment id="13134767" author="aoxiang" created="Tue, 25 Oct 2011 05:46:53 +0000"  >&lt;p&gt;@Namit Jain,&lt;br/&gt;
Thank you very much! I make some changes in hive-2466.3.patch.&lt;/p&gt;</comment>
                            <comment id="13145213" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 04:12:51 +0000"  >&lt;p&gt;njain requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; mapjoin_subquery  dump small table (mapjoin table) to the same file&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; diff for review&lt;/p&gt;

&lt;p&gt;  in mapjoin_subquery.q  there is a query&#65306;&lt;br/&gt;
  SELECT /*+ MAPJOIN(z) */ subq.key1, z.value&lt;br/&gt;
  FROM&lt;br/&gt;
  (SELECT /*+ MAPJOIN&amp;lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&amp;gt; */ x.key as key1, x.value as value1, y.key as key2, y.value as value2&lt;br/&gt;
  FROM src1 x JOIN src y ON (x.key = y.key)) subq&lt;br/&gt;
  JOIN srcpart z ON (subq.key1 = z.key and z.ds=&apos;2008-04-08&apos; and z.hr=11);&lt;br/&gt;
  when dump x and z to a local file,there all dump to the same file, so we lost the data of x&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D285&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D285&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  data/files/x.txt&lt;br/&gt;
  data/files/y.txt&lt;br/&gt;
  data/files/z.txt&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;br/&gt;
  ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java.orig&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java.orig&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/591/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/591/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13145214" author="namit" created="Mon, 7 Nov 2011 04:14:51 +0000"  >&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 680 source files to /data/users/njain/hive_commit2/build/ql/classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /data/users/njain/hive_commit2/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java:191: cannot find symbol&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; symbol  : method generatePath(java.lang.String,java.lang.Byte,java.lang.String)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; location: class org.apache.hadoop.hive.ql.exec.Utilities&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;         String filePath = Utilities.generatePath(baseDir, pos, currentFileName);&lt;/p&gt;


&lt;p&gt;Can you refresh ?&lt;/p&gt;

&lt;p&gt;I am getting the above error in compiling.&lt;br/&gt;
Also, create a arc diff entry for helping reviewing.&lt;/p&gt;</comment>
                            <comment id="13145263" author="aoxiang" created="Mon, 7 Nov 2011 07:22:51 +0000"  >&lt;p&gt;hive-2466.4.patch is based on the trunk, &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk&lt;/a&gt;, I don&apos;t have the compile problem.&lt;br/&gt;
how to create a arc diff entry? I use the command &quot;svn diff &amp;gt; hive-2466.4.patch&quot; to get the patch.&lt;/p&gt;</comment>
                            <comment id="13145663" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 18:10:51 +0000"  >&lt;p&gt;njain updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; mapjoin_subquery  dump small table (mapjoin table) to the same file&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D285&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D285&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  data/files/x.txt&lt;br/&gt;
  data/files/y.txt&lt;br/&gt;
  data/files/z.txt&lt;br/&gt;
  ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;br/&gt;
  ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/p&gt;</comment>
                            <comment id="13145670" author="namit" created="Mon, 7 Nov 2011 18:19:21 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13146093" author="namit" created="Tue, 8 Nov 2011 05:53:22 +0000"  >&lt;p&gt;Committed. Thanks binlijin&lt;/p&gt;</comment>
                            <comment id="13146227" author="hudson" created="Tue, 8 Nov 2011 11:40:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1067 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1067/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1067/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2466&quot; title=&quot;mapjoin_subquery  dump small table (mapjoin table) to the same file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2466&quot;&gt;&lt;del&gt;HIVE-2466&lt;/del&gt;&lt;/a&gt; mapjoin_subquery dump small table (mapjoin table) to the same file&lt;br/&gt;
(binlijin via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199117&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199117&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/data/files/x.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/y.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/z.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HashTableSinkOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/MapJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/GenMRSkewJoinProcessor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HashTableSinkDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/MapJoinDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/mapjoin_subquery2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12502717" name="ASF.LICENSE.NOT.GRANTED--D285.1.patch" size="58498" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 04:12:52 +0000"/>
                            <attachment id="12502778" name="ASF.LICENSE.NOT.GRANTED--D285.2.patch" size="25272" author="phabricator@reviews.facebook.net" created="Mon, 7 Nov 2011 18:10:52 +0000"/>
                            <attachment id="12498726" name="hive-2466.1.patch" size="9263" author="aoxiang" created="Wed, 12 Oct 2011 10:08:14 +0000"/>
                            <attachment id="12500435" name="hive-2466.2.patch" size="22705" author="aoxiang" created="Mon, 24 Oct 2011 13:02:16 +0000"/>
                            <attachment id="12500620" name="hive-2466.3.patch" size="25129" author="aoxiang" created="Tue, 25 Oct 2011 05:44:06 +0000"/>
                            <attachment id="12502730" name="hive-2466.4.patch" size="25851" author="aoxiang" created="Mon, 7 Nov 2011 06:43:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Oct 2011 03:15:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35768</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2467] HA Support for Metastore Server </title>
                <link>https://issues.apache.org/jira/browse/HIVE-2467</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We require HA deployment for metastore server for HCatalog:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Multiple server instances run behind VIP&lt;/li&gt;
	&lt;li&gt;Database provides HA&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Metastore server instances will need to be able to share any state required for VIP outside RDBMS. As of Hive 0.8 affected conversational state that needs to support VIP/HA setup is limited to current delegation tokens. Is this correct?&lt;/p&gt;

&lt;p&gt;We are planning to use ZooKeeper to share current delegation tokens and master keys between nodes of the VIP. ZK is already (optionally) used by Hive for concurrency control. Access to ZK would be limited on the network level or in the future, when ZooKeeper supports security, through Kerberos, similar to NN access.&lt;/p&gt;

&lt;p&gt;Currently Hive taps into Hadoop core security delegation token support through extension of&lt;br/&gt;
org.apache.hadoop.security.token.delegation.AbstractDelegationTokenSecretManager&amp;lt;TokenIdent&amp;gt;&lt;/p&gt;

&lt;p&gt;A solution could amend the Hive specific extension to support:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Pluggable delegation token and master key store (ZooKeeper as alternative for in-memory AbstractDelegationTokenSecretManager)&lt;/li&gt;
	&lt;li&gt;Delegation token retrieval from token store when not found in memory (wrap/extend retrievePassword(...))&lt;/li&gt;
	&lt;li&gt;Cancellation of token in token store&lt;/li&gt;
	&lt;li&gt;Purging of expired tokens from token store&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;http://www.mail-archive.com/hcatalog-user@incubator.apache.org/msg00053.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/hcatalog-user@incubator.apache.org/msg00053.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524585">HIVE-2467</key>
            <summary>HA Support for Metastore Server </summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thw">Thomas Weise</assignee>
                                    <reporter username="thw">Thomas Weise</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Sep 2011 00:09:45 +0000</created>
                <updated>Tue, 20 Dec 2016 19:24:55 +0000</updated>
                            <resolved>Wed, 7 Dec 2011 02:33:29 +0000</resolved>
                                    <version>0.8.0</version>
                    <version>0.9.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Metastore</component>
                    <component>Security</component>
                    <component>Server Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="13143517" author="thw" created="Thu, 3 Nov 2011 20:47:31 +0000"  >&lt;p&gt;Attached is the initial patch (with unit test coverage). Limited end to end testing has been done to validate the token sharing across multiple servers. No scalability testing has been done yet.&lt;/p&gt;

&lt;p&gt;Changes all go into the Hadoop 20S shim module (depend on secure Hadoop). Everything except the ZooKeeper token store implementation logically extends Hadoop security. AbstractDelegationTokenSecretManager was not designed for extensibility and this reflects in the subclass introduced here, which nevertheless duplicates as little code as possible. Longer term Hadoop should support the token store abstraction or at least more appropriate hooks for extension and dependency injection, which will allow for significant enhanced simplicity and clarity (and of course sharing with other projects).&lt;/p&gt;

&lt;p&gt;The ZooKeeper backed token store: The delegation keys and tokens are stored in ZooKeeper. Multiple metastore servers access ZooKeeper and load keys and tokens from there. Keys are cached and each metastore server instance creates its dedicated key, shared through ZooKeeper with other server instances for token validation. Tokens are not cached. Each server will fetch the token from ZooKeeper when the client establishes a metastore connection (not per request, but per connection).&lt;/p&gt;

&lt;p&gt;By default, none of the extensions introduced with this patch will be used (previous behavior and dependencies remain intact). To enable ZooKeeper token store, additional configuration is needed (on top of secure metastore setup):&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
  &amp;lt;name&amp;gt;hive.cluster.delegation.token.store.class&amp;lt;/name&amp;gt;&lt;br/&gt;
  &amp;lt;value&amp;gt;org.apache.hadoop.hive.thrift.ZooKeeperTokenStore&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;description&amp;gt;The delegation token store implementation class.&amp;lt;/description&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
  &amp;lt;name&amp;gt;hive.cluster.delegation.token.store.zookeeper.connectString&amp;lt;/name&amp;gt;&lt;br/&gt;
  &amp;lt;value&amp;gt;localhost:2181&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;description&amp;gt;The ZooKeeper token store connect string.&amp;lt;/description&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
  &amp;lt;name&amp;gt;hive.cluster.delegation.token.store.zookeeper.rootNode&amp;lt;/name&amp;gt;&lt;br/&gt;
  &amp;lt;value&amp;gt;/hcat/tokenstore&amp;lt;/value&amp;gt;&lt;br/&gt;
  &amp;lt;description&amp;gt;The root path for token store data.&amp;lt;/description&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;There are two potential enhancements I would like to put up for discussion:&lt;/p&gt;

&lt;p&gt;1) Partition token storage by master key id (right now all tokens are children of a single ZooKeeper node. This will make it easier to manually inspect the store and make token expiration more efficient (no need to read all children at once).&lt;/p&gt;

&lt;p&gt;2) Introduce dependency injection point for HadoopThriftAuthBridge20S.createServer, which can be used to plug-in alternative implementations of TokenStore, DelegationTokenManager and potentially other objects for customization and unit testing.&lt;/p&gt;</comment>
                            <comment id="13143667" author="cwsteinbach" created="Fri, 4 Nov 2011 01:27:10 +0000"  >&lt;p&gt;@Thomas: Please submit a review request on reviewboard&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HowToContribute#HowToContribute-ReviewProcess&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/HowToContribute#HowToContribute-ReviewProcess&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13143698" author="jiraposter@reviews.apache.org" created="Fri, 4 Nov 2011 02:33:32 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/shims/ivy.xml 1196916 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1196916 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1196916 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Thomas&lt;/p&gt;
</comment>
                            <comment id="13143702" author="jiraposter@reviews.apache.org" created="Fri, 4 Nov 2011 02:35:32 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-04 02:34:21.317393)&lt;/p&gt;


&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/shims/ivy.xml 1196916 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1196916 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1196916 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Thomas&lt;/p&gt;
</comment>
                            <comment id="13148689" author="ashutoshc" created="Fri, 11 Nov 2011 19:37:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;Tokens are not cached. Each server will fetch the token from ZooKeeper when the client establishes a metastore connection&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;AFAIK ZK currently doesn&apos;t have a security. So, is it possible that a malicious user connects to ZK and gets hold of all the tokens and then can exploit those?&lt;/p&gt;</comment>
                            <comment id="13148752" author="thw" created="Fri, 11 Nov 2011 21:31:26 +0000"  >&lt;p&gt;That is correct. The ZooKeeper installation that will be used for this purpose will have to be secured on layer 3 until we have security available in ZK (which is also coming). We are aware of and consider this a limitation that will be addressed by ZK security, not by the client using ZK.&lt;/p&gt;</comment>
                            <comment id="13149251" author="ashutoshc" created="Sun, 13 Nov 2011 08:46:07 +0000"  >&lt;p&gt;ZK security in upcoming release may require some time to bake in. Another alternative approaches could have been to store tokens in hdfs or mysql server. Both of them are secure right now. Though, good part of your design is you have made TokenStore abstract so there could be multiple implementations of it, if need be.&lt;/p&gt;</comment>
                            <comment id="13149742" author="thw" created="Mon, 14 Nov 2011 16:53:39 +0000"  >&lt;p&gt;Yes, this was the intention. Also, the current ZK token store implementation could be translated into a SQL implementation with relatively small effort (it does not depend on ZK watches for invalidation). For our use, we plan to deal with the security limitation at L3 and use ZK security when it becomes available. Longer term, assuming there will be use cases outside HCatalog/Hive for long running processes that require token support in conjunction with HA but without HA RDBMS already available, a ZK based token storage might be a more likely choice. While plain HDFS is secure it does not support the access pattern needed here (fast random reads and writes). &lt;/p&gt;</comment>
                            <comment id="13150243" author="neunand" created="Tue, 15 Nov 2011 05:25:03 +0000"  >&lt;p&gt;If Hadoop .23 relies on ZooKeeper, then I would hope that ZK is already baked in... otherwise I would tend to think, if ZK is tolerably secure for Hadoop, then it should be tolerable for Hive/HCatalog. After all, afaik both Hive and HCatalog piggy back on HDFS for security.&lt;/p&gt;

&lt;p&gt;But I like the idea of having different implementations for the TokenStore, even though my preferred deployment would be ZooKeeper-based.&lt;/p&gt;</comment>
                            <comment id="13151365" author="ashutoshc" created="Wed, 16 Nov 2011 17:42:13 +0000"  >&lt;ul&gt;
	&lt;li&gt;Does it make sense to have TokenStore as a first class interface instead being contained in TokenStoreDelegationTokenSecretManager and then secret manager contain an instance of it?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I think it makes sense to always use TokenStore based DelegationTokenSecretManager and use MemoryStore as default case instead of creating two code paths in ThriftAuthBridge20S.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Various tricks are currently done to get around limited interfaces exported by Hadoop. We should file jiras on hadoop so some of this could be eventually be migrated there.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;After retrieving tokens from tokenstore we put them in abstract class&apos;s maps, pull it back and then delete immediately. This looks unnecessary. If possible we should avoid that.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13151686" author="thw" created="Thu, 17 Nov 2011 00:35:59 +0000"  >&lt;p&gt;Updated patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;No need to load master keys on retrievePassword&lt;/li&gt;
	&lt;li&gt;Make MemoryStore default when no token store is configured (instead of using old implementation)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13151690" author="thw" created="Thu, 17 Nov 2011 00:43:14 +0000"  >&lt;p&gt;@Ashutosh:&lt;/p&gt;

&lt;p&gt;I will file JIRA to incorporate relevant changes to Hadoop trunk so the next shim version (.23 and later) can use it from there (without the various &quot;tricks&quot; to make this work for .20). I would suggest to address the TokenStore first class interface as part of that patch?&lt;/p&gt;

&lt;p&gt;The logic that puts tokens into the cache and removes them immediately is necessary due to field/method visibility issues in the Hadoop code. All that won&apos;t be needed when we prepare a Hadoop patch. I added a few comments in the code.&lt;/p&gt;</comment>
                            <comment id="13151701" author="jiraposter@reviews.apache.org" created="Thu, 17 Nov 2011 00:57:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-17 00:57:32.772077)&lt;/p&gt;


&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467?focusedCommentId=13151686&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13151686&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467?focusedCommentId=13151686&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13151686&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Functional test: Running 2 metastore servers pointed to ZK and a test client that obtains token through first server and uses it to perform metastore op through the other server. - PASSED&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/shims/ivy.xml 1202918 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1202918 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1202918 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Thomas&lt;/p&gt;
</comment>
                            <comment id="13151767" author="appodictic" created="Thu, 17 Nov 2011 03:30:05 +0000"  >&lt;p&gt;If I understand correctly storing tokens in something third party that is not kerberiz&apos;ed defeats the purpose of kerberos. I am not expressly -1. But it seems like doing it once right when ZK has kerberos is better then doing the work twice and in the interim have a quasi-secure solution. &lt;/p&gt;</comment>
                            <comment id="13153016" author="ashutoshc" created="Fri, 18 Nov 2011 18:17:53 +0000"  >&lt;p&gt;@Ed,&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ZK is optional for storing tokens. If someone believes ZK doesn&apos;t serve them appropriately for this purpose then they can implement TokenStore interface and use that implementation for storing tokens.&lt;/li&gt;
	&lt;li&gt;Assumption is that ZK&apos;s api will be backward compatible. So, there will be minimal changes (if at all) required in this code to take advantage of kerberized ZK.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13153042" author="ashutoshc" created="Fri, 18 Nov 2011 18:49:47 +0000"  >&lt;p&gt;@Thomas,&lt;br/&gt;
Now that there are no users of &lt;tt&gt;DelegationTokenSecretManager&lt;/tt&gt;, I think cleaner way to organize this code is to merge &lt;tt&gt;DelegationTokenSecretManager&lt;/tt&gt; and &lt;tt&gt;TokenStoreDelegationSecretManager&lt;/tt&gt; and just call it DelegationTokenSecretManager. Also, &lt;tt&gt;TokenStore&lt;/tt&gt; instead of being contained within a class, I think should exist independently of it.&lt;/p&gt;</comment>
                            <comment id="13154829" author="jiraposter@reviews.apache.org" created="Tue, 22 Nov 2011 02:28:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/#review3417&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#review3417&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7646&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7646&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    For consistency reasons, these should be moved to HiveConf. Also, the other properties which are there in this class.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7647&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7647&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Refer to it by Map.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7648&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7648&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Instead of java.util.concurrent.ConcurrentHashMap, use ConcurrentHashMap instead.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7650&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7650&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    If TokenStore is meant to be Configurable, then have a private variable here to hold the conf in setConf() and return that in getConf()&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7651&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7651&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    use ArrayList, instead of fully qualified with package name&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7652&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7652&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Interface method needs javadoc.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7653&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7653&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Interface method needs javadoc.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7654&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7654&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Either it should return boolean or it should throw Exception. Doing both is confusing. If you want to throw exception, then throw exception on failure and return void, else return false in failure scenario. Token must be removed in all cases if method returns. &lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7655&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7655&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    HashMap instead of java.util.HashMap&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7656&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7656&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Fully qualified classname.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7658&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7658&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should these come from hiveConf, so they are externally configurable?&lt;/p&gt;



&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7659&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7659&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Contract of configurable is to return conf in getConf(), so you must store it in a private variable and return it.&lt;/p&gt;



&lt;p&gt;trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7660&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7660&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    One way to test HA is to start two metastore processes in two different threads configure to use ZK token store and then do operation on first kill it and then do operation on second one and then have it succeeds. If thats not straight forward, may be we can take that up in separate ticket. &lt;/p&gt;



&lt;p&gt;trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/#comment7661&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#comment7661&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Get rid of commented code.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ashutosh&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-11-17 00:57:32, Thomas wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-17 00:57:32)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/ivy.xml 1202918 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1202918 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1202918 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thomas&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13156232" author="jiraposter@reviews.apache.org" created="Wed, 23 Nov 2011 19:55:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-23 19:55:34.604089)&lt;/p&gt;


&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updated patch to address review comments from Ashutosh.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/shims/ivy.xml 1205535 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/DelegationTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1205535 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1205535 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Thomas&lt;/p&gt;
</comment>
                            <comment id="13156234" author="jiraposter@reviews.apache.org" created="Wed, 23 Nov 2011 19:57:39 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java, lines 40-46&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58992#file58992line40&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58992#file58992line40&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     If TokenStore is meant to be Configurable, then have a private variable here to hold the conf in setConf() and return that in getConf()&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Added. It was never meant to implement Configurable, but  ReflectionUtils.newInstance(...) does not support constructor injection for conf.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java, line 33&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58992#file58992line33&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58992#file58992line33&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Instead of java.util.concurrent.ConcurrentHashMap, use ConcurrentHashMap instead.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;done&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java, lines 335-343&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58991#file58991line335&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58991#file58991line335&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     For consistency reasons, these should be moved to HiveConf. Also, the other properties which are there in this class.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ideally yes (tried that originally), but the shim cannot depend on HiveConf... Perhaps in the future we can define these as part of Hadoop common security.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java, line 123&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line123&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line123&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Either it should return boolean or it should throw Exception. Doing both is confusing. If you want to throw exception, then throw exception on failure and return void, else return false in failure scenario. Token must be removed in all cases if method returns.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Exception is for errors, return boolean to indicate status of successful operation. Clarified in java doc.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java, line 100&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line100&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line100&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Interface method needs javadoc.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;done&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java, line 184&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line184&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58993#file58993line184&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Fully qualified classname.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;done&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java, lines 49-50&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58994#file58994line49&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58994#file58994line49&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Should these come from hiveConf, so they are externally configurable?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;these are relative paths, the root is already configurable, added comment in code&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java, line 1&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58996#file58996line1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58996#file58996line1&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     One way to test HA is to start two metastore processes in two different threads configure to use ZK token store and then do operation on first kill it and then do operation on second one and then have it succeeds. If thats not straight forward, may be we can take that up in separate ticket.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s what I&apos;m doing as integration test (this type of thing is really e2e (launching multiple servers), not unit testing). We should have the pieces reasonably covered in unit tests though. The added test covers DelegationTokenManager with token store interaction, the existing test case does the full path through the auth bridge.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java, lines 137-152&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58994#file58994line137&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58994#file58994line137&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Contract of configurable is to return conf in getConf(), so you must store it in a private variable and return it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ditto MemoryTokenStore&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-22 02:27:01, Ashutosh Chauhan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java, line 86&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2721/diff/2/?file=58996#file58996line86&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff/2/?file=58996#file58996line86&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Get rid of commented code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;made this controllable via system property&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Thomas&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2721/#review3417&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/#review3417&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-23 19:55:34, Thomas wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2721/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-23 19:55:34)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Carl Steinbach, Ashutosh Chauhan and Devaraj Das.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2467&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/ivy.xml 1205535 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/DelegationTokenStore.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java 1205535 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java 1205535 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2721/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2721/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;unit test added, ant clean package test  - passed&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thomas&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13160178" author="thw" created="Wed, 30 Nov 2011 17:50:51 +0000"  >&lt;p&gt;All unit tests pass with the patch.&lt;/p&gt;</comment>
                            <comment id="13164077" author="ashutoshc" created="Wed, 7 Dec 2011 02:33:29 +0000"  >&lt;p&gt;+1 Committed to trunk. Thanks, Thomas for this useful contribution.&lt;/p&gt;</comment>
                            <comment id="13164113" author="hudson" created="Wed, 7 Dec 2011 03:40:59 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.23.0 #5 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.23.0/5/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.23.0/5/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt; : HA Support for Metastore Server (Thomas Weise via Ashutosh Chauhan)&lt;/p&gt;

&lt;p&gt;hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211275&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164268" author="hudson" created="Wed, 7 Dec 2011 10:15:16 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1129 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1129/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1129/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2467&quot; title=&quot;HA Support for Metastore Server &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2467&quot;&gt;&lt;del&gt;HIVE-2467&lt;/del&gt;&lt;/a&gt; : HA Support for Metastore Server (Thomas Weise via Ashutosh Chauhan)&lt;/p&gt;

&lt;p&gt;hashutosh : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1211275&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/HadoopThriftAuthBridge20S.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/MemoryTokenStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/TokenStoreDelegationTokenSecretManager.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/thrift/ZooKeeperTokenStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/security/token/delegation/HiveDelegationTokenSupport.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/test/org/apache/hadoop/hive/thrift/TestHadoop20SAuthBridge.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12538244">HIVE-2712</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12598632">HIVE-3255</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12531729">HADOOP-7829</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12480698">ZOOKEEPER-938</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12476697">HIVE-1696</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12504000" name="HIVE-2467.2.patch" size="49622" author="thw" created="Thu, 17 Nov 2011 00:35:58 +0000"/>
                            <attachment id="12502218" name="HIVE-2467.patch" size="50643" author="thw" created="Thu, 3 Nov 2011 20:47:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Nov 2011 01:27:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3398</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06agv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34627</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2468] Make Hive compile against Hadoop 0.23</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2468</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Due to restructure of Hadoop 0.22 branch compared to Hadoop 0.20 Hive does not compile against 0.22&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524588">HIVE-2468</key>
            <summary>Make Hive compile against Hadoop 0.23</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tomwhite">Tom White</assignee>
                                    <reporter username="shv">Konstantin Shvachko</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Sep 2011 00:49:44 +0000</created>
                <updated>Thu, 2 May 2013 02:29:47 +0000</updated>
                            <resolved>Thu, 8 Dec 2011 04:01:48 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>15</watches>
                                                                <comments>
                            <comment id="13144317" author="tomwhite" created="Fri, 4 Nov 2011 20:41:03 +0000"  >&lt;p&gt;Here&apos;s a patch that Roman Shaposhnik and I wrote to get Hive compiling against Hadoop 0.23 (I haven&apos;t tried it against 0.22).&lt;/p&gt;</comment>
                            <comment id="13144661" author="ashutoshc" created="Sat, 5 Nov 2011 11:38:07 +0000"  >&lt;p&gt;@Tom,&lt;br/&gt;
This is very useful. Can you please create RB for it? Also, would you like to change the jira title to reflect it is for 0.23 &lt;/p&gt;</comment>
                            <comment id="13145964" author="jiraposter@reviews.apache.org" created="Mon, 7 Nov 2011 23:56:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/build.properties 1196775 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1196775 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1196775 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1196775 &lt;br/&gt;
  trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1196775 &lt;br/&gt;
  trunk/shims/build.xml 1196775 &lt;br/&gt;
  trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1196775 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1196775 &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyFileSystem.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/EmptyShim.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/HiveHarFileSystem.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSecretManager.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1196775 &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1196775 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tom&lt;/p&gt;
</comment>
                            <comment id="13151885" author="jiraposter@reviews.apache.org" created="Thu, 17 Nov 2011 07:34:53 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/#review3316&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/#review3316&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Looks good overall. Please update build.properties and resubmit. Thanks!&lt;/p&gt;


&lt;p&gt;trunk/build.properties&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2762/#comment7404&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/#comment7404&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    For the time being we need to stick with 0.20.1 as the default Hadoop version against which Hive is tested, but we should start using 0.23.0 for the security tests, and should ensure that all tests pass when run against 0.23.0.&lt;/p&gt;

&lt;p&gt;    Please set hadoop.version to 0.20.1 and hadoop.security.version to 0.23.0, and ensure that all tests pass when run as &quot;ant test -Dhadoop.version=0.23.0&quot;.&lt;/p&gt;

&lt;p&gt;    Also, I added 0.23.0 to the cloudera and facebook hive-deps mirrors, so please reference those locations instead.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-11-07 23:55:47, Tom White wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-07 23:55:47)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/build.properties 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/build.xml 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/EmptyShim.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/HiveHarFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSecretManager.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Tom&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13151903" author="amareshwari" created="Thu, 17 Nov 2011 08:37:18 +0000"  >&lt;p&gt;Would need following changes in bin/hive:&lt;br/&gt;
-if [ $hadoop_minor_ver -ne 20 -o $hadoop_patch_ver -eq 0 ]; then&lt;br/&gt;
+if [ &quot;$hadoop_minor_ver$hadoop_patch_ver&quot; -lt &quot;201&quot; ]; then&lt;/p&gt;

&lt;p&gt;Also, I had to do changes in CombineFileInputFormatShim to work with 0.23. Because the following casting does not work anymore.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;      CombineFileSplit[] splits = (CombineFileSplit[]) super.getSplits(job, numSplits);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the paths of hadoop jars build.properties should be changed according to the 0.23 tar ball&lt;/p&gt;</comment>
                            <comment id="13152568" author="jiraposter@reviews.apache.org" created="Fri, 18 Nov 2011 01:26:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-17 07:33:27, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/build.properties, line 13&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2762/diff/1/?file=56790#file56790line13&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff/1/?file=56790#file56790line13&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     For the time being we need to stick with 0.20.1 as the default Hadoop version against which Hive is tested, but we should start using 0.23.0 for the security tests, and should ensure that all tests pass when run against 0.23.0.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Please set hadoop.version to 0.20.1 and hadoop.security.version to 0.23.0, and ensure that all tests pass when run as &quot;ant test -Dhadoop.version=0.23.0&quot;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also, I added 0.23.0 to the cloudera and facebook hive-deps mirrors, so please reference those locations instead.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for taking a look Carl.&lt;/p&gt;

&lt;p&gt;I agree that we should leave 0.20.1 as the default. I think security tests should be left at the default for now too. This issue was to get Hive compiling against Hadoop 0.23.0, and I imagined any unit test failures against 0.23.0 could be fixed in follow up issues. Does that sound reasonable?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Tom&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/#review3316&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/#review3316&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-07 23:55:47, Tom White wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-07 23:55:47)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/build.properties 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/build.xml 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/EmptyShim.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/HiveHarFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSecretManager.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Tom&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13152572" author="jiraposter@reviews.apache.org" created="Fri, 18 Nov 2011 01:33:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-17 07:33:27, Carl Steinbach wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/build.properties, line 13&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2762/diff/1/?file=56790#file56790line13&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff/1/?file=56790#file56790line13&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     For the time being we need to stick with 0.20.1 as the default Hadoop version against which Hive is tested, but we should start using 0.23.0 for the security tests, and should ensure that all tests pass when run against 0.23.0.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Please set hadoop.version to 0.20.1 and hadoop.security.version to 0.23.0, and ensure that all tests pass when run as &quot;ant test -Dhadoop.version=0.23.0&quot;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also, I added 0.23.0 to the cloudera and facebook hive-deps mirrors, so please reference those locations instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Tom White wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks for taking a look Carl.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I agree that we should leave 0.20.1 as the default. I think security tests should be left at the default for now too. This issue was to get Hive compiling against Hadoop 0.23.0, and I imagined any unit test failures against 0.23.0 could be fixed in follow up issues. Does that sound reasonable?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds good to me.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Carl&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/#review3316&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/#review3316&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-07 23:55:47, Tom White wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-07 23:55:47)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/build.properties 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/build.xml 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/EmptyShim.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/HiveHarFileSystem.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSecretManager.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1196775 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Tom&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13153009" author="thw" created="Fri, 18 Nov 2011 18:05:27 +0000"  >&lt;p&gt;The proposed change would duplicate package/class names from 20S shim. That&apos;s problematic as all go into a single shim jar file. I would suggest to use a different package (or rename all classes) for the .23 shim. In those cases where classes from 20S are copied w/o modification, we should try to separate them out to a common location that is shared between 20S and 23?&lt;/p&gt;</comment>
                            <comment id="13153168" author="jiraposter@reviews.apache.org" created="Fri, 18 Nov 2011 22:06:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-18 22:06:29.024823)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Thanks for all the feedback! Here&apos;s a new patch which addresses it.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Change build.properties to the 0.20-based version numbers (build against 23 with &quot;ant -Dhadoop.version=0.23.0 -Dhadoop.security.version=0.23.0 -Dhadoop.security.version.prefix=0.23&quot;)&lt;/li&gt;
	&lt;li&gt;Makes the change to bin/hive that Amareshwari suggested.&lt;/li&gt;
	&lt;li&gt;Removed duplicate classes names from the 0.23 shim as Thomas suggested. I also removed some classes that I needlessly introduced into the 23 shim tree in the last patch.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Amareshwari, can you post your changes to CombineFileInputFormatShim so we can include those too?&lt;/p&gt;

&lt;p&gt;I also need to run unit tests against 0.20 to check there are no regressions.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1203794 &lt;br/&gt;
  trunk/shims/build.xml 1203794 &lt;br/&gt;
  trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1203794 &lt;br/&gt;
  trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1203794 &lt;br/&gt;
  trunk/build.properties 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1203794 &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier23.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector23.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1203794 &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1203794 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tom&lt;/p&gt;
</comment>
                            <comment id="13153401" author="tomwhite" created="Sat, 19 Nov 2011 05:56:04 +0000"  >&lt;p&gt;All tests pass against 0.20.&lt;/p&gt;</comment>
                            <comment id="13153939" author="cwsteinbach" created="Mon, 21 Nov 2011 01:48:32 +0000"  >&lt;p&gt;@Tom: The latest patch on RB looks good. Can you please attach it here and click the box that gives license rights to the ASF? Thanks!&lt;/p&gt;</comment>
                            <comment id="13154914" author="amareshwari" created="Tue, 22 Nov 2011 06:50:26 +0000"  >&lt;p&gt;I tried to make combine file input format, but &lt;br/&gt;
ant -Dhadoop.version=0.23.0 -Dhadoop.security.version=0.23.0 -Dhadoop.security.version.prefix=0.23 is giving errors.&lt;/p&gt;

&lt;p&gt;I modified build.properties to pickup jars from new locations in hadoop 0.23 tarball. Still I&apos;m getting some errors. For some reason it was not able to find MiniDFSCluster and HadoopArchives classes. Also, it could not find jetty libraries for Jetty23Shims. Noticed that hadoop 0.23 tarball does not have jetty jars in lib/. &lt;br/&gt;
Tom, is it some other way you could compile against 0.23?&lt;/p&gt;</comment>
                            <comment id="13155593" author="tomwhite" created="Wed, 23 Nov 2011 00:55:01 +0000"  >&lt;p&gt;Thanks for the report, Amareshwari. I cleared my Ivy cache and hit the same problem (it was compiling fine against 0.23.0 before). I&apos;ll create a new patch.&lt;/p&gt;</comment>
                            <comment id="13155715" author="tomwhite" created="Wed, 23 Nov 2011 06:25:31 +0000"  >&lt;p&gt;It&apos;s not complete yet, but here&apos;s an updated patch. I still need to fix shim tests, and the missing ProxyLocalFileSystem in 0.23. &lt;/p&gt;</comment>
                            <comment id="13156053" author="tomwhite" created="Wed, 23 Nov 2011 18:39:00 +0000"  >&lt;p&gt;Here&apos;s a work in progress patch which passes some of the tests now.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Moved ProxyLocalFileSystem and ProxyFileSystem to common shims.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-2081&quot; title=&quot;Configuration getInt, getLong, and getFloat replace invalid numbers with the default value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-2081&quot;&gt;&lt;del&gt;HADOOP-2081&lt;/del&gt;&lt;/a&gt; was causing problems with hive.metastore.event.expiry.duration and hive.metastore.event.clean.freq, which were set to 0L, so I changed these to 0.&lt;/li&gt;
	&lt;li&gt;org.apache.hadoop.hive.ql.io.TestSymlinkTextInputFormat is (still) failing due to the issue Amareshwari pointed out.&lt;/li&gt;
	&lt;li&gt;Some tests are failing due to class not found issues, which are due to incorrect classpaths. These still need fixing - I&apos;m running some more tests to see if I can isolate the cause.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13159507" author="tomwhite" created="Tue, 29 Nov 2011 20:09:26 +0000"  >&lt;p&gt;This patch fixes org.apache.hadoop.hive.ql.io.TestSymlinkTextInputFormat (the CombineFileSplit problem), and the classpath problems. I ran the whole unit test suite against Hadoop 0.23 and over 95% of the tests pass now.&lt;/p&gt;</comment>
                            <comment id="13159922" author="amareshwari" created="Wed, 30 Nov 2011 08:58:07 +0000"  >&lt;p&gt;I could compile hive against Hadoop 0.23 without any issues with the latest patch. Thanks Tom. &lt;br/&gt;
Can you also include the change in bin/hive and make it  Patch available?&lt;/p&gt;

&lt;p&gt;I also started running tests. Will get back if i find any issues.&lt;/p&gt;</comment>
                            <comment id="13160144" author="tomwhite" created="Wed, 30 Nov 2011 16:56:24 +0000"  >&lt;p&gt;New patch with Amareshwari&apos;s change to bin/hive.&lt;/p&gt;</comment>
                            <comment id="13160145" author="jiraposter@reviews.apache.org" created="Wed, 30 Nov 2011 16:57:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2762/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-30 16:57:27.344021)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2468&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/bin/hive 1203794 &lt;br/&gt;
  trunk/build-common.xml 1203794 &lt;br/&gt;
  trunk/build.properties 1203794 &lt;br/&gt;
  trunk/build.xml 1203794 &lt;br/&gt;
  trunk/conf/hive-default.xml 1203794 &lt;br/&gt;
  trunk/contrib/build.xml 1203794 &lt;br/&gt;
  trunk/hbase-handler/build.xml 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java 1203794 &lt;br/&gt;
  trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java 1203794 &lt;br/&gt;
  trunk/hwi/build.xml 1203794 &lt;br/&gt;
  trunk/jdbc/build.xml 1203794 &lt;br/&gt;
  trunk/ql/build.xml 1203794 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1203794 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/JobTrackerURLResolver.java 1203794 &lt;br/&gt;
  trunk/service/build.xml 1203794 &lt;br/&gt;
  trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java 1203794 &lt;br/&gt;
  trunk/shims/build.xml 1203794 &lt;br/&gt;
  trunk/shims/src/0.20/java/org/apache/hadoop/fs/ProxyFileSystem.java 1203794 &lt;br/&gt;
  trunk/shims/src/0.20/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java 1203794 &lt;br/&gt;
  trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java 1203794 &lt;br/&gt;
  trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java 1203794 &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier23.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector23.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/fs/ProxyFileSystem.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java PRE-CREATION &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java 1203794 &lt;br/&gt;
  trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java 1203794 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2762/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2762/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Tom&lt;/p&gt;
</comment>
                            <comment id="13160209" author="thw" created="Wed, 30 Nov 2011 18:24:25 +0000"  >&lt;p&gt;I assume (based on findings in linked Pig issue) that when Hive is built against .23 then it won&apos;t be byte code compatible with .20 and so even though the shim is present cannot run on .20?&lt;/p&gt;</comment>
                            <comment id="13160250" author="cwsteinbach" created="Wed, 30 Nov 2011 19:16:03 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13160623" author="cwsteinbach" created="Thu, 1 Dec 2011 03:31:02 +0000"  >&lt;p&gt;Committed to trunk. Thanks Tom!&lt;/p&gt;</comment>
                            <comment id="13160624" author="cwsteinbach" created="Thu, 1 Dec 2011 03:32:48 +0000"  >&lt;p&gt;I&apos;m going to backport this patch to 0.8.0. Reassigning to myself until that work is finished.&lt;/p&gt;

&lt;p&gt;Also, I created a new Jenkins job here: &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.23.0/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.23.0/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13160712" author="hudson" created="Thu, 1 Dec 2011 07:59:16 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1115 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1115/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1115/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2468&quot; title=&quot;Make Hive compile against Hadoop 0.23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2468&quot;&gt;&lt;del&gt;HIVE-2468&lt;/del&gt;&lt;/a&gt;. Make Hive compile against Hadoop 0.23 (Tom White via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1208940&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1208940&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/bin/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.properties&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/contrib/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHBaseTableOutputFormat.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/src/java/org/apache/hadoop/hive/hbase/HiveHFileOutputFormat.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hwi/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/JobTrackerURLResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/service/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/service/src/java/org/apache/hadoop/hive/service/HiveServer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20/java/org/apache/hadoop/fs/ProxyFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.20S/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/shims/Jetty23Shims.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenIdentifier23.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/0.23/java/org/apache/hadoop/hive/thrift/DelegationTokenSelector23.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/fs&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/fs/ProxyFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/fs/ProxyLocalFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/HadoopShims.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/src/common/java/org/apache/hadoop/hive/shims/ShimLoader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13163313" author="ahmed.radwan" created="Tue, 6 Dec 2011 03:31:43 +0000"  >&lt;p&gt;I checked out trunk, then made the release tarball using ant binary. Tried to run against a real hadoop 0.23 cluster, but I am getting the following error when trying to start hive:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.RuntimeException: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: java.lang.RuntimeException: Could not load shims in &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.shims.Hadoop23Shims
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:277)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:603)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:554)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:189)
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.RuntimeException: java.lang.RuntimeException: Could not load shims in &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.shims.Hadoop23Shims
	at org.apache.hadoop.hive.ql.metadata.HiveUtils.getAuthenticator(HiveUtils.java:225)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:270)
	... 7 more
Caused by: java.lang.RuntimeException: java.lang.RuntimeException: Could not load shims in &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.shims.Hadoop23Shims
	at org.apache.hadoop.hive.ql.security.HadoopDefaultAuthenticator.setConf(HadoopDefaultAuthenticator.java:53)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:70)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:125)
	at org.apache.hadoop.hive.ql.metadata.HiveUtils.getAuthenticator(HiveUtils.java:222)
	... 8 more
Caused by: java.lang.RuntimeException: Could not load shims in &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.hadoop.hive.shims.Hadoop23Shims
	at org.apache.hadoop.hive.shims.ShimLoader.createShim(ShimLoader.java:102)
	at org.apache.hadoop.hive.shims.ShimLoader.loadShims(ShimLoader.java:94)
	at org.apache.hadoop.hive.shims.ShimLoader.getHadoopShims(ShimLoader.java:65)
	at org.apache.hadoop.hive.ql.security.HadoopDefaultAuthenticator.setConf(HadoopDefaultAuthenticator.java:51)
	... 11 more
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hive.shims.Hadoop23Shims
	at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:307)
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:252)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClassInternal(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:320)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName0(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:169)
	at org.apache.hadoop.hive.shims.ShimLoader.createShim(ShimLoader.java:99)
	... 14 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13163345" author="cwsteinbach" created="Tue, 6 Dec 2011 04:53:10 +0000"  >&lt;p&gt;@Ahmed: Please try recompiling Hive with the following build properties:&lt;/p&gt;

&lt;p&gt;ant -Dhadoop.version=0.23.0 -Dhadoop.security.version=0.23.0 -Dhadoop.security.version.prefix=0.23&lt;/p&gt;

&lt;p&gt;If this works then we need to investigate ways of building a Hive binary that works with both 0.20.1 and 0.23.0. Otherwise there&apos;s a more serious bug that we need to investigate. Thanks.&lt;/p&gt;</comment>
                            <comment id="13163892" author="ahmed.radwan" created="Tue, 6 Dec 2011 21:53:48 +0000"  >&lt;p&gt;Used these flags in recompiling. Rerunning against 0.23, the previous runtime exception seem to disappear. Thanks!&lt;/p&gt;</comment>
                            <comment id="13430881" author="namit" created="Wed, 8 Aug 2012 05:33:05 +0000"  >&lt;p&gt;@Carl: can the above be used to compile hive source code also ?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12534398">HIVE-2638</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12522489">PIG-2277</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12505137">HCATALOG-10</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12534090">HIVE-2629</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12533041">MAPREDUCE-3479</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12510475">PIG-2125</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12534089">HCATALOG-179</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12505634" name="HIVE-2468.patch" size="79350" author="tomwhite" created="Wed, 30 Nov 2011 16:56:24 +0000"/>
                            <attachment id="12505530" name="HIVE-2468.patch" size="80058" author="tomwhite" created="Tue, 29 Nov 2011 20:09:26 +0000"/>
                            <attachment id="12504905" name="HIVE-2468.patch" size="75433" author="tomwhite" created="Wed, 23 Nov 2011 18:39:00 +0000"/>
                            <attachment id="12504850" name="HIVE-2468.patch" size="49743" author="tomwhite" created="Wed, 23 Nov 2011 06:25:31 +0000"/>
                            <attachment id="12502524" name="HIVE-2468.patch" size="61544" author="tomwhite" created="Fri, 4 Nov 2011 20:41:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Nov 2011 20:41:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 24 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123913</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2469] Error message is wrong if sortby contains function</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2469</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;select key, count(1) cnt from src group by key sort by count(1) limit 10; &lt;/p&gt;

&lt;p&gt;Exception Message is:&lt;br/&gt;
FAILED: Error in semantic analysis: functions are not supported in order by.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.9.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5)&lt;/p&gt;</environment>
        <key id="12524646">HIVE-2469</key>
            <summary>Error message is wrong if sortby contains function</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Sep 2011 15:31:43 +0000</created>
                <updated>Mon, 22 Aug 2016 18:22:00 +0000</updated>
                            <resolved>Mon, 22 Aug 2016 18:22:00 +0000</resolved>
                                    <version>0.9.0</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13114738" author="chinnalalam" created="Mon, 26 Sep 2011 15:57:33 +0000"  >&lt;p&gt;If construct the message with ASTNode it looks like :&lt;/p&gt;

&lt;p&gt;FAILED: Error in semantic analysis: functions are not supported in TOK_SORTBY&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12506000">HIVE-2145</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2470] Improve support for Constant Object Inspectors</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2470</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;ConstantObjectInspectors are nice but they need to be more widely supported and used.  In particular,&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;More functions need to be using them.&lt;/li&gt;
	&lt;li&gt;There need to be facilities for propagating constness.&lt;/li&gt;
	&lt;li&gt;Support for complex types must be added.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12524979">HIVE-2470</key>
            <summary>Improve support for Constant Object Inspectors</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jonchang">Jonathan Chang</assignee>
                                    <reporter username="jonchang">Jonathan Chang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Sep 2011 23:02:11 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:03 +0000</updated>
                            <resolved>Tue, 11 Oct 2011 03:37:28 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13115994" author="jiraposter@reviews.apache.org" created="Tue, 27 Sep 2011 23:04:45 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-27 23:03:09.601042)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/ConstantFoldableGenericUDF.java PRE-CREATION &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java 1cf97c8 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArrayContains.java d60dc86 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIf.java 9a6a7ff &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFMap.java 3b71c48 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFMapKeys.java b384717 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13115995" author="jonchang" created="Tue, 27 Sep 2011 23:05:02 +0000"  >&lt;p&gt;Rename.&lt;/p&gt;</comment>
                            <comment id="13116691" author="jvs" created="Wed, 28 Sep 2011 18:54:28 +0000"  >&lt;p&gt;Cool stuff.  But one question:  do we actually need to change UDF&apos;s to make them foldable?  Another way I&apos;ve seen this done in the past is for the optimizer to actually figure out the maximum constant subexpression (similar to what we already do for figuring out deterministic expressions during predicate pushdown), and then evaluate that and replace the expression with the constant result (and then carry on with optimization).  The benefit is that then other parts of the optimizer see the constant instead of the complex expression.  For example, index search wants to see COL=CONSTANT, not COL=COMPLEX_EXPRESSION.&lt;/p&gt;</comment>
                            <comment id="13116717" author="jonchang" created="Wed, 28 Sep 2011 19:28:41 +0000"  >&lt;p&gt;The goal here was to maximize compatibility; that is, things can be constant folded only if they explicitly ask to be.  The other reason was that some UDFs may have special handling for constants (e.g. all the reflection-based stuff).&lt;/p&gt;</comment>
                            <comment id="13116730" author="jiraposter@reviews.apache.org" created="Wed, 28 Sep 2011 19:42:45 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2142&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2142&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Everything looks great, this will be really helpful!&lt;br/&gt;
Just few inline comments:&lt;/p&gt;


&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/ConstantFoldableGenericUDF.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2078/#comment4959&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#comment4959&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should code here make sure this value is actually constant?&lt;br/&gt;
    I.e. create a deep copy of maps/lists, with Collections.unmodifiableMap/List wrapper around them?&lt;/p&gt;

&lt;p&gt;    (or maybe it is better/cleaner to make StandardConstantList/MapObjectInspector create such a copy inside, and make code here return inspector.getWritableConstantValue instead. That will make this safe for all usages below, like getConstantObjectInspector. This will always be one-time only performance hit, since we are dealing with constant OI&apos;s, so it shouldn&apos;t matter) &lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/ConstantFoldableGenericUDF.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2078/#comment4958&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#comment4958&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This might be useful as a top-level class?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Igor&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-09-27 23:03:09, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-09-27 23:03:09)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/ConstantFoldableGenericUDF.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArray.java 1cf97c8 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFArrayContains.java d60dc86 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFIf.java 9a6a7ff &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFMap.java 3b71c48 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFMapKeys.java b384717 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13117017" author="jvs" created="Thu, 29 Sep 2011 05:50:11 +0000"  >&lt;p&gt;@Jonathan:  then maybe an annotation would be a lower-impact way to let the UDF declare?  And is there any case where the existing annotation for determinism wouldn&apos;t be good enough?&lt;/p&gt;</comment>
                            <comment id="13117600" author="jonchang" created="Thu, 29 Sep 2011 20:50:31 +0000"  >&lt;p&gt;Reflection is a good example (and is actually the motivation for this diff in the first place).  For example, if you have a function which evaluates an another function, say EVAL(&apos;NUMBER_ROWS&apos;), it won&apos;t be known until initialize time whether EVAL is deterministic.&lt;/p&gt;</comment>
                            <comment id="13117629" author="jvs" created="Thu, 29 Sep 2011 21:27:27 +0000"  >&lt;p&gt;I don&apos;t understand how reflection works with the existing annotation support for marking functions as deterministic.  Hive will always see the same annotation value for EVAL, regardless of what is annotated on NUMBER_ROWS, right?  Or is there another change coming along to address that?&lt;/p&gt;

&lt;p&gt;Also, since there are likely to only be very few special functions such as EVAL, wouldn&apos;t it be better to put the onus on them to declare themselves as needing special handling for the folding, and for the rest, always fold if marked as deterministic, otherwise never fold?&lt;/p&gt;</comment>
                            <comment id="13118141" author="ikabiljo" created="Fri, 30 Sep 2011 15:38:06 +0000"  >&lt;p&gt;I think, if the UdfType(deterministic=true):&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;returns constant OI, if all arguments are constant OI&lt;/li&gt;
	&lt;li&gt;handles both compile-time constant OIs and run-time passing of constant OIs&lt;br/&gt;
it can all work, if EVAL is not marked as deterministic, and has its own internal logic if it can return constant OI or not.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In any case, EVAL cannot be marked as deterministic and must have its own internal logic, since EVAL(&apos;RAND&apos;) receives all constant OIs, and doesn&apos;t return constant OI. On the other hand EVAL(&apos;ARRAY&apos;, 1, 2, 3) should return constant OI.&lt;/p&gt;

&lt;p&gt;Also, here &apos;deterministic&apos; and without &apos;side-effects&apos; is treated the same, but we can have function returning constant OI in runtime, that has side-effects - like JAVA_F. &lt;/p&gt;</comment>
                            <comment id="13118158" author="ikabiljo" created="Fri, 30 Sep 2011 16:06:00 +0000"  >&lt;p&gt;Also, is it intentional that you have to put UDFType annotation for function to be considered as deterministic, even though UDFType.deterministic has default value true?&lt;br/&gt;
If I see correctly, FunctionRegistry.isDeterministic only looks if given class has that annotation, and not if parent classes have it. UDFType annotation on GenericUDF is basically useless?&lt;/p&gt;</comment>
                            <comment id="13118165" author="ikabiljo" created="Fri, 30 Sep 2011 16:22:34 +0000"  >&lt;p&gt;Sorry, last comment is incorrect, disregard it. (other then that UDFType annotation on GenericUDF is unneeded)&lt;/p&gt;</comment>
                            <comment id="13118281" author="jonchang" created="Fri, 30 Sep 2011 18:55:59 +0000"  >&lt;p&gt;Oh, I remember why I did things like this.  It&apos;s because types are checked at parse time (when the ExprGenericFuncNodes are created initialize() is called).  Therefore we can&apos;t do this in the optimize step because UDFs which depend on a parameter being constant will fail if the constants in their children expressions haven&apos;t been folded by the time they get created.  This leaves two options.  The first is to modify the tree in place during the beast that is semantic analysis (I&apos;m ok with this if you are).  The other, which I went with, is to have the UDFs themselves do the folding during their initializations.&lt;/p&gt;</comment>
                            <comment id="13118282" author="jonchang" created="Fri, 30 Sep 2011 18:58:09 +0000"  >&lt;p&gt;If we go with the second, I can add the functionality to GenericUDF directly but this will involve either changing all the call sites of GenericUDF or all the UDFs both of which seem pretty risky.&lt;/p&gt;</comment>
                            <comment id="13118320" author="ikabiljo" created="Fri, 30 Sep 2011 19:36:41 +0000"  >&lt;p&gt;Is it enough to add that logic to:&lt;br/&gt;
ExprNodeGenericFuncEvaluator and ExprNodeGenericFuncDesc?&lt;/p&gt;

&lt;p&gt;Probably best via some foldable wrapper, and change only ExprNodeGenericFuncDesc constructor to store wrapped class if class is deterministic.&lt;/p&gt;

&lt;p&gt;Though I am not sure if that would be too hacky.&lt;/p&gt;</comment>
                            <comment id="13118328" author="jonchang" created="Fri, 30 Sep 2011 19:40:54 +0000"  >&lt;p&gt;True, I can add a hook in exprnodegenericfuncevaluator so that if the outputOI is a constantOI to skip evaluation.  @jvs, does that sound ok? (along with adding deterministic/stateful checks in genericfuncdesc)&lt;/p&gt;</comment>
                            <comment id="13118352" author="jvs" created="Fri, 30 Sep 2011 20:03:37 +0000"  >&lt;p&gt;Sounds good to me.&lt;/p&gt;</comment>
                            <comment id="13118370" author="ikabiljo" created="Fri, 30 Sep 2011 20:12:24 +0000"  >&lt;p&gt;If you create DeterministicGenericUDFWrapper, that basically has the same logic as your current ConstantFoldableGenericUDF class, you don&apos;t need to change anything in ExprNodeGenericFuncEvaluator (because it takes generic udf from ExprNodeGenericFuncDesc, which will be wrapped class if udf is deterministic)&lt;/p&gt;</comment>
                            <comment id="13118396" author="jonchang" created="Fri, 30 Sep 2011 20:26:13 +0000"  >&lt;p&gt;@Igor, how is that different  from what is currently being done?&lt;/p&gt;</comment>
                            <comment id="13118404" author="ikabiljo" created="Fri, 30 Sep 2011 20:30:05 +0000"  >&lt;p&gt;I mean, change the constructor of ExprNodeGenericFuncDesc to contain:&lt;/p&gt;

&lt;p&gt;if (FunctionRegistry.isDeterministic(genericUDF))&lt;br/&gt;
  this.genericUDF = new DeterministicGenericUDFWrapper(genericUDF);&lt;br/&gt;
else this.genericUDF = genericUDF;&lt;/p&gt;

&lt;p&gt;so everything works seamlessly from the outside, no need for changing any UDFs and their class hierarchy.&lt;/p&gt;</comment>
                            <comment id="13118407" author="jonchang" created="Fri, 30 Sep 2011 20:32:41 +0000"  >&lt;p&gt;Ah, interesting.  I like the simplicity of that.  You onboard with that jvs?&lt;/p&gt;</comment>
                            <comment id="13118422" author="jvs" created="Fri, 30 Sep 2011 20:44:17 +0000"  >&lt;p&gt;Some places currently using getGenericUDF() will need you to unwrap in order for the class comparison to keep working correctly, e.g. &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Utilities.supportedJDOFuncs&lt;/li&gt;
	&lt;li&gt;IndexPredicateAnalyzer.analyzeExpr&lt;/li&gt;
	&lt;li&gt;PartitionPruner.compactExpr&lt;/li&gt;
	&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13118425" author="jonchang" created="Fri, 30 Sep 2011 20:48:10 +0000"  >&lt;p&gt;This should be ok as long as the wrapper subclasses GenericUDF right?  I&apos;m not sure what the invariant is in these cases but adding an equals method should be safe.&lt;/p&gt;</comment>
                            <comment id="13118426" author="ikabiljo" created="Fri, 30 Sep 2011 20:48:42 +0000"  >&lt;p&gt;Hm, it might be better then to add a field to ExprNodeGenericFuncEvaluator and ExprNodeGenericFuncDesc, that will be wrappedGenericUDF (or executableGenericUDF), on which will initialize/evaluate be called, and all else continue to be called on genericUDF&lt;/p&gt;</comment>
                            <comment id="13119123" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 01:32:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-03 01:31:21.490736)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Take suggestions after discussion with ikabiljo and jvs.  Get rid of constantfoldablegenericudf in favor of just having both the exprnode evaluator and desc initialize /w constant folding and cache values for all non-stateful, deterministic generic udfs.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13119124" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 01:36:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-03 01:36:16.628780)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Get rid of some trailing whitespace.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13119195" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 08:32:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2259&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2259&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Nice, this is even better then what I thought.&lt;/p&gt;

&lt;p&gt;This now supports all OIs, except for struct and unions, right? No reason not to add structs, should we add both?&lt;br/&gt;
Also, should we change so that every VoidObjectInspector is constant (not sure if that would complicate things more, in which case - no)?&lt;/p&gt;

&lt;p&gt;I still think it would be preferable that constant OI guarantees that objects it returns are constant - if somebody changes returned value, next values it returns shouldn&apos;t be affected. But this doesn&apos;t matter that much.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Igor&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-03 01:36:16, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 01:36:16)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119439" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 17:57:34 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-10-03 08:31:46, Igor Kabiljo wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Nice, this is even better then what I thought.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; This now supports all OIs, except for struct and unions, right? No reason not to add structs, should we add both?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Also, should we change so that every VoidObjectInspector is constant (not sure if that would complicate things more, in which case - no)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; I still think it would be preferable that constant OI guarantees that objects it returns are constant - if somebody changes returned value, next values it returns shouldn&apos;t be affected. But this doesn&apos;t matter that much.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;ul&gt;
	&lt;li&gt;I agree that structs and unions would be good to have at some point but it turns out they are much harder to implement.  In particular, they contain references to constituent OIs and do not have natural Java/Writable equivalents.   Thus, the way the constant value should be stored is not obvious and you have weird interactions where some field OI maybe a constantOI but not the whole thing, etc.  This is complex enough that I think it&apos;s worth deferring to another diff&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I will convert void OI to be constant.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I&apos;m not sure that constant OI guarantee that its objects are constant; it might imply unnecessary copies and currently none of the rest of the UDF architecture functions this way (most things passed around are writable and it&apos;s up to consumers not to assume ownership).&lt;/li&gt;
&lt;/ul&gt;



&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2259&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2259&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-10-03 01:36:16, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 01:36:16)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119444" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 18:01:34 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-10-03 08:31:46, Igor Kabiljo wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Nice, this is even better then what I thought.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; This now supports all OIs, except for struct and unions, right? No reason not to add structs, should we add both?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Also, should we change so that every VoidObjectInspector is constant (not sure if that would complicate things more, in which case - no)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; I still think it would be preferable that constant OI guarantees that objects it returns are constant - if somebody changes returned value, next values it returns shouldn&apos;t be affected. But this doesn&apos;t matter that much.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Chang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;* I agree that structs and unions would be good to have at some point but it turns out they are much harder to implement.  In particular, they contain references to constituent OIs and do not have natural Java/Writable equivalents.   Thus, the way the constant value should be stored is not obvious and you have weird interactions where some field OI maybe a constantOI but not the whole thing, etc.  This is complex enough that I think it&apos;s worth deferring to another diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;* I will convert void OI to be constant.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;* I&apos;m not sure that constant OI guarantee that its objects are constant; it might imply unnecessary copies and currently none of the rest of the UDF architecture functions this way (most things passed around are writable and it&apos;s up to consumers not to assume ownership).&lt;/p&gt;&lt;/blockquote&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I didn&apos;t know it was like that (for structs and unions), I thought it was straightforward. so definitely for next diff, not this one&lt;/li&gt;
	&lt;li&gt;constant OI guarantee will not incur much overhead - since all those are executed only once - since they are constant. but I agree, the rest of architecture functions with that assumption, so it is better to be consistent (and later structs - Object[] - cannot be made constant)&lt;/li&gt;
&lt;/ul&gt;



&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Igor&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2259&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2259&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-10-03 01:36:16, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 01:36:16)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119478" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 18:35:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-03 18:35:09.336203)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Get rid of writableconstantvoidobjectinspector.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13119482" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 18:37:35 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2275&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;p&gt;looks good!!&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Igor&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-03 18:35:09, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 18:35:09)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119487" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 18:39:34 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-10-03 18:36:46, Igor Kabiljo wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; looks good!!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Um, @jvs, how do I shipit?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2275&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-10-03 18:35:09, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 18:35:09)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119559" author="jvs" created="Mon, 3 Oct 2011 20:11:34 +0000"  >&lt;p&gt;@Jonathan:  shipit from a non-committer is advisory only &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ll take a look at the latest patch today.&lt;/p&gt;</comment>
                            <comment id="13119733" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 23:22:35 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/#review2291&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#review2291&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2078/#comment5278&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#comment5278&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    typo:  implementation&lt;/p&gt;



&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2078/#comment5279&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/#comment5279&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    typo:  constant&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;John&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-03 18:35:09, Jonathan Chang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-03 18:35:09)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ant test&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13119740" author="jvs" created="Mon, 3 Oct 2011 23:24:42 +0000"  >&lt;p&gt;Looks good; I noted a couple of typos in the Javadoc.  If you give me an updated patch with those corrected, I&apos;ll run through test.&lt;/p&gt;

&lt;p&gt;But one question:  do you have any test that verifies that constant folding is actually taking place as expected?  EXPLAIN doesn&apos;t tell, so it would be good to have a regression test in place that fails if someone accidentally breaks the optimization.&lt;/p&gt;</comment>
                            <comment id="13119746" author="jonchang" created="Mon, 3 Oct 2011 23:32:03 +0000"  >&lt;p&gt;The .q file in the diff verifies this (if constants don&apos;t work, then the input to named struct will not be a constant and an exception will be thrown).&lt;/p&gt;</comment>
                            <comment id="13119769" author="jvs" created="Mon, 3 Oct 2011 23:47:19 +0000"  >&lt;p&gt;Oh right, good.&lt;/p&gt;</comment>
                            <comment id="13120321" author="jonchang" created="Tue, 4 Oct 2011 17:47:34 +0000"  >&lt;p&gt;Fix some typos in comments.&lt;/p&gt;</comment>
                            <comment id="13120322" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 17:47:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-04 17:46:49.734706)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix a couple of typos.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13120393" author="jvs" created="Tue, 4 Oct 2011 19:16:16 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13120395" author="jonchang" created="Tue, 4 Oct 2011 19:18:34 +0000"  >&lt;p&gt;Thanks.  Fingers crossed.&lt;/p&gt;

&lt;p&gt;P.S. Is there a way I can kick off these tests on the server next time so you don&apos;t have to?&lt;/p&gt;</comment>
                            <comment id="13120406" author="jvs" created="Tue, 4 Oct 2011 19:33:31 +0000"  >&lt;p&gt;You can run ant test on a dev box; it currently takes 4-5 hours though until we get the parallelization scripts cleaned up.&lt;/p&gt;

&lt;p&gt;But our current policy is that committers always run through tests unconditionally before commit; in the past, when some breakage has slipped into trunk, it has been a pain to get back to a clean state since people start to assume that any failure is a known failure (so more and more breakage trickles in).&lt;/p&gt;</comment>
                            <comment id="13120411" author="jonchang" created="Tue, 4 Oct 2011 19:36:30 +0000"  >&lt;p&gt;Got it. I thought there was some kind of continuous build/test dashboard somewhere to do the adequate yelling automatically.&lt;/p&gt;</comment>
                            <comment id="13120415" author="jvs" created="Tue, 4 Oct 2011 19:43:47 +0000"  >&lt;p&gt;Yes, there is a Jenkins instance, but it is currently only set up to test out what has been committed already.&lt;/p&gt;

&lt;p&gt;(We&apos;d like to do automatic pre-commit validation as well whenever a patch is submitted; not sure if Marek is going to have time for that one in his internship.)&lt;/p&gt;
</comment>
                            <comment id="13120605" author="jvs" created="Wed, 5 Oct 2011 00:25:26 +0000"  >&lt;p&gt;You did not cross your fingers hard enough.  I got the following test failures:&lt;/p&gt;

&lt;p&gt;explode_null&lt;br/&gt;
num_op_type_conv&lt;br/&gt;
str_to_map&lt;br/&gt;
timestamp_1..3&lt;br/&gt;
timestamp_comparison&lt;br/&gt;
udf6&lt;br/&gt;
udf_bitmap_empty&lt;br/&gt;
udf_coalesce&lt;br/&gt;
udf_elt&lt;br/&gt;
udf_hash&lt;br/&gt;
udf_if&lt;br/&gt;
udf_instr&lt;br/&gt;
udf_locate&lt;br/&gt;
udf_percentile&lt;br/&gt;
udf_when&lt;/p&gt;
</comment>
                            <comment id="13121540" author="jonchang" created="Wed, 5 Oct 2011 22:19:29 +0000"  >&lt;p&gt;Ok, fix on its way.  Note that I have to manually diff stuff because the junit command gives &lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; diff: &lt;a href=&quot;file:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:\&lt;/a&gt;|pfile:&amp;#124;hdfs:&amp;#124;/tmp/&amp;#124;invalidscheme:&amp;#124;lastUpdateTime&amp;#124;lastAccessTime&amp;#124;&lt;span class=&quot;error&quot;&gt;&amp;#91;Oo&amp;#93;&lt;/span&gt;wner&amp;#124;CreateTime&amp;#124;LastAccessTime&amp;#124;Location&amp;#124;LOCATION &apos;&amp;#124;transient_lastDdlTime&amp;#124;last_modified_&amp;#124;java.lang.RuntimeException&amp;#124;at org&amp;#124;at sun&amp;#124;at java&amp;#124;at junit&amp;#124;Caused by:&amp;#124;LOCK_QUERYID:&amp;#124;LOCK_TIME:&amp;#124;grantTime&amp;#124;&lt;span class=&quot;error&quot;&gt;&amp;#91;.&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;.&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;.&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0-9&amp;#93;&lt;/span&gt;* more&amp;#124;job_&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9&amp;#93;&lt;/span&gt;&lt;b&gt;_&lt;span class=&quot;error&quot;&gt;&amp;#91;0-9&amp;#93;&lt;/span&gt;&lt;/b&gt;&amp;#124;USING &apos;java -cp: Regular expression too big&lt;/p&gt;</comment>
                            <comment id="13121565" author="jonchang" created="Wed, 5 Oct 2011 22:50:13 +0000"  >&lt;p&gt;UDF_BITMAP_EMPTY seems broken.  Line 50 asserts that the length = 1, but line 70 asserts that length = 2.  Can you confirm?&lt;/p&gt;</comment>
                            <comment id="13121596" author="jiraposter@reviews.apache.org" created="Wed, 5 Oct 2011 23:32:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-05 23:32:22.234376)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fixes to make unittests pass:&lt;/p&gt;

&lt;p&gt;1.) The return resolver now always converts its input into a standard writable OI so that its output is not a constantoi.&lt;br/&gt;
2.) Fix spurious assert on EWAHBitmapEmpty.&lt;br/&gt;
3.) Add constant support for TIMESTAMP type.&lt;br/&gt;
4.) Make sure key/value/element OIs to ListOI/MapOI are writable.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFEWAHBitmapEmpty.java aa8d474 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java 832f823 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/str_to_map.q.out 30fa7ad &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantByteObjectInspector.java 5a7fe53 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantTimestampObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13121597" author="jonchang" created="Wed, 5 Oct 2011 23:32:41 +0000"  >&lt;p&gt;Fixes unittests.&lt;/p&gt;</comment>
                            <comment id="13122246" author="jvs" created="Thu, 6 Oct 2011 20:21:36 +0000"  >&lt;p&gt;Retesting with latest.&lt;/p&gt;</comment>
                            <comment id="13122288" author="jvs" created="Thu, 6 Oct 2011 20:57:28 +0000"  >&lt;p&gt;Oops, got a conflict trying to apply the patch against latest trunk since I committed &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2380&quot; title=&quot;Add Binary Datatype in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2380&quot;&gt;&lt;del&gt;HIVE-2380&lt;/del&gt;&lt;/a&gt;...can you rebase against trunk?&lt;/p&gt;</comment>
                            <comment id="13122308" author="jiraposter@reviews.apache.org" created="Thu, 6 Oct 2011 21:17:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-06 21:16:11.713258)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Rebased.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFEWAHBitmapEmpty.java aa8d474 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java 832f823 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/str_to_map.q.out 30fa7ad &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2c1a7e0 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java a37547f &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantByteObjectInspector.java 5a7fe53 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantTimestampObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13122418" author="jvs" created="Thu, 6 Oct 2011 23:41:43 +0000"  >&lt;p&gt;I tried &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.patch.7 from review board but still got conflicts.&lt;/p&gt;</comment>
                            <comment id="13122420" author="jonchang" created="Thu, 6 Oct 2011 23:44:10 +0000"  >&lt;p&gt;Won&apos;t review board throw an error if it doesn&apos;t apply cleanly?&lt;/p&gt;</comment>
                            <comment id="13122426" author="jvs" created="Thu, 6 Oct 2011 23:55:26 +0000"  >&lt;p&gt;Dunno.  There&apos;s only one failure:&lt;/p&gt;

&lt;p&gt;patching file serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java&lt;br/&gt;
Hunk #1 FAILED at 31.&lt;br/&gt;
Hunk #2 succeeded at 76 (offset 2 lines).&lt;br/&gt;
Hunk #3 succeeded at 865 (offset 9 lines).&lt;br/&gt;
1 out of 3 hunks FAILED &amp;#8211; saving rejects to file serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java.rej&lt;/p&gt;</comment>
                            <comment id="13122982" author="jiraposter@reviews.apache.org" created="Fri, 7 Oct 2011 17:38:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-07 17:36:59.604078)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Rebase for realsies.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeGenericFuncEvaluator.java ebc236d &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeGenericFuncDesc.java 7da5d6a &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java 570e408 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFEWAHBitmapEmpty.java aa8d474 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFUtils.java 832f823 &lt;br/&gt;
  ql/src/test/queries/clientpositive/constant_prop.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/constant_prop.q.out PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/str_to_map.q.out 30fa7ad &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorFactory.java a4689fb &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/ObjectInspectorUtils.java 2d45aba &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantListObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/StandardConstantMapObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/PrimitiveObjectInspectorFactory.java 5c8f42d &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantByteObjectInspector.java 5a7fe53 &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantTimestampObjectInspector.java PRE-CREATION &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableConstantVoidObjectInspector.java f3aee4e &lt;br/&gt;
  serde/src/java/org/apache/hadoop/hive/serde2/objectinspector/primitive/WritableVoidObjectInspector.java 6f99561 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                            <comment id="13124528" author="jvs" created="Mon, 10 Oct 2011 22:18:18 +0000"  >&lt;p&gt;OK, that one applied cleanly.  Kicking off tests now.  Can you attach the final patch here so I can commit it if they pass?&lt;/p&gt;</comment>
                            <comment id="13124531" author="jonchang" created="Mon, 10 Oct 2011 22:21:53 +0000"  >&lt;p&gt;Cleanly applies to trunk now.&lt;/p&gt;</comment>
                            <comment id="13124661" author="jvs" created="Tue, 11 Oct 2011 03:37:28 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Jonathan!&lt;/p&gt;</comment>
                            <comment id="13129218" author="jiraposter@reviews.apache.org" created="Mon, 17 Oct 2011 21:21:12 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2078/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-17 21:19:30.440767)&lt;/p&gt;


&lt;p&gt;Review request for hive, Carl Steinbach, John Sichi, and Igor Kabiljo.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Rebase!&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ConstantObjectInspectors were introduced in a previous patch so that UDF&apos;s could have access to constant values at initialize time.  This diff adds the following improvements:&lt;/p&gt;

&lt;p&gt;1.) Extends this functionality beyond primitive types to List/Map types.&lt;br/&gt;
2.) Fixes a bug in ExprNodeGenericFuncDesc where the constant value would not propagate beyond one level of evaluation.&lt;br/&gt;
3.) Adds a helper class to make functions constant-aware.  By inheriting from this class they return constant OIs if all their arguments are constant, and they cache the result so that computation is only done during initialize().  Some functions such as ARRAY/IF/MAP have been migrated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; title=&quot;Improve support for Constant Object Inspectors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2470&quot;&gt;&lt;del&gt;HIVE-2470&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2470&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/SimpleGenericUDAFParameterInfo.java 3277b98 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFPercentileApprox.java 678607b &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/AbstractGenericUDAFResolver.java 766e473 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFParameterInfo.java 04cfc28 &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1110cfa &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java cbbfffb &lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/optimizer/index/RewriteQueryUsingAggregateIndex.java c179d44 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2078/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2078/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;ant test&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12465154">HIVE-1360</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12496808" name="HIVE-1360.part2.patch" size="28368" author="jonchang" created="Tue, 27 Sep 2011 23:02:40 +0000"/>
                            <attachment id="12496809" name="HIVE-2470.patch" size="28368" author="jonchang" created="Tue, 27 Sep 2011 23:05:02 +0000"/>
                            <attachment id="12497419" name="HIVE-2470.patch.3" size="23105" author="jonchang" created="Mon, 3 Oct 2011 01:37:00 +0000"/>
                            <attachment id="12497508" name="HIVE-2470.patch.4" size="27240" author="jonchang" created="Mon, 3 Oct 2011 18:36:36 +0000"/>
                            <attachment id="12497669" name="HIVE-2470.patch.5" size="27243" author="jonchang" created="Tue, 4 Oct 2011 17:47:33 +0000"/>
                            <attachment id="12497922" name="HIVE-2470.patch.6" size="37682" author="jonchang" created="Wed, 5 Oct 2011 23:32:41 +0000"/>
                            <attachment id="12498479" name="HIVE-2470.patch.8" size="37682" author="jonchang" created="Mon, 10 Oct 2011 22:21:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Sep 2011 23:04:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34242</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123915</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2471] Add timestamp column to the partition stats table.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2471</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Occasionally, when entries are added to the partition stats table the program is halted before it can delete those entries, by an exception, keyboard interrupt, etc.  These build up to the point where the table gets very large, and it hurts the performance of the update statement which is often called.  In order to fix this, I am adding a column to the table which is auto-populated with the current timestamp.  This will allow us to create scripts that go through periodically and clean out old entries from the table.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524983">HIVE-2471</key>
            <summary>Add timestamp column to the partition stats table.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Sep 2011 23:30:03 +0000</created>
                <updated>Wed, 9 Jan 2013 10:23:22 +0000</updated>
                            <resolved>Tue, 20 Mar 2012 00:59:59 +0000</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13116018" author="jiraposter@reviews.apache.org" created="Tue, 27 Sep 2011 23:58:45 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2079/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2079/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added a timestamp column ts to the partition statistics table which defaults to the current_timestamp.  I also added code to create an index on that column, and verify that index exists when we check if the table exists.&lt;/p&gt;

&lt;p&gt;I also took the opportunity to fix another problem.  Every time we change the schema of the partition statistics table we give it a slightly different name, like PARTITION_STATS, PARITION_STATISTICS, PARTITION_STAT_TBL, etc.  Instead, I want to put a number at the end of the table name, here I have PARTITION_STATS_V2, instead of trying to come up on a new variation of name, we can just increment the final number, this will also make it easy to identify old tables which can be dropped.&lt;/p&gt;

&lt;p&gt;Checking whether the index exists may not be worth the time it takes.  We have to check this every time we init JDBCStatsPublisher, unless the table doesn&apos;t exist, and if it doesn&apos;t exist, it&apos;s not the end of the world, it just means any scripts which try to use the index will be slower, and the index can always be added later.  Also, the chance the program creates the table, but is interrupted before it can create the index is low.  I added the check because I thought the chance of having to try and find the reason why Hive slowed down, and having to find that a clean up script is running slow, and hence holding the locks for a long time, sounded painful, and hence the check would be worth it, but I am open to debate.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2471&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsPublisher.java 1175957 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java 1175957 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java 1175957 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2079/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2079/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran TestStatsPublisherEnhanced using both derby and MySQL, and verified all the tests succeeded.&lt;/p&gt;

&lt;p&gt;I also ran a few queries and verified that the table and index were created and that the rows, including timestamp, appeared in the table.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13231479" author="kevinwilfong" created="Fri, 16 Mar 2012 18:21:11 +0000"  >&lt;p&gt;Given the issues we have seen in the past with indexes on this table, I have decided not to add an index on the timestamp column.&lt;/p&gt;</comment>
                            <comment id="13231480" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 18:21:36 +0000"  >&lt;p&gt;kevinwilfong requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2471&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Added a timestamp column to the stats table.  It defaults to the current timestamp on inserts.  I also updated the update query to update the timestamp, since derby does not support the on update option as far as I can tell.&lt;/p&gt;

&lt;p&gt;  I modified the insert query to specify the columns it&apos;s inserting to.  This is not only necessary to prevent the query from inserting into the timestamp column, it is safer in general.&lt;/p&gt;

&lt;p&gt;  Occasionally, when entries are added to the partition stats table the program is halted before it can delete those entries, by an exception, keyboard interrupt, etc.  These build up to the point where the table gets very large, and it hurts the performance of the update statement which is often called.  In order to fix this, I am adding a column to the table which is auto-populated with the current timestamp.  I am also adding an index on this column.  This will allow us to create scripts that go through periodically and clean out old entries from the table.  The index will help to keep the runtime of these scripts short, and hence reduce the amount of time they need to lock the table/indexes for.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/5253/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/5253/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13231524" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 19:03:35 +0000"  >&lt;p&gt;kevinwilfong updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;br/&gt;
Reviewers: JIRA, njain&lt;/p&gt;

&lt;p&gt;  Changed the name of the stats table so that this update will apply automatically and immediately, otherwise the update command will fail on old schemas.  Also introduced versioning to the name while I think is better than the old method of coming up with a new combination of (PARTITION, PART) and (STATISTICS, STATS).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java&lt;/p&gt;</comment>
                            <comment id="13231603" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 20:39:36 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java:26 Write a big comment here that it is the users responsibility&lt;br/&gt;
  to delete the old table&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java:128 I am not sure this will work -&lt;br/&gt;
  I am assuming this is invoked by StatsAggregator, but the data is&lt;br/&gt;
  inserted by StatsPublisher.&lt;/p&gt;

&lt;p&gt;  The timestamp will be different in the 2 places&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13231621" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 20:57:36 +0000"  >&lt;p&gt;kevinwilfong has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java:26 Will do&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java:128 This is invoked by the StatsPublisher, it is used for the case where a row was not deleted by a previous StatsPublisher, otherwise there is a conflict between the primary keys.&lt;/p&gt;

&lt;p&gt;  The StatsAggregator only invokes SELECT and DELETE statements.  The aggregated stats are added to the metastore via a call to the metastore&apos;s alter_table method.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13231631" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 21:09:37 +0000"  >&lt;p&gt;kevinwilfong updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;br/&gt;
Reviewers: JIRA, njain&lt;/p&gt;

&lt;p&gt;  Added a big comment saying it is up to the Hive administrator to drop old partition stats tables.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java&lt;/p&gt;</comment>
                            <comment id="13231643" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 21:23:36 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java:128 Let us discuss offline - I am not sure I understood&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13232764" author="phabricator@reviews.facebook.net" created="Mon, 19 Mar 2012 17:47:35 +0000"  >&lt;p&gt;njain has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Add timestamp column with index to the partition stats table.&quot;.&lt;/p&gt;

&lt;p&gt;  Running tests&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  svn&lt;/p&gt;</comment>
                            <comment id="13233074" author="namit" created="Tue, 20 Mar 2012 00:59:59 +0000"  >&lt;p&gt;Committed. Thanks Kevin&lt;/p&gt;</comment>
                            <comment id="13233258" author="hudson" created="Tue, 20 Mar 2012 06:38:42 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1322 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1322/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1322/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; Add timestamp column to the partition stats table.&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1302739)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1302739&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1302739&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13265315" author="ashutoshc" created="Mon, 30 Apr 2012 21:11:40 +0000"  >&lt;p&gt;This issue is closed now. It was released with the fix in 0.9.0. If there is a problem, please open a new jira and link this one with that.&lt;/p&gt;</comment>
                            <comment id="13547866" author="hudson" created="Wed, 9 Jan 2013 10:23:22 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2471&quot; title=&quot;Add timestamp column to the partition stats table.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2471&quot;&gt;&lt;del&gt;HIVE-2471&lt;/del&gt;&lt;/a&gt; Add timestamp column to the partition stats table.&lt;br/&gt;
(Kevin Wilfong via namit) (Revision 1302739)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1302739&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1302739&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsSetupConstants.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/stats/jdbc/JDBCStatsUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12518716" name="ASF.LICENSE.NOT.GRANTED--HIVE-2471.D2367.1.patch" size="3034" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 18:21:37 +0000"/>
                            <attachment id="12518722" name="ASF.LICENSE.NOT.GRANTED--HIVE-2471.D2367.2.patch" size="3111" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 19:03:36 +0000"/>
                            <attachment id="12518736" name="ASF.LICENSE.NOT.GRANTED--HIVE-2471.D2367.3.patch" size="3250" author="phabricator@reviews.facebook.net" created="Fri, 16 Mar 2012 21:09:38 +0000"/>
                            <attachment id="12496816" name="HIVE-2471.1.patch.txt" size="4353" author="kevinwilfong" created="Tue, 27 Sep 2011 23:59:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Sep 2011 23:58:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34247</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
