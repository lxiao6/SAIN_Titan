<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:19:08 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2011-9-28+AND+created+%3C%3D+2011-10-5+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="12" total="12"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-2472] Metastore statistics are not being updated for CTAS queries.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2472</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We need to add a Statistics task at the end of a CTAS query in order to update the metastore statistics for the table being created.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525237">HIVE-2472</key>
            <summary>Metastore statistics are not being updated for CTAS queries.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsurowka">Robert Sur&#243;wka</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Sep 2011 20:24:03 +0000</created>
                <updated>Thu, 2 Feb 2012 22:09:31 +0000</updated>
                            <resolved>Fri, 11 Nov 2011 06:13:27 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Statistics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13117643" author="jiraposter@reviews.apache.org" created="Thu, 29 Sep 2011 21:49:45 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2120/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2120/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Yongqiang He and Ning Zhang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;(This is not needed for RC-2)&lt;/p&gt;

&lt;p&gt;I modified StatsTask so that it could be created from a CTAS query.&lt;/p&gt;

&lt;p&gt;The StatsTask is created where StatsTask are typically created, but instead of being appended to the final MoveTask it is stored in the QB.  This is because the SemanticAnalyzer appends the task to create the table to the task tree in order to ensure atomicity.  The StatsTask requires that the table already be created, by putting it in the QB, the SemanticAnalyzer is able to access it and append to it to the create table task.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1177363 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1177363 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/QB.java 1177363 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1177363 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1177363 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1177363 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1177363 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1177363 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1177363 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2120/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2120/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran a CTAS query and verified the stats appeared in the console at the end of the query, and that they were stored in the table&apos;s metadata.&lt;/p&gt;

&lt;p&gt;I ran the unit test queries, and updated the output of the ones which use CTAS queries&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13143477" author="jiraposter@reviews.apache.org" created="Thu, 3 Nov 2011 19:47:32 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-03 19:46:23.842574)&lt;/p&gt;


&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Now table stats will be collected for CTAS queries.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/database.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1196269 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Robert&lt;/p&gt;
</comment>
                            <comment id="13143478" author="rsurowka" created="Thu, 3 Nov 2011 19:48:12 +0000"  >&lt;p&gt;The diff for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.2.patch can be found at &lt;a href=&quot;https://reviews.apache.org/r/2583/diff/#index_header&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff/#index_header&lt;/a&gt; (last version). &lt;/p&gt;</comment>
                            <comment id="13143483" author="jiraposter@reviews.apache.org" created="Thu, 3 Nov 2011 19:51:33 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-03 19:50:15.818785)&lt;/p&gt;


&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;


&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;

&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;

&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;

&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;

&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;

&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;


&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/database.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1196269 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Robert&lt;/p&gt;
</comment>
                            <comment id="13143494" author="jiraposter@reviews.apache.org" created="Thu, 3 Nov 2011 20:05:32 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-03 20:05:20.364390)&lt;/p&gt;


&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;In version 3 there was a missclick mistake I made in eclipse (after the out files were already generated, but before I diffed the patch). It is corrected now, please ignore 3rd version, and when looking for changes compare version 4 with version 2. &lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;


&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;

&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;

&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;

&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;

&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;

&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;


&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1196269 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/database.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1196269 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1196269 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Robert&lt;/p&gt;
</comment>
                            <comment id="13145886" author="jiraposter@reviews.apache.org" created="Mon, 7 Nov 2011 22:26:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/#review3089&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#review3089&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6894&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6894&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    why do we need to check partitions.size() == 0? Isn&apos;t it the case that when a partitioned table first created and there is no partitions yet, it will satisfy this condition? &lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6895&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6895&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    code style nitpick: space between &apos;if&apos; and &apos;(&apos; &lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6896&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6896&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Here I think the plan should be stage-3 (StatsTask) depends on stage-4 (DDLTask), which depends on stage-0 (MoveTask).&lt;/p&gt;

&lt;p&gt;    Also can you change the .q file to add describe formatted &amp;lt;created_table&amp;gt; to verify that the stats are gathered for the newly created table after CTAS?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6897&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6897&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Same here. &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ning&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-11-03 20:05:20, Robert Sur&#243;wka wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-03 20:05:20)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Robert&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13146052" author="jiraposter@reviews.apache.org" created="Tue, 8 Nov 2011 02:54:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-07 22:24:59, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually after CTAS the partitions collection wasn&apos;t null, whereas it was just empty (I also commented on it near the end of the diff description). I will do all other changes requested ASAP, thank you. &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Robert&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/#review3089&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#review3089&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-03 20:05:20, Robert Sur&#243;wka wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-03 20:05:20)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1196269 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Robert&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13146069" author="jiraposter@reviews.apache.org" created="Tue, 8 Nov 2011 04:10:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-08 04:08:52.506156)&lt;/p&gt;


&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I implemented all the change requests (hopefully), with one exception that I already commented about.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;


&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;

&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;

&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;

&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;

&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;

&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;


&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1199067 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1199067 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/ctas.q 1199067 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1199067 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/database.q.out 1199067 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1199067 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1199067 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1199067 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Robert&lt;/p&gt;
</comment>
                            <comment id="13146438" author="jiraposter@reviews.apache.org" created="Tue, 8 Nov 2011 17:59:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-07 22:24:59, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/test/results/clientpositive/ctas.q.out, line 25&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/diff/4/?file=56200#file56200line25&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff/4/?file=56200#file56200line25&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Here I think the plan should be stage-3 (StatsTask) depends on stage-4 (DDLTask), which depends on stage-0 (MoveTask).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also can you change the .q file to add describe formatted &amp;lt;created_table&amp;gt; to verify that the stats are gathered for the newly created table after CTAS?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Change to amend this was done in Semantic Analyzer around line 7050&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Robert&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/#review3089&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#review3089&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-08 04:08:52, Robert Sur&#243;wka wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-08 04:08:52)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/ctas.q 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Robert&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13147520" author="jiraposter@reviews.apache.org" created="Thu, 10 Nov 2011 06:53:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/#review3124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#review3124&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6939&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6939&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    style nitpick: removing tab.&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6959&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6959&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    here, rather than checkin partitions.size()==0, I think it&apos;s better to change getPartitionList() to return null when it is CTAS (i.e., getLoadFileDesc() != null). &lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6958&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6958&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I suspect this is caused by the change in SemanticAnalyzer.java around line 7906. Can you test if this is caused by that change? If so you&apos;ll need to resolve this rather than updating the .out file. &lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6960&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6960&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    here stage-2 should only depends on stage-6.&lt;/p&gt;

&lt;p&gt;    also please add &apos;desc formatted &amp;lt;tbl&amp;gt;&apos; to verify the stats are correct.&lt;/p&gt;



&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/#comment6961&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#comment6961&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    same: stage-2 should only depends on stage-4.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ning&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-11-08 04:08:52, Robert Sur&#243;wka wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-08 04:08:52)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/ctas.q 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Robert&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13147894" author="jiraposter@reviews.apache.org" created="Thu, 10 Nov 2011 18:30:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-10 06:52:08, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This code is not a part of this patch!&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-10 06:52:08, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/test/results/clientpositive/database.q.out, line 1224&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/diff/5/?file=56835#file56835line1224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff/5/?file=56835#file56835line1224&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I suspect this is caused by the change in SemanticAnalyzer.java around line 7906. Can you test if this is caused by that change? If so you&apos;ll need to resolve this rather than updating the .out file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I strongly doubt it, as no other code in Hive except the one I added myself, knows that db name is being stored there. Yet I will check it. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-11-10 06:52:08, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/test/results/clientpositive/merge3.q.out, line 60&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2583/diff/5/?file=56836#file56836line60&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff/5/?file=56836#file56836line60&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     here stage-2 should only depends on stage-6.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     also please add &apos;desc formatted &amp;lt;tbl&amp;gt;&apos; to verify the stats are correct.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I will investigate this in the following one, it is actually quite strange (possibly generating out file failed), thank you. &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Robert&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/#review3124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/#review3124&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-08 04:08:52, Robert Sur&#243;wka wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-08 04:08:52)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/ctas.q 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/ctas.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/database.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/merge3.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1199067 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Robert&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13148112" author="jiraposter@reviews.apache.org" created="Thu, 10 Nov 2011 23:35:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-10 23:34:41.924906)&lt;/p&gt;


&lt;p&gt;Review request for Ning Zhang and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Hopefully all the earlier mentioned problems have been amended. Actually there was a bug in my code that caused &quot;Cannot get table db1.db1.conflict_name&quot; to happen, it&apos;s solved by change in LoadFileDesc.java around line 45.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Explanation of how stats for CTAS were added (line numbers may be slightly off due to repository changes):&lt;/p&gt;


&lt;p&gt;Because CTAS contains an INSERT, the approach was to reuse as much, from what is already there for INSERT, as possible.&lt;/p&gt;

&lt;p&gt;There were 2 main issues: to make sure that FileSinkOperators will gather stats, and that there will be StatsTask that will then aggregate them and store to Metastore.&lt;/p&gt;

&lt;p&gt;FileSinkOperator gathers stats if conf.isGatherStats (line 576) is true. It is set to true upon adding StatsTask in GenMRFileSink1 (126) which will happen if isInsertTable will be true, which is set in 105 (I didn&apos;t change comment since it is still being set due to INSERT OVERWRITE that is just a part of the CTAS). To make it true, one must set that CTAS contains insert into the table, add the TableSpec, which was done in SemanticAnalyzer (1051) (BaseSemanticAnalyzer tableSpec() must had been changed to support TOK_CREATETABLE). &lt;/p&gt;

&lt;p&gt;Next issue, was to supply to StatsWork (part of StatsTask) information about the table being created. To do that, database name was added to CreateTableDesc, and it is set in SemanticAnalyzer (7878). Then this CreateTableDesc is added to LoadFileDesc (just to get table info) in SemanticAnalyzer(4000), which then is added to StatsWork in GenMRFileFileSink1 (170). This StatskWork is later used by StatsTask to get the table info.&lt;/p&gt;

&lt;p&gt;Another thing was that StatsTask would be called before the CreateTableTask. To remedy that, a change in SemanticAnalyzer(7048) was made, so for CTAS the StatsTask will be moved to be after the crtTblTask.&lt;/p&gt;

&lt;p&gt;Finally in StatsTask, support for the LoadFileDesc was added (which is present for CTAS). Importantly, line 306 was changed, since for CTAS there was an empty partitionList, instead of null (this last change took me around 3 hours to find, since this was last place I looked at, when figuring what&apos;s wrong).&lt;/p&gt;


&lt;p&gt;I noticed that to database.q.out &quot;Cannot get table db1.db1.conflict_name&quot; in line 1224 was added, but it wasn&apos;t present there in previous diff version that contained exactly same Java code, so I assume it is due to some other work happening concurrently.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2472&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java 1200588 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java 1200588 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/ctas.q 1200588 &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/merge3.q 1200588 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/ctas.q.out 1200588 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/database.q.out 1200588 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/merge3.q.out 1200588 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out 1200588 &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out 1200588 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2583/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2583/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;run ant tests with overwrite option, changes to out files are part of the diff&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Robert&lt;/p&gt;
</comment>
                            <comment id="13148128" author="nzhang" created="Thu, 10 Nov 2011 23:59:56 +0000"  >&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="13148287" author="nzhang" created="Fri, 11 Nov 2011 06:13:27 +0000"  >&lt;p&gt;Committed. Thanks Robert and Kevin!&lt;/p&gt;</comment>
                            <comment id="13148421" author="hudson" created="Fri, 11 Nov 2011 11:01:45 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1076 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1076/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1076/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2472&quot; title=&quot;Metastore statistics are not being updated for CTAS queries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2472&quot;&gt;&lt;del&gt;HIVE-2472&lt;/del&gt;&lt;/a&gt;. Metastore statistics are not being updated for CTAS queries. (Robert Surowka via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1200744&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1200744&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/StatsTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/CreateTableDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/LoadFileDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/StatsWork.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ctas.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/merge3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ctas.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/database.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/merge3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/rcfile_createas1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/smb_mapjoin9.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12407019">HIVE-33</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12497066" name="HIVE-2472.1.patch.txt" size="78889" author="kevinwilfong" created="Thu, 29 Sep 2011 21:48:17 +0000"/>
                            <attachment id="12502208" name="HIVE-2472.2.patch" size="98197" author="rsurowka" created="Thu, 3 Nov 2011 19:45:33 +0000"/>
                            <attachment id="12502211" name="HIVE-2472.3.patch" size="97281" author="rsurowka" created="Thu, 3 Nov 2011 20:06:25 +0000"/>
                            <attachment id="12502879" name="HIVE-2472.4.patch" size="114245" author="rsurowka" created="Tue, 8 Nov 2011 04:09:48 +0000"/>
                            <attachment id="12503305" name="HIVE-2472.5.patch" size="117002" author="rsurowka" created="Thu, 10 Nov 2011 23:35:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Sep 2011 21:49:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00x4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2473] Hive throws an NPE when $HADOOP_HOME points to a tarball install directory that contains a build/ subdirectory.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2473</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment>&lt;p&gt;hadoop-0.20.204.0&lt;/p&gt;</environment>
        <key id="12525383">HIVE-2473</key>
            <summary>Hive throws an NPE when $HADOOP_HOME points to a tarball install directory that contains a build/ subdirectory.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Sat, 1 Oct 2011 00:20:07 +0000</created>
                <updated>Tue, 15 Oct 2013 23:29:13 +0000</updated>
                            <resolved>Fri, 26 Jul 2013 15:39:52 +0000</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13118596" author="cwsteinbach" created="Sat, 1 Oct 2011 00:24:06 +0000"  >&lt;p&gt;Steps to reproduce:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;% tar -xvzf hadoop-0.20.204.0.tar.gz 
% cd hadoop-0.20.204.0.tar.gz
% ant
% export HADOOP_HOME=`pwd`
% export PATH=$HADOOP_HOME/bin:$PATH
% cd ..
% hive -e &apos;show tables&apos; -hiveconf hive.root.logger=INFO,console
WARNING: org.apache.hadoop.metrics.jvm.EventCounter is deprecated. Please use org.apache.hadoop.log.metrics.EventCounter in all the log4j.properties files.
Logging initialized using configuration in jar:file:/home/carl/Work/repos/hive2/build/dist/lib/hive-common-0.9.0-SNAPSHOT.jar!/hive-log4j.properties
11/09/30 17:21:09 INFO SessionState: Logging initialized using configuration in jar:file:/home/carl/Work/repos/hive2/build/dist/lib/hive-common-0.9.0-SNAPSHOT.jar!/hive-log4j.properties
Hive history file=/tmp/carl/hive_job_log_carl_201109301721_961941092.txt
11/09/30 17:21:09 INFO exec.HiveHistory: Hive history file=/tmp/carl/hive_job_log_carl_201109301721_961941092.txt
show tables;
11/09/30 17:21:12 INFO ql.Driver: &amp;lt;PERFLOG method=compile&amp;gt;
11/09/30 17:21:12 INFO parse.ParseDriver: Parsing command: show tables
11/09/30 17:21:12 INFO parse.ParseDriver: Parse Completed
11/09/30 17:21:12 INFO ql.Driver: Semantic Analysis Completed
11/09/30 17:21:12 INFO ql.Driver: Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:tab_name, type:string, comment:from deserializer)], properties:null)
11/09/30 17:21:12 INFO ql.Driver: &amp;lt;/PERFLOG method=compile start=1317428472621 end=1317428472868 duration=247&amp;gt;
11/09/30 17:21:12 INFO ql.Driver: &amp;lt;PERFLOG method=Driver.execute&amp;gt;
11/09/30 17:21:12 INFO ql.Driver: Starting command: show tables
11/09/30 17:21:12 INFO metastore.HiveMetaStore: 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore
11/09/30 17:21:12 INFO metastore.ObjectStore: ObjectStore, initialize called
11/09/30 17:21:13 ERROR metastore.HiveMetaStore: JDO datastore error. Retrying metastore command after 1000 ms (attempt 1 of 1)
11/09/30 17:21:14 INFO metastore.HiveMetaStore: 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore
11/09/30 17:21:14 INFO metastore.ObjectStore: ObjectStore, initialize called
FAILED: Error in metadata: javax.jdo.JDOFatalInternalException: Unexpected exception caught.
NestedThrowables:
java.lang.reflect.InvocationTargetException
11/09/30 17:21:14 ERROR exec.Task: FAILED: Error in metadata: javax.jdo.JDOFatalInternalException: Unexpected exception caught.
NestedThrowables:
java.lang.reflect.InvocationTargetException
org.apache.hadoop.hive.ql.metadata.HiveException: javax.jdo.JDOFatalInternalException: Unexpected exception caught.
NestedThrowables:
java.lang.reflect.InvocationTargetException
	at org.apache.hadoop.hive.ql.metadata.Hive.getDatabase(Hive.java:1045)
	at org.apache.hadoop.hive.ql.metadata.Hive.databaseExists(Hive.java:1030)
	at org.apache.hadoop.hive.ql.exec.DDLTask.showTables(DDLTask.java:1825)
	at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:299)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:132)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1327)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1118)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:926)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:253)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:210)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:401)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:669)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:552)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:156)
Caused by: javax.jdo.JDOFatalInternalException: Unexpected exception caught.
NestedThrowables:
java.lang.reflect.InvocationTargetException
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1186)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:803)
	at javax.jdo.JDOHelper.getPersistenceManagerFactory(JDOHelper.java:698)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPMF(ObjectStore.java:246)
	at org.apache.hadoop.hive.metastore.ObjectStore.getPersistenceManager(ObjectStore.java:275)
	at org.apache.hadoop.hive.metastore.ObjectStore.initialize(ObjectStore.java:208)
	at org.apache.hadoop.hive.metastore.ObjectStore.setConf(ObjectStore.java:183)
	at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:62)
	at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.java:396)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.executeWithRetry(HiveMetaStore.java:348)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.java:493)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.java:261)
	at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.&amp;lt;init&amp;gt;(HiveMetaStore.java:224)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.&amp;lt;init&amp;gt;(HiveMetaStoreClient.java:109)
	at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.java:2027)
	at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.java:2037)
	at org.apache.hadoop.hive.ql.metadata.Hive.getDatabase(Hive.java:1041)
	... 18 more
Caused by: java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at javax.jdo.JDOHelper$16.run(JDOHelper.java:1958)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.jdo.JDOHelper.invoke(JDOHelper.java:1953)
	at javax.jdo.JDOHelper.invokeGetPersistenceManagerFactoryOnImplementation(JDOHelper.java:1159)
	... 35 more
Caused by: java.lang.NullPointerException
	at org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:443)
	at org.datanucleus.plugin.NonManagedPluginRegistry.registerBundle(NonManagedPluginRegistry.java:355)
	at org.datanucleus.plugin.NonManagedPluginRegistry.registerExtensions(NonManagedPluginRegistry.java:215)
	at org.datanucleus.plugin.NonManagedPluginRegistry.registerExtensionPoints(NonManagedPluginRegistry.java:156)
	at org.datanucleus.plugin.PluginManager.registerExtensionPoints(PluginManager.java:82)
	at org.datanucleus.OMFContext.&amp;lt;init&amp;gt;(OMFContext.java:156)
	at org.datanucleus.OMFContext.&amp;lt;init&amp;gt;(OMFContext.java:137)
	at org.datanucleus.ObjectManagerFactoryImpl.initialiseOMFContext(ObjectManagerFactoryImpl.java:132)
	at org.datanucleus.jdo.JDOPersistenceManagerFactory.initialiseProperties(JDOPersistenceManagerFactory.java:363)
	at org.datanucleus.jdo.JDOPersistenceManagerFactory.&amp;lt;init&amp;gt;(JDOPersistenceManagerFactory.java:307)
	at org.datanucleus.jdo.JDOPersistenceManagerFactory.createPersistenceManagerFactory(JDOPersistenceManagerFactory.java:255)
	at org.datanucleus.jdo.JDOPersistenceManagerFactory.getPersistenceManagerFactory(JDOPersistenceManagerFactory.java:182)
	... 43 more

FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
11/09/30 17:21:14 ERROR ql.Driver: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
11/09/30 17:21:14 INFO ql.Driver: &amp;lt;/PERFLOG method=Driver.execute start=1317428472868 end=1317428474321 duration=1453&amp;gt;
11/09/30 17:21:14 INFO ql.Driver: &amp;lt;PERFLOG method=releaseLocks&amp;gt;
11/09/30 17:21:14 INFO ql.Driver: &amp;lt;/PERFLOG method=releaseLocks start=1317428474321 end=1317428474321 duration=0&amp;gt;
hive&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13118598" author="cwsteinbach" created="Sat, 1 Oct 2011 00:29:54 +0000"  >&lt;p&gt;Workaround: either remove the $HADOOP_HOME/build directory (which was created when ant was run), or else set $HADOOP_HOME to point to the build subdirectory.&lt;/p&gt;

&lt;p&gt;Cause: The root cause of the bug is that the aspectjtools-1.6.5.jar appears twice on the CLASSPATH when the build subdirectory is present, and when this happens DataNucleus throws an NPE.&lt;/p&gt;</comment>
                            <comment id="13133097" author="benoyantony" created="Fri, 21 Oct 2011 21:48:02 +0000"  >&lt;p&gt;The issue is more pronounced when trying to use Hive 0.7 with Hadoop 0.22. Hadoop 0.22 has aspectj in the libs of common, hdfs and mapreduce. All the jars in these 3 libs are included in Hive&apos;s classpath. So the aspectj*.jar appears thrice in the Hive&apos;s classpath and hive throws the above exception.&lt;/p&gt;</comment>
                            <comment id="13258620" author="cwsteinbach" created="Fri, 20 Apr 2012 22:02:30 +0000"  >&lt;p&gt;It looks like the underlying bug has been resolved in DN 3.0.0: &lt;a href=&quot;http://www.datanucleus.org/servlet/jira/browse/NUCCORE-689&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.datanucleus.org/servlet/jira/browse/NUCCORE-689&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13720893" author="ashutoshc" created="Fri, 26 Jul 2013 15:39:52 +0000"  >&lt;p&gt;This should have been fixed via &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3632&quot; title=&quot;Upgrade datanucleus to support JDK7&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3632&quot;&gt;&lt;del&gt;HIVE-3632&lt;/del&gt;&lt;/a&gt; If you can still reproduce, feel free to reopen.&lt;/p&gt;</comment>
                            <comment id="13795856" author="ashutoshc" created="Tue, 15 Oct 2013 23:29:13 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12502784">HIVE-2084</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 21 Oct 2011 21:48:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41747</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0jy2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2474] Hive PDK needs an Ivy configuration file</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2474</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12525469">HIVE-2474</key>
            <summary>Hive PDK needs an Ivy configuration file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Sun, 2 Oct 2011 07:17:49 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:56 +0000</updated>
                            <resolved>Mon, 3 Oct 2011 18:43:06 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Build Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13118977" author="jiraposter@reviews.apache.org" created="Sun, 2 Oct 2011 07:22:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2142/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2142/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Review for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2474&quot; title=&quot;Hive PDK needs an Ivy configuration file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2474&quot;&gt;&lt;del&gt;HIVE-2474&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2474&quot; title=&quot;Hive PDK needs an Ivy configuration file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2474&quot;&gt;&lt;del&gt;HIVE-2474&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2474&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  pdk/ivy.xml PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2142/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2142/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13119489" author="jvs" created="Mon, 3 Oct 2011 18:43:06 +0000"  >&lt;p&gt;Committed to 0.8 and trunk.  Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13119495" author="jvs" created="Mon, 3 Oct 2011 18:49:18 +0000"  >&lt;p&gt;Also, +1.&lt;/p&gt;</comment>
                            <comment id="13119786" author="hudson" created="Tue, 4 Oct 2011 00:13:58 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #988 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/988/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/988/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2474&quot; title=&quot;Hive PDK needs an Ivy configuration file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2474&quot;&gt;&lt;del&gt;HIVE-2474&lt;/del&gt;&lt;/a&gt;. Hive PDK needs an Ivy configuration file&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178514&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178514&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/pdk/ivy.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13119861" author="hudson" created="Tue, 4 Oct 2011 01:39:08 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #43 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/43/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/43/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2474&quot; title=&quot;Hive PDK needs an Ivy configuration file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2474&quot;&gt;&lt;del&gt;HIVE-2474&lt;/del&gt;&lt;/a&gt;. Hive PDK needs an Ivy configuration file&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178515&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178515&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/ivy.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497394" name="HIVE-2474.1.patch.txt" size="1479" author="cwsteinbach" created="Sun, 2 Oct 2011 07:20:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 2 Oct 2011 07:22:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43136</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123917</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2475] Allow UDAFs to short-circuit</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2475</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Imagine a udaf called ALL, which returns true when ALL of the entries in the column are true. Then, this UDAF can return false for the group as soon as any item seen is false. The Hive UDF framework should provide a manner by which a UDAF can &quot;short-circuit&quot; further evaluation and thus systematically ignore the rest of the rows that will be pushed in.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525549">HIVE-2475</key>
            <summary>Allow UDAFs to short-circuit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="akramer">Adam Kramer</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Oct 2011 17:16:05 +0000</created>
                <updated>Mon, 3 Oct 2011 17:16:05 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08p27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2476] Update project description and wiki link in ivy.xml files</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2476</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Needs to be done for all subdirs; they currently have&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        Hive is a data warehouse infrastructure built on top of Hadoop see
        http://wiki.apache.org/hadoop/Hive
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2435&quot; title=&quot;Update project naming and description in Hive wiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2435&quot;&gt;&lt;del&gt;HIVE-2435&lt;/del&gt;&lt;/a&gt; for updated description.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525562">HIVE-2476</key>
            <summary>Update project description and wiki link in ivy.xml files</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12522320">HIVE-2432</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashutoshc">Ashutosh Chauhan</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Oct 2011 18:37:57 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:05 +0000</updated>
                            <resolved>Thu, 20 Oct 2011 21:47:57 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13130444" author="ashutoshc" created="Wed, 19 Oct 2011 08:05:27 +0000"  >&lt;p&gt;Patch to update */ivy.xml files as noted above.&lt;/p&gt;</comment>
                            <comment id="13132040" author="jvs" created="Thu, 20 Oct 2011 21:10:16 +0000"  >&lt;p&gt;Oops when I pasted into &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2435&quot; title=&quot;Update project naming and description in Hive wiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2435&quot;&gt;&lt;del&gt;HIVE-2435&lt;/del&gt;&lt;/a&gt; the symbol came out as ...HiveTM...  Should be ...Hive (TM)... for ASCII text.&lt;/p&gt;</comment>
                            <comment id="13132064" author="ashutoshc" created="Thu, 20 Oct 2011 21:31:29 +0000"  >&lt;p&gt;Literal copy paste doesn&apos;t always help : ) Updated patch respecting ascii art.&lt;/p&gt;</comment>
                            <comment id="13132071" author="jvs" created="Thu, 20 Oct 2011 21:35:42 +0000"  >&lt;p&gt;Awesome, +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13132081" author="jvs" created="Thu, 20 Oct 2011 21:47:57 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Ashutosh!&lt;/p&gt;</comment>
                            <comment id="13132107" author="cwsteinbach" created="Thu, 20 Oct 2011 22:16:57 +0000"  >&lt;p&gt;Backported to branch-0.8.&lt;/p&gt;</comment>
                            <comment id="13132307" author="hudson" created="Fri, 21 Oct 2011 03:44:20 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #64 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/64/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/64/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2476&quot; title=&quot;Update project description and wiki link in ivy.xml files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2476&quot;&gt;&lt;del&gt;HIVE-2476&lt;/del&gt;&lt;/a&gt;. Update project description and wiki link in ivy.xml files (Ashutosh Chauhan via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187099&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187099&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/ant/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/cli/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/common/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/contrib/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/hbase-handler/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/hwi/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/jdbc/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/serde/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/service/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/shims/ivy.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13132338" author="hudson" created="Fri, 21 Oct 2011 05:13:47 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1023 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1023/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2476&quot; title=&quot;Update project description and wiki link in ivy.xml files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2476&quot;&gt;&lt;del&gt;HIVE-2476&lt;/del&gt;&lt;/a&gt;. Update project description and wiki link in ivy.xml files&lt;br/&gt;
(Ashutosh Chauhan via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187070&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1187070&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ant/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/cli/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/contrib/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hwi/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/service/ivy.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/ivy.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12499653" name="hive-2476.patch" size="10467" author="ashutoshc" created="Wed, 19 Oct 2011 08:05:26 +0000"/>
                            <attachment id="12499958" name="hive-2476_1.patch" size="10505" author="ashutoshc" created="Thu, 20 Oct 2011 21:31:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Oct 2011 08:05:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43859</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i09zhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56192</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2477] Use name of original expression for name of CAST output</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2477</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;CAST(foo AS INT)&lt;br/&gt;
should, by default, consider itself a column named foo if unspecified/unaliased.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525603">HIVE-2477</key>
            <summary>Use name of original expression for name of CAST output</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="akramer">Adam Kramer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 00:09:43 +0000</created>
                <updated>Thu, 16 May 2013 21:10:28 +0000</updated>
                            <resolved>Thu, 6 Dec 2012 17:47:08 +0000</resolved>
                                                    <fixVersion>0.11.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13189019" author="navis" created="Thu, 19 Jan 2012 09:13:38 +0000"  >&lt;p&gt;Simple patch. &lt;/p&gt;

&lt;p&gt;If a column is function with single param and the param is a column, use the column name as alias.&lt;/p&gt;</comment>
                            <comment id="13510362" author="phabricator@reviews.facebook.net" created="Wed, 5 Dec 2012 08:42:57 +0000"  >&lt;p&gt;navis requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Use name of original expression for name of CAST output&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  DPAL-642 Use name of original expression for name of CAST output&lt;/p&gt;

&lt;p&gt;  CAST(foo AS INT)&lt;br/&gt;
  should, by default, consider itself a column named foo if unspecified/unaliased.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7161&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7161&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/alias_casted_column.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/alias_unary_function.q&lt;br/&gt;
  ql/src/test/results/clientpositive/alias_unary_function.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_testxpath2.q.xml&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/16953/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/16953/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;/p&gt;</comment>
                            <comment id="13511081" author="namit" created="Thu, 6 Dec 2012 04:03:06 +0000"  >&lt;p&gt;minor comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13511082" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 04:04:57 +0000"  >&lt;p&gt;njain has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Use name of original expression for name of CAST output&quot;.&lt;/p&gt;

&lt;p&gt;  minor comments&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/alias_casted_column.q:1 you forgot to add the output file for this&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java:1185 do you want to add a indirection ?&lt;/p&gt;

&lt;p&gt;  something like:&lt;/p&gt;

&lt;p&gt;  isOpPreserveInputName() &amp;#8211; which can call isOpCast (isOpCast can be private).&lt;br/&gt;
  and the caller (SemanticAnalyzer can call isOpPreserveName). If in future there&lt;br/&gt;
  is another function with this requirement, it would be easy.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7161&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7161&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13511192" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 07:34:57 +0000"  >&lt;p&gt;navis has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Use name of original expression for name of CAST output&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java:1185 Seemed reasonable. I&apos;ll do that.&lt;br/&gt;
  ql/src/test/queries/clientpositive/alias_casted_column.q:1 Sorry&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7161&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7161&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13511259" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 09:08:57 +0000"  >&lt;p&gt;navis updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Use name of original expression for name of CAST output&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Addressed comments&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D7161&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D7161&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/alias_casted_column.q&lt;br/&gt;
  ql/src/test/results/clientpositive/alias_casted_column.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_testxpath2.q.xml&lt;/p&gt;

&lt;p&gt;To: JIRA, navis&lt;br/&gt;
Cc: njain&lt;/p&gt;</comment>
                            <comment id="13511353" author="namit" created="Thu, 6 Dec 2012 13:55:25 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13511556" author="namit" created="Thu, 6 Dec 2012 17:47:08 +0000"  >&lt;p&gt;Committed. Thanks Navis&lt;/p&gt;</comment>
                            <comment id="13526185" author="hudson" created="Fri, 7 Dec 2012 07:02:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1839 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1839/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1839/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; Use name of original expression for name of CAST output&lt;br/&gt;
(Navis via namit) (Revision 1418012)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1418012&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1418012&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/alias_casted_column.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/alias_casted_column.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13547864" author="hudson" created="Wed, 9 Jan 2013 10:23:22 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2477&quot; title=&quot;Use name of original expression for name of CAST output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2477&quot;&gt;&lt;del&gt;HIVE-2477&lt;/del&gt;&lt;/a&gt; Use name of original expression for name of CAST output&lt;br/&gt;
(Navis via namit) (Revision 1418012)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1418012&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1418012&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/alias_casted_column.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/alias_casted_column.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12511110" name="HIVE-2477.1.patch.txt" size="1678" author="navis" created="Thu, 19 Jan 2012 09:13:37 +0000"/>
                            <attachment id="12556078" name="HIVE-2477.D7161.1.patch" size="7553" author="phabricator@reviews.facebook.net" created="Wed, 5 Dec 2012 08:42:57 +0000"/>
                            <attachment id="12556237" name="HIVE-2477.D7161.2.patch" size="10289" author="phabricator@reviews.facebook.net" created="Thu, 6 Dec 2012 09:08:57 +0000"/>
                            <attachment id="12556276" name="hive.2477.4.patch" size="10606" author="namit" created="Thu, 6 Dec 2012 13:37:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 19 Jan 2012 09:13:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43971</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08p2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48660</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2478] Support dry run option in hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2478</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive currently doesn&apos;t support a dry run option. For some complex queries we just want to verify the query syntax initally before running it. A dry run option where just the parsing is done without actual execution is a good option.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525679">HIVE-2478</key>
            <summary>Support dry run option in hive</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="sushanth">Sushanth Sowmyan</assignee>
                                    <reporter username="saktikalyan">kalyan ram</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 14:46:41 +0000</created>
                <updated>Thu, 18 Jan 2018 17:06:31 +0000</updated>
                                            <version>0.9.0</version>
                                                    <component>Configuration</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13120181" author="saktikalyan" created="Tue, 4 Oct 2011 14:49:20 +0000"  >&lt;p&gt;Adding a sample patch &amp;lt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt;-1.patch&amp;gt; for this improvement. Let me know if this is sufficent enough for the feature.&lt;/p&gt;</comment>
                            <comment id="13120272" author="jvs" created="Tue, 4 Oct 2011 16:48:51 +0000"  >&lt;p&gt;Can&apos;t you already use EXPLAIN for this purpose?&lt;/p&gt;</comment>
                            <comment id="13120890" author="saktikalyan" created="Wed, 5 Oct 2011 12:37:51 +0000"  >&lt;p&gt;Yes we can use EXPLAIN as well. In MySql older versions for some queries having sub queries &amp;lt;explain&amp;gt; was executing the sub queries so I was thinking on those terms. So in Hive is it that we never execute the query if EXPLAIN is present ? This feature might still be useful in remote cases where you can&apos;t go and change your queries. For example if you want to check if your queries will work against a new version of hive we can set this property and check without modifying the query.&lt;/p&gt;</comment>
                            <comment id="13121114" author="jvs" created="Wed, 5 Oct 2011 16:34:49 +0000"  >&lt;p&gt;Currently, Hive does not execute anything as part of EXPLAIN.&lt;/p&gt;</comment>
                            <comment id="13146396" author="sushanth" created="Tue, 8 Nov 2011 16:54:59 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have a question - does EXPLAIN execute any user-specified code? I&apos;m faced with a environment issue where I don&apos;t want to execute any user-specified code (UDFs,etc) or run anything, merely to syntax check. Would EXPLAIN still fit my need?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13146486" author="jvs" created="Tue, 8 Nov 2011 19:20:52 +0000"  >&lt;p&gt;Yes, it does execute user-defined code, e.g. for resolving the types of UDF invocations.  Without that, you&apos;d have to stop immediately after ANTLR parsing (pure syntax check, no semantic analysis).&lt;/p&gt;</comment>
                            <comment id="13146524" author="sushanth" created="Tue, 8 Nov 2011 20:07:56 +0000"  >&lt;p&gt;Would this modification of Kalyan&apos;s patch do the trick then?&lt;/p&gt;

&lt;p&gt;(Tests not added yet, will do so if intent is okay)&lt;/p&gt;</comment>
                            <comment id="13146571" author="jvs" created="Tue, 8 Nov 2011 21:06:22 +0000"  >&lt;p&gt;If we&apos;re going to add this, it would be best to generalize it so that you can choose what phase to stop after, e.g.&lt;/p&gt;

&lt;p&gt;hive.exec.dryrun=&lt;/p&gt;
{off,parse,analyze,plan}</comment>
                            <comment id="13146575" author="sushanth" created="Tue, 8 Nov 2011 21:18:35 +0000"  >&lt;p&gt;I like that idea! Ok, will look into it.&lt;/p&gt;</comment>
                            <comment id="13172523" author="sushanth" created="Mon, 19 Dec 2011 19:08:04 +0000"  >&lt;p&gt;Patch with &lt;/p&gt;
{off,parse,analyze,plan}
&lt;p&gt; change detailed above.&lt;/p&gt;</comment>
                            <comment id="13172542" author="sushanth" created="Mon, 19 Dec 2011 19:36:43 +0000"  >&lt;p&gt;Added phabricator review at &lt;a href=&quot;https://reviews.facebook.net/D921&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D921&lt;/a&gt; (Not familiar enough with the new process to know if I&apos;m doing it right - please correct if needed - Thanks!)&lt;/p&gt;</comment>
                            <comment id="13172639" author="jvs" created="Mon, 19 Dec 2011 21:37:09 +0000"  >&lt;p&gt;Could you abandon D921 and create a new review request with --jira so that they get linked properly from the start?&lt;/p&gt;</comment>
                            <comment id="13172644" author="sushanth" created="Mon, 19 Dec 2011 21:40:10 +0000"  >&lt;p&gt;Ok, trying.&lt;/p&gt;</comment>
                            <comment id="13172647" author="phabricator@reviews.facebook.net" created="Mon, 19 Dec 2011 21:45:30 +0000"  >&lt;p&gt;khorgath requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  Adding a hive.dry.run parameter that takes the following values : &lt;/p&gt;
{off,parse,analyze,plan}

&lt;p&gt;  They have the following behaviours:&lt;br/&gt;
  off : Nothing special, run query as expected&lt;br/&gt;
  parse : Return after parse finishes (acts as a syntax check)&lt;br/&gt;
  analyze : Return after semantic analysis finishes&lt;br/&gt;
  plan : Return after plan generation.&lt;/p&gt;

&lt;p&gt;  Hive currently doesn&apos;t support a dry run option. For some complex queries we just want to verify the query syntax initally before running it. A dry run option where just the parsing is done without actual execution is a good option.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;br/&gt;
  ql/src/test/results/clientnegative/dryrun_bad_parse.q.out&lt;br/&gt;
  ql/src/test/results/clientnegative/dryrun_nonexistant_table.q.out&lt;br/&gt;
  ql/src/test/results/clientnegative/dryrun_bad_fetch_serde.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun_nonexistant_table_parse_ok.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun_bad_fetch_serde_analyze_ok.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/dryrun3.q.out&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_fetch_serde.q&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_nonexistant_table.q&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_parse.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun_nonexistant_table_parse_ok.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun_bad_fetch_serde_analyze_ok.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun1.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun2.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun3.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/dryrun4.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/1935/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/1935/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13172651" author="sushanth" created="Mon, 19 Dec 2011 21:47:29 +0000"  >&lt;p&gt;I&apos;m not quite sure how to abandon D921 yet (looking through arcanist manpage)&lt;/p&gt;

&lt;p&gt;But I generated again with --jira, and asked it to create a new revision - it created it at D927 : &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt; &lt;/p&gt;
</comment>
                            <comment id="13172652" author="jvs" created="Mon, 19 Dec 2011 21:49:00 +0000"  >&lt;p&gt;You can abandon it from the Phabricator UI...use the dropdown at the bottom of the page and then click the button.&lt;/p&gt;</comment>
                            <comment id="13172656" author="sushanth" created="Mon, 19 Dec 2011 21:54:13 +0000"  >&lt;p&gt;That worked - thanks!&lt;/p&gt;</comment>
                            <comment id="13172657" author="phabricator@reviews.facebook.net" created="Mon, 19 Dec 2011 21:55:30 +0000"  >&lt;p&gt;khorgath has added reviewers to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;br/&gt;
Added Reviewers: jsichi&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13175012" author="phabricator@reviews.facebook.net" created="Thu, 22 Dec 2011 19:53:30 +0000"  >&lt;p&gt;ashutoshc has requested changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:558 Name the property as hive.exec.dryrun. Also, add it in hive-default.xml.template&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:135-140 There seems to be a confusion about these different mode means. You have not used PLAN anywhere. Also, &apos;off&apos; is confusing. I don&apos;t think there is any need of OFF. Allow three values: PARSE, ANALYZE &amp;amp; PLAN.  and then match these against the user provided value. In hiveConf, default value returned is empty string &quot;&quot;.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:423 Use, conf.getVar() instead.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:452 Without thus does it result in NPE later? Because returned schema is empty object. It will be good to add that in comment, if that is so.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:479-488 I think you want to end this phase after sem.validate().&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:944 This should be DryMode.PLAN&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_fetch_serde.q:1 Please add some comments at the top of script, explaining which phase should succeed and which should fail in these tests. You can also come up with better filenaemes for these tests which explains the intent.&lt;/p&gt;

&lt;p&gt;  This applies for all tests&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13178965" author="phabricator@reviews.facebook.net" created="Tue, 3 Jan 2012 19:28:39 +0000"  >&lt;p&gt;khorgath has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:135-140 PLAN is not explicitly used anywhere in code, because we need to only check 3 times to establish the 4 states.&lt;/p&gt;

&lt;p&gt;  The first two checks happen in the compile part :&lt;br/&gt;
  First check is for PARSE, if it&apos;s PARSE, it&apos;s weeded out and if not, it continues.&lt;br/&gt;
  Second check is for ANALYZE, if it&apos;s that, it&apos;s weeded out and if not, it continues.&lt;/p&gt;

&lt;p&gt;  The third check is after the compile, and thus, done for whether it&apos;s not-OFF(because both the PARSE and ANALYZE returns return here too, and we weed out all the non-OFF cases there.)&lt;/p&gt;

&lt;p&gt;  I think I agree that an empty string would serve better than OFF, looking to change that.&lt;br/&gt;
  common/src/java/org/apache/hadoop/hive/conf/HiveConf.java:558 Ok, fixing along with trying to make OFF an empty string in the next patch.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:423 Good spot, changing.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:452 Yup. Without this, it does, because it tries to read .getFields() on the schema. Adding comment.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:479-488 Oh, ok - I wasn&apos;t entirely sure of that, given the LOG.info proclaiming semantic analysis was complete before the validation. Would the plan validation not count as part of the plan phase?&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:944 Disagree. PARSE, ANALYZE and PLAN all come up to here, and need to be rejected. !OFF is the correct check here.&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_fetch_serde.q:1 Ok, doing so.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13178966" author="phabricator@reviews.facebook.net" created="Tue, 3 Jan 2012 19:28:39 +0000"  >&lt;p&gt;khorgath has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13179239" author="phabricator@reviews.facebook.net" created="Wed, 4 Jan 2012 02:38:39 +0000"  >&lt;p&gt;khorgath has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_fetch_serde.q:1 Hmm.. ok, this is funny - if I try adding comments (using double hyphen) to the .q script, I get parse failures from the testcase runner.  And a number of other .q tests don&apos;t have comments either, so I don&apos;t see what format I can use to comment.&lt;/p&gt;

&lt;p&gt;  How do I add comments here?&lt;/p&gt;

&lt;p&gt;  &amp;#8211; comment  : does not work&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;comment : does not work&lt;br/&gt;
  // comment : does not work&lt;br/&gt;
  /* comment */ : does not work&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13183428" author="phabricator@reviews.facebook.net" created="Tue, 10 Jan 2012 18:02:39 +0000"  >&lt;p&gt;ashutoshc has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2478&quot; title=&quot;Support dry run option in hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2478&quot;&gt;HIVE-2478&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Support dry run option in hive&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:479-488 Analysis would be complete but validation won&apos;t. I think when some wants a dryrun till analysis they want to know that whether query is semantically valid or not and not just whether semantic analysis phase could be completed successfully.&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/Driver.java:944 Didn&apos;t get. How come Parse, Analyze get here? I was assuming execution returns if dry mode is set to one of these modes. Also, now that we have agreed to get rid of OFF, this needs to be modified anyways. If you still plan not to use PLAN, then I think that should be removed from enum, since else it sounds confusing to me.&lt;br/&gt;
  ql/src/test/queries/clientnegative/dryrun_bad_fetch_serde.q:1 Try:&lt;br/&gt;
  &amp;#8211; comment&lt;/p&gt;

&lt;p&gt;  Note don&apos;t put ; at the end of line.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D927&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16330781" author="ptallada" created="Thu, 18 Jan 2018 17:06:31 +0000"  >&lt;p&gt;Is there any progress on this?&lt;/p&gt;

&lt;p&gt;We are running a web interface to hive and we want to validate SQL queries that users submit. Not only the syntax, but also to retrieve the resulting schema (column names and types).&lt;/p&gt;

&lt;p&gt;We are kind-of hacking it running the query inside a subselect:&lt;/p&gt;

&lt;p&gt;SELECT * FROM ( &amp;lt;original_query&amp;gt; ) AS t LIMIT 0&lt;/p&gt;

&lt;p&gt;But if the user does a join and there is a field with the same name in two differents tables, it fails...&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12507980" name="ASF.LICENSE.NOT.GRANTED--HIVE-2478.D927.1.patch" size="8733" author="phabricator@reviews.facebook.net" created="Mon, 19 Dec 2011 21:45:31 +0000"/>
                            <attachment id="12497644" name="HIVE-2478-1.patch" size="1438" author="saktikalyan" created="Tue, 4 Oct 2011 14:50:20 +0000"/>
                            <attachment id="12502954" name="HIVE-2478-2.patch" size="2137" author="sushanth" created="Tue, 8 Nov 2011 20:07:56 +0000"/>
                            <attachment id="12507953" name="HIVE-2478-3.patch" size="9443" author="sushanth" created="Mon, 19 Dec 2011 19:08:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 4 Oct 2011 16:48:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44377</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08p2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48661</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2479] Log more Hadoop task counter values in the MapRedStats class.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2479</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We should log more of the Hadoop task tracker counters in the MapRedStats class, in order to make them available to hooks and improve logging.&lt;/p&gt;

&lt;p&gt;We should make the counters that are logged configurable, so that if different Hadoop versions are used, different counters can be collected.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525698">HIVE-2479</key>
            <summary>Log more Hadoop task counter values in the MapRedStats class.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 17:11:13 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:00 +0000</updated>
                            <resolved>Thu, 6 Oct 2011 03:23:38 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13120300" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 17:29:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-04 17:27:43.657392)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;

&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;


&lt;p&gt;This addresses bug Hive-2479.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;

&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13120302" author="he yongqiang" created="Tue, 4 Oct 2011 17:30:08 +0000"  >&lt;p&gt;Let&apos;s put all job counters into a map in MapRedStats (not just the one listed above), and a hook can do anything he wants&lt;/p&gt;</comment>
                            <comment id="13120303" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 17:31:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/#review2316&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#review2316&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2167/#comment5322&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#comment5322&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    don&apos;t put the counter names here, let&apos;s use a map and pass it the hook&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Yongqiang&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-04 17:27:43, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-04 17:27:43)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug Hive-2479.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13120311" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 17:39:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-04 17:38:18.076011)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added everything from Task$Counter except CPU_MILLISECONDS because currently that receives special treatment in HadoopJobExecHelper.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;

&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;


&lt;p&gt;This addresses bug Hive-2479.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;

&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13120563" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 22:59:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-04 22:58:24.529007)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;MapRedStats provides an enum which just contains those counters that were being used before this diff.  I also made it take a generic enum, and made the task counter enum used by HadoopJobExecHelper configurable.  This way, if one Hadoop version contains more enums than another, the counters to be logged can be modified by creating a new enum.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;

&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;


&lt;p&gt;This addresses bug Hive-2479.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1178612 &lt;br/&gt;
  trunk/conf/hive-default.xml 1178612 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;

&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13120651" author="jiraposter@reviews.apache.org" created="Wed, 5 Oct 2011 02:24:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/#review2335&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#review2335&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2167/#comment5396&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#comment5396&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    remove the enum, just either put all the counters objects into this MapRedStats, or put a map&amp;lt;counterGrpAndName, counterInst&amp;gt; here.&lt;/p&gt;

&lt;p&gt;    For simplicity, we can just put the counters object here and hooks can anything they want.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Yongqiang&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-04 22:58:24, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-04 22:58:24)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug Hive-2479.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/conf/hive-default.xml 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13121286" author="jiraposter@reviews.apache.org" created="Wed, 5 Oct 2011 17:58:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-05 17:58:04.685771)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Thanks Yongqiang, that&apos;s a way better idea.  I implemented it, again leaving cpuMsec because of the special logic for it in HadoopJobExecHelper, but converting all other counters to use it.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;

&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;


&lt;p&gt;This addresses bug Hive-2479.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;

&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13121302" author="he yongqiang" created="Wed, 5 Oct 2011 18:07:49 +0000"  >&lt;p&gt;Looks good!&lt;/p&gt;

&lt;p&gt;a small comment, and also can you rebase?&lt;/p&gt;
</comment>
                            <comment id="13121304" author="jiraposter@reviews.apache.org" created="Wed, 5 Oct 2011 18:08:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/#review2355&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#review2355&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/2167/#comment5419&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/#comment5419&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    We may get NPE, so use code like this:&lt;/p&gt;

&lt;p&gt;    Counter ctr = null;&lt;br/&gt;
    if(counters != null) {&lt;br/&gt;
      ctr= counters.findCounter(...);&lt;br/&gt;
      if (ctr != null) &lt;/p&gt;
{
        ......
      }
&lt;p&gt;    }&lt;br/&gt;
    Or put this to a common method. &lt;/p&gt;




&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Yongqiang&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-10-05 17:58:04, Kevin Wilfong wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-10-05 17:58:04)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug Hive-2479.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178612 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13121393" author="jiraposter@reviews.apache.org" created="Wed, 5 Oct 2011 19:38:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-05 19:38:10.946692)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ramkumar Vadali and Yongqiang He.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Nice catch Yongqiang, I&apos;m sorry I let that slip through.  I rebased and made the change.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I added the counters mentioned in the task to the MapRedStats class, and modified HadoopJobExecHelper to collect them.&lt;/p&gt;

&lt;p&gt;I got tired of writing the same code over and over again, so I modified the way MapRedStats and HadoopJobExecHelper treat task counters.  MapRedStats now has an enum with all of the task counters we want to collect, it is a subset of the enum in Task$Counter.  Task is package private so the enum in it is unavailable.  MapRedStats now contains a map from the enum values to the values of the counters, if they were set.  HadoopJobExecHelper loops over the enum values and tries to get a value for each counter.  As long as the new getter and setter methods are used the functionality is the same, in particular for the getter, if a counter was set, it returns the value of the counter, otherwise it returns -1.&lt;/p&gt;


&lt;p&gt;This addresses bug Hive-2479.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/Hive-2479&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/Hive-2479&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java 1179378 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1179378 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2167/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2167/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I ran some queries to verify the counters were being populated.&lt;/p&gt;

&lt;p&gt;I also ran a few of the unit test queries to verify I hadn&apos;t broken anything.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
</comment>
                            <comment id="13121527" author="he yongqiang" created="Wed, 5 Oct 2011 22:07:07 +0000"  >&lt;p&gt;+1, will commit after tests pass.&lt;/p&gt;</comment>
                            <comment id="13121700" author="he yongqiang" created="Thu, 6 Oct 2011 03:23:39 +0000"  >&lt;p&gt;Committed, thanks Kevin Wilfong!&lt;/p&gt;</comment>
                            <comment id="13121714" author="hudson" created="Thu, 6 Oct 2011 04:28:14 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #995 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/995/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/995/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2479&quot; title=&quot;Log more Hadoop task counter values in the MapRedStats class.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2479&quot;&gt;&lt;del&gt;HIVE-2479&lt;/del&gt;&lt;/a&gt;: Log more Hadoop task counter values in the MapRedStats class (Kevin Wilfong via He Yongqiang)&lt;/p&gt;

&lt;p&gt;heyongqiang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1179493&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1179493&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/MapRedStats.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497665" name="HIVE-2479.1.patch.txt" size="5523" author="kevinwilfong" created="Tue, 4 Oct 2011 17:39:36 +0000"/>
                            <attachment id="12497724" name="HIVE-2479.2.patch.txt" size="7434" author="kevinwilfong" created="Tue, 4 Oct 2011 22:58:53 +0000"/>
                            <attachment id="12497861" name="HIVE-2479.3.patch.txt" size="5066" author="kevinwilfong" created="Wed, 5 Oct 2011 17:59:27 +0000"/>
                            <attachment id="12497876" name="HIVE-2479.4.patch.txt" size="5639" author="kevinwilfong" created="Wed, 5 Oct 2011 19:38:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 4 Oct 2011 17:29:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44574</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2480] UDAF: Multiple iterator() functions not respected</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2480</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The UDAF function allows definition of an iterator() function. In keeping with how Java works and how the UDF (non-aggregating) structure works, multiple iterator() functions should be definable for different functionality of the same function (especially for something like defining defaults).&lt;/p&gt;

&lt;p&gt;Multiple methods for a single UDAF is currently possible via definition of multiple Evaluators, but that is overkill for the &quot;defining defaults&quot; case. Overloading functions is also a standard practice in Java, so the fact that Hive silently disallows this is actually a bug. Further, the manner by which Hive ignores this (publishing only the last iterator defined in the file) is buggy, potentially inconsistent, and wholly undocumented.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525708">HIVE-2480</key>
            <summary>UDAF: Multiple iterator() functions not respected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="akramer">Adam Kramer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 18:03:04 +0000</created>
                <updated>Tue, 4 Oct 2011 18:03:04 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44585</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123919</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2481] HadoopJobExecHelper does not handle null counters well</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2481</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Sometimes hadoop can return null counters for a mapreduce job if the job has been retired. The HadoopJobExecHelper needs to handle it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525713">HIVE-2481</key>
            <summary>HadoopJobExecHelper does not handle null counters well</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rvadali">Ramkumar Vadali</assignee>
                                    <reporter username="rvadali">Ramkumar Vadali</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 18:32:53 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:24 +0000</updated>
                            <resolved>Tue, 4 Oct 2011 22:14:22 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13120369" author="jiraposter@reviews.apache.org" created="Tue, 4 Oct 2011 18:39:34 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2175/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2175/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for Yongqiang He.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt; Handle null counters in HadoopJobExecHelper&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2481&quot; title=&quot;HadoopJobExecHelper does not handle null counters well&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2481&quot;&gt;&lt;del&gt;HIVE-2481&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2481&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2481&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java 1178891 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2175/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2175/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Compile, TestCliDriver&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ramkumar&lt;/p&gt;
</comment>
                            <comment id="13120431" author="he yongqiang" created="Tue, 4 Oct 2011 20:15:33 +0000"  >&lt;p&gt;+1, will commit after tests pass&lt;/p&gt;</comment>
                            <comment id="13120432" author="he yongqiang" created="Tue, 4 Oct 2011 20:16:06 +0000"  >&lt;p&gt;i only looked at the review board diff, but where is the attached patch?&lt;/p&gt;</comment>
                            <comment id="13120523" author="he yongqiang" created="Tue, 4 Oct 2011 22:14:22 +0000"  >&lt;p&gt;committed, thanks Ramkumar Vadal!&lt;/p&gt;</comment>
                            <comment id="13120745" author="hudson" created="Wed, 5 Oct 2011 08:00:01 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #992 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/992/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/992/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2481&quot; title=&quot;HadoopJobExecHelper does not handle null counters well&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2481&quot;&gt;&lt;del&gt;HIVE-2481&lt;/del&gt;&lt;/a&gt;: HadoopJobExecHelper does not handle null counters well (Ramkumar Vadali via He Yongqiang)&lt;/p&gt;

&lt;p&gt;heyongqiang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178981&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1178981&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/HadoopJobExecHelper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497703" name="HIVE-2481.patch" size="5239" author="rvadali" created="Tue, 4 Oct 2011 20:51:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 4 Oct 2011 18:39:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>44607</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123920</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2482] Convenience UDFs for binary data type</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2482</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2380&quot; title=&quot;Add Binary Datatype in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2380&quot;&gt;&lt;del&gt;HIVE-2380&lt;/del&gt;&lt;/a&gt; introduced binary data type in Hive. It will be good to have following udfs to make it more useful:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;UDF&apos;s to convert to/from hex string&lt;/li&gt;
	&lt;li&gt;UDF&apos;s to convert to/from string using a specific encoding&lt;/li&gt;
	&lt;li&gt;UDF&apos;s to convert to/from base64 string&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12525746">HIVE-2482</key>
            <summary>Convenience UDFs for binary data type</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mwagner">Mark Wagner</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                            <label>TODOC12</label>
                    </labels>
                <created>Tue, 4 Oct 2011 23:33:14 +0000</created>
                <updated>Thu, 30 Apr 2015 05:38:20 +0000</updated>
                            <resolved>Tue, 13 Aug 2013 13:19:09 +0000</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13165641" author="alamakota.tmp.123@wp.pl" created="Thu, 8 Dec 2011 22:32:17 +0000"  >&lt;p&gt;MOO!&lt;/p&gt;</comment>
                            <comment id="13165642" author="alamakota.tmp.123@wp.pl" created="Thu, 8 Dec 2011 22:32:44 +0000"  >&lt;p&gt;MOO!&lt;/p&gt;</comment>
                            <comment id="13215913" author="ashutoshc" created="Fri, 24 Feb 2012 21:11:07 +0000"  >&lt;p&gt;I wont have any time in near future for this. Feel free to take it up.&lt;/p&gt;</comment>
                            <comment id="13725917" author="mwagner" created="Thu, 1 Aug 2013 00:57:51 +0000"  >&lt;p&gt;I&apos;ve implemented the hex, encoding, and base64 UDFs along with unit tests.&lt;/p&gt;

&lt;p&gt;I&apos;ve also changed Unhex to return a binary instead of wrapping it&apos;s output as a string. This is an incompatible change, but I think it&apos;s ultimately the right thing to do.&lt;/p&gt;</comment>
                            <comment id="13725947" author="appodictic" created="Thu, 1 Aug 2013 01:38:06 +0000"  >&lt;p&gt;It is nice that you have written traditional junit tests which can stay but we normally do this with q file. You can look at the developer guide on the wiki to understand how to write these. I an help you along as well because...I do not want your UDFs ending up like mine &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1262&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1262&lt;/a&gt; &lt;/p&gt;
</comment>
                            <comment id="13726038" author="mwagner" created="Thu, 1 Aug 2013 04:19:40 +0000"  >&lt;p&gt;I&apos;m aware of .q files and have used them before, but I figured that UDFs are nice and isolated so a unit test is more appropriate. I didn&apos;t realize all the other UDFs had their own .q tests. I&apos;ll update with a .q test.&lt;/p&gt;</comment>
                            <comment id="13726142" author="thejas" created="Thu, 1 Aug 2013 06:54:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appodictic&quot; class=&quot;user-hover&quot; rel=&quot;appodictic&quot;&gt;Edward Capriolo&lt;/a&gt; Should we try changing the practice of using .q files everywhere (at least when alternatives are easy enough/possible)?&lt;br/&gt;
The use of .q file gives good test coverage when we do things like change the query plan, as they are more a &apos;end-to-end&apos; test rather than a &apos;unit&apos; test. Writing the .q file based test is also often the easier thing to do.&lt;br/&gt;
But there are few reasons why I think we should avoid them when if it does not provide additional test coverage -&lt;br/&gt;
1. It takes lot longer to run compared to real unit tests&lt;br/&gt;
2. They are harder to debug&lt;br/&gt;
3. There are high chances that benchmark (q.out) with wrong results get checked in, as they are generated with &apos;-Doverwrite=true&apos;, and the contributor just eyeballs the results to verify the correctness. With real unit test, expected results come first (you write them first), before running the tests to verify.&lt;/p&gt;

&lt;p&gt;Also, I feel that one is likely to cover more corner cases in the test with real unit tests.&lt;/p&gt;</comment>
                            <comment id="13726475" author="appodictic" created="Thu, 1 Aug 2013 14:32:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;Thejas M Nair&lt;/a&gt; Thank you for your comment, I am going to agree and disagree with your for my prospective on this issue.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;I use hive_test to tests my udfs &lt;a href=&quot;https://github.com/edwardcapriolo/hive_test&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/edwardcapriolo/hive_test&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;At one point we added a plugin developer kit to hive which allowed annotation based testing of UDFS&lt;br/&gt;
At one point this was removed, there were reports that it was flakey and I was not paying much attention at that time, but I probably would have advocated that it not be removed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Now, I do agree with you that we can get better coverage of some things outside end-to-end tests, but believe it or not functions are not one of them.&lt;/p&gt;

&lt;p&gt;Why do I say this? A few reasons:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Most functions are not functional.&lt;/li&gt;
	&lt;li&gt;They actually have state, conf at initialization, reusable objects shared between calls to evaluate.&lt;/li&gt;
	&lt;li&gt;UDAFs have entire aggregation buffers systems.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;To your specific points&lt;br/&gt;
1) Welcome to my life, I have been complaining about our test infrastructure for years. Honestly now that we have a build system we can test udf&apos;s fairly fast, and there is not a huge volume of them anyway.&lt;/p&gt;

&lt;p&gt;2) That can be true, again I use hive_test and I am not against having units + end-to-end tests&lt;br/&gt;
3) I agree with this to an extent, but even in a real unit test one still has to write Assert.assertEquals( something, somethingElse ) so you still eyeball something. From a review standpoints it&apos;s easier to eyeball the .out then tens or hundreds of asserts.&lt;/p&gt;

&lt;p&gt;Again I am not against having more traditionally unit tests and writing code in functional style that is easier to document and and reason about, but I think to cover all the corner cases of exceptions and cleaning out private state properly the unit tests will be more ugly then the q tests.&lt;/p&gt;

&lt;p&gt;I am talking on hive-dev about the project split up. This is one of the things I want to do, move all the end-to-end test to a final project and really step up the unit style testing.&lt;/p&gt;

&lt;p&gt;There is lots of things we can do to make the tests faster&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;move all the UDFs into 1 big test &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; save the overhead of launching multiple tests&lt;/li&gt;
	&lt;li&gt;optimize &apos;select udf(column) from table limit 1&apos; &amp;lt;-- we should be able to make that test scream&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Anyway unlike the past where stuff like this sits on the queue forever we now have a build bot and I am dedicated to seeing patches reviewed and committed fast (especially those like these)&lt;/p&gt;

&lt;p&gt;BTW at minimum there is show_functions.q, so every time you add a function you at least have to touch that test.&lt;/p&gt;

</comment>
                            <comment id="13726587" author="brocknoland" created="Thu, 1 Aug 2013 16:36:42 +0000"  >&lt;p&gt;Just going through this chain. I really appreciate the unit tests as well! There is a good point about object reuse though. Is it reasonable to say that we strongly encourage unit testing but we&apos;d like to see at least one end to end test?&lt;/p&gt;</comment>
                            <comment id="13726621" author="ashutoshc" created="Thu, 1 Aug 2013 17:09:54 +0000"  >&lt;p&gt;I usually write end to end tests for new features (mostly for regression testing but also to demonstrate what functionality is getting introduced). For bug fixes I write junit tests to test the part which I am fixing.&lt;br/&gt;
Obviously there are lot more bug fixes than features, so in most circumstances junit tests are encouraged, though in this particular instance there are new udfs (thus new features) so here end to end tests does make sense. &lt;/p&gt;</comment>
                            <comment id="13726630" author="appodictic" created="Thu, 1 Aug 2013 17:19:01 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Is it reasonable to say that we strongly encourage unit testing but we&apos;d like to see at least one end to end test?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;^ that has always been the case.&lt;br/&gt;
I am ok with moving to a simpler/faster/east to test style. But asserting on evaluate() really does not cover everything  (because of the state). Neither does select udf&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from src limit 1 (bugs from multiple rows). I think we need to be simulating from the standpoint of an operator interacting with the UDF normally. It would not be full end-to-end but more then just cherry picking execution points and validating results.&lt;/p&gt;

</comment>
                            <comment id="13726632" author="appodictic" created="Thu, 1 Aug 2013 17:21:05 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I usually write end to end tests for new features (mostly for regression testing but also to demonstrate what functionality is getting introduced). For bug fixes I write junit tests to test the part which I am fixing.&lt;br/&gt;
 Obviously there are lot more bug fixes than features, so in most circumstances junit tests are encouraged, though in this particular instance there are new udfs (thus new features) so here end to end tests does make sense.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well said. Hive is releasable trunk, so every commit for a new feature has to be usable. q tests show the usable. &lt;/p&gt;

&lt;p&gt;Moreover the q tests serve as the ONLY true documentation we have, since most things never hit the wiki.&lt;/p&gt;</comment>
                            <comment id="13726637" author="brocknoland" created="Thu, 1 Aug 2013 17:29:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;I usually write end to end tests for new features (mostly for regression testing but also to demonstrate what functionality is getting introduced). For bug fixes I write junit tests to test the part which I am fixing.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hey guys, just to make sure I understand, unit tests are still strongly encouraged for new features as well as end-to-end tests? &lt;/p&gt;</comment>
                            <comment id="13727217" author="thejas" created="Fri, 2 Aug 2013 01:55:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Hey guys, just to make sure I understand, unit tests are still strongly encouraged for new features as well as end-to-end tests?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I would agree with that conclusion&lt;/p&gt;</comment>
                            <comment id="13727270" author="mwagner" created="Fri, 2 Aug 2013 03:25:26 +0000"  >&lt;p&gt;Here&apos;s the updated patch with q testing.&lt;/p&gt;</comment>
                            <comment id="13727277" author="mwagner" created="Fri, 2 Aug 2013 03:32:17 +0000"  >&lt;p&gt;Also, this patch relies on changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4970&quot; title=&quot;BinaryConverter does not respect nulls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4970&quot;&gt;&lt;del&gt;HIVE-4970&lt;/del&gt;&lt;/a&gt; to apply cleanly (and to fix the test case)&lt;/p&gt;</comment>
                            <comment id="13732616" author="ashutoshc" created="Wed, 7 Aug 2013 19:27:44 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;Mark Wagner&lt;/a&gt; I have couple of minor comments. Can you create a RB or phabricator entry for the patch?&lt;/p&gt;</comment>
                            <comment id="13732955" author="mwagner" created="Wed, 7 Aug 2013 23:51:24 +0000"  >&lt;p&gt;I&apos;ve posted it at &lt;a href=&quot;https://reviews.apache.org/r/13244/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/13244/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13734315" author="mwagner" created="Fri, 9 Aug 2013 01:30:51 +0000"  >&lt;p&gt;RB is down, but here&apos;s the updated watch with Ashutosh&apos;s suggestions.&lt;/p&gt;</comment>
                            <comment id="13734478" author="ashutoshc" created="Fri, 9 Aug 2013 06:48:22 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13734675" author="hiveqa" created="Fri, 9 Aug 2013 11:17:36 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12597005/HIVE-2482.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12597005/HIVE-2482.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 3 failed/errored test(s), 2779 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_unhex
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_hex
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_udf_sentences
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/356/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/356/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/356/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/356/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests failed with: TestsFailedException: 3 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13735131" author="mwagner" created="Fri, 9 Aug 2013 18:50:58 +0000"  >&lt;p&gt;Fixed test failures.&lt;/p&gt;</comment>
                            <comment id="13735220" author="appodictic" created="Fri, 9 Aug 2013 20:14:48 +0000"  >&lt;p&gt;I was going to say:&lt;br/&gt;
This is an incompatible change because the return type of unhex has been changed from string to binary &lt;br/&gt;
I think we should not do this ^ lets make another UDF, or overload the parameters of this one.&lt;/p&gt;</comment>
                            <comment id="13735689" author="hiveqa" created="Sat, 10 Aug 2013 02:28:32 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12597142/HIVE-2482.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12597142/HIVE-2482.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 2780 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/371/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/371/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-Build/371/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-Build/371/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13737287" author="mwagner" created="Mon, 12 Aug 2013 19:55:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we should not do this ^ lets make another UDF, or overload the parameters of this one.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is there any way to deprecate a UDF that will move people away from the current &apos;unhex&apos;? The only difference from the updated version is that the current one wraps the output in Text, so that it could be used by Hive before the binary support. Now that there is binary support it doesn&apos;t make any sense for unhex to wrap its output.&lt;/p&gt;</comment>
                            <comment id="13737295" author="ashutoshc" created="Mon, 12 Aug 2013 20:07:36 +0000"  >&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;Mark Wagner&lt;/a&gt; analysis.&lt;/p&gt;</comment>
                            <comment id="13737319" author="appodictic" created="Mon, 12 Aug 2013 20:44:53 +0000"  >&lt;p&gt;I am ok with it as well, but remember everything you change breaks someones workflow. &lt;/p&gt;</comment>
                            <comment id="13738177" author="ashutoshc" created="Tue, 13 Aug 2013 13:19:09 +0000"  >&lt;p&gt;Committed to trunk. Thanks, Mark!&lt;/p&gt;</comment>
                            <comment id="13738448" author="hudson" created="Tue, 13 Aug 2013 16:29:10 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2-ptest #56 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/56/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2-ptest/56/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2482&quot; title=&quot;Convenience UDFs for binary data type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2482&quot;&gt;&lt;del&gt;HIVE-2482&lt;/del&gt;&lt;/a&gt; : Convenience UDFs for binary data type (Mark Wagner via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ba_table_udfs.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_sentences.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ba_table_udfs.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/show_functions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hex.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_sentences.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_unhex.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13738467" author="hudson" created="Tue, 13 Aug 2013 16:41:12 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop2 #357 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/357/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/357/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2482&quot; title=&quot;Convenience UDFs for binary data type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2482&quot;&gt;&lt;del&gt;HIVE-2482&lt;/del&gt;&lt;/a&gt; : Convenience UDFs for binary data type (Mark Wagner via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ba_table_udfs.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_sentences.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ba_table_udfs.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/show_functions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hex.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_sentences.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_unhex.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13738637" author="hudson" created="Tue, 13 Aug 2013 18:37:01 +0000"  >&lt;p&gt;FAILURE: Integrated in Hive-trunk-hadoop1-ptest #126 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/126/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop1-ptest/126/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2482&quot; title=&quot;Convenience UDFs for binary data type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2482&quot;&gt;&lt;del&gt;HIVE-2482&lt;/del&gt;&lt;/a&gt; : Convenience UDFs for binary data type (Mark Wagner via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ba_table_udfs.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_sentences.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ba_table_udfs.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/show_functions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hex.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_sentences.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_unhex.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13739141" author="hudson" created="Wed, 14 Aug 2013 01:55:54 +0000"  >&lt;p&gt;SUCCESS: Integrated in Hive-trunk-h0.21 #2266 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/2266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/2266/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2482&quot; title=&quot;Convenience UDFs for binary data type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2482&quot;&gt;&lt;del&gt;HIVE-2482&lt;/del&gt;&lt;/a&gt; : Convenience UDFs for binary data type (Mark Wagner via Ashutosh Chauhan) (hashutosh: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1513474&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/GenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFDecode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestGenericUDFEncode.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFBase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFHex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnbase64.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/org/apache/hadoop/hive/ql/udf/TestUDFUnhex.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ba_table_udfs.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/udf_sentences.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ba_table_udfs.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/show_functions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hex.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_sentences.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_unhex.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13795877" author="ashutoshc" created="Tue, 15 Oct 2013 23:29:21 +0000"  >&lt;p&gt;This issue has been fixed and released as part of 0.12 release. If you find further issues, please create a new jira and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12825396">HIVE-10518</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12518954">HIVE-2380</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12595314" name="HIVE-2482.1.patch" size="25622" author="mwagner" created="Thu, 1 Aug 2013 00:57:51 +0000"/>
                            <attachment id="12595547" name="HIVE-2482.2.patch" size="44929" author="mwagner" created="Fri, 2 Aug 2013 03:25:26 +0000"/>
                            <attachment id="12597005" name="HIVE-2482.3.patch" size="45075" author="mwagner" created="Fri, 9 Aug 2013 01:30:51 +0000"/>
                            <attachment id="12597142" name="HIVE-2482.4.patch" size="56218" author="mwagner" created="Fri, 9 Aug 2013 18:50:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Dec 2011 22:32:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lk6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123921</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This is an incompatible change because the return type of unhex has been changed from string to binary</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2483] Add support for serializing zero-length binary data </title>
                <link>https://issues.apache.org/jira/browse/HIVE-2483</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2380&quot; title=&quot;Add Binary Datatype in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2380&quot;&gt;&lt;del&gt;HIVE-2380&lt;/del&gt;&lt;/a&gt; added binary data type in Hive. Currently, LazyBinaryColumnarSerde cannot serialize zero-length binary data and throws an Exception when it encounters zero-length binary data. It will be good to lift this restriction. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12525747">HIVE-2483</key>
            <summary>Add support for serializing zero-length binary data </summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="n_krishna_kumar">Krishna Kumar</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Oct 2011 23:38:29 +0000</created>
                <updated>Wed, 5 Oct 2011 00:09:39 +0000</updated>
                                            <version>0.9.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12518954">HIVE-2380</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08o0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48490</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>
