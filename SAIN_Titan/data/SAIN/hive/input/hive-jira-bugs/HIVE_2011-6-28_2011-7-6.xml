<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Tue Jan 22 15:18:27 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+HIVE+AND+created+%3E%3D+2011-6-28+AND+created+%3C%3D+2011-7-6+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="18" total="18"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[HIVE-2243] Can&apos;t publish maven release artifacts to apache repository</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2243</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;So far I haven&apos;t been able to push the maven artifacts to the Apache release repository. Here&apos;s the error I get:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;% ant maven-publish -Dmvn.publish.repo=releases
...
maven-publish-artifact:
[artifact:install-provider] Installing provider: org.apache.maven.wagon:wagon-http:jar:1.0-beta-2:runtime
[artifact:deploy] Deploying to https://repository.apache.org/content/repositories/releases
[artifact:deploy] Uploading: org/apache/hive/hive-anttasks/0.7.1/hive-anttasks-0.7.1.jar to repository apache.releases.https at https://repository.apache.org/content/repositories/releases
[artifact:deploy] Transferring 9K from apache.releases.https
[artifact:deploy] An error has occurred while processing the Maven artifact tasks.
[artifact:deploy]  Diagnosis:
[artifact:deploy] 
[artifact:deploy] Error deploying artifact &apos;org.apache.hive:hive-anttasks:jar&apos;: Error deploying artifact: Authorization failed: Access denied to: https://repository.apache.org/content/repositories/releases/org/apache/hive/hive-anttasks/0.7.1/hive-anttasks-0.7.1.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I get the same error when I try to publish to the staging repository.&lt;/p&gt;

&lt;p&gt;I took another look at the Apache &quot;Publishing Maven Artifacts&quot; guide (&lt;a href=&quot;http://www.apache.org/dev/publishing-maven-artifacts.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/dev/publishing-maven-artifacts.html&lt;/a&gt;) and think that we&apos;re probably failing to include a couple fields that are required in the pom files. It also looks like we should be pushing this to the staging repository as opposed to the releases repository.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12512028">HIVE-2243</key>
            <summary>Can&apos;t publish maven release artifacts to apache repository</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jun 2011 18:13:21 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:03 +0000</updated>
                            <resolved>Mon, 10 Oct 2011 20:00:57 +0000</resolved>
                                    <version>0.7.1</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Build Infrastructure</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13072175" author="gkesavan" created="Thu, 28 Jul 2011 04:49:59 +0000"  >&lt;p&gt;Hi Carl,&lt;/p&gt;

&lt;p&gt;I can work on this jira if you are busy; let me know.&lt;/p&gt;</comment>
                            <comment id="13072449" author="cwsteinbach" created="Thu, 28 Jul 2011 17:54:19 +0000"  >&lt;p&gt;Sounds good. Reassigning to you.&lt;/p&gt;</comment>
                            <comment id="13072919" author="gkesavan" created="Fri, 29 Jul 2011 17:02:33 +0000"  >&lt;p&gt;can someone try the following command with credentials in the .m2/settings.xml and post the output? ( I don&apos;t have repo access to verify this). &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant clean maven-build maven-publish -Dmvn.publish.repo=staging -Dversion=0.8.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This would publish the artifacts to the apache staging repo. we can delete them post publishing.. by logging on to the repository.apache.org.&lt;/p&gt;

&lt;p&gt;If the command works then I would submit a patch for gpg signing.&lt;/p&gt;</comment>
                            <comment id="13073490" author="amareshwari" created="Mon, 1 Aug 2011 10:54:22 +0000"  >&lt;p&gt;I&apos;m not able run the command successfully. It gives Access denied error.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;maven-publish-artifact:
[artifact:install-provider] Installing provider: org.apache.maven.wagon:wagon-http:jar:1.0-beta-2:runtime
[artifact:deploy] Deploying to https://repository.apache.org/content/repositories/staging
[artifact:deploy] Uploading: org/apache/hive/hive-anttasks/0.8.0/hive-anttasks-0.8.0.jar to repository apache.staging.https at https://repository.apache.org/content/repositories/staging
[artifact:deploy] Transferring 9K from apache.staging.https
[artifact:deploy] An error has occurred while processing the Maven artifact tasks.
[artifact:deploy]  Diagnosis:
[artifact:deploy] 
[artifact:deploy] Error deploying artifact &apos;org.apache.hive:hive-anttasks:jar&apos;: Error deploying artifact: Authorization failed: Access denied to: https://repository.apache.org/content/repositories/staging/org/apache/hive/hive-anttasks/0.8.0/hive-anttasks-0.8.0.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;where as I&apos;m able to publish to snapshots repo without any problems.&lt;/p&gt;</comment>
                            <comment id="13091572" author="amareshwari" created="Fri, 26 Aug 2011 04:37:12 +0000"  >&lt;p&gt;Giri, Did you get a chance to look at why publishing to staging area is failing?&lt;/p&gt;</comment>
                            <comment id="13119604" author="jiraposter@reviews.apache.org" created="Mon, 3 Oct 2011 20:58:35 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2153/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2153/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;. Can&apos;t publish maven release artifacts to apache repository.&lt;/p&gt;

&lt;p&gt;With this patch in place I verified that I am able to publish to the snapshot&lt;br/&gt;
and staging repositories as follows:&lt;/p&gt;

&lt;p&gt;% ant maven-build -Dmvn.publish.repo=snapshots&lt;br/&gt;
% ant maven-publish -Dmvn.publish.repo=snaphots&lt;/p&gt;

&lt;p&gt;% ant maven-build -Dmvn.publish.repo=staging -Dversion=0.9.0&lt;br/&gt;
% ant maven-publish -Dmvn.publish.repo=staging -Dversion=0.9.0&lt;/p&gt;

&lt;p&gt;I also confirmed that this patch applies cleanly to the 0.8.0 branch.&lt;/p&gt;

&lt;p&gt;Please note that I had to move several taskdefs from build-common.xml&lt;br/&gt;
to build.xml in order to avoid OOM errors.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2243&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  build-common.xml 9a738c9 &lt;br/&gt;
  build.xml 13b09c1 &lt;br/&gt;
  contrib/build.xml cf1711c &lt;br/&gt;
  hbase-handler/build.xml 4990b13 &lt;br/&gt;
  ql/build.xml ca8ba86 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2153/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2153/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Verified that I can publish maven artifacts to the snapshot and staging repos.&lt;/li&gt;
	&lt;li&gt;Verified that the jar, package, and test targets still work.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13119797" author="jvs" created="Tue, 4 Oct 2011 00:28:57 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="13120379" author="jvs" created="Tue, 4 Oct 2011 18:52:02 +0000"  >&lt;p&gt;While attempting to run ant test, I got a PermGen space OOM  (in the ivy-resolve after the metastore tests).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
ivy-resolve:
[ivy:resolve] :: Ivy 2.1.0 - 20090925235825 :: http://ant.apache.org/ivy/ ::
[ivy:resolve] :: loading settings :: file = /data/users/jsichi/open/test-trunk/\
ivy/ivysettings.xml
      [for] /data/users/jsichi/open/test-trunk/ql/build.xml: The following erro\
r occurred while executing this line:
      [for] /data/users/jsichi/open/test-trunk/build.xml:241: The following err\
or occurred while executing this line:
      [for] /data/users/jsichi/open/test-trunk/build-common.xml:163: java.lang.\
OutOfMemoryError: PermGen space
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13120503" author="cwsteinbach" created="Tue, 4 Oct 2011 21:49:41 +0000"  >&lt;p&gt;@John: Which version of Ant are you using? Do you have ANT_OPTS or JAVA_OPTS set?&lt;/p&gt;</comment>
                            <comment id="13120509" author="jvs" created="Tue, 4 Oct 2011 21:54:31 +0000"  >&lt;p&gt;java version &quot;1.6.0_14&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_14-b08)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 14.0-b16, mixed mode)&lt;/p&gt;

&lt;p&gt;I did not set any special options.&lt;/p&gt;</comment>
                            <comment id="13120547" author="jvs" created="Tue, 4 Oct 2011 22:43:22 +0000"  >&lt;p&gt;(Tests have been passing fine for me on the same box without this change.)&lt;/p&gt;</comment>
                            <comment id="13122243" author="jvs" created="Thu, 6 Oct 2011 20:20:19 +0000"  >&lt;p&gt;Update:  Hit PermGen OOM testing an unrelated patch too, so I&apos;m retrying this one after rebooting the machine used for testing.&lt;/p&gt;</comment>
                            <comment id="13122411" author="jvs" created="Thu, 6 Oct 2011 23:33:13 +0000"  >&lt;p&gt;After reboot, still hit the PermGen OOM in the middle (this time right after pdk tests).&lt;/p&gt;</comment>
                            <comment id="13122606" author="jiraposter@reviews.apache.org" created="Fri, 7 Oct 2011 08:10:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2153/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2153/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-07 08:08:55.722617)&lt;/p&gt;


&lt;p&gt;Review request for hive and John Sichi.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Updating diff with &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12498125/HIVE-2243.2.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12498125/HIVE-2243.2.patch.txt&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;. Can&apos;t publish maven release artifacts to apache repository.&lt;/p&gt;

&lt;p&gt;With this patch in place I verified that I am able to publish to the snapshot&lt;br/&gt;
and staging repositories as follows:&lt;/p&gt;

&lt;p&gt;% ant maven-build -Dmvn.publish.repo=snapshots&lt;br/&gt;
% ant maven-publish -Dmvn.publish.repo=snaphots&lt;/p&gt;

&lt;p&gt;% ant maven-build -Dmvn.publish.repo=staging -Dversion=0.9.0&lt;br/&gt;
% ant maven-publish -Dmvn.publish.repo=staging -Dversion=0.9.0&lt;/p&gt;

&lt;p&gt;I also confirmed that this patch applies cleanly to the 0.8.0 branch.&lt;/p&gt;

&lt;p&gt;Please note that I had to move several taskdefs from build-common.xml&lt;br/&gt;
to build.xml in order to avoid OOM errors.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2243&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ant/build.xml 17b3c3a &lt;br/&gt;
  build-common.xml 9a738c9 &lt;br/&gt;
  build.xml 13b09c1 &lt;br/&gt;
  cli/build.xml add53e1 &lt;br/&gt;
  common/build.xml e8a0712 &lt;br/&gt;
  contrib/build.xml cf1711c &lt;br/&gt;
  hbase-handler/build.xml 4990b13 &lt;br/&gt;
  hwi/build.xml 76bffa8 &lt;br/&gt;
  jdbc/build.xml 9d9a59e &lt;br/&gt;
  metastore/build.xml 7f01f91 &lt;br/&gt;
  odbc/build.xml db9f4af &lt;br/&gt;
  pdk/build.xml b1f6ed4 &lt;br/&gt;
  ql/build.xml ca8ba86 &lt;br/&gt;
  serde/build.xml 51ac8dd &lt;br/&gt;
  service/build.xml 3c54625 &lt;br/&gt;
  shims/build.xml 9dadc8a &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2153/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2153/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Verified that I can publish maven artifacts to the snapshot and staging repos.&lt;/li&gt;
	&lt;li&gt;Verified that the jar, package, and test targets still work.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Carl&lt;/p&gt;
</comment>
                            <comment id="13122609" author="cwsteinbach" created="Fri, 7 Oct 2011 08:17:44 +0000"  >&lt;ul&gt;
	&lt;li&gt;I commented out the body of the &apos;test&apos; target in build-common.xml and then verified that the OOM error still occurs.&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;% export ANT_OPTS=&quot;-XX:+PrintCommandLineFlags -XX:+PrintGCDetails -XX:+PrintGC -XX:+TraceClassLoading -XX:+TraceClassUnloading -XX:+HeapDumpOnOutOfMemoryError&quot;
% ant clean package test &amp;amp;&amp;gt; build.log
% cat build.log | grep &apos;^\[(Loaded|Unloading)&apos; | sort -n | uniq -c &amp;gt; event.log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The contents of event.log indicate that the &apos;ivy-init-antlib&apos; target in build-common.xml&lt;br/&gt;
is getting called over twenty times, and the classes which are re-loaded as a result&lt;br/&gt;
of each call are never unloaded. Eventually these class definitions fill up the PermGen&lt;br/&gt;
space and cause an OOM error. I suspect that the &apos;typefound&apos; task in the &apos;ivy-probe-antlib&apos;&lt;br/&gt;
target has a bug, or that it doesn&apos;t work as expected when called via ant/subant/antcall&lt;br/&gt;
tasks.&lt;/p&gt;

&lt;p&gt;The new version of the patch fixes this issue by relocating ivy-init-antlib target from&lt;br/&gt;
build-common.xml to build.xml.&lt;/p&gt;</comment>
                            <comment id="13122964" author="jvs" created="Fri, 7 Oct 2011 17:03:38 +0000"  >&lt;p&gt;Will give it another run.&lt;/p&gt;</comment>
                            <comment id="13124439" author="jvs" created="Mon, 10 Oct 2011 20:00:57 +0000"  >&lt;p&gt;Committed to trunk and 0.8.  Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13124578" author="hudson" created="Mon, 10 Oct 2011 23:38:28 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1003 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1003/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1003/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;. Can&apos;t publish maven release artifacts to apache repository&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1181187&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1181187&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ant/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/cli/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/common/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/contrib/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hbase-handler/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/hwi/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/jdbc/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/odbc/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/service/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/shims/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13124609" author="hudson" created="Tue, 11 Oct 2011 00:42:11 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #52 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/52/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/52/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2243&quot; title=&quot;Can&amp;#39;t publish maven release artifacts to apache repository&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2243&quot;&gt;&lt;del&gt;HIVE-2243&lt;/del&gt;&lt;/a&gt;. Can&apos;t publish maven release artifacts to apache repository&lt;br/&gt;
(Carl Steinbach via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1181189&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1181189&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/ant/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/build-common.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/cli/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/common/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/contrib/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/hbase-handler/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/hwi/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/jdbc/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/odbc/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/ql/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/serde/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/service/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/shims/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497532" name="HIVE-2243.1.patch.txt" size="21865" author="cwsteinbach" created="Mon, 3 Oct 2011 20:38:42 +0000"/>
                            <attachment id="12498125" name="HIVE-2243.2.patch.txt" size="57176" author="cwsteinbach" created="Fri, 7 Oct 2011 08:07:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 28 Jul 2011 04:49:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42209</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123746</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2244] Add a Plugin Developer Kit to Hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2244</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/PluginDeveloperKit&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/PluginDeveloperKit&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512173">HIVE-2244</key>
            <summary>Add a Plugin Developer Kit to Hive</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvs">John Sichi</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Jun 2011 06:52:25 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:18 +0000</updated>
                            <resolved>Thu, 29 Sep 2011 18:15:36 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>UDF</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13057036" author="jiraposter@reviews.apache.org" created="Wed, 29 Jun 2011 06:55:28 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/977/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/977/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Review request from JVS.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2244&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/build.xml&lt;/a&gt; 1139984 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/build.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/README&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/README&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/build-plugin.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/build-plugin.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/class-registration.xsl&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/class-registration.xsl&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/PluginTest.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/PluginTest.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/build.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/cleanup.sql&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/cleanup.sql&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/onerow.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/onerow.txt&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/setup.sql&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/setup.sql&lt;/a&gt; PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/977/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/977/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;John&lt;/p&gt;
</comment>
                            <comment id="13057037" author="jvs" created="Wed, 29 Jun 2011 06:56:16 +0000"  >&lt;p&gt;Review board at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/977/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/977/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13058092" author="jvs" created="Thu, 30 Jun 2011 21:36:20 +0000"  >&lt;p&gt;I&apos;m tweaking a few things based on experience at the mini-hackathon, so this is just a first draft.&lt;/p&gt;</comment>
                            <comment id="13064544" author="miloveme" created="Wed, 13 Jul 2011 13:35:13 +0000"  >&lt;p&gt;I tested my udf using pdk. but it was slow because invoking cli repeatedly.&lt;br/&gt;
So, I just changed PluginTest to use Driver directly not using invoking cli. &lt;br/&gt;
then, I got a following result &lt;/p&gt;

&lt;p&gt;test case : Rot13 , Rot12 (just changed class-name of Rot13)&lt;br/&gt;
total test count : 4&lt;/p&gt;

&lt;p&gt;pdk using cli : 2min 44s&lt;br/&gt;
pdk using driver : 1min 49s &lt;/p&gt;

&lt;p&gt;I think that we need to improve it&apos;s performance in this release to apply many udf.&lt;/p&gt;</comment>
                            <comment id="13064690" author="jvs" created="Wed, 13 Jul 2011 16:46:19 +0000"  >&lt;p&gt;I agree; I&apos;m working on a similar optimization.&lt;/p&gt;</comment>
                            <comment id="13113077" author="jvs" created="Fri, 23 Sep 2011 00:53:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;.1.patch has the optimization.&lt;/p&gt;</comment>
                            <comment id="13113080" author="jiraposter@reviews.apache.org" created="Fri, 23 Sep 2011 00:55:25 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2030/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2030/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2244&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/build.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/cleanup.sql&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/cleanup.sql&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/onerow.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/onerow.txt&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/setup.sql&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/test-plugin/test/setup.sql&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/PluginTest.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/PluginTest.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/build-plugin.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/build-plugin.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/class-registration.xsl&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/class-registration.xsl&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/README&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/scripts/README&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/pdk/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/pdk/build.xml&lt;/a&gt; PRE-CREATION &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java&lt;/a&gt; 1174460 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hive/trunk/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hive/trunk/build.xml&lt;/a&gt; 1174460 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2030/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2030/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;John&lt;/p&gt;
</comment>
                            <comment id="13113081" author="jvs" created="Fri, 23 Sep 2011 00:55:33 +0000"  >&lt;p&gt;Review Board at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2030&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2030&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13113097" author="cwsteinbach" created="Fri, 23 Sep 2011 01:35:55 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13113527" author="appodictic" created="Fri, 23 Sep 2011 16:06:12 +0000"  >&lt;p&gt;I have a similar approach on github.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/edwardcapriolo/hive_test&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/edwardcapriolo/hive_test&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It pulls down all hive deps from maven and only requires a local copy of hadoop because hive always seems to fork a call to hadoop jar.&lt;/p&gt;</comment>
                            <comment id="13117494" author="cwsteinbach" created="Thu, 29 Sep 2011 18:15:36 +0000"  >&lt;p&gt;Committed to trunk and branch-0.8. Thanks John!&lt;/p&gt;</comment>
                            <comment id="13117751" author="hudson" created="Thu, 29 Sep 2011 23:49:12 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #38 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/38/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/38/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;. Add a Plugin Developer Kit to Hive (John Sichi via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177386&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177386&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/scripts&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/scripts/README&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/scripts/build-plugin.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/scripts/class-registration.xsl&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive/pdk&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/src/java/org/apache/hive/pdk/PluginTest.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src/org&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src/org/apache/hive&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src/org/apache/hive/pdktest&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/test&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/test/cleanup.sql&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/test/onerow.txt&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/pdk/test-plugin/test/setup.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13117784" author="hudson" created="Fri, 30 Sep 2011 00:33:35 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #983 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/983/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/983/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2244&quot; title=&quot;Add a Plugin Developer Kit to Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2244&quot;&gt;&lt;del&gt;HIVE-2244&lt;/del&gt;&lt;/a&gt;. Add a Plugin Developer Kit to Hive (John Sichi via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177382&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1177382&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts/README&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts/build-plugin.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/scripts/class-registration.xsl&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive/pdk&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive/pdk/FunctionExtractor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTest.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive/pdk/HivePdkUnitTests.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/src/java/org/apache/hive/pdk/PluginTest.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/build.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src/org&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src/org/apache&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src/org/apache/hive&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/src/org/apache/hive/pdktest/Rot13.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/test&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/test/cleanup.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/test/onerow.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/pdk/test-plugin/test/setup.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12528584">HIVE-2523</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12496209" name="HIVE-2244.1.patch" size="32825" author="jvs" created="Fri, 23 Sep 2011 00:53:15 +0000"/>
                            <attachment id="12484601" name="HIVE-2244.patch" size="29279" author="jvs" created="Wed, 29 Jun 2011 06:53:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 29 Jun 2011 06:55:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0knyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>118700</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2245] Make CombineHiveInputFormat the default hive.input.format</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2245</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We should use CombineHiveInputFormat as the default Hive input format.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512288">HIVE-2245</key>
            <summary>Make CombineHiveInputFormat the default hive.input.format</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jun 2011 07:53:46 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:57 +0000</updated>
                            <resolved>Wed, 6 Jul 2011 19:47:55 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13058784" author="nzhang" created="Fri, 1 Jul 2011 20:41:58 +0000"  >&lt;p&gt;Changes look good. Carl, have you run the unit tests? I think many .q.out files need to be updated. &lt;/p&gt;</comment>
                            <comment id="13059657" author="cwsteinbach" created="Tue, 5 Jul 2011 02:03:21 +0000"  >&lt;p&gt;@Ning: Yup, I ran the tests and everything passed. Looks like no test updates are required after all.&lt;/p&gt;</comment>
                            <comment id="13059685" author="nzhang" created="Tue, 5 Jul 2011 05:57:41 +0000"  >&lt;p&gt;+1. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13060005" author="nzhang" created="Tue, 5 Jul 2011 17:09:45 +0000"  >&lt;p&gt;Carl, there are 11 failed tests in TestCliDriver, e.g., index_bitmap.q and many index_*.q. Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13060066" author="cwsteinbach" created="Tue, 5 Jul 2011 18:41:38 +0000"  >&lt;p&gt;@Ning: I re-ran the TestCliDriver index* tests and they all pass. Can you please try running these tests again on your side? Thanks.&lt;/p&gt;</comment>
                            <comment id="13060070" author="jvs" created="Tue, 5 Jul 2011 18:45:34 +0000"  >&lt;p&gt;Ning, in case you are hitting the problem Paul was tracking down with ls, can you run his test script on your dev box to test it?  My dev box was affected, so I found another one which worked.&lt;/p&gt;</comment>
                            <comment id="13060115" author="nzhang" created="Tue, 5 Jul 2011 20:31:14 +0000"  >&lt;p&gt;Interesting. I&apos;m trying index_bitmap.q on my dev box and it worked. I used to run all unit tests on the test machine I used and everything was fine then. I guess there&apos;s something wrong with that box recently. I&apos;ll run the whole test on my dev box then. &lt;/p&gt;</comment>
                            <comment id="13060790" author="nzhang" created="Wed, 6 Jul 2011 19:47:55 +0000"  >&lt;p&gt;Committed. Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13060943" author="hudson" created="Thu, 7 Jul 2011 00:10:22 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #813 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/813/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/813/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2245&quot; title=&quot;Make CombineHiveInputFormat the default hive.input.format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2245&quot;&gt;&lt;del&gt;HIVE-2245&lt;/del&gt;&lt;/a&gt;. Make CombineHiveInputFormat the default hive.input.format (Carl Steinbach via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1143540&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1143540&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/conf/hive-default.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12484731" name="HIVE-2245.1.patch.txt" size="1526" author="cwsteinbach" created="Thu, 30 Jun 2011 08:38:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Jul 2011 20:41:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05in3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2246] Dedupe tables&apos; column schemas from partitions in the metastore db</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2246</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Note: this patch proposes a schema change, and is therefore incompatible with the current metastore.&lt;/p&gt;

&lt;p&gt;We can re-organize the JDO models to reduce space usage to keep the metastore scalable for the future.  Currently, partitions are the fastest growing objects in the metastore, and the metastore keeps a separate copy of the columns list for each partition.  We can normalize the metastore db by decoupling Columns from Storage Descriptors and not storing duplicate lists of the columns for each partition. &lt;/p&gt;

&lt;p&gt;An idea is to create an additional level of indirection with a &quot;Column Descriptor&quot; that has a list of columns.  A table has a reference to its latest Column Descriptor (note: a table may have more than one Column Descriptor in the case of schema evolution).  Partitions and Indexes can reference the same Column Descriptors as their parent table.&lt;/p&gt;

&lt;p&gt;Currently, the COLUMNS table in the metastore has roughly (number of partitions + number of tables) * (average number of columns pertable) rows.  We can reduce this to (number of tables) * (average number of columns per table) rows, while incurring a small cost proportional to the number of tables to store the Column Descriptors.&lt;/p&gt;

&lt;p&gt;Please see the latest review board for additional implementation details.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512385">HIVE-2246</key>
            <summary>Dedupe tables&apos; column schemas from partitions in the metastore db</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sohanjain">Sohan Jain</assignee>
                                    <reporter username="sohanjain">Sohan Jain</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jun 2011 22:07:28 +0000</created>
                <updated>Wed, 9 Jan 2013 10:23:50 +0000</updated>
                            <resolved>Tue, 9 Aug 2011 22:08:44 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13058109" author="jiraposter@reviews.apache.org" created="Thu, 30 Jun 2011 22:25:28 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/985/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/985/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;We can re-organize the JDO models to reduce space usage to keep the metastore scalable for the future. Currently, partitions are the fastest growing objects in the metastore, and the metastore keeps a separate copy of the columns list for each partition. We can normalize the metastore db by decoupling Columns from Storage Descriptors and not storing duplicate lists of the columns for each partition.&lt;/p&gt;

&lt;p&gt;An idea is to create an additional level of indirection with a &quot;Column Descriptor&quot; that has a list of columns. A table has a reference to its latest Column Descriptor (note: a table may have more than one Column Descriptor in the case of schema evolution). Partitions and Indexes can reference the same Column Descriptors as their parent table.&lt;/p&gt;

&lt;p&gt;Currently, the COLUMNS table in the metastore has roughly (number of partitions + number of tables) * (average number of columns pertable) rows. We can reduce this to (number of tables) * (average number of columns per table) rows, while incurring a small cost proportional to the number of tables to store the Column Descriptors.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MDatabase.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MFieldSchema.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MIndex.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MPartition.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MTable.java 1140399 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/ImportSemanticAnalyzer.java 1140399 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/985/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/985/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Haven&apos;t run any unit tests yet, just qualitative testing so far.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13069388" author="sohanjain" created="Fri, 22 Jul 2011 05:25:17 +0000"  >&lt;p&gt;See the latest review board.  This patch is incompatible with the current metastore and requires schema migration.&lt;/p&gt;</comment>
                            <comment id="13069389" author="jiraposter@reviews.apache.org" created="Fri, 22 Jul 2011 05:25:58 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1148945 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1148945 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1148945 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13069391" author="sohanjain" created="Fri, 22 Jul 2011 05:29:24 +0000"  >&lt;p&gt;Adding some missing files that I forgot to svn add&lt;/p&gt;</comment>
                            <comment id="13069392" author="jiraposter@reviews.apache.org" created="Fri, 22 Jul 2011 05:30:57 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-07-22 05:30:29.026246)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Adding some files I missed in the last diff.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1148945 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1148945 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1148945 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13070337" author="jiraposter@reviews.apache.org" created="Mon, 25 Jul 2011 06:47:09 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/#review1176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#review1176&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2467&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2467&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    is the CHARSET (latin1) the same as SDS? This will require the user&apos;s comments to be in latin1 which prevents UTF chars.&lt;/p&gt;



&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2466&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2466&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    can you also add migration script for derby? we support derby as a default metastore RDBMS as well. &lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2468&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2468&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    here do you check if the &apos;alter table&apos; command changes the schema (columns definition)? If it just set a table property, then you don&apos;t need to create a new ColumnDescriptor right?&lt;/p&gt;

&lt;p&gt;    Also if a table&apos;s schema got changed, a new CD will be created, but the old partition will still have the old CDs. When we query the old partition, do we use the old partitons&apos;s CD or the table&apos;s CD? &lt;/p&gt;

&lt;p&gt;    Also in the above case, when you run &apos;desc table partition &amp;lt;old_partition&amp;gt;&apos;, do you return the old partition&apos;s CD or the table&apos;s CD? &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ning&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-22 05:30:29, Sohan Jain wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-22 05:30:29)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/package.jdo 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13080211" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 20:46:27 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-07-25 06:46:04, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql, line 76&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/diff/2/?file=26824#file26824line76&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff/2/?file=26824#file26824line76&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     is the CHARSET (latin1) the same as SDS? This will require the user&apos;s comments to be in latin1 which prevents UTF chars.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, this charset matches the same ones from the official hive schema for 0.7.0.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-07-25 06:46:04, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql, line 206&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/diff/2/?file=26824#file26824line206&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff/2/?file=26824#file26824line206&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     can you also add migration script for derby? we support derby as a default metastore RDBMS as well.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok, will do.  I will add it in the next-next diff here.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-07-25 06:46:04, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java, line 1752&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/diff/2/?file=26825#file26825line1752&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff/2/?file=26825#file26825line1752&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     here do you check if the &apos;alter table&apos; command changes the schema (columns definition)? If it just set a table property, then you don&apos;t need to create a new ColumnDescriptor right?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also if a table&apos;s schema got changed, a new CD will be created, but the old partition will still have the old CDs. When we query the old partition, do we use the old partitons&apos;s CD or the table&apos;s CD? &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also in the above case, when you run &apos;desc table partition &amp;lt;old_partition&amp;gt;&apos;, do you return the old partition&apos;s CD or the table&apos;s CD?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good point; I should check whether the table columns have changed; I do this already when altering partitions.  I added that in the next diff.&lt;/p&gt;

&lt;p&gt;If a table&apos;s schema changes, it does not update existing partition CDs.  If we ever grab the partition object after the schema change, it will refer to its old CD, not the table&apos;s CD.  However, when querying tables on the CLI, we almost always use the table&apos;s set of columns.  E.g., if did:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;create table test (a string) partitioned by (p1 string, p2 string);&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;alter table test add partition(p1=1, p2=1);&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;# populate the p1=1, p2=1 partition with some data now&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;alter table test add columns (b string)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;select * from test where p1 = 1 and p2 = 1,&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it&apos;d use the table&apos;s latest schema; i.e., return the column &apos;a&apos;s values and the column &apos;b&apos; as all NULL.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sohan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/#review1176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#review1176&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-07-22 05:30:29, Sohan Jain wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-22 05:30:29)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/package.jdo 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13080214" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 20:48:27 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-07-25 06:46:04, Ning Zhang wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java, line 1752&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/diff/2/?file=26825#file26825line1752&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff/2/?file=26825#file26825line1752&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     here do you check if the &apos;alter table&apos; command changes the schema (columns definition)? If it just set a table property, then you don&apos;t need to create a new ColumnDescriptor right?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also if a table&apos;s schema got changed, a new CD will be created, but the old partition will still have the old CDs. When we query the old partition, do we use the old partitons&apos;s CD or the table&apos;s CD? &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also in the above case, when you run &apos;desc table partition &amp;lt;old_partition&amp;gt;&apos;, do you return the old partition&apos;s CD or the table&apos;s CD?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan Jain wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Good point; I should check whether the table columns have changed; I do this already when altering partitions.  I added that in the next diff.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;If a table&apos;s schema changes, it does not update existing partition CDs.  If we ever grab the partition object after the schema change, it will refer to its old CD, not the table&apos;s CD.  However, when querying tables on the CLI, we almost always use the table&apos;s set of columns.  E.g., if did:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; create table test (a string) partitioned by (p1 string, p2 string);&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; alter table test add partition(p1=1, p2=1);&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; # populate the p1=1, p2=1 partition with some data now&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; alter table test add columns (b string)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; select * from test where p1 = 1 and p2 = 1,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;it&apos;d use the table&apos;s latest schema; i.e., return the column &apos;a&apos;s values and the column &apos;b&apos; as all NULL.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Also, I fixed the &quot;desc table partition&quot; to use the partition&apos;s column schema, not the table&apos;s.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sohan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/#review1176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#review1176&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-07-22 05:30:29, Sohan Jain wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-22 05:30:29)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/package.jdo 1148945 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13080216" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 20:48:29 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-05 20:48:05.144312)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;-On alter table, only change the column descriptor if the columns have changed.&lt;br/&gt;
-Fix &quot;desc table partition...&quot; to use the partition&apos;s column schema, not the table&apos;s&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13080218" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 20:50:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-05 20:49:19.127572)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;-Forgot to add a few files.  NOTE: this is only a temporary diff; I need to add derby and postgres migration scripts.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13080245" author="jiraposter@reviews.apache.org" created="Fri, 5 Aug 2011 21:41:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/#review1309&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#review1309&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Also, can you add migration scripts for other DB&apos;s?&lt;/p&gt;


&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2982&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2982&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Typo&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2979&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2979&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The check and the delete should in the same transaction, as it&apos;s possible for a reference to a CD to be created after the check but before the delete.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2981&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2981&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    How does this drop the storage descriptor?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/model/package.jdo&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2968&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2968&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Fix indent&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Paul&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-08-05 20:49:19, Sohan Jain wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-08-05 20:49:19)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/package.jdo 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13080327" author="jiraposter@reviews.apache.org" created="Sat, 6 Aug 2011 01:41:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-06 01:40:49.118616)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;-made listStorageDescriptors.. into one transaction&lt;br/&gt;
-renamed dropStorageDescriptorCleanly to make it&apos;s functionality clearer&lt;br/&gt;
-indents &amp;amp; typo&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13080328" author="jiraposter@reviews.apache.org" created="Sat, 6 Aug 2011 01:43:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/#review1313&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#review1313&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1183/#comment2984&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/#comment2984&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    should read 1-N actually&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sohan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-08-06 01:40:49, Sohan Jain wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-08-06 01:40:49)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;- SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/model/package.jdo 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Sohan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13081188" author="jiraposter@reviews.apache.org" created="Mon, 8 Aug 2011 20:55:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-08 20:55:11.546253)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;added derby upgrade and revert-the-upgrade script&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When adding or altering a table, create a new column descriptor every time.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13081202" author="jiraposter@reviews.apache.org" created="Mon, 8 Aug 2011 21:20:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-08 21:19:06.999293)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;revised description for latest changes&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When creating a table, create a new column descriptor every time.  When altering a table, only construct a new column descriptor if the columns list has changed.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1153927 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/MetaDataFormatUtils.java 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13081209" author="jiraposter@reviews.apache.org" created="Mon, 8 Aug 2011 21:30:26 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-08 21:29:23.722825)&lt;/p&gt;


&lt;p&gt;Review request for hive, Ning Zhang and Paul Yang.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Revert the changes to &quot;describe table T partition P&quot;, so that it always shows the table T&apos;s schema.  If a table&apos;s schema has changed, we do not support querying on the old partition&apos;s schema at the moment.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This patch tries to make minimal changes to the API while keeping migration short and somewhat easy to revert.&lt;/p&gt;

&lt;p&gt;The new schema can be described as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CDS is a table corresponding to Column Descriptor objects.  Currently, it only stores a CD_ID.&lt;/li&gt;
	&lt;li&gt;COLUMNS_V2 is a table corresponding to MFieldSchema objects, or columns.  A Column Descriptor holds a list of columns.  COLUMNS_V2 has a foreign key to the CD_ID to which it belongs.&lt;/li&gt;
	&lt;li&gt;SDS was modified to reference a Column Descriptor. So SDS now has a foreign key to a CD_ID which describes its columns.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;During migration, we create Column Descriptors for tables in a straightforward manner: their columns are now just wrapped inside a column descriptor.  The SDS of partitions use their parent table&apos;s column descriptor, since currently a partition and its table share the same list of columns.&lt;/p&gt;

&lt;p&gt;When altering or adding a partition, give it it&apos;s parent table&apos;s column descriptor IF the columns they describe are the same.  Otherwise, create a new column descriptor for its columns.&lt;/p&gt;

&lt;p&gt;When creating a table, create a new column descriptor every time.  When altering a table, only construct a new column descriptor if the columns list has changed.&lt;/p&gt;

&lt;p&gt;Whenever you drop a storage descriptor (e.g, when dropping tables or partitions), check to see if the related column descriptor has any other references in the table.  That is, check to see if any other storage descriptors point to that column descriptor.  If none do, then delete that column descriptor.  This check is in place so we don&apos;t have unreferenced column descriptors and columns hanging around after schema evolution for tables.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2246&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java 1153927 &lt;br/&gt;
  trunk/metastore/src/model/package.jdo 1153927 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1183/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1183/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Passes facebook&apos;s regression testing and all existing test cases.  In one instance, before migration, the overhead involved with storage descriptors and columns was ~11 GB.  After migration, the overhead was ~1.5 GB.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13081956" author="pauly" created="Tue, 9 Aug 2011 21:54:33 +0000"  >&lt;p&gt;+1 - tests passed. Will commit.&lt;/p&gt;</comment>
                            <comment id="13081963" author="pauly" created="Tue, 9 Aug 2011 22:08:44 +0000"  >&lt;p&gt;Committed. Thanks Sohan!&lt;/p&gt;</comment>
                            <comment id="13082131" author="hudson" created="Wed, 10 Aug 2011 04:36:13 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #885 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/885/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/885/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;. Dedupe tables&apos; column schemas from partitions in the metastore db (Sohan Jain via pauly)&lt;/p&gt;

&lt;p&gt;pauly : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155573&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1155573&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MColumnDescriptor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/model/org/apache/hadoop/hive/metastore/model/MStorageDescriptor.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/model/package.jdo&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13083751" author="pauly" created="Thu, 11 Aug 2011 22:26:32 +0000"  >&lt;p&gt;There has been some issues identified with this patch. We will be doing some additional testing, but we might rollback so that we don&apos;t leave trunk in an unstable state.&lt;/p&gt;</comment>
                            <comment id="13144449" author="hudson" created="Fri, 4 Nov 2011 23:18:56 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1059 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1059/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1059/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2366&quot; title=&quot;Metastore upgrade scripts for HIVE-2246 do not migrate indexes nor rename the old COLUMNS table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2366&quot;&gt;&lt;del&gt;HIVE-2366&lt;/del&gt;&lt;/a&gt;. Metastore upgrade scripts for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt; do not migrate indexes nor rename the old COLUMNS table (Sohan Jain via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197644&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197644&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13144490" author="hudson" created="Sat, 5 Nov 2011 00:41:25 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #82 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/82/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/82/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2366&quot; title=&quot;Metastore upgrade scripts for HIVE-2246 do not migrate indexes nor rename the old COLUMNS table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2366&quot;&gt;&lt;del&gt;HIVE-2366&lt;/del&gt;&lt;/a&gt;. Metastore upgrade scripts for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt; do not migrate indexes nor rename the old COLUMNS table (Sohan Jain via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197646&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1197646&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/scripts/upgrade/derby/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/scripts/upgrade/derby/008-REVERT-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.derby.sql&lt;/li&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13146787" author="hudson" created="Wed, 9 Nov 2011 05:56:50 +0000"  >&lt;p&gt;Integrated in Hive-0.8.0-SNAPSHOT-h0.21 #87 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/87/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-0.8.0-SNAPSHOT-h0.21/87/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2556&quot; title=&quot;upgrade script 008-HIVE-2246.mysql.sql contains syntax errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2556&quot;&gt;&lt;del&gt;HIVE-2556&lt;/del&gt;&lt;/a&gt;. upgrade script 008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql contains syntax errors. (Ning Zhang via pauly)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;begin &lt;b&gt;PUBLIC&lt;/b&gt; platform impact section -&lt;br/&gt;
Bugzilla: #&lt;/li&gt;
	&lt;li&gt;end platform impact -&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;pauly : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199595&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199595&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/branches/branch-0.8/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13146794" author="hudson" created="Wed, 9 Nov 2011 06:15:23 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1070 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1070/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1070/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2556&quot; title=&quot;upgrade script 008-HIVE-2246.mysql.sql contains syntax errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2556&quot;&gt;&lt;del&gt;HIVE-2556&lt;/del&gt;&lt;/a&gt;. upgrade script 008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql contains syntax errors. (Ning Zhang via pauly)&lt;/p&gt;

&lt;p&gt;pauly : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199593&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1199593&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13148987" author="hudson" created="Sat, 12 Nov 2011 04:46:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1079 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1079/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1079/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2568&quot; title=&quot;HIVE-2246 upgrade script needs to drop foreign key in COLUMNS_OLD&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2568&quot;&gt;&lt;del&gt;HIVE-2568&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt; upgrade script needs to drop foreign key in COLUMNS_OLD&lt;br/&gt;
(Ning Zhang via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201091&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201091&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13149397" author="hudson" created="Sun, 13 Nov 2011 23:55:09 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1082 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1082/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1082/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2572&quot; title=&quot;HIVE-2246 upgrade script changed the COLUMNS_V2.COMMENT length&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2572&quot;&gt;&lt;del&gt;HIVE-2572&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt; upgrade script changed the COLUMNS_V2.COMMENT length&lt;br/&gt;
(Ning Zhang via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201470&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201470&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13161747" author="namit" created="Fri, 2 Dec 2011 17:47:40 +0000"  >&lt;p&gt;Note that there is a bug in the upgrade script. After running this script, the column information for all the partitions is lost. They all inherit the columns from the table definition. It is not a serious problem, as the&lt;br/&gt;
partition column information is not really used by Hive. The only command whose results will change is:&lt;/p&gt;

&lt;p&gt;describe table &amp;lt;T&amp;gt; partition &amp;lt;P&amp;gt;;&lt;/p&gt;</comment>
                            <comment id="13161749" author="ashutoshc" created="Fri, 2 Dec 2011 17:55:28 +0000"  >&lt;p&gt;Thanks Namit for pointing this out. HCatalog looks into the columns information of partitions, so it will have an issue. Do you have a fix or it or if you can point out which part of script has a bug, we can take a look.&lt;/p&gt;</comment>
                            <comment id="13161753" author="ashutoshc" created="Fri, 2 Dec 2011 17:57:55 +0000"  >&lt;p&gt;Also, I assume this is only while upgrading an existing metastore. Newly added partitions after upgrade or new install will not loose any information.&lt;/p&gt;</comment>
                            <comment id="13448018" author="hudson" created="Tue, 4 Sep 2012 20:25:38 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1646 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1646/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1646/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3424&quot; title=&quot;Error by upgrading a Hive 0.7.0 database to 0.8.0 (008-HIVE-2246.mysql.sql) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3424&quot;&gt;&lt;del&gt;HIVE-3424&lt;/del&gt;&lt;/a&gt;. Error by upgrading a Hive 0.7.0 database to 0.8.0 (008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql) (Alexander Alten-Lorenz via cws) (Revision 1380483)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1380483&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1380483&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13547981" author="hudson" created="Wed, 9 Jan 2013 10:23:50 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3424&quot; title=&quot;Error by upgrading a Hive 0.7.0 database to 0.8.0 (008-HIVE-2246.mysql.sql) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3424&quot;&gt;&lt;del&gt;HIVE-3424&lt;/del&gt;&lt;/a&gt;. Error by upgrading a Hive 0.7.0 database to 0.8.0 (008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql) (Alexander Alten-Lorenz via cws) (Revision 1380483)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1380483&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1380483&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/scripts/upgrade/mysql/008-&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2246&quot; title=&quot;Dedupe tables&amp;#39; column schemas from partitions in the metastore db&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2246&quot;&gt;&lt;del&gt;HIVE-2246&lt;/del&gt;&lt;/a&gt;.mysql.sql&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12518517">HIVE-2366</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12518531">HIVE-2367</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12518535">HIVE-2368</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12487393" name="HIVE-2246.2.patch" size="15556" author="sohanjain" created="Fri, 22 Jul 2011 05:25:17 +0000"/>
                            <attachment id="12487394" name="HIVE-2246.3.patch" size="23114" author="sohanjain" created="Fri, 22 Jul 2011 05:29:24 +0000"/>
                            <attachment id="12489531" name="HIVE-2246.4.patch" size="29540" author="sohanjain" created="Fri, 5 Aug 2011 20:51:02 +0000"/>
                            <attachment id="12489746" name="HIVE-2246.8.patch" size="29577" author="sohanjain" created="Mon, 8 Aug 2011 21:31:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Jun 2011 22:25:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>65239</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123747</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This makes an incompatible change in the metastore DB table schema from previous versions (&amp;lt;0.8). Older metastores created with previous versions of Hive will need to be upgraded with the supplied scripts.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>metastore, schema, JDO</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2247] ALTER TABLE RENAME PARTITION</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2247</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We need a ALTER TABLE TABLE RENAME PARTITIONfunction that is similar t ALTER TABLE RENAME.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512388">HIVE-2247</key>
            <summary>ALTER TABLE RENAME PARTITION</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="weiyan">Weiyan Wang</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jun 2011 22:26:11 +0000</created>
                <updated>Sun, 20 Jan 2013 07:43:24 +0000</updated>
                            <resolved>Thu, 21 Jun 2012 20:06:15 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13059160" author="ashutoshc" created="Sun, 3 Jul 2011 05:12:16 +0000"  >&lt;p&gt;Can you provide a usecase where it will be useful? Will it affect the physical data (moving dirs), or purely a metadata operation?   &lt;/p&gt;</comment>
                            <comment id="13063457" author="sdong" created="Mon, 11 Jul 2011 18:13:30 +0000"  >&lt;p&gt;The use case of use is that we want to have sanity check for the quality of the data in a temp partition name before we move the data to the partition that people consider that the partition is ready. We want to avoid data scanning for this operation.&lt;/p&gt;</comment>
                            <comment id="13064937" author="jiraposter@reviews.apache.org" created="Wed, 13 Jul 2011 23:04:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13064938" author="weiyan" created="Wed, 13 Jul 2011 23:06:15 +0000"  >&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;</comment>
                            <comment id="13064966" author="jiraposter@reviews.apache.org" created="Wed, 13 Jul 2011 23:58:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1052&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1052&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/metastore/if/hive_metastore.thrift&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2131&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2131&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Do we really need a new metastore function? Can we just use alter_partition()?&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2126&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2126&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This doesn&apos;t seem to be correct to me. The partition should always have SerDe. Even if it doesn&apos;t have one, copying from the table&apos;s Serde doesn&apos;t seem to be the right thing to do.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2127&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Also, it doesn&apos;t seem to be correct to me here. There shouldn&apos;t be any case that we need to create new directory for the renamed partitions. Renaming should just change the name, with all other attributes kept.&lt;/p&gt;



&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2128&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2128&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I can&apos;t understand those codes. What you try to do here?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2129&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2129&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Since we only need old part spec and new part spec, why we make a new Partition object at all?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2130&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2130&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    why we still continue when tab is null?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2125&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2125&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Privilege.ALTER_METADATA doesn&apos;t sound right to me here. Can you use Privilede.DROP and Priviledge.CREATE?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2124&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Looks like you copied from the file AddPartitionDesc, but do you need all those class members for renaming partition?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Siying&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-13 23:04:47, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-13 23:04:47)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13064993" author="jiraposter@reviews.apache.org" created="Thu, 14 Jul 2011 00:54:59 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-07-13 23:58:21, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java, line 1854&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/diff/1/?file=25067#file25067line1854&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff/1/?file=25067#file25067line1854&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Also, it doesn&apos;t seem to be correct to me here. There shouldn&apos;t be any case that we need to create new directory for the renamed partitions. Renaming should just change the name, with all other attributes kept.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In that case, what does &quot;physical data rename&quot; mean in the task if we are just supposed to change the name of partition?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Weiyan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1052&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1052&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-07-13 23:04:47, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-13 23:04:47)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13064994" author="sdong" created="Thu, 14 Jul 2011 00:59:00 +0000"  >&lt;p&gt;Sorry for the confusion. I just meaned to change the directory name where the data is, and change the &quot;location&quot; parameter in the partition metadata.&lt;br/&gt;
If we decide not to change physical path, we just change partition name. If we need to change the physical path, then we need to change partition name and location.&lt;/p&gt;
</comment>
                            <comment id="13066754" author="weiyan" created="Mon, 18 Jul 2011 00:06:16 +0000"  >&lt;p&gt;Refactor the code, &lt;br/&gt;
rename the old partition data directory to new partition data directory. &lt;/p&gt;</comment>
                            <comment id="13066756" author="jiraposter@reviews.apache.org" created="Mon, 18 Jul 2011 00:12:00 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-07-18 00:10:53.957462)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Change thrift interface to &lt;br/&gt;
void rename_partition(1:string dbname, 2:string name, 3:list&amp;lt;string&amp;gt; part_vals, 4:list&amp;lt;string&amp;gt; newpart_vals)&lt;br/&gt;
Rename the data directory of old partition to that of new partition and change location/name parameter of partition metadata&lt;br/&gt;
use Alter_partition to update the partition metadata&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13066757" author="jiraposter@reviews.apache.org" created="Mon, 18 Jul 2011 00:19:59 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-07-13 23:58:21, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/metastore/if/hive_metastore.thrift, line 272&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/diff/1/?file=25058#file25058line272&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff/1/?file=25058#file25058line272&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Do we really need a new metastore function? Can we just use alter_partition()?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;alter_partition() just updates the partition metadata and neither check whether the new partition exists nor do physical rename of data directory. It&apos;s basically used by alter_table when there is no data in the old partition. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-07-13 23:58:21, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java, line 1704&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/diff/1/?file=25075#file25075line1704&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff/1/?file=25075#file25075line1704&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     why we still continue when tab is null?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fixed, throw an exception when tab is null.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-07-13 23:58:21, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java, line 39&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/diff/1/?file=25080#file25080line39&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff/1/?file=25080#file25080line39&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Privilege.ALTER_METADATA doesn&apos;t sound right to me here. Can you use Privilede.DROP and Priviledge.CREATE?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Change it to ALTERTABLE_RENAMEPART(&quot;ALTERTABLE_RENAMEPART&quot;, new Privilege[]&lt;/p&gt;
{Privilege.DROP}
&lt;p&gt;, new Privilege[]&lt;/p&gt;
{Privilege.CREATE}
&lt;p&gt;)&lt;br/&gt;
Not sure if it sounds right to you.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-07-13 23:58:21, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java, line 1&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/diff/1/?file=25081#file25081line1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff/1/?file=25081#file25081line1&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Looks like you copied from the file AddPartitionDesc, but do you need all those class members for renaming partition?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Only keep necessary functions&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Weiyan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1052&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1052&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-07-18 00:10:53, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-18 00:10:53)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13068751" author="weiyan" created="Thu, 21 Jul 2011 01:18:47 +0000"  >&lt;p&gt;Use alter_partition(db_name, tbl_name, newPart, part_vals) to replace rename_partition thrift API&lt;br/&gt;
Add one authorization unit test to test if new partition has the same privilege as old one&lt;/p&gt;</comment>
                            <comment id="13068753" author="jiraposter@reviews.apache.org" created="Thu, 21 Jul 2011 01:21:57 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-07-21 01:20:25.242756)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Refactor the code, rename_partition shares the same thrift API as alter_partition, we do alter_partition when part_vals is empty, we do rename_partition when part_vals is given &lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13069126" author="sdong" created="Thu, 21 Jul 2011 18:48:05 +0000"  >&lt;p&gt;I&apos;m looking at the patch. Please test the backward compatible between the old server, new client and new server, old client. Please come by if you don&apos;t know how to test it.&lt;/p&gt;</comment>
                            <comment id="13069146" author="jiraposter@reviews.apache.org" created="Thu, 21 Jul 2011 19:24:58 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1156&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1156&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Please try to add the new column in the middle first. If that works, we should do that way to make it consistent with alter_table() call. If that doesn&apos;t work, it&apos;s OK to add it to the end now.&lt;/p&gt;


&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment2385&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment2385&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why we still need another function call rename_partition_core()? Can&apos;t we just modify alter_partition_core() to always use the same logic?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Siying&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-21 01:20:25, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-21 01:20:25)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13072654" author="jiraposter@reviews.apache.org" created="Fri, 29 Jul 2011 02:40:09 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-07-29 02:39:50.879825)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Combine alter_partition_core and rename_partition_core together&lt;br/&gt;
Fix a bug: fs.rename(srcPath, destPath) will fail if destPath&apos;s parent directory doesn&apos;t exist.&lt;br/&gt;
So I call wh.mkdirs(destPath.getParent()) first then call rename function&lt;br/&gt;
change the thrift api to alter_partition(db_name, tbl_name, part_vals, new_part)&lt;br/&gt;
add setValues function in Partition.java&lt;br/&gt;
Test compatibility:&lt;br/&gt;
old client can talk to new server&lt;br/&gt;
new client can talk to old server&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13072656" author="weiyan" created="Fri, 29 Jul 2011 02:42:06 +0000"  >&lt;p&gt;Combine alter_rename_core and alter_partition_core together&lt;br/&gt;
Test compatibility issues.&lt;/p&gt;</comment>
                            <comment id="13088048" author="jiraposter@reviews.apache.org" created="Fri, 19 Aug 2011 22:53:27 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1572&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1572&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment3548&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment3548&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think you need to put old partition information into Input set.&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment3549&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment3549&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Can you be more specific in this Exception? Maybe &quot;Unable to rename partition to the same name&quot;?&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment3550&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment3550&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why is it related to dynamic partitioning? It shouldn&apos;t be related. If you can&apos;t get val from old partition spec, it should be an exception.&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment3552&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment3552&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Following the coding convention, else should be put after }&lt;/p&gt;



&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/1105/#comment3554&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#comment3554&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This message can be more specific, like: &quot;RENAME PARTITION Missing Destination&quot;?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Siying&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-29 02:39:50, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-29 02:39:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13088487" author="weiyan" created="Sun, 21 Aug 2011 22:29:08 +0000"  >&lt;p&gt;refactor codes&lt;/p&gt;</comment>
                            <comment id="13088625" author="jiraposter@reviews.apache.org" created="Mon, 22 Aug 2011 11:49:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-08-21 22:27:31.236138)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Refactor code&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13088626" author="jiraposter@reviews.apache.org" created="Mon, 22 Aug 2011 11:49:33 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-08-19 22:52:29, Siying Dong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t think so, because I already renamed the old partition to new one. If I run &quot;Partition part = db.getPartition(tbl, renamePartitionDesc.getOldPartSpec(), false);&quot;, I will get null instead.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Weiyan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/#review1572&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/#review1572&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-07-29 02:39:50, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-29 02:39:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Add a partition A in the table&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename partition A to partition B&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Show the partitions in the table, it returns partition B.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition A, it returns no results&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13095082" author="jiraposter@reviews.apache.org" created="Thu, 1 Sep 2011 02:25:10 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-09-01 02:23:59.714244)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;+    work.getInputs().add(new ReadEntity(oldPart));&lt;br/&gt;
+    work.getOutputs().add(new WriteEntity(newPart));&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1145366 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1145366 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1145366 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13095083" author="weiyan" created="Thu, 1 Sep 2011 02:25:44 +0000"  >&lt;p&gt;+    work.getInputs().add(new ReadEntity(oldPart));&lt;br/&gt;
+    work.getOutputs().add(new WriteEntity(newPart));&lt;/p&gt;</comment>
                            <comment id="13129224" author="sdong" created="Mon, 17 Oct 2011 21:27:48 +0000"  >&lt;p&gt;Weiyan, can you rebase it?&lt;/p&gt;</comment>
                            <comment id="13132828" author="namit" created="Fri, 21 Oct 2011 17:03:06 +0000"  >&lt;p&gt;Weiyan, please address Siying&apos;s comments &lt;/p&gt;</comment>
                            <comment id="13132977" author="sdong" created="Fri, 21 Oct 2011 19:34:03 +0000"  >&lt;p&gt;Weiyan, I ran test against the the rebased patch. Tests failed and seem to be real bugs. Maybe the auto-conflict resolving didn&apos;t work well. Can you take a look?&lt;/p&gt;</comment>
                            <comment id="13136716" author="jiraposter@reviews.apache.org" created="Thu, 27 Oct 2011 02:13:32 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-10-27 02:14:56.306830)&lt;/p&gt;


&lt;p&gt;Review request for Siying Dong.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Fix the unit test errors. &lt;br/&gt;
They are all parsing errors. &lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Implement ALTER TABLE PARTITION RENAME function to rename a partition. &lt;br/&gt;
Add HiveQL syntax &quot;ALTER TABLE bar PARTITION (k1=&apos;v1&apos;, k2=&apos;v2&apos;) RENAME TO PARTITION (k1=&apos;v3&apos;, k2=&apos;v4&apos;);&quot;&lt;br/&gt;
This is my first Hive diff, I just learn everything from existing codebase and may not have a good understanding on it. &lt;br/&gt;
Feel free to inform me if I make something wrong. Thanks&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1186991 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java 1186991 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java 1186991 &lt;br/&gt;
  trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java 1186991 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out PRE-CREATION &lt;br/&gt;
  trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1105/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1105/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Add a partition A in the table&lt;br/&gt;
Rename partition A to partition B&lt;br/&gt;
Show the partitions in the table, it returns partition B.&lt;br/&gt;
SELECT the data from partition A, it returns no results&lt;br/&gt;
SELECT the data from partition B, it returns the data originally stored in partition A&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13139116" author="hudson" created="Sat, 29 Oct 2011 05:09:23 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1042 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1042/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1042/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt; ALTER TABLE RENAME PARTITION (Weiyan Wang via. Siying Dong)&lt;/p&gt;

&lt;p&gt;sdong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1190696&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1190696&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/if/hive_metastore.thrift&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/ObjectStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/RawStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/test/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/metadata/Partition.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/AlterTableDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/DDLWork.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/RenamePartitionDesc.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientnegative/alter_rename_partition_failure3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/alter_rename_partition.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/alter_rename_partition_authorization.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/alter_rename_partition.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13146865" author="jiraposter@reviews.apache.org" created="Wed, 9 Nov 2011 08:59:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2783/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2783/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-09 08:58:03.327969)&lt;/p&gt;


&lt;p&gt;Review request for hive, Siying Dong and Kevin Wilfong.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null&lt;/p&gt;

&lt;p&gt;Run the &quot;ant test&quot;. Only load_fs.q fails, but after I revert the patch and run &quot;ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false&quot; it still fails. So I think it&apos;s not a bug introduced by my patch&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/metastore/if/hive_metastore.thrift 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199598 &lt;br/&gt;
  trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199598 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199598 &lt;br/&gt;
  trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199598 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2783/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2783/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Weiyan&lt;/p&gt;
</comment>
                            <comment id="13146867" author="jiraposter@reviews.apache.org" created="Wed, 9 Nov 2011 09:01:51 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-11-09 08:48:57, Kevin Wilfong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; I&apos;ll review this, but you should add another reviewer, like Siying, who has the authority to commit to Hive, as I do not.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Kevin Wilfong wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;As long as you&apos;re modifying fields, you should add hive to the Groups field and &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt; in the Bugs field.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sorry, I thought &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt; was the JIRA this review was for, it should really be &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2562&quot; title=&quot;HIVE-2247 Changed the Thrift API causing compatibility issues.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2562&quot;&gt;&lt;del&gt;HIVE-2562&lt;/del&gt;&lt;/a&gt; in the bugs field, that way everything that gets posted here will get posted on the JIRA as well.  Thanks for making these changes.  &lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Kevin&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/2783/#review3125&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2783/#review3125&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-11-09 08:58:03, Weiyan Wang wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/2783/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2783/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-11-09 08:58:03)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive, Siying Dong and Kevin Wilfong.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;keep the old api alter_partition, and add the new api alter_rename_partition. In the server side, alter_partition calls alter_rename_partition with part_vals = null&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Run the &quot;ant test&quot;. Only load_fs.q fails, but after I revert the patch and run &quot;ant clean package; ant test -Dtestcase=TestCliDriver -Dqfile=load_fs.q -Dtest.silent=false&quot; it still fails. So I think it&apos;s not a bug introduced by my patch&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2247&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/if/hive_metastore.thrift 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java 1199598 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/2783/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/2783/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Weiyan&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13148118" author="hudson" created="Thu, 10 Nov 2011 23:37:53 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1075 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1075/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1075/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2562&quot; title=&quot;HIVE-2247 Changed the Thrift API causing compatibility issues.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2562&quot;&gt;&lt;del&gt;HIVE-2562&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2247&quot; title=&quot;ALTER TABLE RENAME PARTITION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2247&quot;&gt;&lt;del&gt;HIVE-2247&lt;/del&gt;&lt;/a&gt; Changed the Thrift API causing compatibility issues. (Weiyan Wang via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1200442&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1200442&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/metastore/if/hive_metastore.thrift&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-php/hive_metastore/ThriftHiveMetastore.php&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/gen/thrift/gen-rb/thrift_hive_metastore.rb&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/metastore/src/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13398322" author="rsm" created="Thu, 21 Jun 2012 10:01:00 +0000"  >&lt;p&gt;Can we get this patch in? We have a usecase where some partitions were created with the wrong names. There seems to be no easy way to fix the names of the partitions directly in hive.&lt;/p&gt;</comment>
                            <comment id="13398618" author="namit" created="Thu, 21 Jun 2012 17:34:41 +0000"  >&lt;p&gt;This is a pretty old patch. I dont think anyone is working on it right now.&lt;br/&gt;
I will try to refresh it, and see how it applies&lt;/p&gt;</comment>
                            <comment id="13398814" author="sdong" created="Thu, 21 Jun 2012 20:06:16 +0000"  >&lt;p&gt;I committed the patch 7 months ago. Forgot to resolve it. Thanks Weiyan!&lt;/p&gt;</comment>
                            <comment id="13443778" author="qwertymaniac" created="Wed, 29 Aug 2012 03:26:49 +0000"  >&lt;p&gt;Can someone mark a Fix Version for this JIRA please? It is unclear.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12501017" name="HIVE-2247.10.patch.txt" size="194507" author="weiyan" created="Thu, 27 Oct 2011 02:08:59 +0000"/>
                            <attachment id="12501409" name="HIVE-2247.11.patch.txt" size="194507" author="weiyan" created="Sat, 29 Oct 2011 00:05:07 +0000"/>
                            <attachment id="12486385" name="HIVE-2247.3.patch.txt" size="347086" author="weiyan" created="Wed, 13 Jul 2011 23:06:15 +0000"/>
                            <attachment id="12486782" name="HIVE-2247.4.patch.txt" size="348550" author="weiyan" created="Mon, 18 Jul 2011 00:06:16 +0000"/>
                            <attachment id="12487247" name="HIVE-2247.5.patch.txt" size="186045" author="weiyan" created="Thu, 21 Jul 2011 01:18:47 +0000"/>
                            <attachment id="12488167" name="HIVE-2247.6.patch.txt" size="190700" author="weiyan" created="Fri, 29 Jul 2011 02:42:06 +0000"/>
                            <attachment id="12491161" name="HIVE-2247.7.patch.txt" size="190741" author="weiyan" created="Sun, 21 Aug 2011 22:29:08 +0000"/>
                            <attachment id="12492565" name="HIVE-2247.8.patch.txt" size="191127" author="weiyan" created="Thu, 1 Sep 2011 02:25:44 +0000"/>
                            <attachment id="12499912" name="HIVE-2247.9.patch.txt" size="194774" author="weiyan" created="Thu, 20 Oct 2011 19:27:22 +0000"/>
                            <attachment id="12499911" name="HIVE-2247.9.patch.txt" size="194774" author="weiyan" created="Thu, 20 Oct 2011 19:26:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 3 Jul 2011 05:12:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42208</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 21 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123748</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2248] Comparison Operators convert number types to common type instead of double if possible</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2248</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Now if the two sides of comparison is of different type, we always convert both to double and compare. It was a slight regression from the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1638&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1638&lt;/a&gt;. The old UDFOP&amp;lt;Comparison&amp;gt;, using GenericUDFBridge, always tried to find common type first.&lt;/p&gt;

&lt;p&gt;The worse case is this: If you did &quot;WHERE &amp;lt;BIGINT_COLUMN&amp;gt; = 0 &quot;, we always convert the column and 0 to double and compare, which is wasteful, though it is usually a minor costs in the system. But it is easy to fix.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512393">HIVE-2248</key>
            <summary>Comparison Operators convert number types to common type instead of double if possible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jun 2011 23:04:42 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:00 +0000</updated>
                            <resolved>Fri, 1 Jul 2011 01:53:21 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13058127" author="namit" created="Thu, 30 Jun 2011 23:17:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13058178" author="namit" created="Fri, 1 Jul 2011 01:53:21 +0000"  >&lt;p&gt;Committed. Thanks Siying&lt;/p&gt;</comment>
                            <comment id="13058221" author="hudson" created="Fri, 1 Jul 2011 05:28:02 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #803 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/803/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/803/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2248&quot; title=&quot;Comparison Operators convert number types to common type instead of double if possible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2248&quot;&gt;&lt;del&gt;HIVE-2248&lt;/del&gt;&lt;/a&gt; Comparison Operators convert number types to common type instead of&lt;br/&gt;
          double if necessary (Siying Dong via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1141777&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1141777&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBaseCompare.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12484838" name="HIVE-2248.1.patch" size="1993" author="sdong" created="Thu, 30 Jun 2011 23:14:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Jun 2011 23:17:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66857</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2249] When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2249</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;The current code to build constant expression for numbers, here is the code:&lt;/p&gt;

&lt;p&gt;     try &lt;/p&gt;
{
        v = Double.valueOf(expr.getText());
        v = Long.valueOf(expr.getText());
        v = Integer.valueOf(expr.getText());
      }
&lt;p&gt; catch (NumberFormatException e) &lt;/p&gt;
{
        // do nothing here, we will throw an exception in the following block
      }
&lt;p&gt;      if (v == null) &lt;/p&gt;
{
        throw new SemanticException(ErrorMsg.INVALID_NUMERICAL_CONSTANT
            .getMsg(expr));
      }
&lt;p&gt;      return new ExprNodeConstantDesc(v);&lt;/p&gt;


&lt;p&gt;The for the case that &quot;WHERE &amp;lt;BIG_INT_COLUMN&amp;gt; = 0&quot;, or &quot;WHERE &amp;lt;DOUBLE_COLUMN&amp;gt; = 0&quot;, we always have to do a type conversion when comparing, which is unnecessary if it is slightly smarter to choose type when creating the constant expression. We can simply walk one level up the tree, find another comparison party and use the same type with that one if it is possible. For user&apos;s wrong query like &apos;&amp;lt;INT_COLUMN&amp;gt;=1.1&apos;, we can even do more.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512396">HIVE-2249</key>
            <summary>When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhiqiu">Zhiqiu Kong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jun 2011 23:43:51 +0000</created>
                <updated>Wed, 9 Jan 2013 10:23:31 +0000</updated>
                            <resolved>Tue, 31 Jan 2012 06:40:36 +0000</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13069713" author="barillari" created="Fri, 22 Jul 2011 20:26:11 +0000"  >&lt;p&gt;As explained in the comments in TypeCheckProcFactory, this patch implements this fix. It also optimizes impossible comparisons (int column and double constant) to FALSE. &lt;/p&gt;

&lt;p&gt;It also includes a new unit test, type_matching.q. Note that this test does (and should) produce slightly different output between the trunk version and the patched version, since it runs EXPLAIN SELECT on several queries that this patch will modify, so the string outputs (e.g., &quot;22&quot; vs &quot;22.0&quot; are different.)&lt;/p&gt;</comment>
                            <comment id="13070811" author="sdong" created="Mon, 25 Jul 2011 22:10:50 +0000"  >&lt;p&gt;Joseph, can you handle the string case too?&lt;/p&gt;</comment>
                            <comment id="13191892" author="zhiqiu" created="Tue, 24 Jan 2012 05:17:11 +0000"  >&lt;p&gt;This patch adds support to smartly infer the constant&apos;s type when encountering the query like &quot;column CMP constant&quot;, where CMP could be any of the comparators supported by Hive. This aims to improving the performance by moving the type conversion from runtime stage to compiling stage.&lt;/p&gt;

&lt;p&gt;To be more detailed, the smart type inference will happen when the type of the column is on e of the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TINYINT&lt;/li&gt;
	&lt;li&gt;SMALLINT&lt;/li&gt;
	&lt;li&gt;INT&lt;/li&gt;
	&lt;li&gt;BIGINT&lt;/li&gt;
	&lt;li&gt;FLOAT&lt;/li&gt;
	&lt;li&gt;DOUBLE&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If the type of the columns fits any of the above, the constant on the other hand side will be converted firstly to the column&apos;s type. When failing, the constant will then be converted to DOUBLE. If both tries fail, the constant will be left as what type it is.&lt;/p&gt;

&lt;p&gt;One exception is when the column is STRING while the constant is BIGINT. In this case, we do nothing. Otherwise, the constant will be converted to DOUBLE.&lt;/p&gt;

&lt;p&gt;Other improvements include returning false immediately for the query like &quot;int_col = not_convertable_double_constant&quot;, such as &quot;uid = 1.5&quot;.&lt;/p&gt;


&lt;p&gt;NOTE:&lt;/p&gt;

&lt;p&gt;~130 unit test cases need to be updated due to this diff. All updates are limited to convert to the plan like &quot;col = 10&quot; to &quot;col = 10.0&quot;, and are carefully checked individually. &lt;/p&gt;

&lt;p&gt;TWO test cases failed during the unit testing:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;testCliDriver_insert2_overwrite_partitions&lt;/li&gt;
	&lt;li&gt;testCliDriver_ppr_pushdown&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;When looking into the query as well as the output, the plans generated were found to be the same while the query results changed. As the queries in these two cases are simple select queries, maybe the default sorting criteria was changed unintentionally by this diff or other diffs. &lt;/p&gt;
</comment>
                            <comment id="13192534" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 21:24:43 +0000"  >&lt;p&gt;zhiqiu requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;br/&gt;
Reviewers: njain, kevinwilfong, heyongqiang, JIRA&lt;/p&gt;

&lt;p&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; Smart type inference of constants&lt;/p&gt;

&lt;p&gt;  This patch adds support to smartly infer the constant&apos;s type when&lt;br/&gt;
  encountering the query like &quot;column CMP constant&quot;, where CMP could be&lt;br/&gt;
  any of the comparators supported by Hive. This aims to improving the&lt;br/&gt;
  performance by moving the type conversion from runtime stage to&lt;br/&gt;
  compiling stage.&lt;/p&gt;

&lt;p&gt;  To be more detailed, the smart type inference will happen when the type&lt;br/&gt;
  of the column is one of the followings:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TINYINT&lt;/li&gt;
	&lt;li&gt;SMALLINT&lt;/li&gt;
	&lt;li&gt;INT&lt;/li&gt;
	&lt;li&gt;BIGINT&lt;/li&gt;
	&lt;li&gt;FLOAT&lt;/li&gt;
	&lt;li&gt;DOUBLE&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  If the type of the columns fits any of the above, the constant on the&lt;br/&gt;
  other hand side will be converted firstly to the column&apos;s type.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;TINYINT =&amp;gt; Byte&lt;/li&gt;
	&lt;li&gt;SMALLINT =&amp;gt; Short&lt;/li&gt;
	&lt;li&gt;INT =&amp;gt; Integer&lt;/li&gt;
	&lt;li&gt;BIGINT =&amp;gt; Long&lt;/li&gt;
	&lt;li&gt;FLOAT =&amp;gt; Float&lt;/li&gt;
	&lt;li&gt;DOUBLE =&amp;gt; Double&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  If failing, the constant will then be converted to DOUBLE. If both tries&lt;br/&gt;
  fail, the constant will be left as what type it is.&lt;/p&gt;

&lt;p&gt;  One exception is when the column is STRING while the constant is BIGINT.&lt;br/&gt;
  In this case, we do nothing. Otherwise, the constant will be converted&lt;br/&gt;
  to DOUBLE.&lt;/p&gt;

&lt;p&gt;  Other improvements include returning false immediately for the query&lt;br/&gt;
  like &quot;int_col = not_convertable_double_constant&quot;, such as &quot;uid = 1.5&quot;.&lt;/p&gt;

&lt;p&gt;  NOTE:&lt;/p&gt;

&lt;p&gt;  ~130 unit test cases need to be updated due to this diff. All updates&lt;br/&gt;
  are limited to convert to the plan like &quot;col = 10&quot; to &quot;col = 10.0&quot;, and&lt;br/&gt;
  are carefully checked individually.&lt;/p&gt;

&lt;p&gt;  TWO test cases failed during the unit testing:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;testCliDriver_insert2_overwrite_partitions&lt;/li&gt;
	&lt;li&gt;testCliDriver_ppr_pushdown&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  When looking into the query as well as the output, the plans generated&lt;br/&gt;
  were found to be the same while the query results changed. As the&lt;br/&gt;
  queries in these two cases are simple select queries, maybe the default&lt;br/&gt;
  sorting criteria was changed unintentionally by this diff or other&lt;br/&gt;
  diffs.&lt;/p&gt;

&lt;p&gt;  Task ID: #620808&lt;/p&gt;

&lt;p&gt;  Blame Rev:&lt;/p&gt;

&lt;p&gt;  The current code to build constant expression for numbers, here is the code:&lt;/p&gt;

&lt;p&gt;       try &lt;/p&gt;
{
          v = Double.valueOf(expr.getText());
          v = Long.valueOf(expr.getText());
          v = Integer.valueOf(expr.getText());
        }
&lt;p&gt; catch (NumberFormatException e) &lt;/p&gt;
{
          // do nothing here, we will throw an exception in the following block
        }
&lt;p&gt;        if (v == null) &lt;/p&gt;
{
          throw new SemanticException(ErrorMsg.INVALID_NUMERICAL_CONSTANT
              .getMsg(expr));
        }
&lt;p&gt;        return new ExprNodeConstantDesc(v);&lt;/p&gt;

&lt;p&gt;  The for the case that &quot;WHERE &amp;lt;BIG_INT_COLUMN&amp;gt; = 0&quot;, or &quot;WHERE &amp;lt;DOUBLE_COLUMN&amp;gt; = 0&quot;, we always have to do a type conversion when comparing, which is unnecessary if it is slightly smarter to choose type when creating the constant expression. We can simply walk one level up the tree, find another comparison party and use the same type with that one if it is possible. For user&apos;s wrong query like &apos;&amp;lt;INT_COLUMN&amp;gt;=1.1&apos;, we can even do more.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Run unit tests.&lt;/p&gt;

&lt;p&gt;  TWO test cases failed during the unit testing:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;testCliDriver_insert2_overwrite_partitions&lt;/li&gt;
	&lt;li&gt;testCliDriver_ppr_pushdown&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  When looking into the query as well as the output, the plans generated&lt;br/&gt;
  were found to be the same while the query results changed. As the&lt;br/&gt;
  queries in these two cases are simple select queries, maybe the default&lt;br/&gt;
  sorting criteria was changed unintentionally by this diff or other&lt;br/&gt;
  diffs.&lt;/p&gt;

&lt;p&gt;  Revert Plan:&lt;/p&gt;

&lt;p&gt;  Tags:&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  contrib/src/test/results/clientpositive/dboutput.q.out&lt;br/&gt;
  contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cast1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/create_view.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/having.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input1_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input2_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input42.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join34.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join35.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join38.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join39.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/no_hooks.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/order2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/pcr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_transform.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/quote1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regex_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regexp_extract.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_hour.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_like.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_lower.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_minute.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_second.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union_ppr.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/cast1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_part1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join8.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/subq.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/udf1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/union.q.xml&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/2901/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/2901/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13193227" author="phabricator@reviews.facebook.net" created="Wed, 25 Jan 2012 19:15:39 +0000"  >&lt;p&gt;kevinwilfong has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;  I looked at the tests that were failing:&lt;/p&gt;

&lt;p&gt;  insert2_overwrite_partitions.q orders by the column one, but since there are several rows with the same value in column one, this does not guarantee a the rows will be returned in the same order, and hence, with the limit 5, you are not guaranteed to get the same rows.  I&apos;m not sure why your change would cause the order to differ, but it shouldn&apos;t be an issue.&lt;/p&gt;

&lt;p&gt;  It looks like the order by was added to try and make the test deterministic.  Since your code can&apos;t be committed if tests are failing, could you change the order by to be on one, two.  This should guarantee you get the same rows every time.&lt;/p&gt;

&lt;p&gt;  Also, it would probably be worth while to do this in insert1_overwrite_partitions.q as well, as it does a similar order by.&lt;/p&gt;

&lt;p&gt;  I haven&apos;t been able to reproduce a failure in ppr_pushdown.q so far.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:709-712 This is never used.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13193245" author="phabricator@reviews.facebook.net" created="Wed, 25 Jan 2012 19:43:39 +0000"  >&lt;p&gt;zhiqiu has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;  Thanks a lot, Kevin! I&apos;ll remove the un-used lines.&lt;/p&gt;

&lt;p&gt;  Just tried to update insert2_overwrite_partitions.q and insert1_overwrite_partitions.q to add &quot;order by&quot; clause.&lt;/p&gt;

&lt;p&gt;  For ppr_pushdown, I think you analyses also apply. It failed on my side b/c the query like this:&lt;/p&gt;

&lt;p&gt;      select * from ppr_test where ds = &apos;1234&apos;&lt;/p&gt;

&lt;p&gt;  The results on my machine are:&lt;br/&gt;
      1234  1234&lt;br/&gt;
      abcd   1234&lt;/p&gt;

&lt;p&gt;  while the &quot;expected&quot; outputs are:&lt;br/&gt;
      abcd 1234&lt;br/&gt;
      1234 1234&lt;/p&gt;

&lt;p&gt;  So I think it is good to also add &quot;order by&quot; to this case, right?&lt;/p&gt;






&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13193387" author="phabricator@reviews.facebook.net" created="Wed, 25 Jan 2012 22:00:40 +0000"  >&lt;p&gt;zhiqiu has planned changes to the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Remove unused lines (the set doubleTypes)&lt;/li&gt;
	&lt;li&gt;Fix the test cases by adding &quot;sort by&quot; clause to the query: 1. insert1_overwrite_partitions.q  2. insert2_overwrite_partitions.q  3. ppr_pushdown&lt;/li&gt;
	&lt;li&gt;Add test case for this new change on smart type inference&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13194058" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 18:33:40 +0000"  >&lt;p&gt;zhiqiu updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;br/&gt;
Reviewers: njain, kevinwilfong, heyongqiang, JIRA, stuart983&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Address Kevin&apos;s comments: fix the failed test cases (insert1_overwrite_partitions.q, 2. insert2_overwrite_partitions.q 3. ppr_pushdown)&lt;/li&gt;
	&lt;li&gt;Add a unit test to verify the smart type inference works (infer_const_type.q)&lt;/li&gt;
	&lt;li&gt;Remove un-used lines and fix a bug that str_col = long_const does not return false&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  contrib/src/test/results/clientpositive/dboutput.q.out&lt;br/&gt;
  contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/infer_const_type.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert1_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert2_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/ppr_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cast1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/create_view.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/having.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_const_type.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input1_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input2_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input42.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join34.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join35.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join38.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join39.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/no_hooks.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/order2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/pcr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_transform.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/quote1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regex_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regexp_extract.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_hour.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_like.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_lower.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_minute.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_second.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union_ppr.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/cast1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_part1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join8.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/subq.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/udf1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/union.q.xml&lt;/p&gt;</comment>
                            <comment id="13194485" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 05:37:38 +0000"  >&lt;p&gt;stuart983 has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:739 Instead of passing false, I think we should leave the operation tree as what it is to keep absolute compatible.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13194488" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 05:43:40 +0000"  >&lt;p&gt;stuart983 has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/test/queries/clientpositive/infer_const_type.q:1 I think it&apos;s better to drop the table first.&lt;br/&gt;
  ql/src/test/queries/clientpositive/infer_const_type.q:34 It&apos;s better to not only explain it, but also execute it and see the results are right.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13194968" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 18:12:09 +0000"  >&lt;p&gt;kevinwilfong has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:739 I agree. Looking at the implementation of ExprNodeGenericFuncDesc.newInstance, comparing a string and a bigint will either throw an exception, or display a warning depending on configuration settings, but that functionality will be lost for the case of comparing a column and a constant if false is returned.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13194976" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 18:22:10 +0000"  >&lt;p&gt;zhiqiu updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;br/&gt;
Reviewers: njain, kevinwilfong, heyongqiang, JIRA, stuart983&lt;/p&gt;

&lt;p&gt;  Address Siying&apos;s and Kevin&apos;s comments&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;For string_col = long_const, no smart type inference is done&lt;/li&gt;
	&lt;li&gt;Add query to test case to verify the results are correct&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  contrib/src/test/results/clientpositive/dboutput.q.out&lt;br/&gt;
  contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;br/&gt;
  data/files/infer_const_type.txt&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/infer_const_type.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert1_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert2_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/ppr_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cast1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/create_view.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/having.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_const_type.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input1_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input2_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input42.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join34.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join35.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join38.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join39.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/no_hooks.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/order2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/pcr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_transform.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/quote1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regex_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regexp_extract.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_hour.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_like.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_lower.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_minute.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_second.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union_ppr.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/cast1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_part1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join8.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/subq.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/udf1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/union.q.xml&lt;/p&gt;</comment>
                            <comment id="13194986" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 18:30:10 +0000"  >&lt;p&gt;stuart983 has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:735 It&apos;s not what I mean. Instead of translating the long value to double, you should keep it as long, and leave the next step to deal with it, either showing a warning or failing the query.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13195025" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 19:10:10 +0000"  >&lt;p&gt;zhiqiu has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java:735 Yes. And that&apos;s why I use !constType.equalsIgnoreCase(Constants.BIGINT_TYPE_NAME).&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13196535" author="phabricator@reviews.facebook.net" created="Mon, 30 Jan 2012 23:23:09 +0000"  >&lt;p&gt;stuart983 has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13196703" author="phabricator@reviews.facebook.net" created="Tue, 31 Jan 2012 05:13:08 +0000"  >&lt;p&gt;zhiqiu updated the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot;.&lt;br/&gt;
Reviewers: njain, kevinwilfong, heyongqiang, JIRA, stuart983&lt;/p&gt;

&lt;p&gt;  Fix insert1_overwrite_partitions.q and insert2_overwrite_partitions.q thus the results are deterministic&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1383&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  contrib/src/test/results/clientpositive/dboutput.q.out&lt;br/&gt;
  contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;br/&gt;
  data/files/infer_const_type.txt&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;br/&gt;
  ql/src/test/queries/clientpositive/infer_const_type.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert1_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/insert2_overwrite_partitions.q&lt;br/&gt;
  ql/src/test/queries/clientpositive/ppr_pushdown.q&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join27.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join28.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join29.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/auto_join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cast1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/cluster.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/create_view.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/having.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_auto_update.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_compression.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/infer_const_type.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input11_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input14_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input18.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input1_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input2_limit.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input42.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/input_part7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join0.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join11.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join12.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join14.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join16.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join21.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join23.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join34.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join35.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join38.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join39.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join40.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join5.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join6.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join7.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/join8.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/no_hooks.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/notable_alias2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/order2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/pcr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_transform.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/quote1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regex_col.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/regexp_extract.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/semijoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/skewjoin.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/subq2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf1.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf9.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_hour.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_like.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_lower.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_minute.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_second.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/udf_union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union20.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union22.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union24.q.out&lt;br/&gt;
  ql/src/test/results/clientpositive/union_ppr.q.out&lt;br/&gt;
  ql/src/test/results/compiler/plan/cast1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input2.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input3.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/input_part1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join4.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join5.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join6.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join7.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/join8.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/subq.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/udf1.q.xml&lt;br/&gt;
  ql/src/test/results/compiler/plan/union.q.xml&lt;/p&gt;</comment>
                            <comment id="13196740" author="sdong" created="Tue, 31 Jan 2012 06:40:17 +0000"  >&lt;p&gt;committed. Thanks Zhiqiu!&lt;/p&gt;</comment>
                            <comment id="13196844" author="hudson" created="Tue, 31 Jan 2012 11:41:04 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1233 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1233/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1233/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double (Zhiqiu Kong via Siying Dong)&lt;/p&gt;

&lt;p&gt;sdong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1238175&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1238175&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/contrib/src/test/results/clientpositive/dboutput.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/infer_const_type.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/infer_const_type.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/insert1_overwrite_partitions.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/insert2_overwrite_partitions.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ppr_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join0.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join16.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join21.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join23.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join27.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join28.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join29.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/cast1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/cluster.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/create_view.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/having.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_update.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_compression.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_stale.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/infer_const_type.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input11_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input14_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input18.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input1_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input2_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input42.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join0.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join16.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join21.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join23.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join34.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join35.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join38.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join39.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join40.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/multi_insert.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/no_hooks.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/notable_alias1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/notable_alias2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/order2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/pcr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_transform.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppr_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/quote1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/regex_col.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/regexp_extract.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/semijoin.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/skewjoin.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/subq.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/subq2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf9.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hour.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_like.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_lower.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_minute.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_second.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_union.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union22.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union24.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/cast1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input2.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input3.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input4.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input_part1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join4.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join5.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join6.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join7.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join8.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/subq.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/udf1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/union.q.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13265267" author="ashutoshc" created="Mon, 30 Apr 2012 21:11:24 +0000"  >&lt;p&gt;This issue is closed now. It was released with the fix in 0.9.0. If there is a problem, please open a new jira and link this one with that.&lt;/p&gt;</comment>
                            <comment id="13547903" author="hudson" created="Wed, 9 Jan 2013 10:23:31 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2249&quot; title=&quot;When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2249&quot;&gt;&lt;del&gt;HIVE-2249&lt;/del&gt;&lt;/a&gt; When creating constant expression for numbers, try to infer type from another comparison operand, instead of trying to use integer first, and then long and double (Zhiqiu Kong via Siying Dong) (Revision 1238175)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
sdong : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1238175&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1238175&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/contrib/src/test/results/clientpositive/dboutput.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/data/files/infer_const_type.txt&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/infer_const_type.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/insert1_overwrite_partitions.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/insert2_overwrite_partitions.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/ppr_pushdown.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join0.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join16.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join21.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join23.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join27.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join28.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join29.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/auto_join8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/cast1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/cluster.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/create_view.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/having.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_empty.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_file_format.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_multiple.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_self_join.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_unused.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_auto_update.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_auto.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_bitmap_compression.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_compression.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_stale.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/index_stale_partitioned.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/infer_const_type.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input11_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input14_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input18.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input1_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input2_limit.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input42.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/input_part7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join0.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join11.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join12.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join14.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join16.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join21.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join23.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join34.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join35.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join38.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join39.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join40.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join7.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/join8.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/load_dyn_part13.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/louter_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/multi_insert.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/no_hooks.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/noalias_subq1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/notable_alias1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/notable_alias2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/nullgroup4_multi_distinct.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/order2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/outer_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/pcr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_clusterby.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_multi_insert.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_outer_join1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_transform.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppd_udf_col.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppr_pushdown.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/ppr_pushdown3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/quote1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/rcfile_null_value.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/regex_col.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/regexp_extract.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/router_join_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/semijoin.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/set_processor_namespaces.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/skewjoin.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/subq.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/subq2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/transform_ppr1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/transform_ppr2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf1.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf9.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_10_trims.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_hour.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_like.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_lower.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_minute.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_parse_url.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_second.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/udf_union.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union20.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union22.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union24.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/union_ppr.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/cast1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input2.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input3.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input4.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/input_part1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join4.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join5.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join6.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join7.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/join8.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/subq.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/udf1.q.xml&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/plan/union.q.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12531725">HIVE-2586</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511728" name="ASF.LICENSE.NOT.GRANTED--HIVE-2249.D1383.1.patch" size="211393" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 21:24:44 +0000"/>
                            <attachment id="12512017" name="ASF.LICENSE.NOT.GRANTED--HIVE-2249.D1383.2.patch" size="237396" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 18:33:41 +0000"/>
                            <attachment id="12512208" name="ASF.LICENSE.NOT.GRANTED--HIVE-2249.D1383.3.patch" size="240987" author="phabricator@reviews.facebook.net" created="Fri, 27 Jan 2012 18:22:11 +0000"/>
                            <attachment id="12512532" name="ASF.LICENSE.NOT.GRANTED--HIVE-2249.D1383.4.patch" size="260321" author="phabricator@reviews.facebook.net" created="Tue, 31 Jan 2012 05:13:09 +0000"/>
                            <attachment id="12487473" name="HIVE-2249.1.patch.txt" size="47430" author="barillari" created="Fri, 22 Jul 2011 20:26:11 +0000"/>
                            <attachment id="12511626" name="HIVE-2249.2.patch.txt" size="219952" author="zhiqiu" created="Tue, 24 Jan 2012 05:17:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Jul 2011 20:26:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42207</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123750</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2250] &quot;DESCRIBE EXTENDED table_name&quot; shows inconsistent compression information.</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2250</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Commands executed in this order:&lt;/p&gt;

&lt;p&gt;user@node # hive&lt;br/&gt;
hive&amp;gt; SET hive.exec.compress.output=true; &lt;br/&gt;
hive&amp;gt; SET io.seqfile.compression.type=BLOCK;&lt;br/&gt;
hive&amp;gt; CREATE TABLE table_name ( &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; ) ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\t&apos; STORED AS SEQUENCEFILE;&lt;br/&gt;
hive&amp;gt; CREATE TABLE staging_table ( &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; ) ROW FORMAT DELIMITED FIELDS TERMINATED BY &apos;\t&apos;;&lt;br/&gt;
hive&amp;gt; LOAD DATA LOCAL INPATH &apos;file:///root/input/&apos; OVERWRITE INTO TABLE staging_table;&lt;br/&gt;
hive&amp;gt; INSERT OVERWRITE TABLE table_name SELECT * FROM staging_table;&lt;br/&gt;
(Map reduce job to change to sequence file...)&lt;br/&gt;
hive&amp;gt; DESCRIBE EXTENDED table_name;&lt;/p&gt;

&lt;p&gt;Detailed Table Information      Table(tableName:table_name, dbName:benchmarking, owner:root, createTime:1309480053, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:&lt;span class=&quot;error&quot;&gt;&amp;#91;FieldSchema(name:session_key, type:string, comment:null), FieldSchema(name:remote_address, type:string, comment:null), FieldSchema(name:canister_lssn, type:string, comment:null), FieldSchema(name:canister_session_id, type:bigint, comment:null), FieldSchema(name:tltsid, type:string, comment:null), FieldSchema(name:tltuid, type:string, comment:null), FieldSchema(name:tltvid, type:string, comment:null), FieldSchema(name:canister_server, type:string, comment:null), FieldSchema(name:session_timestamp, type:string, comment:null), FieldSchema(name:session_duration, type:string, comment:null), FieldSchema(name:hit_count, type:bigint, comment:null), FieldSchema(name:http_user_agent, type:string, comment:null), FieldSchema(name:extractid, type:bigint, comment:null), FieldSchema(name:site_link, type:string, comment:null), FieldSchema(name:dt, type:string, comment:null), FieldSchema(name:hour, type:int, comment:null)&amp;#93;&lt;/span&gt;, location:hdfs://hadoop2/user/hive/warehouse/benchmarking.db/table_name, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=   , field.delim=&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;SEE ABOVE: Compression is set to FALSE, even though contents of table is compressed.&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;RHEL, Full Cloudera stack&lt;/p&gt;</environment>
        <key id="12512486">HIVE-2250</key>
            <summary>&quot;DESCRIBE EXTENDED table_name&quot; shows inconsistent compression information.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="subramanian">subramanian raghunathan</assignee>
                                    <reporter username="tpowell">Travis Powell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2011 17:07:24 +0000</created>
                <updated>Wed, 15 Feb 2017 12:03:07 +0000</updated>
                                            <version>0.7.0</version>
                                                    <component>CLI</component>
                    <component>Diagnosability</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13100116" author="subramanian" created="Thu, 8 Sep 2011 07:13:21 +0000"  >&lt;p&gt;Handled the following scenarios &lt;/p&gt;

&lt;p&gt;Create table &lt;br/&gt;
Create table like&lt;br/&gt;
Alter table fileformat&lt;/p&gt;

&lt;p&gt;Based on the Inputformat if its type is secquenceFileFormat , then compression flag is set to true and vice versa.&lt;/p&gt;</comment>
                            <comment id="13133817" author="he yongqiang" created="Mon, 24 Oct 2011 03:25:41 +0000"  >&lt;p&gt;If a table&apos;s fileformat is seqfile, it does not mean the data is compressed. &lt;br/&gt;
I guess a better way to populate this information is from the MoveTask. eg a &apos;insert overwrite ...&apos; normally has 2 taks, one is the mapreduce task, which use the compression configuration, and the other is the load task which is a data load task. And i think they share the same conf.&lt;/p&gt;

&lt;p&gt;But not sure about how compression info for queries like &quot;load data local inpath &apos;&apos;&quot;.&lt;/p&gt;

&lt;p&gt;We can focus on correcting the &quot;insert overwrite &quot; in this task.&lt;/p&gt;</comment>
                            <comment id="13507271" author="qwertymaniac" created="Fri, 30 Nov 2012 11:20:44 +0000"  >&lt;p&gt;If we don&apos;t really make use of the IS_COMPRESSED attribute of a table, should we just get rid of it (or at least not print it in the &lt;tt&gt;describe extended/formatted&lt;/tt&gt; output, which causes great confusion as it is always certainly &lt;tt&gt;No&lt;/tt&gt;)?&lt;/p&gt;</comment>
                            <comment id="14502264" author="yibing" created="Mon, 20 Apr 2015 02:53:51 +0000"  >&lt;p&gt;+1&lt;br/&gt;
This is really confusing!&lt;/p&gt;</comment>
                            <comment id="15867705" author="viktor.gerdin" created="Wed, 15 Feb 2017 12:03:07 +0000"  >&lt;p&gt;+1 This is still a great confusion. (on Hive version 1.2.1.2.4)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12515560">HIVE-2316</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12493555" name="HIVE-2250.patch" size="12457" author="subramanian" created="Thu, 8 Sep 2011 07:10:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Sep 2011 07:13:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123751</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2251] wiki.apache.org/hadoop/Hive links all gone</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2251</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;SEO suicide. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Could you add a RewriteRule that issues redirects to the new wiki&apos;s home?&lt;/p&gt;

&lt;p&gt;RewriteRule ^/hadoop/Hive/(.*)  &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/$1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/$1&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;R=301&amp;#93;&lt;/span&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;&lt;a href=&quot;http://www.google.com/search?q=site%3Awiki.apache.org+inurl%3Ahive&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.google.com/search?q=site%3Awiki.apache.org+inurl%3Ahive&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="12512487">HIVE-2251</key>
            <summary>wiki.apache.org/hadoop/Hive links all gone</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cmb">Carlos Bueno</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2011 17:10:02 +0000</created>
                <updated>Fri, 1 Jul 2011 18:19:32 +0000</updated>
                            <resolved>Fri, 1 Jul 2011 18:19:32 +0000</resolved>
                                                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13058673" author="jvs" created="Fri, 1 Jul 2011 17:49:27 +0000"  >&lt;p&gt;The Apache Infrastructure team manages the servers, so you would need to create a ticket in the INFRA project instead.  The page name mapping isn&apos;t 1-for-1 due to different namespacing conventions, so the rule wouldn&apos;t be that straightforward.&lt;/p&gt;</comment>
                            <comment id="13058691" author="cmb" created="Fri, 1 Jul 2011 18:19:09 +0000"  >&lt;p&gt;Fair enough. opened &lt;a href=&quot;https://issues.apache.org/jira/browse/INFRA-3744&quot; title=&quot;wiki.apache.org/hadoop/Hive links all gone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;INFRA-3744&quot;&gt;&lt;del&gt;INFRA-3744&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Jul 2011 17:49:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69451</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 30 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123752</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2252] Display a sample of partitions created when Fatal Error occurred due to too many partitioned created</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2252</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In dynamic partition inserts, if a mapper created too many partitions, a fatal error is raised and the job got killed. Sometimes the error is caused by data error and it will be helpful for users to debug if we display a sample of dynamic partitions generated. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12512517">HIVE-2252</key>
            <summary>Display a sample of partitions created when Fatal Error occurred due to too many partitioned created</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="nzhang">Ning Zhang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2011 23:57:45 +0000</created>
                <updated>Fri, 16 Dec 2011 23:57:08 +0000</updated>
                            <resolved>Sat, 16 Jul 2011 06:44:10 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Diagnosability</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13060140" author="jiraposter@reviews.apache.org" created="Tue, 5 Jul 2011 21:34:18 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1013/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1013/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;In dynamic partition inserts, if a mapper created too many partitions, a fatal error is raised and the job got killed. Sometimes the error is caused by data error and it will be helpful for users to debug if we display a sample of dynamic partitions generated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2252&quot; title=&quot;Display a sample of partitions created when Fatal Error occurred due to too many partitioned created&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2252&quot;&gt;&lt;del&gt;HIVE-2252&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2252&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java 1141747 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1013/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1013/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;passed all unit tests. &lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ning&lt;/p&gt;
</comment>
                            <comment id="13066108" author="jiraposter@reviews.apache.org" created="Fri, 15 Jul 2011 18:21:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1013/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1013/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-07-15 18:20:41.419263)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;rebased on the current trunk&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;In dynamic partition inserts, if a mapper created too many partitions, a fatal error is raised and the job got killed. Sometimes the error is caused by data error and it will be helpful for users to debug if we display a sample of dynamic partitions generated.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2252&quot; title=&quot;Display a sample of partitions created when Fatal Error occurred due to too many partitioned created&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2252&quot;&gt;&lt;del&gt;HIVE-2252&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2252&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2252&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java 1147261 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1013/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1013/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;passed all unit tests. &lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ning&lt;/p&gt;
</comment>
                            <comment id="13066142" author="nzhang" created="Fri, 15 Jul 2011 19:14:07 +0000"  >&lt;p&gt;rebased based on current trunk&lt;/p&gt;</comment>
                            <comment id="13066177" author="namit" created="Fri, 15 Jul 2011 20:23:24 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13066371" author="namit" created="Sat, 16 Jul 2011 06:44:10 +0000"  >&lt;p&gt;Committed. Thanks Ning&lt;/p&gt;</comment>
                            <comment id="13066393" author="hudson" created="Sat, 16 Jul 2011 10:38:50 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #829 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/829/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/829/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2252&quot; title=&quot;Display a sample of partitions created when Fatal Error occurred due to too many partitioned created&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2252&quot;&gt;&lt;del&gt;HIVE-2252&lt;/del&gt;&lt;/a&gt; Display a sample of partitions created when Fatal Error&lt;br/&gt;
occurred due to too many partitioned created (Ning Zhang via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147365&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147365&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12486664" name="HIVE-2252.2.patch" size="2885" author="nzhang" created="Fri, 15 Jul 2011 19:14:07 +0000"/>
                            <attachment id="12485337" name="HIVE-2252.patch" size="2885" author="nzhang" created="Tue, 5 Jul 2011 21:30:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jul 2011 21:34:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 28 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123753</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2253] Merge failing of join tree in exceptional case</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2253</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In some very exceptional cases, SemanticAnayzer fails to merge join tree. Example is below.&lt;/p&gt;

&lt;p&gt;create table a (val1 int, val2 int)&lt;br/&gt;
create table b (val1 int, val2 int)&lt;br/&gt;
create table c (val1 int, val2 int)&lt;br/&gt;
create table d (val1 int, val2 int)&lt;br/&gt;
create table e (val1 int, val2 int)&lt;/p&gt;

&lt;p&gt;1. all same(single) join key --&amp;gt; one MR, good&lt;br/&gt;
select * from a join b on a.val1=b.val1 join c on a.val1=c.val1 join d on a.val1=d.val1 join e on a.val1=e.val1&lt;/p&gt;

&lt;p&gt;2. two join keys --&amp;gt; expected to have two MR, but resulted to three MR&lt;br/&gt;
select * from a join b on a.val1=b.val1 join c on a.val1=c.val1 join d on a.val1=d.val1 join e on a.val2=e.val2&lt;/p&gt;

&lt;p&gt;3. by changing the join order, we could attain two MR as first-expectation.&lt;br/&gt;
select * from a join e on a.val2=e.val2 join c on a.val1=c.val1 join d on a.val1=d.val1 join b on a.val1=b.val1&lt;/p&gt;</description>
                <environment>&lt;p&gt;hadoop 0.20.2, hive 0.7.0&lt;/p&gt;</environment>
        <key id="12512698">HIVE-2253</key>
            <summary>Merge failing of join tree in exceptional case</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="navis">Navis</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Jul 2011 07:45:19 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:33 +0000</updated>
                            <resolved>Thu, 1 Dec 2011 20:28:05 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13060030" author="jvs" created="Tue, 5 Jul 2011 17:37:00 +0000"  >&lt;p&gt;We&apos;ll need a small unit test with EXPLAIN for this case.&lt;/p&gt;</comment>
                            <comment id="13060337" author="navis" created="Wed, 6 Jul 2011 07:24:30 +0000"  >&lt;p&gt;added unit test&lt;/p&gt;</comment>
                            <comment id="13061479" author="jvs" created="Thu, 7 Jul 2011 18:39:29 +0000"  >&lt;p&gt;If this patch is ready for review, click the Submit Patch button.&lt;/p&gt;</comment>
                            <comment id="13061858" author="navis" created="Fri, 8 Jul 2011 09:11:04 +0000"  >&lt;p&gt;missed granting ASF license part.&lt;/p&gt;</comment>
                            <comment id="13061859" author="navis" created="Fri, 8 Jul 2011 09:11:50 +0000"  >&lt;p&gt;minor fix.&lt;/p&gt;</comment>
                            <comment id="13063536" author="jvs" created="Mon, 11 Jul 2011 21:00:54 +0000"  >&lt;p&gt;Also please create a Review Board entry in reviews.apache.org.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/HowToContribute#HowToContribute-ReviewProcess&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/HowToContribute#HowToContribute-ReviewProcess&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13079824" author="navis" created="Fri, 5 Aug 2011 08:26:40 +0000"  >&lt;p&gt;changed to git patch&lt;/p&gt;</comment>
                            <comment id="13132308" author="navis" created="Fri, 21 Oct 2011 03:50:48 +0000"  >&lt;p&gt;merged to 0.8.0-SNAPSHOT&lt;/p&gt;</comment>
                            <comment id="13135237" author="namit" created="Tue, 25 Oct 2011 17:06:09 +0000"  >&lt;p&gt;@Navis, your code changes look good.&lt;br/&gt;
Thanks for catching this.&lt;/p&gt;

&lt;p&gt;For testing, the convention we have adopted is to have a test file for such a case.&lt;br/&gt;
Look at the *.q files in ql/src/test/queries/clientpositive&lt;/p&gt;

&lt;p&gt;Add a new .q file (say, mergejoins.q)&lt;br/&gt;
Add a explain plan in the .q file to check the number of map-reduce jobs etc.&lt;/p&gt;

&lt;p&gt;You can run the test by executing:&lt;/p&gt;

&lt;p&gt;ant test -Dtestcase=TestCliDriver -Dqfile=mergejoins.q &lt;/p&gt;

&lt;p&gt;Verify that the output file mergejoins.q.out is correct, and check it in&lt;br/&gt;
ql/src/results/clientpositive&lt;/p&gt;

</comment>
                            <comment id="13150295" author="jiraposter@reviews.apache.org" created="Tue, 15 Nov 2011 08:13:51 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1304/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1304/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-11-15 08:13:13.468713)&lt;/p&gt;


&lt;p&gt;Review request for hive and namit jain.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Rebased patch to trunk&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;It&apos;s very very rare case.. just for code completeness.&lt;/p&gt;

&lt;p&gt;&amp;lt;added&amp;gt; &lt;/p&gt;

&lt;p&gt;This case had happened in real query. It was not as rare as we thought. Fix this plz.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2253&quot; title=&quot;Merge failing of join tree in exceptional case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2253&quot;&gt;&lt;del&gt;HIVE-2253&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2253&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2253&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java d60ba09 &lt;br/&gt;
  ql/src/test/queries/clientpositive/mergejoins.q PRE-CREATION &lt;br/&gt;
  ql/src/test/results/clientpositive/mergejoins.q.out PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1304/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1304/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Test case added : clientpositive/mergejoins.q&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Navis&lt;/p&gt;
</comment>
                            <comment id="13155458" author="cwsteinbach" created="Tue, 22 Nov 2011 21:39:08 +0000"  >&lt;p&gt;Is this ready for review? If so, please change the status to Patch Available. Thanks.&lt;/p&gt;</comment>
                            <comment id="13161117" author="jvs" created="Thu, 1 Dec 2011 20:28:05 +0000"  >&lt;p&gt;+1, passed tests, committed to trunk.  Thanks Navis!&lt;/p&gt;</comment>
                            <comment id="13161334" author="hudson" created="Fri, 2 Dec 2011 01:03:09 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1117 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1117/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1117/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2253&quot; title=&quot;Merge failing of join tree in exceptional case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2253&quot;&gt;&lt;del&gt;HIVE-2253&lt;/del&gt;&lt;/a&gt;. Merge failing of join tree in exceptional case&lt;br/&gt;
(Navis Ryu via jvs)&lt;/p&gt;

&lt;p&gt;jvs : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1209226&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1209226&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/mergejoins.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/mergejoins.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12500080" name="HIVE-2253-0.8.0.patch" size="4362" author="navis" created="Fri, 21 Oct 2011 03:50:47 +0000"/>
                            <attachment id="12503721" name="HIVE-2253.1.patch.txt" size="9428" author="navis" created="Tue, 15 Nov 2011 08:04:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jul 2011 17:37:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42206</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2254] Provide an automatic recovery feature for Hive Server in case of failure</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2254</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;b&gt;Motivation&lt;/b&gt;&lt;br/&gt;
We are doing log analysis using Hive by submitting queries through Hive Server and we have provided Name Node HA and Job tracker HA to achieve the high availability but Currently Hive Server is a single point of failure. If the machine running Hive Server is down or broken, Hive service cannot be availed till someone notice the Hive Sever failure and bring it up till this time our log analysis is not continuing. To avoid this problem we need an automatic system that can detect the failure and make sure of the high availability of the Server.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Proposal&lt;/b&gt;&lt;br/&gt;
Deploy two Hive Servers. One of the Hive Server will act as active while the other one will be a Hot Standby. Here we need a system to decide which can be active and which can be standby and a failure detection mechanism it should detect if Active server is down or broken and trigger the switch over (standby to active). This failure detection mechanism will be based on Zookeeper (HA Agent).&lt;/p&gt;

&lt;p&gt;The clients of Hive Server should be configured with the address of both servers. While getting the connection it will detect the Active Hive Server &amp;amp; connect to it.&lt;/p&gt;

&lt;p&gt;While executing query Hive Server is down after starting Hive Server need to submit the query again but already executed query will run in the background. Continuing this query execution is no use so it is wastage of cluster resource. In this solution once active is down standby will become active to server and it will ensure to stop the already executed query execution (Hive tasks &amp;amp; MapRed jobs).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Hadoop 0.20.1, Hive0.8.0 and SUSE Linux Enterprise Server 10 SP2 (i586) - Kernel 2.6.16.60-0.21-smp (5)&lt;/p&gt;</environment>
        <key id="12512749">HIVE-2254</key>
            <summary>Provide an automatic recovery feature for Hive Server in case of failure</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="chinnalalam">Chinna Rao Lalam</assignee>
                                    <reporter username="chinnalalam">Chinna Rao Lalam</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 05:29:10 +0000</created>
                <updated>Mon, 1 Aug 2011 12:26:51 +0000</updated>
                                            <version>0.5.0</version>
                    <version>0.7.1</version>
                                                    <component>Clients</component>
                    <component>Query Processor</component>
                    <component>Server Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                    <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12508707">ZOOKEEPER-1080</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12488399" name="HIVE-2254.patch" size="156959" author="chinnalalam" created="Mon, 1 Aug 2011 12:25:55 +0000"/>
                            <attachment id="12485196" name="Hive Automatic Recovery Solution.pdf" size="182399" author="chinnalalam" created="Tue, 5 Jul 2011 05:41:42 +0000"/>
                            <attachment id="12488400" name="zk_les.jar" size="46933" author="chinnalalam" created="Mon, 1 Aug 2011 12:26:24 +0000"/>
                            <attachment id="12488401" name="zkclient-0.1.0.jar" size="97207" author="chinnalalam" created="Mon, 1 Aug 2011 12:26:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42205</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123755</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2255] uncomment test-shims in build.xml</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2255</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I saw this code in build.xml:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;target name=&quot;test&quot; depends=&quot;clean-test,jar-test&quot; description=&quot;Run tests&quot;&amp;gt;
  &amp;lt;!-- TODO: temp comment out for testing
    &amp;lt;antcall target=&quot;test-shims&quot;&amp;gt;
      &amp;lt;param name=&quot;hadoop.version.ant-internal&quot; value=&quot;${hadoop.security.version}&quot; /&amp;gt;
    &amp;lt;/antcall&amp;gt;
    --&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I used svn blame to trace it back to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-818&quot; title=&quot;Create a Hive CLI that connects to hive ThriftServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-818&quot;&gt;&lt;del&gt;HIVE-818&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512875">HIVE-2255</key>
            <summary>uncomment test-shims in build.xml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="nzhang">Ning Zhang</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 18:02:45 +0000</created>
                <updated>Tue, 5 Jul 2011 21:05:50 +0000</updated>
                            <resolved>Tue, 5 Jul 2011 21:05:50 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13060130" author="cwsteinbach" created="Tue, 5 Jul 2011 21:05:50 +0000"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2257&quot; title=&quot;Enable TestHadoop20SAuthBridge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2257&quot;&gt;&lt;del&gt;HIVE-2257&lt;/del&gt;&lt;/a&gt; (whoops)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jul 2011 21:05:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>69103</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d347:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74281</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2256] Better error message in CLI on invalid column name</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2256</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;In the CLI, if a user inputs an incorrect column name, we currently just print the bad column name in the query.  Typically, the user needs to &quot;describe&quot; the table to figure out the correct column.&lt;/p&gt;

&lt;p&gt;This patch prints out a list of valid column and partition names in the table when a user inputs an incorrect column name.&lt;/p&gt;

&lt;p&gt;e.g., &lt;br/&gt;
&lt;tt&gt;Error in semantic analysis: Invalid table alias or column reference &apos;col_does_not_exist&apos; (possible column names are: col1, col2)&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512882">HIVE-2256</key>
            <summary>Better error message in CLI on invalid column name</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sohanjain">Sohan Jain</assignee>
                                    <reporter username="sohanjain">Sohan Jain</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 19:28:45 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:46 +0000</updated>
                            <resolved>Tue, 26 Jul 2011 22:28:55 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                    <component>Diagnosability</component>
                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13060088" author="sohanjain" created="Tue, 5 Jul 2011 19:30:50 +0000"  >&lt;p&gt;The patch will probably need to edit test cases as well to account for the new error messages.&lt;/p&gt;</comment>
                            <comment id="13060133" author="sohanjain" created="Tue, 5 Jul 2011 21:15:53 +0000"  >&lt;p&gt;-Updated the outputs for unit tests.&lt;br/&gt;
-Fixed the error message to include the line number and position in the query of the invalid column.&lt;/p&gt;</comment>
                            <comment id="13061586" author="jiraposter@reviews.apache.org" created="Thu, 7 Jul 2011 21:01:16 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1031/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1031/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;In the CLI, if a user inputs an incorrect column name, we currently just print the bad column name in the query. Typically, the user needs to &quot;describe&quot; the table to figure out the correct column.&lt;/p&gt;

&lt;p&gt;This patch prints out a list of valid column and partition names in the table when a user inputs an incorrect column name.&lt;/p&gt;

&lt;p&gt;e.g., &lt;br/&gt;
Error in semantic analysis: Invalid table alias or column reference &apos;col_does_not_exist&apos; (possible column names are: col1, col2)&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2256&quot; title=&quot;Better error message in CLI on invalid column name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2256&quot;&gt;&lt;del&gt;HIVE-2256&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2256&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2256&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java 1140399 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/clustern4.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/input2.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/regex_col_groupby.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/semijoin1.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/semijoin2.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/semijoin3.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/clientnegative/semijoin4.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/compiler/errors/unknown_column4.q.out 1140399 &lt;br/&gt;
  trunk/ql/src/test/results/compiler/errors/unknown_column5.q.out 1140399 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1031/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1031/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Checked the outputs of relevant unit tests, and they looks good.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sohan&lt;/p&gt;
</comment>
                            <comment id="13071391" author="cwsteinbach" created="Tue, 26 Jul 2011 22:18:17 +0000"  >&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="13071395" author="cwsteinbach" created="Tue, 26 Jul 2011 22:28:55 +0000"  >&lt;p&gt;Committed to trunk. Thanks Sohan!&lt;/p&gt;</comment>
                            <comment id="13071500" author="hudson" created="Wed, 27 Jul 2011 03:52:02 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #852 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/852/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/852/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2256&quot; title=&quot;Better error message in CLI on invalid column name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2256&quot;&gt;&lt;del&gt;HIVE-2256&lt;/del&gt;&lt;/a&gt;. Better error message in CLI on invalid column name (Sohan Jain via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1151280&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1151280&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/semijoin2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/semijoin3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/semijoin4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/udf/UDAFPercentile.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/regex_col_groupby.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/clustern4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/errors/unknown_column4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/compiler/errors/unknown_column5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/input2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/TypeCheckProcFactory.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/RowResolver.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientnegative/semijoin1.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485315" name="HIVE-2256.1.patch" size="2623" author="sohanjain" created="Tue, 5 Jul 2011 19:30:50 +0000"/>
                            <attachment id="12485333" name="HIVE-2256.2.patch" size="7295" author="sohanjain" created="Tue, 5 Jul 2011 21:15:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Jul 2011 21:01:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66841</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123756</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2257] Enable TestHadoop20SAuthBridge</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2257</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Looks like this test was accidentally disabled in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-818&quot; title=&quot;Create a Hive CLI that connects to hive ThriftServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-818&quot;&gt;&lt;del&gt;HIVE-818&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512890">HIVE-2257</key>
            <summary>Enable TestHadoop20SAuthBridge</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="cwsteinbach">Carl Steinbach</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 20:45:15 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:58 +0000</updated>
                            <resolved>Wed, 6 Jul 2011 00:14:50 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13060121" author="cwsteinbach" created="Tue, 5 Jul 2011 20:52:02 +0000"  >&lt;p&gt;TestHadoop20SAuthBridge passes with this patch in place. Currently running full regressions tests.&lt;/p&gt;</comment>
                            <comment id="13060128" author="nzhang" created="Tue, 5 Jul 2011 21:03:13 +0000"  >&lt;p&gt;oops, my fault. I remembered there was some issues in that test, but forgot to change it back. &lt;/p&gt;

&lt;p&gt;+1 on this. &lt;/p&gt;</comment>
                            <comment id="13060212" author="nzhang" created="Wed, 6 Jul 2011 00:14:50 +0000"  >&lt;p&gt;Committed. Thanks Carl!&lt;/p&gt;</comment>
                            <comment id="13060306" author="hudson" created="Wed, 6 Jul 2011 05:55:58 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #809 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/809/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/809/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2257&quot; title=&quot;Enable TestHadoop20SAuthBridge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2257&quot;&gt;&lt;del&gt;HIVE-2257&lt;/del&gt;&lt;/a&gt;. Enable TestHadoop20SAuthBridge (Carl Steinbach via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1143233&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1143233&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/build.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485329" name="HIVE-2257-test-shims.1.patch.txt" size="554" author="cwsteinbach" created="Tue, 5 Jul 2011 20:51:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jul 2011 21:03:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05inj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30119</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2258] Honor -S flag during hadoop rmr command</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2258</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently even if -S flag is specified, the output of hadoop -rmr command is printed to the screen.&lt;br/&gt;
The reason is that the command writes output to screen instead of log file.&lt;/p&gt;

&lt;p&gt;I have fixed the problem by temporarily redirecting the output for that command.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512895">HIVE-2258</key>
            <summary>Honor -S flag during hadoop rmr command</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="vaggarw">Vaibhav Aggarwal</assignee>
                                    <reporter username="vaggarw">Vaibhav Aggarwal</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 21:09:53 +0000</created>
                <updated>Fri, 5 Aug 2011 02:33:35 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13079753" author="jghoman" created="Fri, 5 Aug 2011 02:23:58 +0000"  >&lt;p&gt;Vaibhav - can you please create a review board for this patch?  Also, I&apos;m a bit confused - won&apos;t this hide the output for the rmr regardless of -S is set?  Moreover, the current Hive documentation says the -S will only emit data, but isn&apos;t the message from rmr (generally that a file has been moved to the trash) is also data?  If not, should we be consistent and suppress all the output of the shell commands?  &lt;/p&gt;</comment>
                            <comment id="13079760" author="jghoman" created="Fri, 5 Aug 2011 02:33:35 +0000"  >&lt;p&gt;Canceling patch post-review.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485332" name="HIVE-2258.patch" size="1315" author="vaggarw" created="Tue, 5 Jul 2011 21:15:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Aug 2011 02:23:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42204</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lj6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>


<item>
            <title>[HIVE-2259] Skip comments in hive script</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2259</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;If you specify something like:&lt;/p&gt;

&lt;p&gt;&amp;#8211; This is a comment&lt;br/&gt;
add jar jar_path;&lt;br/&gt;
select * from my_table;&lt;/p&gt;

&lt;p&gt;This fails.&lt;/p&gt;

&lt;p&gt;I have created a fix to skip the commented lines.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512896">HIVE-2259</key>
            <summary>Skip comments in hive script</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vaggarw">Vaibhav Aggarwal</assignee>
                                    <reporter username="vaggarw">Vaibhav Aggarwal</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 21:21:06 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:57 +0000</updated>
                            <resolved>Fri, 15 Jul 2011 04:46:05 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13065053" author="cwsteinbach" created="Thu, 14 Jul 2011 05:19:01 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13065712" author="cwsteinbach" created="Fri, 15 Jul 2011 04:46:05 +0000"  >&lt;p&gt;Committed to trunk. Thanks Vaibhav!&lt;/p&gt;</comment>
                            <comment id="13065760" author="hudson" created="Fri, 15 Jul 2011 08:26:17 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #828 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/828/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/828/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2259&quot; title=&quot;Skip comments in hive script&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2259&quot;&gt;&lt;del&gt;HIVE-2259&lt;/del&gt;&lt;/a&gt;. Skip comments in hive script (Vaibhav Aggarwal via cws)&lt;/p&gt;

&lt;p&gt;cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1146960&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1146960&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13070204" author="ihadanny" created="Sun, 24 Jul 2011 16:12:20 +0000"  >&lt;p&gt;Hey, what about /* style comments? &lt;br/&gt;
this also fails: /&lt;b&gt;pretty comment&lt;/b&gt;/drop table BABA;&lt;br/&gt;
with this error message: Query returned non-zero code: 11, cause: FAILED: Parse Error: line 1:0 cannot recognize input &apos;/&apos;&lt;/p&gt;</comment>
                            <comment id="13070205" author="ihadanny" created="Sun, 24 Jul 2011 16:15:04 +0000"  >&lt;p&gt;oops, wiki-markup-fail. meant:&lt;br/&gt;
this also fails: / * pretty comment * /drop table BABA;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485335" name="HIVE-2259.patch" size="609" author="vaggarw" created="Tue, 5 Jul 2011 21:22:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 14 Jul 2011 05:19:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 27 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05ik7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30104</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[HIVE-2260] ExecDriver::addInputPaths should pass the table properties to the record writer</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2260</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results).  However, when it does this and calls &lt;tt&gt;getHiveRecordWriter()&lt;/tt&gt;, it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;

&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as &lt;a href=&quot;http://bit.ly/iwEQzJ&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Haivvreo&lt;/a&gt;).  The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512906">HIVE-2260</key>
            <summary>ExecDriver::addInputPaths should pass the table properties to the record writer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jghoman">Jakob Homan</assignee>
                                    <reporter username="jghoman">Jakob Homan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jul 2011 22:42:17 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:33 +0000</updated>
                            <resolved>Sat, 16 Jul 2011 15:28:56 +0000</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13060179" author="jghoman" created="Tue, 5 Jul 2011 22:44:06 +0000"  >&lt;p&gt;Patch takes the Properties from the table/partition and passes it to the RecordWriter.  This fixes the issue Haivvreo runs into.  &lt;/p&gt;

&lt;p&gt;The patch doesn&apos;t include a unit test, since this is pretty far into the guts of ExecDriver.  I&apos;d be happy to write one up and introduce Mockito, which I think is the only reasonable way of getting to this code path, if others think it&apos;s worthwhile.&lt;/p&gt;</comment>
                            <comment id="13060222" author="jiraposter@reviews.apache.org" created="Wed, 6 Jul 2011 00:46:16 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1014/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1014/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results). However, when it does this and calls getHiveRecordWriter(), it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;

&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as Haivvreo). The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2260&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1014/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1014/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jakob&lt;/p&gt;
</comment>
                            <comment id="13060756" author="jghoman" created="Wed, 6 Jul 2011 18:46:46 +0000"  >&lt;p&gt;Tests pass except filter_join_breaktask, which failed once during the full test run, but I&apos;ve not been able to re-produce it again.  This is ready for review.&lt;/p&gt;</comment>
                            <comment id="13063740" author="jiraposter@reviews.apache.org" created="Tue, 12 Jul 2011 06:18:00 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/1014/#review1036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1014/#review1036&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Changes look good. &lt;br/&gt;
Is it possible to add a testcase? If not, can you update the jira how it is tested?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Amareshwari&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-07-06 00:45:12, Jakob Homan wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/1014/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1014/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-07-06 00:45:12)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hive.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Currently when ExecDriver encounters a non-existent partition, it creates an empty file so that the query will be valid (and return 0 results). However, when it does this and calls getHiveRecordWriter(), it creates a new instance of Properties, rather than providing the Properties associated with the table.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This causes RecordWriters that pull information from the table through the Properties to fail (such as Haivvreo). The RecordWriter should be provided the table&apos;s Properties, as it is in all other cases where it&apos;s called.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2260&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java 4fba845 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/1014/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1014/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jakob&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13064916" author="jghoman" created="Wed, 13 Jul 2011 22:29:08 +0000"  >&lt;p&gt;resonding to RB comment.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Is it possible to add a testcase? If not, can you update the jira how it is tested?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Adding a testcase isn&apos;t possible without something like Mockito, since this is buried deep within the guts of a private method that calls many methods and creates new instances of classes from calls to getClass().  Even then it would take about a dozen mocks and be amazingly fragile.  This code is certainly ripe for refactoring to ease testing.&lt;/p&gt;

&lt;p&gt;This was manually tested (and deployed to our cluster).  The manual test is to prune on a non-existent partition while using an input format like Haivvreo&apos;s, which makes use of the Properties instance.  Without the patch, the call fails.  With the patch, it succeeds with the behavior as described in &lt;tt&gt;ExecDriver.java&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;ExecDriver&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// If the query references non-existent partitions
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// We need to add a empty file, it is not acceptable to change the
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; tree
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// Consider the query:
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// select * from (select count(1) from T union all select count(1) from
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// T2) x;
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// If T is empty and T2 contains 100 rows, the user expects: 0, 100 (2
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// rows)&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13065758" author="jghoman" created="Fri, 15 Jul 2011 08:19:35 +0000"  >&lt;p&gt;Is there anything else that needs to be done to get a code review or commit on this patch?&lt;/p&gt;</comment>
                            <comment id="13066113" author="nzhang" created="Fri, 15 Jul 2011 18:27:21 +0000"  >&lt;p&gt;+1. Looks good to me. Will commit if tests pass. &lt;/p&gt;</comment>
                            <comment id="13066444" author="nzhang" created="Sat, 16 Jul 2011 15:28:56 +0000"  >&lt;p&gt;Committed. Thanks Jakob!&lt;/p&gt;</comment>
                            <comment id="13066511" author="hudson" created="Sat, 16 Jul 2011 19:26:48 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #830 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/830/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/830/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2260&quot; title=&quot;ExecDriver::addInputPaths should pass the table properties to the record writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2260&quot;&gt;&lt;del&gt;HIVE-2260&lt;/del&gt;&lt;/a&gt;. ExecDriver::addInputPaths should pass the table properties to the record writer (Jakob Homan via Ning Zhang)&lt;/p&gt;

&lt;p&gt;nzhang : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147436&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1147436&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485344" name="HIVE-2260.patch" size="1518" author="jghoman" created="Tue, 5 Jul 2011 22:44:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 6 Jul 2011 00:46:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05ikf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30105</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
