<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:14:07 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2010-6-16+AND+created+%3C%3D+2010-6-23+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="5" total="5"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-579] Add RPC Payloads and Better Histograms to Stats Package</title>
                <link>https://issues.apache.org/jira/browse/AVRO-579</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description></description>
                <environment></environment>
        <key id="12467148">AVRO-579</key>
            <summary>Add RPC Payloads and Better Histograms to Stats Package</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12466926">AVRO-576</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pwendell">Patrick Wendell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jun 2010 03:21:43 +0000</created>
                <updated>Tue, 13 Dec 2011 19:06:49 +0000</updated>
                            <resolved>Thu, 24 Jun 2010 21:59:06 +0000</resolved>
                                                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94885</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e16v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79955</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-580] java: permit generic data within specific</title>
                <link>https://issues.apache.org/jira/browse/AVRO-580</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;It should be possible to intermix specific and generic data.  For example, if some fields of a record have specific classes defined, while others do not, the latter should use the generic representation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12467243">AVRO-580</key>
            <summary>java: permit generic data within specific</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jun 2010 17:28:55 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:54 +0000</updated>
                            <resolved>Wed, 21 Jul 2010 21:16:59 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12879875" author="philip" created="Thu, 17 Jun 2010 18:19:30 +0000"  >&lt;p&gt;I&apos;m not sure it&apos;s a good idea to encourage using multiple APIs in the same code.  Is this to facilitate making Pair easier to program (in which case, just duplicate the 10 lines of code?), or is there a genuine use case when you want to use one API for the first element of the pair, and a different API for the second element?&lt;/p&gt;</comment>
                            <comment id="12879876" author="cutting" created="Thu, 17 Jun 2010 18:22:48 +0000"  >&lt;p&gt;This can be implemented by making SpecificDatumReader, when it encounters a schema whose name corresponds to no defined class, run the superclass (GenericDatumReader) method.  Similarly, when SpecificDatumWriter encounters a non-specific class, it can punt to GenericDatumWriter.&lt;/p&gt;</comment>
                            <comment id="12879903" author="cutting" created="Thu, 17 Jun 2010 19:18:20 +0000"  >&lt;p&gt;&amp;gt; I&apos;m not sure it&apos;s a good idea to encourage using multiple APIs in the same code.&lt;/p&gt;

&lt;p&gt;The goal is actually to reduce the number of APIs.  Folks could use a single API (specific) to read &amp;amp; write data.  If they&apos;ve generated classes for records, those classes will be used, otherwise GenericRecord would be used.  The only reason to use GenericDatumReader and GenericDatumWriter explicitly would be to disable this, to force everything to use the generic representation, which might be useful if one must, e,g., walk data genericially.&lt;/p&gt;

&lt;p&gt;Alternately, instead of modifying SpecificDatumReader &amp;amp; SpecificDatumWriter, we could add a third kind of reader/writer that has this behaviour.&lt;/p&gt;

&lt;p&gt;&amp;gt; Is this to facilitate making Pair easier to program&lt;/p&gt;

&lt;p&gt;It may not even be required by Pair.  Pair can be implemented as a manually-written SpecificRecord, so that the specific reader/writer can handle it.   The generic writer can write instances of this (since it only requires IndexedRecord, which both SpecificRecord and GenericRecord implement) and the generic reader could similarly read instances of this, except for instance creation.  So, the least-lines of code way to implement this might be to use a subclass of GenericDatumReader when the user has requested generic data that special cases Pair.  But this subclass would be equivalent to changing SpecificDatumWriter to punt to GenericDatumWriter when it sees an unknown class, and that latter implementation is more generally useful.&lt;/p&gt;

&lt;p&gt;The specific/generic distinction is confusing.  Rather than telling folks who&apos;re, e.g., writing a mapreduce program that they need to decide which representation they&apos;ll use, we can tell them that, if they generate code it will be used, otherwise generic representations will be used.&lt;/p&gt;

&lt;p&gt;&amp;gt; is there a genuine use case when you want to use one API for the first element of the pair, and a different API for the second element?&lt;/p&gt;

&lt;p&gt;In reduce logic we&apos;d like to process pairs identically regardless of how their keys and values are represented, so using different classes makes for more work.  We could have a common interface for the two, but that&apos;s hard when one would naturally be a GenericRecord and the other a manually written class.&lt;/p&gt;

&lt;p&gt;Currently object trees must all be either specific or generic.  By extending SpecificRecord, one can intermix manually-written classes with specific classes, permitting things like a generic Pair&amp;lt;K,V&amp;gt; that&apos;s not easily handled by generated code, since the key/value schemas vary.  It seems to me that it&apos;d be a feature to be able to intermix generic data into trees too, simplifying lots of things.&lt;/p&gt;</comment>
                            <comment id="12881445" author="cutting" created="Tue, 22 Jun 2010 23:18:28 +0000"  >&lt;p&gt;Here&apos;s a patch that implements this, complete with a test.&lt;/p&gt;

&lt;p&gt;I intend to wait until at least &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-581&quot; title=&quot;java: add reducer that separates keys and values when map output is pairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-581&quot;&gt;&lt;del&gt;AVRO-581&lt;/del&gt;&lt;/a&gt; has proven this to be a useful approach before committing it.&lt;/p&gt;</comment>
                            <comment id="12890901" author="cutting" created="Wed, 21 Jul 2010 21:16:59 +0000"  >&lt;p&gt;I just committed this as a part of &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-581&quot; title=&quot;java: add reducer that separates keys and values when map output is pairs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-581&quot;&gt;&lt;del&gt;AVRO-581&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12467245">AVRO-581</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12447761" name="AVRO-580.patch" size="6597" author="cutting" created="Tue, 22 Jun 2010 23:18:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Jun 2010 18:19:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e173:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79956</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-581] java: add reducer that separates keys and values when map output is pairs</title>
                <link>https://issues.apache.org/jira/browse/AVRO-581</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;We should add a Pair&amp;lt;K,V&amp;gt; class, implementing SpecificRecord, that combines instances of two schemas (specific or generic).  Pairs would be compared by key, ignoring value.  The template for its schema would be:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.avro.mapred.Pair&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[
  {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&quot; &amp;lt;&amp;lt;insert key schema here&amp;gt;&amp;gt;},
  {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;order&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;ignore&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &amp;lt;&amp;lt;insert value schema&amp;gt;&amp;gt;}
]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When map outputs are instances of this class, a reducer may be used whose reduce method is something like:&lt;/p&gt;

&lt;p&gt;public abstract void reduce(K key, Iterable&amp;lt;V&amp;gt; values);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12467245">AVRO-581</key>
            <summary>java: add reducer that separates keys and values when map output is pairs</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jun 2010 17:40:08 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:55 +0000</updated>
                            <resolved>Wed, 21 Jul 2010 21:20:51 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12879861" author="cutting" created="Thu, 17 Jun 2010 17:41:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-580&quot; title=&quot;java: permit generic data within specific&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-580&quot;&gt;&lt;del&gt;AVRO-580&lt;/del&gt;&lt;/a&gt; is required to permit implementation of a Pair class that can wrap either specific or generic data.&lt;/p&gt;</comment>
                            <comment id="12879957" author="cutting" created="Thu, 17 Jun 2010 21:55:38 +0000"  >&lt;p&gt;Philip&apos;s asked what the Pair class might look like.  Here&apos;s a first pass:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Pair&amp;lt;K,V&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; SpecificRecord {
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Schema schema;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; K key;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; V value;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Pair(K key, Schema keySchema, V value, Schema valueSchema) {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.schema = getPairSchema(keySchema, valueSchema);
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.key = key;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.value = value;
  }
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;Schema,Map&amp;lt;Schema,Schema&amp;gt;&amp;gt; SCHEMA_CACHE = 
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; WeakHashMap&amp;lt;Schema,Map&amp;lt;Schema,Schema&amp;gt;&amp;gt;();
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Schema getPairSchema(Schema key, Schema value) {
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (SCHEMA_CACHE) {
      ... see schema template in comment above....
    }
  }
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; K key() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; key; }
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void key(K key) { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.key = key; }
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; V value() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value; }
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void value(V value) { &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.value = value; }

  &lt;span class=&quot;code-comment&quot;&gt;// IndexedRecord methods, used by reader/writers
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; get(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i) {
     &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (i) {
       &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 0: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; key;
       &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1: &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; value;
       &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ...
     } 
  }
  @SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void set(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; o) {
     &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (i) {
       &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 0: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.key = o;
       &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; 1: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.value = o;
       &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ...
     } 
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I believe this would work as-is with SpecificDatumReader/Writer so long as K and V are specific data that conform to the schemas provided.  It would also work with GenericDatumWriter if K and V are generic data conforming the the schemas provided.  It would not work with GenericDatumReader, since that&apos;s hardwired to always create a GenericData.Record for a record schema.&lt;/p&gt;

&lt;p&gt;When this is used for map output we can split outputs when passing them to Hadoop and then let Hadoop&apos;s reduce grouping support rather than layering our own as in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-513&quot; title=&quot;java mapreduce api should pass iterator of matching objects to reduce&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-513&quot;&gt;&lt;del&gt;AVRO-513&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12889309" author="cutting" created="Fri, 16 Jul 2010 20:30:42 +0000"  >&lt;p&gt;This patch implements the proposal.  It also includes the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-580&quot; title=&quot;java: permit generic data within specific&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-580&quot;&gt;&lt;del&gt;AVRO-580&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Map inputs and final outputs may be any type.  Map outputs for non-map-only jobs must be Pairs.  The default mapper casts inputs to pairs.  The default reducer pairs every value with its key.&lt;/p&gt;

&lt;p&gt;TestWordCount illustrates this new API.  The prior mapreduce API in Avro is replaced.&lt;/p&gt;</comment>
                            <comment id="12889954" author="cutting" created="Mon, 19 Jul 2010 18:23:00 +0000"  >&lt;p&gt;Updated version that permits SpecificDatumReader to construct Pair instances.&lt;/p&gt;

&lt;p&gt;I will commit this in the next day or so unless someone objects.&lt;/p&gt;</comment>
                            <comment id="12890091" author="cutting" created="Mon, 19 Jul 2010 23:30:08 +0000"  >&lt;p&gt;Some improvements suggested offline by Tom White:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;make AvroMapper and AvroReducer the default&lt;/li&gt;
	&lt;li&gt;don&apos;t make AvroMapper abstract&lt;/li&gt;
	&lt;li&gt;add Pair constructors with Void parameters for null schema&lt;/li&gt;
	&lt;li&gt;add missing AvroJob.getInputSchema() method.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12890307" author="tomwhite" created="Tue, 20 Jul 2010 16:41:35 +0000"  >&lt;p&gt;A few more comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;It would be nice to have a unit test for map-only jobs, since they exercise a different code path, and the output doesn&apos;t need to be a pair. For a map-only job I get a NPE if I don&apos;t call AvroJob.setOutputSchema() - calling AvroJob.setMapOutputSchema() was not sufficient.&lt;/li&gt;
	&lt;li&gt;A test using Specific types would be good, to test that it works properly with pairs.&lt;/li&gt;
	&lt;li&gt;Should configureAvroJob() only set the input format if it hasn&apos;t already been set? E.g. if I set AvroUtf8InputFormat before calling setInputSchema then it will be silently changed to AvroInputFormat.&lt;/li&gt;
	&lt;li&gt;Generating a Pair schema could be made more elegant for users by exposing Pair#getPairSchema() as a static method.&lt;/li&gt;
	&lt;li&gt;Not related to this patch, but it would be nice if generated specific classes had a copy constructor, and/or a copyInto() method, since it&apos;s a common pattern in reducers to save the state of an object since the objects are reused in the values iterator.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12890414" author="cutting" created="Tue, 20 Jul 2010 19:55:47 +0000"  >&lt;p&gt;&amp;gt; It would be nice to have a unit test for map-only jobs&lt;/p&gt;

&lt;p&gt;Good idea.  I added one that also tests the default mapper over weather data.&lt;/p&gt;

&lt;p&gt;&amp;gt; For a map-only job I get a NPE if I don&apos;t call AvroJob.setOutputSchema() - calling AvroJob.setMapOutputSchema() was not sufficient.&lt;/p&gt;

&lt;p&gt;The javadoc for setMapOutputSchema says you should only call it if it differs from the final output schema and that it must always be a Pair schema.  Is that not clear enough?&lt;/p&gt;

&lt;p&gt;&amp;gt; A test using Specific types would be good&lt;/p&gt;

&lt;p&gt;Good idea.  I added one that sorts weather data.&lt;/p&gt;

&lt;p&gt;&amp;gt; Should configureAvroJob() only set the input format if it hasn&apos;t already been set?&lt;/p&gt;

&lt;p&gt;Good idea.  Done.&lt;/p&gt;

&lt;p&gt;&amp;gt; Generating a Pair schema could be made more elegant for users by exposing Pair#getPairSchema() as a static method.&lt;/p&gt;

&lt;p&gt;Good idea.  Done.&lt;/p&gt;

&lt;p&gt;Note that, in addition to applying the patch, the two attached .avro binary files must to be placed in share/test/data.&lt;/p&gt;</comment>
                            <comment id="12890636" author="tomwhite" created="Wed, 21 Jul 2010 09:54:28 +0000"  >&lt;p&gt;&amp;gt; The javadoc for setMapOutputSchema says you should only call it if it differs from the final output schema and that it must always be a Pair schema. Is that not clear enough?&lt;/p&gt;

&lt;p&gt;It&apos;s clear, but I was going by analogy with Hadoop, where (I think) you can just call JobConf#setMapOutputKeyClass() and JobConf#setMapOutputValueClass() for map-only jobs. Could we do a similar thing for the Avro API?&lt;/p&gt;

&lt;p&gt;Otherwise, I&apos;m +1 on this.&lt;/p&gt;</comment>
                            <comment id="12890904" author="cutting" created="Wed, 21 Jul 2010 21:20:51 +0000"  >&lt;p&gt;&amp;gt; Could we do a similar thing for the Avro API?&lt;/p&gt;

&lt;p&gt;Sure.  I made it so that, with a map-only job, you can call either setOutputSchema() or setMapOutputSchema().&lt;/p&gt;

&lt;p&gt;&amp;gt; Otherwise, I&apos;m +1 on this.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews!&lt;/p&gt;

&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12467243">AVRO-580</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12461600">AVRO-513</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12449964" name="AVRO-581.patch" size="96539" author="cutting" created="Tue, 20 Jul 2010 19:55:47 +0000"/>
                            <attachment id="12449901" name="AVRO-581.patch" size="89191" author="cutting" created="Mon, 19 Jul 2010 23:30:08 +0000"/>
                            <attachment id="12449860" name="AVRO-581.patch" size="86543" author="cutting" created="Mon, 19 Jul 2010 18:23:00 +0000"/>
                            <attachment id="12449697" name="AVRO-581.patch" size="85007" author="cutting" created="Fri, 16 Jul 2010 20:30:41 +0000"/>
                            <attachment id="12449965" name="weather-sorted.avro" size="335" author="cutting" created="Tue, 20 Jul 2010 19:55:47 +0000"/>
                            <attachment id="12449966" name="weather.avro" size="358" author="cutting" created="Tue, 20 Jul 2010 19:55:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Jul 2010 16:41:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94887</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e17b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79957</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-582] java: add comment to generated code warning not to call set &amp; get</title>
                <link>https://issues.apache.org/jira/browse/AVRO-582</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Java&apos;s specific compiler generates classes with set(int, Object) and get(int) methods, used by the DatumReader and DatumWriter implementations to read and write instances.  These methods are not intended for users to call, but must be public.  We should add a comment to the generated code indicating this, to reduce confusion.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12467251">AVRO-582</key>
            <summary>java: add comment to generated code warning not to call set &amp; get</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jun 2010 18:46:24 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:55 +0000</updated>
                            <resolved>Fri, 23 Jul 2010 18:15:14 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12879953" author="philip" created="Thu, 17 Jun 2010 21:49:10 +0000"  >&lt;p&gt;+1 to Javadoc, but do we have flexibility to rename them?  Java APIs are riddled with gets and sets, whereas this is more like readInternal, writeInternal or something.&lt;/p&gt;</comment>
                            <comment id="12880029" author="scott_carey" created="Fri, 18 Jun 2010 01:17:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;do we have flexibility to rename them? Java APIs are riddled with gets and sets, whereas this is more like readInternal, writeInternal or something.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good idea.  Later we likely want to &apos;bean-ify&apos; these with getters and setters, and these keywords should be reserved for that purpose.  Unfortunately that is part of the IndexedRecord interface, so has a somewhat broader impact.  internalGet and internalSet might also be reasonable names for this.&lt;/p&gt;</comment>
                            <comment id="12891306" author="cutting" created="Thu, 22 Jul 2010 20:00:22 +0000"  >&lt;p&gt;Here&apos;s a patch for this.&lt;/p&gt;</comment>
                            <comment id="12891351" author="scott_carey" created="Thu, 22 Jul 2010 21:35:42 +0000"  >&lt;p&gt;+1 looks good&lt;/p&gt;</comment>
                            <comment id="12891702" author="cutting" created="Fri, 23 Jul 2010 18:15:14 +0000"  >&lt;p&gt;Thanks for the review, Scott.  I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12450205" name="AVRO-582.patch" size="1145" author="cutting" created="Thu, 22 Jul 2010 20:00:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Jun 2010 21:49:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e17j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79958</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-583] Bad error message if you try and name an array or a map: org.apache.avro.SchemaParseException: Undefined name: &quot;map&quot;</title>
                <link>https://issues.apache.org/jira/browse/AVRO-583</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Error message should be something like &quot;You can&apos;t name a map&quot;&lt;/p&gt;

&lt;p&gt;Broken schema:&lt;br/&gt;
{&lt;br/&gt;
  &quot;name&quot;:&quot;annoyance&quot;,&lt;br/&gt;
  &quot;type&quot;:&quot;record&quot;,&lt;br/&gt;
  &quot;fields&quot;:[&lt;/p&gt;
    {
      &quot;name&quot;:&quot;mymap&quot;,
      &quot;type&quot;:&quot;map&quot;,
      &quot;values&quot;:&quot;string&quot;
    }
&lt;p&gt;  ]&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Error:&lt;/p&gt;

&lt;p&gt;org.apache.avro.SchemaParseException: Undefined name: &quot;map&quot;&lt;br/&gt;
	at org.apache.avro.Schema.parse(Schema.java:876)&lt;br/&gt;
	at org.apache.avro.Schema.parse(Schema.java:912)&lt;br/&gt;
	at org.apache.avro.Schema.parse(Schema.java:796)&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12467639">AVRO-583</key>
            <summary>Bad error message if you try and name an array or a map: org.apache.avro.SchemaParseException: Undefined name: &quot;map&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="spullara">Sam Pullara</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Jun 2010 23:00:45 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:56 +0000</updated>
                            <resolved>Tue, 3 Aug 2010 23:04:32 +0000</resolved>
                                    <version>1.3.2</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12881442" author="cutting" created="Tue, 22 Jun 2010 23:14:30 +0000"  >&lt;p&gt;The bug in that schema is that, when a string is used as a type it&apos;s assumed to be a type name.&lt;/p&gt;

&lt;p&gt;I think the schema you intended is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;annoyance&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[
    {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;mymap&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: {&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;map&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;values&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;}}
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That should parse.&lt;/p&gt;

&lt;p&gt;Maybe we should prohibit the use of non-primitive type keywords as user type names,  e.g., &quot;map&quot;, &quot;record&quot;, &quot;enum&quot;, &quot;fixed&quot;, and &quot;array&quot; could be made reserved words.  That would permit us to generate a better error here.&lt;/p&gt;</comment>
                            <comment id="12881454" author="spullara" created="Tue, 22 Jun 2010 23:37:44 +0000"  >&lt;p&gt;Yeah, that is the schema I intended but it took me a while to figure out why it was failing.&lt;/p&gt;</comment>
                            <comment id="12890440" author="cutting" created="Tue, 20 Jul 2010 20:59:46 +0000"  >&lt;p&gt;Is there a bug here to fix, or should we just close this?&lt;/p&gt;</comment>
                            <comment id="12890456" author="scott_carey" created="Tue, 20 Jul 2010 21:28:06 +0000"  >&lt;p&gt;This error message confused me as well when first learning Avro.   The message led me in circles and does not point to what is wrong unless you already have a deeper understanding of Avro.&lt;/p&gt;

&lt;p&gt;Note that what is wrong here is the &lt;em&gt;type&lt;/em&gt; , not the name, and to a beginner the first &apos;gut&apos; response to that message is &apos;I set the name to &quot;mymap&quot;, not &quot;map&quot;, wtf?&apos;.&lt;/p&gt;

&lt;p&gt;If it said &apos;invalid name for type identifier, &quot;map&quot;&apos; it would be better, or ideally something more informative about what is valid in that location and why.&lt;/p&gt;

&lt;p&gt;The confusion for a beginner is that you see examples with fields like:&lt;/p&gt;

  {&quot;name&quot;: &quot;myfield&quot;, &quot;type&quot;: &quot;string&quot; }

&lt;p&gt;and so it makes sense to think that other built-in types work the same way, and so&lt;/p&gt;

   {&quot;name&quot;: &quot;mymap&quot;, &quot;type&quot;: &quot;map&quot;, &quot;values&quot;: &quot;string&quot;} 

&lt;p&gt;would work.&lt;/p&gt;

&lt;p&gt;The current error message does nothing to inform the beginner that &quot;map&quot; and &quot;array&quot; are different than &quot;string&quot; and &quot;int&quot; etc.  one is a named type and the other is not.&lt;/p&gt;


&lt;p&gt;I&apos;m not sure how much context we have when this error is thrown to be more informative, but it should be easy to do better than the current message.&lt;/p&gt;</comment>
                            <comment id="12894580" author="cutting" created="Mon, 2 Aug 2010 15:59:43 +0000"  >&lt;p&gt;Maybe we could change this error message to something like:&lt;/p&gt;

&lt;p&gt;X is not a defined name.  Field type must be a defined name or a &lt;/p&gt;
{&quot;type&quot;: ...}
&lt;p&gt; expression.&lt;/p&gt;

&lt;p&gt;Is that clearer?&lt;/p&gt;</comment>
                            <comment id="12894581" author="cutting" created="Mon, 2 Aug 2010 16:01:33 +0000"  >&lt;p&gt;Would it also help to give the name of the field?  So the error might then be:&lt;/p&gt;

&lt;p&gt;&quot;map&quot; is not a defined name.  Type of &quot;mymap&quot; field must be a defined name or a &lt;/p&gt;
{&quot;type&quot;: ...}
&lt;p&gt; expression.&lt;/p&gt;</comment>
                            <comment id="12894582" author="spullara" created="Mon, 2 Aug 2010 16:08:44 +0000"  >&lt;p&gt;The problem I have with those error messages is that &quot;map&quot; is the name of a defined type. It just happens to be a special case.  My deeper question is why this doesn&apos;t work? Is there a real problem naming and defining a map/array without nesting?&lt;/p&gt;</comment>
                            <comment id="12894593" author="cutting" created="Mon, 2 Aug 2010 16:45:41 +0000"  >&lt;p&gt;&amp;gt; The problem I have with those error messages is that &quot;map&quot; is the name of a defined type.&lt;/p&gt;

&lt;p&gt;The problem in part is that terms like &quot;type&quot;, &quot;name&quot; and &quot;defined&quot; are overloaded here.  &quot;map&quot; is a keyword, like &quot;type&quot;, and cannot alone be used to determine the type of a field.  The type of a field can either be a JSON string, naming a previously defined type, or a JSON object.&lt;/p&gt;

&lt;p&gt;&amp;gt; My deeper question is why this doesn&apos;t work? Is there a real problem naming and defining a map/array without nesting?&lt;/p&gt;

&lt;p&gt;So you propose that, in addition to permitting nested type expressions we permit flattened type expressions in fields.  That&apos;s possible.  How would metadata be handled?  For example, if someone put &quot;foo&quot;:&quot;bar&quot; in a field, would that be  a property of the Field, of its Schema, or both?  Worse yet, how about:&lt;/p&gt;

{&quot;name&quot;: &quot;myfield&quot;, &quot;type&quot;: &quot;record&quot;, &quot;name&quot;: &quot;myrecord&quot;, &quot;fields&quot;:[...] }

&lt;p&gt;Oops.  That has two names!  JSON objects are unordered, so we can&apos;t tell them apart!&lt;/p&gt;</comment>
                            <comment id="12894596" author="spullara" created="Mon, 2 Aug 2010 16:49:59 +0000"  >&lt;p&gt;Actually I was proposing you treat &quot;map&quot; and &quot;array&quot; just like &quot;record&quot;. In the same way &quot;record&quot; can have &quot;fields&quot;, &quot;map&quot; can have &quot;values&quot; and &quot;array&quot; can have &quot;items&quot;. It isn&apos;t clear to me why they are treated differently.&lt;/p&gt;</comment>
                            <comment id="12894609" author="cutting" created="Mon, 2 Aug 2010 17:24:28 +0000"  >&lt;p&gt;&amp;gt; It isn&apos;t clear to me why they are treated differently.&lt;/p&gt;

&lt;p&gt;I don&apos;t see how they are treated differently.  Can you provide some examples?&lt;/p&gt;</comment>
                            <comment id="12894618" author="scott_carey" created="Mon, 2 Aug 2010 17:50:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;&quot;map&quot; is not a defined name. Type of &quot;mymap&quot; field must be a defined name or a {&quot;type&quot;: ...} expression.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 Yes, I think that would prevent beginners from looking in the wrong place for the error in their schema.&lt;/p&gt;</comment>
                            <comment id="12894619" author="spullara" created="Mon, 2 Aug 2010 17:50:54 +0000"  >&lt;p&gt;Ah, you are right. Was again confusing defining the type name with defining the field name.  One breaking change that would probably fix this would be to change the &quot;name&quot; field for a field to &quot;field&quot; or something similar.  Then you could have:&lt;/p&gt;

{&quot;field&quot;: &quot;myfield&quot;, &quot;type&quot;: &quot;record&quot;, &quot;name&quot;: &quot;myrecord&quot;, &quot;fields&quot;:[...] }

{&quot;field&quot;: &quot;myfield&quot;, &quot;type&quot;: &quot;array&quot;, &quot;items&quot;:&quot;string&quot;}

{&quot;field&quot;: &quot;myfield&quot;, &quot;type&quot;: &quot;map&quot;, &quot;values&quot;:&quot;string&quot;}
</comment>
                            <comment id="12894669" author="cutting" created="Mon, 2 Aug 2010 19:40:03 +0000"  >&lt;p&gt;Here&apos;s a patch that improves the error message as I proposed above.&lt;/p&gt;</comment>
                            <comment id="12895074" author="cutting" created="Tue, 3 Aug 2010 23:04:32 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12451067" name="AVRO-583.patch" size="954" author="cutting" created="Mon, 2 Aug 2010 19:40:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Jun 2010 23:14:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94889</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 25 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e17r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79959</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
