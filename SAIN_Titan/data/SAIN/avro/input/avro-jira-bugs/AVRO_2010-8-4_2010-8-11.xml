<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:14:20 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2010-8-4+AND+created+%3C%3D+2010-8-11+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="6" total="6"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-605] Java: make Utf8 implement CharSequence</title>
                <link>https://issues.apache.org/jira/browse/AVRO-605</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;If Utf8 implemented CharSequence then interfaces could change to specify CharSequence and accept Utf8 or String interchangeably.&lt;/p&gt;

&lt;p&gt;This would be mostly back-compatible, except the method signatures of generated protocols would be different, so implementations would need to be updated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470824">AVRO-605</key>
            <summary>Java: make Utf8 implement CharSequence</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Aug 2010 18:22:59 +0000</created>
                <updated>Tue, 28 Dec 2010 21:10:20 +0000</updated>
                            <resolved>Tue, 10 Aug 2010 17:10:21 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12895356" author="cutting" created="Wed, 4 Aug 2010 18:41:17 +0000"  >&lt;p&gt;Here&apos;s a patch that implements this.  Tests pass.&lt;/p&gt;</comment>
                            <comment id="12895357" author="cutting" created="Wed, 4 Aug 2010 18:43:20 +0000"  >&lt;p&gt;Update patch to be root-relative.&lt;/p&gt;</comment>
                            <comment id="12895791" author="cutting" created="Thu, 5 Aug 2010 20:44:04 +0000"  >&lt;p&gt;Unless there are objections, I will commit this soon.  I think it is a great improvement to APIs, as it permits Utf8 and String to be intermixed.&lt;/p&gt;</comment>
                            <comment id="12895867" author="scott_carey" created="Thu, 5 Aug 2010 23:12:02 +0000"  >&lt;p&gt;Sounds like a useful change to me.  A few things will slow down due to the extra instanceof checks, but its a much more flexible API. &lt;/p&gt;

&lt;p&gt;I suspect that some will not properly reset the string via setLength(), there is some risk around mixing the mutable Utf8 type with the immutable String.&lt;/p&gt;

&lt;p&gt;Minor nit:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;   &lt;span class=&quot;code-comment&quot;&gt;/** Return length in bytes. */&lt;/span&gt;
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getLength() { &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; length; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lets clearly disambiguate getLength() from length().   Make it clear that getLength() is Utf8 byte count, and perhaps provide a doc link to the CharSequence.length() for those looking for the number of Java chars in the sequence. &lt;/p&gt;</comment>
                            <comment id="12895871" author="cutting" created="Thu, 5 Aug 2010 23:23:58 +0000"  >&lt;p&gt;&amp;gt; Lets clearly disambiguate getLength() from length().&lt;/p&gt;

&lt;p&gt;Should we rename get/setLength to be get/setByteLength?  This will break some folks, but might be worth it.&lt;/p&gt;</comment>
                            <comment id="12895903" author="scott_carey" created="Fri, 6 Aug 2010 00:59:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should we rename get/setLength to be get/setByteLength? This will break some folks, but might be worth it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If we were starting over, that would be a good plan.  If we don&apos;t want to break anyone, then we need extra explicit javadoc.   I&apos;m OK with breaking this and happy to recompile my code for 1.4, but I can see the API breakage causing trouble for others because the Utf8 class is highly likely to be used by client code prior to this CharSequence change.   Maybe we should make the new get/setByteLength methods, deprecate the old ones, and have the old ones simply call the new ones.    Then we can toss out the old ones in 1.5 or 1.6.&lt;/p&gt;</comment>
                            <comment id="12896065" author="tomwhite" created="Fri, 6 Aug 2010 16:02:47 +0000"  >&lt;p&gt;&amp;gt; there is some risk around mixing the mutable Utf8 type with the immutable String.&lt;/p&gt;

&lt;p&gt;This might be a good opportunity to add a comment to the Utf8 class documentation to say that it is mutable (unlike String), and not thread-safe.&lt;/p&gt;</comment>
                            <comment id="12896155" author="cutting" created="Fri, 6 Aug 2010 20:49:41 +0000"  >&lt;p&gt;New version of patch incorporating Scott &amp;amp; Tom&apos;s feedback:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;set/getLength are now deprecated in favor of set/getByteLength&lt;/li&gt;
	&lt;li&gt;added a javadoc comment about mutability of Utf8.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12896716" author="tomwhite" created="Mon, 9 Aug 2010 22:35:20 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;The patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="12896959" author="cutting" created="Tue, 10 Aug 2010 17:10:21 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                            <comment id="12907831" author="philip" created="Thu, 9 Sep 2010 23:57:24 +0000"  >&lt;p&gt;BTW, a caveat for those using this: Utf8(&quot;foo&quot;).equals(&quot;foo&quot;) is still false, so it&apos;s easy to get into a false sense of security with using Utf8&apos;s and Strings interchangeably.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12494201">AVRO-720</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12451464" name="AVRO-605.patch" size="42426" author="cutting" created="Fri, 6 Aug 2010 20:49:41 +0000"/>
                            <attachment id="12451248" name="AVRO-605.patch" size="40271" author="cutting" created="Wed, 4 Aug 2010 18:43:20 +0000"/>
                            <attachment id="12451247" name="AVRO-605.patch" size="38715" author="cutting" created="Wed, 4 Aug 2010 18:41:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Aug 2010 23:12:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 20 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1cn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79981</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-606] Add File-Based Span Storage to TracePlugin</title>
                <link>https://issues.apache.org/jira/browse/AVRO-606</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description></description>
                <environment></environment>
        <key id="12470843">AVRO-606</key>
            <summary>Add File-Based Span Storage to TracePlugin</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21146&amp;avatarType=issuetype">Sub-task</type>
                            <parent id="12466926">AVRO-576</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pwendell">Patrick Wendell</assignee>
                                    <reporter username="pwendell">Patrick Wendell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Aug 2010 22:21:19 +0000</created>
                <updated>Thu, 2 May 2013 02:29:29 +0000</updated>
                            <resolved>Fri, 13 Aug 2010 20:59:43 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12895466" author="pwendell" created="Wed, 4 Aug 2010 23:19:41 +0000"  >&lt;p&gt;This is the full diff from origin/HEAD and includes outstanding code for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-595&quot; title=&quot;Add Basic Trace Collection and Propagation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-595&quot;&gt;&lt;del&gt;AVRO-595&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;The exact set of new files (but only a subset of all of the changes) are shown in this git hash:&lt;br/&gt;
&lt;a href=&quot;http://github.com/pwendell/Avro/commit/c3127daa936a74db66b817ea97c6b9f5c1e24997&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://github.com/pwendell/Avro/commit/c3127daa936a74db66b817ea97c6b9f5c1e24997&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch is a preliminary file-based storage mechanism for Avro Trace.&lt;/p&gt;</comment>
                            <comment id="12895495" author="pwendell" created="Thu, 5 Aug 2010 00:42:51 +0000"  >&lt;p&gt;This is the same patch, but only the incremental diff from &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-595&quot; title=&quot;Add Basic Trace Collection and Propagation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-595&quot;&gt;&lt;del&gt;AVRO-595&lt;/del&gt;&lt;/a&gt; which has been committed.&lt;/p&gt;</comment>
                            <comment id="12895754" author="philip" created="Thu, 5 Aug 2010 17:56:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;simply drop oldest file if&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Nit: missing &quot;the&quot;, and perhaps insert a &quot;we&quot; in there, to indicate that this is what the code does.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;private Long currentTimestamp&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why not &quot;long&quot;?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;private static int SECONDS_PER_FILE = 60 * 10; // ten minute chunks&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Consider making this configurable.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;catch (InterruptedException e1) {

I think (http://www.ibm.com/developerworks/java/library/j-jtp05236.html) you&apos;re supposed to call Thread.currentThread().interrupt(); at this point.  I kind of hate this part of Java.

You could also allow yourself to get interrupted, as a flow control mechanism.

Look around to see what other Hadoop worker threads do.

bq. } catch (IOException e) {&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You should probably log the exception.&lt;/p&gt;

&lt;p&gt;You should also probably catch all Throwables, and log those too.  If you don&apos;t, your thread tends to die, and nobody tends to know where it went.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;this.spansSoFar -= spansPerFile.get(oldest);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is this always the same as this.spansSoFar = 0?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;if (createNewFile) {&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Wouldn&apos;t you want to set spansSoFar to 0 if you&apos;re writing a new file?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+  private static String TRACE_FILE_DIR = &quot;/tmp&quot;;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This stuff ought to be configurable.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Thread writer;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why not private?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+  Boolean writerEnabled;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why not primitive type?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;private static void addFileSpans&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;this feels like &quot;readFileSpans()&quot; more so than &quot;add&quot;.  &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;private static void addFileSpans&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You could do binary search here, but for now it&apos;s probably fine to just indicate that it&apos;s linear.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;public static void setFileGranularityForTesting(int granularity) {&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Package-private (default) is probably good enough here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;protected void finalize() {&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Finalize is almost always a bad idea; why is this here?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;// TODO Auto-generated method stub&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Throw UnsupportedOperationException() here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;* @param start UNIX time (in nanoseconds) as a long&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Huh?  I thought this was millis/1000, i.e., seconds and not nanos.&lt;/p&gt;</comment>
                            <comment id="12895756" author="philip" created="Thu, 5 Aug 2010 18:01:23 +0000"  >&lt;p&gt;Pressed &quot;add&quot; quite early.&lt;/p&gt;

&lt;p&gt;Looks reasonable, for the most part.  It feels a bit odd that the reader and writer of these log directories are the same class, still.  That might be worth splitting up at some point.  Instead of keeping a list of all previous files, you could also simply scan the directory and look around.  Note that it&apos;s possible to add some metadata to AVRO data files when you open them, so you might store the open time in the header.  (The close time would require a seek...).  That way, you could retrieve spans across restarts.&lt;/p&gt;</comment>
                            <comment id="12896639" author="pwendell" created="Mon, 9 Aug 2010 17:49:12 +0000"  >&lt;blockquote&gt;
&lt;p&gt;this.spansSoFar -= spansPerFile.get(oldest);&lt;br/&gt;
Is this always the same as this.spansSoFar = 0?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No. spansSoFar tracks spans stored in &lt;b&gt;all files&lt;/b&gt; which is what the limit applies to. So this is just subtracting the spans of the most recently deleted file.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Wouldn&apos;t you want to set spansSoFar to 0 if you&apos;re writing a new file?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Same answer.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Boolean writerEnabled;&lt;br/&gt;
Why not primitive type?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is passed by reference to the thread so that the parent thread can signal the child to stop if it wishes. Is there a better way to do this?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;@param start UNIX time (in nanoseconds) as a long&lt;br/&gt;
Huh? I thought this was millis/1000, i.e., seconds and not nanos.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I changed from milli to nanoseconds to support implementations which have better clock granularity. Currently I don&apos;t think any systems offer granularity better than microseconds (1*10^-6) but don&apos;t see any reason not to be more specific if there is no additional overhead. &lt;/p&gt;</comment>
                            <comment id="12896724" author="pwendell" created="Mon, 9 Aug 2010 22:55:31 +0000"  >&lt;p&gt;Hey Phil,&lt;/p&gt;

&lt;p&gt;I addressed all of the small things.&lt;/p&gt;

&lt;p&gt;For persistent storage - this gets very difficult to do if we don&apos;t enforce that there is only one TracePlugin running at a time. If multiple TracePlugin&apos;s are running at the same time, and they both are managing the files in that directory, we don&apos;t have any good way to coordinate the deletion of files. It turns into a consistency nightmare.&lt;/p&gt;

&lt;p&gt;I have some code that does persistent storage in a local branch, but I&apos;m going to punt it until we decide to make this into a Factory method, or figure out in more detail the context in which a TracePlugin is going to run.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Patrick&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12897386" author="philip" created="Wed, 11 Aug 2010 18:54:04 +0000"  >&lt;p&gt;Looks good.&lt;/p&gt;

&lt;p&gt;I don&apos;t see &quot;writerEnabled&quot; being used, except to set it to true once.  Am I missing something?  You probably need a volatile for it.  I tend to use methods instead of fields for this sort of control (disableWriter() or what-not), so as to abstract away the implementation.&lt;/p&gt;

&lt;p&gt;&amp;#8211; Philip&lt;/p&gt;</comment>
                            <comment id="12897490" author="pwendell" created="Wed, 11 Aug 2010 22:26:15 +0000"  >&lt;p&gt;Yep I was actually in the process of deleting that variable but must have left a few references around. For now, we actually don&apos;t have any case where we need to explicitly disable the storage, so just keeping it out. &lt;/p&gt;</comment>
                            <comment id="12898351" author="pwendell" created="Fri, 13 Aug 2010 18:22:19 +0000"  >&lt;p&gt;Tweaked one test which was failing occasionally. Also, patched this on a clean checkout and tests/checksyle pass, FYI.&lt;/p&gt;</comment>
                            <comment id="12898417" author="philip" created="Fri, 13 Aug 2010 20:59:43 +0000"  >&lt;p&gt;I just committed this as r985363.  Thanks for your contribution, Patrick!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12469129">AVRO-595</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12451279" name="AVRO-606.v1.txt" size="109843" author="pwendell" created="Wed, 4 Aug 2010 23:19:41 +0000"/>
                            <attachment id="12451287" name="AVRO-606.v2.txt" size="27569" author="pwendell" created="Thu, 5 Aug 2010 00:42:51 +0000"/>
                            <attachment id="12451632" name="AVRO-606.v3.txt" size="28876" author="pwendell" created="Mon, 9 Aug 2010 22:55:31 +0000"/>
                            <attachment id="12451835" name="AVRO-606.v4.txt" size="28768" author="pwendell" created="Wed, 11 Aug 2010 22:26:15 +0000"/>
                            <attachment id="12452039" name="AVRO-606.v5.txt" size="28769" author="pwendell" created="Fri, 13 Aug 2010 18:22:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Aug 2010 17:56:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94910</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1cv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79982</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-607] SpecificData.getSchema not thread-safe</title>
                <link>https://issues.apache.org/jira/browse/AVRO-607</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;SpecificData.getSchema uses a WeakHashMap to cache schemas, but WeakHashMap is not thread-safe, and the method itself is not synchronized. Seems like this could lead to the data structure getting corrupted. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12470865">AVRO-607</key>
            <summary>SpecificData.getSchema not thread-safe</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Andrius Driu">Andrius Druzinis-Vitkus</assignee>
                                    <reporter username="stephentu">Stephen Tu</reporter>
                        <labels>
                            <label>newbie</label>
                            <label>patch</label>
                    </labels>
                <created>Thu, 5 Aug 2010 04:28:22 +0000</created>
                <updated>Sun, 4 Sep 2016 19:25:32 +0000</updated>
                            <resolved>Sun, 4 Sep 2016 00:20:30 +0000</resolved>
                                    <version>1.3.3</version>
                    <version>1.8.1</version>
                                    <fixVersion>1.8.2</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="12895846" author="cutting" created="Thu, 5 Aug 2010 22:24:25 +0000"  >&lt;p&gt;Here&apos;s a simple patch.  I&apos;ve converted it to use ConcurrentHashMap instead.  We already have static ConcurrentHashMaps that contain instances of Class, and most instances of Type are Class.  So this will prevent classes and types from getting GC&apos;d, but neither need to be GC&apos;d much.&lt;/p&gt;

&lt;p&gt;A better fix might be to update all uses of static ConcurrentHashMaps with &apos;new com.google.common.collect.&lt;br/&gt;
new MapMaker().weakKeys().makeMap()&apos;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/MapMaker.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/MapMaker.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Should we add a dependency on Google Collections?&lt;/p&gt;</comment>
                            <comment id="13645811" author="scott_carey" created="Tue, 30 Apr 2013 18:24:44 +0000"  >&lt;p&gt;I quite like Guava, Having a concurrent weak hash map is great, and the Immutable collections are very useful, and several other collection types are massive time savers (Multiset, Multimap and BiMap).&lt;/p&gt;

&lt;p&gt;However, items get deprecated and dissapear in 2 years in Guava, so we would have to avoid the newest APIs and quickly move off of deprecated ones to prevent users who also use it from coming into conflict.  It is manageable, but it is a dependency that is very likely to be used by our users, and if we are on version 11 while a user is on 13, we could be in a position where neither version works for both of us simultaneously.  I also worry about our place as a library far down the stack for some users.  &lt;/p&gt;

&lt;p&gt;We could complicate our build to shade in only the classes we use under a different namespace to avoid such problems (this may be useful for other dependencies as well). &lt;/p&gt;
</comment>
                            <comment id="13645819" author="scott_carey" created="Tue, 30 Apr 2013 18:29:28 +0000"  >&lt;p&gt;Alternative to this patch, we could synchronize the method, or we can use a ThreadLocal&amp;lt;WeakHashMap&amp;lt;Type, Schema&amp;gt;&amp;gt;.&lt;/p&gt;

&lt;p&gt;A cache with a Type or Class key (that is not weak) that becomes static can lead to classloader leaks. &lt;/p&gt;

&lt;p&gt;In Avro code, a weak concurrent hash map is in high demand.&lt;/p&gt;</comment>
                            <comment id="13646114" author="cutting" created="Tue, 30 Apr 2013 23:04:44 +0000"  >&lt;p&gt;&amp;gt; In Avro code, a weak concurrent hash map is in high demand.&lt;/p&gt;

&lt;p&gt;Might we add a org.apache.avro.util.WeakConcurrentMap&amp;lt;T&amp;gt; class that&apos;s a ConncurrentHashMap&amp;lt;WeakReference&amp;lt;T&amp;gt;&amp;gt;?  We already have our own WeakIdentityHashMap...&lt;/p&gt;</comment>
                            <comment id="13647037" author="scott_carey" created="Wed, 1 May 2013 23:01:28 +0000"  >&lt;p&gt;If I recall, that turns out to be very hard due to how the equals contract works with weak references.  There is already a Java WeakHashMap, so making one with identity semantics wasn&apos;t too hard.&lt;br/&gt;
We may need thousands of lines of code and might have to implement our own concurrent map implementation.  I think I&apos;d rather spend my efforts figuring out how to extract Google&apos;s implementation into another namespace in the build with shade, jarjar, or similar.&lt;/p&gt;</comment>
                            <comment id="14380318" author="davelatham" created="Wed, 25 Mar 2015 17:35:45 +0000"  >&lt;p&gt;This is affecting us in production, with the symptom being hundreds of threads being stuck in a loop at:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at java.util.WeakHashMap.get(WeakHashMap.java:470)
	at org.apache.avro.specific.SpecificData.getSchema(SpecificData.java:138)
	at org.apache.avro.specific.SpecificDatumWriter.&amp;lt;init&amp;gt;(SpecificDatumWriter.java:33)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;until the process is restarted.&lt;/p&gt;</comment>
                            <comment id="14387775" author="githubbot" created="Tue, 31 Mar 2015 01:21:53 +0000"  >&lt;p&gt;GitHub user rdblue opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/30&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/30&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt;. Make SpecificData#getSchema thread-safe.&lt;/p&gt;

&lt;p&gt;    This adds a version of WeakIdentityHashMap that is thread-safe by&lt;br/&gt;
    replacing the backing Map implementation with ConcurrentHashMap. Both&lt;br/&gt;
    WeakIdentityHashmap and the new WeakIdentityConcurrentMap are subclases&lt;br/&gt;
    of the (new) WeakIdentityMap, which allows subclasses to supply a&lt;br/&gt;
    backing map implementation.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/rdblue/avro&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/rdblue/avro&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt;-concurrent-schema-cache&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/30.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/30.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #30&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit b287db7560928d88b1ef1dd0cc79d1ad3e7cfa1e&lt;br/&gt;
Author: Ryan Blue &amp;lt;blue@apache.org&amp;gt;&lt;br/&gt;
Date:   2015-03-31T00:31:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt;. Make SpecificData#getSchema thread-safe.&lt;/p&gt;

&lt;p&gt;    This adds a version of WeakIdentityHashMap that is thread-safe by&lt;br/&gt;
    replacing the backing Map implementation with ConcurrentHashMap. Both&lt;br/&gt;
    WeakIdentityHashmap and the new WeakIdentityConcurrentMap are subclases&lt;br/&gt;
    of the (new) WeakIdentityMap, which allows subclasses to supply a&lt;br/&gt;
    backing map implementation.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14387777" author="rdblue" created="Tue, 31 Mar 2015 01:22:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davelatham&quot; class=&quot;user-hover&quot; rel=&quot;davelatham&quot;&gt;Dave Latham&lt;/a&gt;&apos;s comment is a good excuse to start this thread again. From the discussion above, it sounds like building the WeakConcurrentMap is a problem because its equals method doesn&apos;t override the default and two WeakReferences to the same object aren&apos;t equal. But, WeakIdentityHashMap creates a subclass of WeakReference that overrides equals to avoid that problem and it would be appropriate to use an IdentityHashMap for this cache. So I created a version of the WeakIdentityHashMap that is backed by a ConcurrentHashMap instead of a regular HashMap. Even if the GC removes the weakly-referenced object while the ConcurrentHashMap is doing some operation, it either removes all weak references or none, so key equality is preserved.&lt;/p&gt;

&lt;p&gt;I also caught a couple of places where I think the current implementation violates its contract. For example, &lt;tt&gt;keySet&lt;/tt&gt; gets all of the identity weak references and accumulates a set of the real values. As soon as each real value is referenced, we know that the weak reference won&apos;t disappear. But I think there&apos;s a small opportunity between reaping the current reference set and adding all the referenced objects to the key set for GC to run and remove values:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Set&amp;lt;K&amp;gt; keySet() {
    reap();
    Set&amp;lt;K&amp;gt; ret = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;K&amp;gt;();
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (IdentityWeakReference&amp;lt;K&amp;gt; ref : backingStore.keySet()) {
      &lt;span class=&quot;code-comment&quot;&gt;// half-way through the loop, GC could run and remove the next referenced object
&lt;/span&gt;      ret.add(ref.get());
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Collections.unmodifiableSet(ret);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve also added checks so that in &lt;tt&gt;keySet&lt;/tt&gt; and &lt;tt&gt;entrySet&lt;/tt&gt;, the WeakReference is resolved (which prevents losing the value) and checked to see if it is null before adding to the output collection.&lt;/p&gt;

&lt;p&gt;I&apos;ve added &lt;a href=&quot;https://github.com/apache/avro/pull/30&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;PR #30&lt;/a&gt; on github, and I can upload a patch if that&apos;s preferred.&lt;/p&gt;</comment>
                            <comment id="14500594" author="rdblue" created="Fri, 17 Apr 2015 20:23:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;Tom White&lt;/a&gt;, do you have time to take a look?&lt;/p&gt;</comment>
                            <comment id="15026871" author="tomwhite" created="Wed, 25 Nov 2015 14:45:54 +0000"  >&lt;p&gt;&amp;gt; I think I&apos;d rather spend my efforts figuring out how to extract Google&apos;s implementation into another namespace in the build with shade, jarjar, or similar.&lt;/p&gt;

&lt;p&gt;I agree. Shading Guava is not too hard, and means that we&apos;d be able to use well-tested code.&lt;/p&gt;</comment>
                            <comment id="15034319" author="rdblue" created="Tue, 1 Dec 2015 18:37:08 +0000"  >&lt;p&gt;Shading guava isn&apos;t too bad, but it will increase the size of the Avro jar by 1.6 MB and make the build more complex. I&apos;m not sure that&apos;s worth replacing this class.&lt;/p&gt;</comment>
                            <comment id="15133235" author="githubbot" created="Thu, 4 Feb 2016 22:53:42 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/30&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/30&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15308498" author="dhalperi@google.com" created="Tue, 31 May 2016 20:03:14 +0000"  >&lt;p&gt;Is this bug still open? It&apos;s also affecting some users of Apache Beam (incubating) in production.&lt;/p&gt;</comment>
                            <comment id="15308534" author="rdblue" created="Tue, 31 May 2016 20:12:44 +0000"  >&lt;p&gt;Yes, this is still open. We&apos;ve added guava, so we just need to convert the cache to the appropriate thread-safe guava one. I&apos;ll mark this for the next release.&lt;/p&gt;</comment>
                            <comment id="15308554" author="dhalperi@google.com" created="Tue, 31 May 2016 20:21:34 +0000"  >&lt;p&gt;Thanks Ryan.&lt;/p&gt;

&lt;p&gt;So if I&apos;m reading this right, the only way to avoid this bug is to serialize access to SpecificData.getSchema. Right now, we&apos;re hitting this via the following code path:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;--- &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[pool-1-thread-15,5,main] State: RUNNABLE stack: ---
  java.util.WeakHashMap.get(WeakHashMap.java:403)
  org.apache.avro.specific.SpecificData.getSchema(SpecificData.java:187)
  org.apache.avro.reflect.ReflectData.isRecord(ReflectData.java:168)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericData.getSchemaName(GenericData.java:612)
  org.apache.avro.specific.SpecificData.getSchemaName(SpecificData.java:265)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericData.resolveUnion(GenericData.java:601)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.resolveUnion(GenericDatumWriter.java:151)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.write(GenericDatumWriter.java:71)
  org.apache.avro.reflect.ReflectDatumWriter.write(ReflectDatumWriter.java:143)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.writeField(GenericDatumWriter.java:114)
  org.apache.avro.reflect.ReflectDatumWriter.writeField(ReflectDatumWriter.java:175)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.writeRecord(GenericDatumWriter.java:104)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.write(GenericDatumWriter.java:66)
  org.apache.avro.reflect.ReflectDatumWriter.write(ReflectDatumWriter.java:143)
  org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter.write(GenericDatumWriter.java:58)
  org.apache.beam.sdk.coders.AvroCoder.encode(AvroCoder.java:264)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have many different threads all calling AvroCoder#encode (on different DatumWriter instances), which eventually reflectively uses the static cache.&lt;/p&gt;

&lt;p&gt;Are there any standard ways to populate the cache to avoid this problem?&lt;/p&gt;</comment>
                            <comment id="15308563" author="rdblue" created="Tue, 31 May 2016 20:30:24 +0000"  >&lt;p&gt;Yeah, the &lt;a href=&quot;https://github.com/apache/avro/blob/master/lang/java/avro/src/main/java/org/apache/avro/specific/SpecificData.java#L214&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;&lt;tt&gt;getSchema&lt;/tt&gt;&lt;/a&gt; method is public, so you could synchronize calls to it with your classes.&lt;/p&gt;</comment>
                            <comment id="15308570" author="dhalperi@google.com" created="Tue, 31 May 2016 20:36:19 +0000"  >&lt;p&gt;Thanks, Ryan!&lt;/p&gt;</comment>
                            <comment id="15308572" author="dhalperi@google.com" created="Tue, 31 May 2016 20:36:40 +0000"  >&lt;p&gt;Thanks, Ryan!&lt;/p&gt;

</comment>
                            <comment id="15318804" author="busbey" created="Tue, 7 Jun 2016 16:27:22 +0000"  >&lt;p&gt;FYI, I added this to the &lt;span class=&quot;error&quot;&gt;&amp;#91;help wanted tracker|helpwanted.apache.org&amp;#93;&lt;/span&gt; (can&apos;t find a permalink to the particular task).&lt;/p&gt;</comment>
                            <comment id="15367145" author="chunfy.tseng" created="Fri, 8 Jul 2016 03:01:34 +0000"  >&lt;p&gt;When using RPC, the client can use such as httpclient similar tools or use the postman? Can you please give me an example? Thank you!&lt;/p&gt;</comment>
                            <comment id="15379582" author="githubbot" created="Fri, 15 Jul 2016 15:44:33 +0000"  >&lt;p&gt;GitHub user dhalperi opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-beam/pull/664&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/incubator-beam/pull/664&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Upgrade to Avro 1.8.1&lt;/p&gt;

&lt;p&gt;    This version has some important fixes for potential memory leaks.&lt;/p&gt;

&lt;p&gt;    (It does not have a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt; yet, but still has good fixes.)&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dhalperi/incubator-beam&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/dhalperi/incubator-beam&lt;/a&gt; avro-upgrade&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/incubator-beam/pull/664.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/incubator-beam/pull/664.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #664&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 313a3e60042c86c0130c499ed5503380dab251cd&lt;br/&gt;
Author: Dan Halperin &amp;lt;dhalperi@google.com&amp;gt;&lt;br/&gt;
Date:   2016-07-15T15:43:35Z&lt;/p&gt;

&lt;p&gt;    Upgrade to Avro 1.8.1&lt;/p&gt;

&lt;p&gt;    This version has some important fixes for potential memory leaks.&lt;/p&gt;

&lt;p&gt;    (It does not have a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt; yet, but still has good fixes.)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15379586" author="dhalperi@google.com" created="Fri, 15 Jul 2016 15:47:21 +0000"  >&lt;p&gt;Sorry folks, I did not think the bot would comment on this issue unless this was in the first line of the commit.&lt;/p&gt;</comment>
                            <comment id="15382210" author="busbey" created="Mon, 18 Jul 2016 12:33:43 +0000"  >&lt;p&gt;No worries. It helps to know the relative demand for outstanding issues. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15384445" author="andrius driu" created="Tue, 19 Jul 2016 16:11:01 +0000"  >&lt;p&gt;Hi all, I would like to propose a fix based on Guava&apos;s Caches. The advantage of a cache over a (synchronised) map is that caches offer atomic &quot;get-if-absent-compute&quot; semantics, which should prevent race conditions. Also, it offers a &apos;weak keys&apos; option (and weak values, if needed). &lt;/p&gt;

&lt;p&gt;Since I can&apos;t see an Attach patch button, I&apos;ve added the patch to a GitHub gist:&lt;br/&gt;
&lt;a href=&quot;https://gist.github.com/driu/51238a26f3a980d2b91222f788ff651b&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gist.github.com/driu/51238a26f3a980d2b91222f788ff651b&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15384468" author="busbey" created="Tue, 19 Jul 2016 16:35:04 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Andrius+Driu&quot; class=&quot;user-hover&quot; rel=&quot;Andrius Driu&quot;&gt;Andrius Druzinis-Vitkus&lt;/a&gt;! I&apos;ve assigned the jira to you now, so you ought to be able to attach a patch. Please either do that or create a pull request (and reference this jira there).&lt;/p&gt;</comment>
                            <comment id="15388423" author="busbey" created="Thu, 21 Jul 2016 21:04:31 +0000"  >&lt;p&gt;thanks for the patch. could you regenerate it using the &lt;tt&gt;git format-patch&lt;/tt&gt; command? that way I&apos;ll know how you want yourself attributed.&lt;/p&gt;</comment>
                            <comment id="15388425" author="busbey" created="Thu, 21 Jul 2016 21:05:44 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.cache.CacheBuilder;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.cache.CacheLoader;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.cache.LoadingCache;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If these are in the shaded module, shouldn&apos;t they be relocated from the com.google namespace?&lt;/p&gt;</comment>
                            <comment id="15389184" author="andrius driu" created="Fri, 22 Jul 2016 09:00:00 +0000"  >&lt;p&gt;Hi Sean, if I understand correctly, the avro module depends on avro-guava-dependencies (the shaded slimmed-down jar) but not com.google.guava; in order to make a class available in avro, it needs to be referenced in GuavaClasses. At least, that is how I read this comment:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;GuavaClasses.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /*
   * Referencing Guava classes here includes them in the minimized Guava jar
   * that is shaded in the avro jar.
   */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I wasn&apos;t sure which namespace to use in SpecificData.java and chose the com.google one because classes GenericData and ReflectData also import from com.google and not org.apache.avro:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;GenericData.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.MapMaker;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;ReflectData.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.MapMaker;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is the above reasoning not correct? I will update the patch once we clear this up. &lt;/p&gt;</comment>
                            <comment id="15389462" author="busbey" created="Fri, 22 Jul 2016 13:10:05 +0000"  >&lt;p&gt;hurm. let me try to figure it out today. I thought our goal was to avoid exposing our dependency on guava, but maybe we&apos;re rewriting the referenced classes in the build.&lt;/p&gt;</comment>
                            <comment id="15392613" author="andrius driu" created="Mon, 25 Jul 2016 20:36:42 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, any updates on this?&lt;/p&gt;</comment>
                            <comment id="15392631" author="rdblue" created="Mon, 25 Jul 2016 20:44:31 +0000"  >&lt;p&gt;Sorry, I didn&apos;t see this until now. The org.apache.avro:avro artifact shades the Guava artifact and relocates its classes. That way, Avro depends on Guava classes like normal and they aren&apos;t leaked after that. So the normal import lines are correct.&lt;/p&gt;</comment>
                            <comment id="15392632" author="rdblue" created="Mon, 25 Jul 2016 20:45:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Andrius+Driu&quot; class=&quot;user-hover&quot; rel=&quot;Andrius Driu&quot;&gt;Andrius Druzinis-Vitkus&lt;/a&gt;, do you know how much larger this makes the avro-guava jar? This is shaded, so we want to keep it small if possible.&lt;/p&gt;</comment>
                            <comment id="15396119" author="andrius driu" created="Wed, 27 Jul 2016 18:32:53 +0000"  >&lt;p&gt;The size went up from 852 KB to 1 MB. Is this an acceptable increase? &lt;/p&gt;

&lt;p&gt;These added classes would potentially help elsewhere in the codebase where atomic &quot;get-if-absent-compute&quot; works better, e.g. defaultValueCache in GenericData.java. &lt;/p&gt;</comment>
                            <comment id="15461933" author="jira-bot" created="Sun, 4 Sep 2016 00:19:16 +0000"  >&lt;p&gt;Commit fa0059c55a31813634188eb85e53b68e33644489 in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Andrius+Driu&quot; class=&quot;user-hover&quot; rel=&quot;Andrius Driu&quot;&gt;Andrius Druzinis-Vitkus&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=fa0059c&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=fa0059c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-607&quot; title=&quot;SpecificData.getSchema not thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-607&quot;&gt;&lt;del&gt;AVRO-607&lt;/del&gt;&lt;/a&gt;: Java: Make SpecificData schema cache thread-safe.&lt;/p&gt;

&lt;p&gt;Changed SpecificData.getSchema to use a thread-safe Cache class from&lt;br/&gt;
Google Guava.&lt;/p&gt;</comment>
                            <comment id="15461934" author="rdblue" created="Sun, 4 Sep 2016 00:19:22 +0000"  >&lt;p&gt;Sounds good to me. Thanks for replying!&lt;/p&gt;</comment>
                            <comment id="15461936" author="rdblue" created="Sun, 4 Sep 2016 00:20:31 +0000"  >&lt;p&gt;I committed the patch that uses Guava&apos;s cache. Thanks for this contribution, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Andrius+Driu&quot; class=&quot;user-hover&quot; rel=&quot;Andrius Driu&quot;&gt;Andrius Druzinis-Vitkus&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15463382" author="busbey" created="Sun, 4 Sep 2016 19:25:32 +0000"  >&lt;p&gt;I marked the helpwanted task as done. Thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12990761">AVRO-1885</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12820676" name="0001-AVRO-607-Changed-SpecificData.getSchema-to-use-a-thr.patch" size="3493" author="Andrius Driu" created="Thu, 28 Jul 2016 08:49:55 +0000"/>
                            <attachment id="12818863" name="AVRO-607.patch" size="3069" author="Andrius Driu" created="Tue, 19 Jul 2016 17:26:37 +0000"/>
                            <attachment id="12451382" name="AVRO-607.patch" size="932" author="cutting" created="Thu, 5 Aug 2010 22:24:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Aug 2010 22:24:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1d3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79983</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Method org.apache.avro.specific.SpecificData::getSchema(type) to use Guava&amp;#39;s LoadingCache instead of a Map to avoid race conditions. </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-608] setRequestPayload() in Responder should not pass handshake</title>
                <link>https://issues.apache.org/jira/browse/AVRO-608</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;In current implementation, Responder passes the entire request buffer, including the handshake, to the RPCPlugin. It should only pass the payload itself, as is the case for all other setXPayload() methods.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470926">AVRO-608</key>
            <summary>setRequestPayload() in Responder should not pass handshake</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="pwendell">Patrick Wendell</assignee>
                                    <reporter username="pwendell">Patrick Wendell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Aug 2010 17:57:22 +0000</created>
                <updated>Thu, 14 Oct 2010 19:24:43 +0000</updated>
                            <resolved>Wed, 25 Aug 2010 22:39:01 +0000</resolved>
                                                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12902684" author="pwendell" created="Wed, 25 Aug 2010 22:39:01 +0000"  >&lt;p&gt;Part of broader discussion now reflected in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-631&quot; title=&quot;Change Payload Reporting for Plugins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-631&quot;&gt;&lt;del&gt;AVRO-631&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79984</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-609] JsonToBinaryFragmentTool doesn&apos;t flush output</title>
                <link>https://issues.apache.org/jira/browse/AVRO-609</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;JsonToBinaryFragmentTool needs to flush its output, as standard output is sometimes buffered.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470998">AVRO-609</key>
            <summary>JsonToBinaryFragmentTool doesn&apos;t flush output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Aug 2010 19:16:24 +0000</created>
                <updated>Wed, 8 Sep 2010 21:08:03 +0000</updated>
                            <resolved>Tue, 10 Aug 2010 21:58:05 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12896129" author="cutting" created="Fri, 6 Aug 2010 19:18:08 +0000"  >&lt;p&gt;Here&apos;s a patch for this and updates to tests.&lt;/p&gt;</comment>
                            <comment id="12896956" author="philip" created="Tue, 10 Aug 2010 17:07:59 +0000"  >&lt;p&gt;Looks good, thanks, Doug!&lt;/p&gt;</comment>
                            <comment id="12897054" author="cutting" created="Tue, 10 Aug 2010 21:58:04 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12451455" name="AVRO-609.patch" size="1885" author="cutting" created="Fri, 6 Aug 2010 19:18:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Aug 2010 17:07:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94913</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1dj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79985</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-610] Move away from Net:HTTP</title>
                <link>https://issues.apache.org/jira/browse/AVRO-610</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;For a variety of reasons, Net:HTTP doesn&apos;t work well:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;its pure ruby, so its performance isn&apos;t great&lt;/li&gt;
	&lt;li&gt;it uses the Timeout module, which isn&apos;t very effective&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Typhoeus would be my preference: &lt;a href=&quot;http://github.com/pauldix/typhoeus&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://github.com/pauldix/typhoeus&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12471011">AVRO-610</key>
            <summary>Move away from Net:HTTP</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kingryan">Ryan King</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Aug 2010 21:10:41 +0000</created>
                <updated>Mon, 9 Aug 2010 16:22:42 +0000</updated>
                                                                            <component>ruby</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12896490" author="mrflip" created="Mon, 9 Aug 2010 09:23:01 +0000"  >&lt;p&gt;I like the idea of Avro remaining ubiquitous &amp;#8211; the ability to fall back on a pure ruby implementation is compelling.  Typhoeus depends on libcurl, which I believe will rule out JRuby and IronRuby &amp;amp;c. I don&apos;t know if the current version works on alternate rubies but in terms of dependencies it&apos;s otherwise clean (ruby-dev, gem, rake, echoe, yajl-ruby)&lt;/p&gt;

&lt;p&gt;I&apos;m in favor of the performance improvement this will bring but Avro should seamlessly fall back to Net::HTTP if the alternate lib is unavailable.&lt;/p&gt;

&lt;p&gt;Typhoeus does seem to have good momentum. EventMachine is the other thing I hear people ripping out Net::HTTP to use but I don&apos;t know if it&apos;s appropriate here.&lt;/p&gt;</comment>
                            <comment id="12896605" author="kingryan" created="Mon, 9 Aug 2010 16:22:42 +0000"  >&lt;p&gt;I&apos;d prefer to avoid the the complexity of having multiple http implementations.&lt;/p&gt;

&lt;p&gt;I think jruby and iron ruby would do better by using the java and c# implemenations of avro, rather than the ruby one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 Aug 2010 09:23:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e1dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79986</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
