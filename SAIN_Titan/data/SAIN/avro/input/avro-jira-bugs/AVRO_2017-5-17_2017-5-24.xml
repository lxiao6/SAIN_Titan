<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:25:05 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2017-5-17+AND+created+%3C%3D+2017-5-24+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="2" total="2"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-2035] enable validation of default values in schemas by default</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2035</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;suppose i have the following schema evolution:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;: [
    {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;f1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;}
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and then:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;Bob&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;: [
    {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;f1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;},
    {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;f2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;}
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the default value for &quot;f2&quot; is specified as the &lt;em&gt;STRING&lt;/em&gt; &quot;true&quot; (and not the literal boolean true). &lt;/p&gt;

&lt;p&gt;if this default value is ever accessed (when reading a gen1-serialized object as a gen2) we get this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.avro.AvroTypeException: Non-&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;

	at org.apache.avro.io.parsing.ResolvingGrammarGenerator.encode(ResolvingGrammarGenerator.java:408)
	at org.apache.avro.io.parsing.ResolvingGrammarGenerator.getBinary(ResolvingGrammarGenerator.java:307)
	at org.apache.avro.io.parsing.ResolvingGrammarGenerator.resolveRecords(ResolvingGrammarGenerator.java:285)
	at org.apache.avro.io.parsing.ResolvingGrammarGenerator.generate(ResolvingGrammarGenerator.java:118)
	at org.apache.avro.io.parsing.ResolvingGrammarGenerator.generate(ResolvingGrammarGenerator.java:50)
	at org.apache.avro.io.ResolvingDecoder.resolve(ResolvingDecoder.java:85)
	at org.apache.avro.io.ResolvingDecoder.&amp;lt;init&amp;gt;(ResolvingDecoder.java:49)
	at org.apache.avro.io.DecoderFactory.resolvingDecoder(DecoderFactory.java:307)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.getResolver(GenericDatumReader.java:127)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:142)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;yet Schema.parse() passes for this&lt;/p&gt;</description>
                <environment></environment>
        <key id="13072650">AVRO-2035</key>
            <summary>enable validation of default values in schemas by default</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="radai">radai rosenblatt</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 May 2017 01:27:34 +0000</created>
                <updated>Tue, 27 Feb 2018 22:06:15 +0000</updated>
                            <resolved>Tue, 27 Feb 2018 22:06:15 +0000</resolved>
                                    <version>1.8.1</version>
                                    <fixVersion>1.9.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="16052401" author="busbey" created="Fri, 16 Jun 2017 21:16:46 +0000"  >&lt;p&gt;Hi Radai! Any interest in putting up a fix for this?&lt;/p&gt;</comment>
                            <comment id="16052438" author="cutting" created="Fri, 16 Jun 2017 22:06:33 +0000"  >&lt;p&gt;Strings are not valid as the default value for a boolean.&lt;/p&gt;

&lt;p&gt;The schema parser does not ordinarily validate default values, but this can be enabled if desired.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://avro.apache.org/docs/1.8.1/api/java/org/apache/avro/Schema.Parser.html#setValidateDefaults(boolean&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://avro.apache.org/docs/1.8.1/api/java/org/apache/avro/Schema.Parser.html#setValidateDefaults(boolean&lt;/a&gt;)&lt;/p&gt;

</comment>
                            <comment id="16052670" author="radai" created="Sat, 17 Jun 2017 03:39:07 +0000"  >&lt;p&gt;Is there any reason why the schema parser shouldnt validate default values by default? given that such a schema, if it slips past the parser is not generally usable (any scenario where the default value come into play results in explosion) it seems this just leads to issues being discovered very late by users (as was the case for me).&lt;/p&gt;

&lt;p&gt;Also, given that there are probably users out there with such schemas already out and about (again, me for example) - is there a reason not to at least try and accommodate and see if the string value happens to be parseable as a boolean? (maybe not do this by default, but configure the reader somehow ...)&lt;/p&gt;</comment>
                            <comment id="16057848" author="cutting" created="Wed, 21 Jun 2017 17:02:53 +0000"  >&lt;p&gt;Turning default value validation on would be an incompatible change, so it would need to come in a major release, i.e., 1.9.  There are probably applications which have invalid default values that are never used which validation would break.&lt;/p&gt;

&lt;p&gt;For reference, this was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1449&quot; title=&quot;Check default value&amp;#39;s type matches union at schema parse time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1449&quot;&gt;&lt;del&gt;AVRO-1449&lt;/del&gt;&lt;/a&gt; and is discussed further there.  The intention was to turn it on in some future release, but that seems to have been forgotten.&lt;/p&gt;</comment>
                            <comment id="16059801" author="busbey" created="Thu, 22 Jun 2017 18:15:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16063300" author="jira-bot" created="Mon, 26 Jun 2017 16:01:37 +0000"  >&lt;p&gt;Commit e5ae42e5703b8b193e5c2a61458e28a931c5774e in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=e5ae42e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=e5ae42e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;: Java: validate default values when parsing schemas.&lt;/p&gt;</comment>
                            <comment id="16066916" author="jira-bot" created="Wed, 28 Jun 2017 17:35:13 +0000"  >&lt;p&gt;Commit d145b8b6463a7b0d1821d7ebdd561524f9d80914 in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=d145b8b&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=d145b8b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;: Update tests to require that default values are validated by default.&lt;/p&gt;</comment>
                            <comment id="16373653" author="cutting" created="Thu, 22 Feb 2018 23:08:52 +0000"  >&lt;p&gt;This patch enabled validation for parsed schemas, but not for those created using schema constructors.  These are still unvalidated.&lt;/p&gt;</comment>
                            <comment id="16373686" author="githubbot" created="Thu, 22 Feb 2018 23:44:52 +0000"  >&lt;p&gt;cutting opened a new pull request #288: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;. Java: enable default validation for schemas created by constructors.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/288&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/288&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16373698" author="cutting" created="Thu, 22 Feb 2018 23:52:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zolyfarkas&quot; class=&quot;user-hover&quot; rel=&quot;zolyfarkas&quot;&gt;Zoltan Farkas&lt;/a&gt; Does this look right to you?&lt;/p&gt;</comment>
                            <comment id="16373777" author="zolyfarkas" created="Fri, 23 Feb 2018 01:19:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt; looks good. thanks!  &lt;/p&gt;</comment>
                            <comment id="16374607" author="githubbot" created="Fri, 23 Feb 2018 16:38:38 +0000"  >&lt;p&gt;cutting closed pull request #288: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;. Java: enable default validation for schemas created by constructors.&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/288&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/288&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/main/java/org/apache/avro/Schema.java b/lang/java/avro/src/main/java/org/apache/avro/Schema.java&lt;br/&gt;
index 97aed83cc..9333b7984 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/main/java/org/apache/avro/Schema.java&lt;br/&gt;
+++ b/lang/java/avro/src/main/java/org/apache/avro/Schema.java&lt;br/&gt;
@@ -399,11 +399,17 @@ public Field(String name, Schema schema, String doc,&lt;br/&gt;
     @Deprecated&lt;br/&gt;
     public Field(String name, Schema schema, String doc,&lt;br/&gt;
         JsonNode defaultValue, Order order) &lt;/p&gt;
{
+      this(name, schema, doc, defaultValue, true, order);
+    }
&lt;p&gt;+    public Field(String name, Schema schema, String doc,&lt;br/&gt;
+                 JsonNode defaultValue, boolean validateDefault, Order order) &lt;/p&gt;
{
       super(FIELD_RESERVED);
       this.name = validateName(name);
       this.schema = schema;
       this.doc = doc;
-      this.defaultValue = validateDefault(name, schema, defaultValue);
+      this.defaultValue = validateDefault
+        ? validateDefault(name, schema, defaultValue)
+        : defaultValue;
       this.order = order;
     }
&lt;p&gt;     /**&lt;br/&gt;
@@ -1159,7 +1165,7 @@ private static String validateName(String name) {&lt;br/&gt;
   private static final ThreadLocal&amp;lt;Boolean&amp;gt; VALIDATE_DEFAULTS&lt;br/&gt;
     = new ThreadLocal&amp;lt;Boolean&amp;gt;() {&lt;br/&gt;
     @Override protected Boolean initialValue() &lt;/p&gt;
{
-      return false;
+      return true;
     }
&lt;p&gt;   };&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
index 271c5fd55..39dd1a241 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
@@ -97,10 +97,10 @@&lt;br/&gt;
         .setFields(list(new Field(&quot;a&quot;, INT_SCHEMA, null, 0), new Field(&quot;b&quot;, INT_SCHEMA, null, 0)));&lt;br/&gt;
     A_DINT_B_DFIXED_4_BYTES_RECORD1.setFields(list(&lt;br/&gt;
         new Field(&quot;a&quot;, INT_SCHEMA, null, 0),&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new Field(&quot;b&quot;, FIXED_4_BYTES, null, 0)));&lt;br/&gt;
+        new Field(&quot;b&quot;, FIXED_4_BYTES, null, null)));&lt;br/&gt;
     A_DINT_B_DFIXED_8_BYTES_RECORD1.setFields(list(&lt;br/&gt;
         new Field(&quot;a&quot;, INT_SCHEMA, null, 0),&lt;/li&gt;
	&lt;li&gt;new Field(&quot;b&quot;, FIXED_8_BYTES, null, 0)));&lt;br/&gt;
+        new Field(&quot;b&quot;, FIXED_8_BYTES, null, null)));&lt;br/&gt;
     A_DINT_B_DINT_STRING_UNION_RECORD1.setFields(list(&lt;br/&gt;
         new Field(&quot;a&quot;, INT_SCHEMA, null, 0),&lt;br/&gt;
         new Field(&quot;b&quot;, INT_STRING_UNION_SCHEMA, null, 0)));&lt;br/&gt;
@@ -109,10 +109,10 @@&lt;br/&gt;
         new Field(&quot;b&quot;, INT_UNION_SCHEMA, null, 0)));&lt;br/&gt;
     A_DINT_B_DENUM_1_RECORD1.setFields(list(&lt;br/&gt;
         new Field(&quot;a&quot;, INT_SCHEMA, null, 0),&lt;/li&gt;
	&lt;li&gt;new Field(&quot;b&quot;, ENUM1_AB_SCHEMA, null, 0)));&lt;br/&gt;
+        new Field(&quot;b&quot;, ENUM1_AB_SCHEMA, null, null)));&lt;br/&gt;
     A_DINT_B_DENUM_2_RECORD1.setFields(list(&lt;br/&gt;
         new Field(&quot;a&quot;, INT_SCHEMA, null, 0),&lt;/li&gt;
	&lt;li&gt;new Field(&quot;b&quot;, ENUM2_AB_SCHEMA, null, 0)));&lt;br/&gt;
+        new Field(&quot;b&quot;, ENUM2_AB_SCHEMA, null, null)));&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   // Recursive records&lt;br/&gt;
diff --git a/lang/java/compiler/src/main/javacc/org/apache/avro/compiler/idl/idl.jj b/lang/java/compiler/src/main/javacc/org/apache/avro/compiler/idl/idl.jj&lt;br/&gt;
index 7de123e20..290f0190e 100644&lt;br/&gt;
&amp;#8212; a/lang/java/compiler/src/main/javacc/org/apache/avro/compiler/idl/idl.jj&lt;br/&gt;
+++ b/lang/java/compiler/src/main/javacc/org/apache/avro/compiler/idl/idl.jj&lt;br/&gt;
@@ -1324,7 +1324,8 @@ void VariableDeclarator(Schema type, List&amp;lt;Field&amp;gt; fields):&lt;br/&gt;
     for (String key : props.keySet())&lt;br/&gt;
       if (&quot;order&quot;.equals(key))&lt;br/&gt;
         order = Field.Order.valueOf(getTextProp(key,props,token).toUpperCase());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Field field = new Field(name, type, getDoc(), defaultValue, order);&lt;br/&gt;
+    boolean validate = !SchemaResolver.isUnresolvedSchema(type);&lt;br/&gt;
+    Field field = new Field(name,type, getDoc(), defaultValue, validate, order);&lt;br/&gt;
     for (String key : props.keySet())&lt;br/&gt;
       if (&quot;order&quot;.equals(key)) 
{                  // already handled: ignore
       }
&lt;p&gt; else if (&quot;aliases&quot;.equals(key)) {         // aliases&lt;br/&gt;
diff --git a/lang/java/compiler/src/test/idl/input/simple.avdl b/lang/java/compiler/src/test/idl/input/simple.avdl&lt;br/&gt;
index 1bfcd7b27..0ad7c7e37 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/compiler/src/test/idl/input/simple.avdl&lt;br/&gt;
+++ b/lang/java/compiler/src/test/idl/input/simple.avdl&lt;br/&gt;
@@ -50,8 +50,8 @@ protocol Simple {&lt;br/&gt;
     date d = 0;&lt;br/&gt;
     time_ms t = 0;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@foo.bar(&quot;bar.foo&quot;) long l;&lt;/li&gt;
	&lt;li&gt;union 
{null, @foo.foo.bar(42) @foo.foo.foo(&quot;3foo&quot;) string} nested_properties;&lt;br/&gt;
+    @foo.bar(&quot;bar.foo&quot;) long l = 0;&lt;br/&gt;
+    union {null, @foo.foo.bar(42) @foo.foo.foo(&quot;3foo&quot;) string}
&lt;p&gt; prop = null;&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   error TestError &lt;/p&gt;
{
diff --git a/lang/java/compiler/src/test/idl/output/simple.avpr b/lang/java/compiler/src/test/idl/output/simple.avpr
index f40030790..ae155f53b 100644
--- a/lang/java/compiler/src/test/idl/output/simple.avpr
+++ b/lang/java/compiler/src/test/idl/output/simple.avpr
@@ -56,10 +56,12 @@
       &quot;default&quot;: 0
     }
&lt;p&gt; , {&lt;br/&gt;
       &quot;name&quot;: &quot;l&quot;,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;type&quot;: 
{&quot;type&quot;: &quot;long&quot;, &quot;foo.bar&quot;: &quot;bar.foo&quot;}
&lt;p&gt;+      &quot;type&quot;: &lt;/p&gt;
{&quot;type&quot;: &quot;long&quot;, &quot;foo.bar&quot;: &quot;bar.foo&quot;}
&lt;p&gt;,&lt;br/&gt;
+      &quot;default&quot;: 0&lt;br/&gt;
     } , {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;&quot;name&quot;: &quot;nested_properties&quot;,&lt;/li&gt;
	&lt;li&gt;&quot;type&quot;: [ &quot;null&quot; , 
{&quot;type&quot;:&quot;string&quot;, &quot;foo.foo.bar&quot;: 42, &quot;foo.foo.foo&quot;: &quot;3foo&quot;}
&lt;p&gt; ]&lt;br/&gt;
+      &quot;name&quot;: &quot;prop&quot;,&lt;br/&gt;
+      &quot;type&quot;: [ &quot;null&quot; , &lt;/p&gt;
{&quot;type&quot;:&quot;string&quot;, &quot;foo.foo.bar&quot;: 42, &quot;foo.foo.foo&quot;: &quot;3foo&quot;}
&lt;p&gt; ],&lt;br/&gt;
+      &quot;default&quot;: null&lt;br/&gt;
     }],&lt;br/&gt;
     &quot;my-property&quot; : {&lt;br/&gt;
       &quot;key&quot; : 3&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16374608" author="jira-bot" created="Fri, 23 Feb 2018 16:38:40 +0000"  >&lt;p&gt;Commit 26894395cb480790488e0db283f8a503bd093909 in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=2689439&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=2689439&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;. Java: enable default validation for schemas created by constructors.&lt;/p&gt;</comment>
                            <comment id="16374609" author="jira-bot" created="Fri, 23 Feb 2018 16:38:41 +0000"  >&lt;p&gt;Commit 61befce7e70aeb13ab5a8d6ff3c336d4f982b9a9 in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=61befce&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=61befce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #288 from cutting/&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;. Java: enable default validation for schemas created by constructors.&lt;/p&gt;</comment>
                            <comment id="16374610" author="jira-bot" created="Fri, 23 Feb 2018 16:38:42 +0000"  >&lt;p&gt;Commit 61befce7e70aeb13ab5a8d6ff3c336d4f982b9a9 in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=61befce&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=61befce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #288 from cutting/&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2035&quot; title=&quot;enable validation of default values in schemas by default&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2035&quot;&gt;&lt;del&gt;AVRO-2035&lt;/del&gt;&lt;/a&gt;. Java: enable default validation for schemas created by constructors.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12874112" name="AVRO-2035.patch" size="1007" author="cutting" created="Thu, 22 Jun 2017 17:00:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 16 Jun 2017 21:16:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3f37j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-2036] Avro fails to compile for C</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2036</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;AVRO for C fails to compile. &lt;/p&gt;

&lt;p&gt;Could be duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-778&quot; title=&quot;C: avrocc schema-specific compiler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-778&quot;&gt;AVRO-778&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;First instance of failure (of many) occures in avro_schema_to_header :&lt;/p&gt;

&lt;p&gt;static int avro_schema_to_header(avro_schema_t schema, specific_ctx * ctx)&lt;br/&gt;
{&lt;br/&gt;
	size_t i;&lt;br/&gt;
	FILE *fp = ctx-&amp;gt;header;&lt;/p&gt;

&lt;p&gt;	indent(ctx, fp);&lt;br/&gt;
	ctx-&amp;gt;depth++;&lt;/p&gt;

&lt;p&gt;	if (is_avro_primitive(schema) &amp;amp;&amp;amp; !ctx-&amp;gt;name) {&lt;br/&gt;
&amp;lt;function continues....&amp;gt;&lt;/p&gt;

&lt;p&gt;ctx has no member name.&lt;/p&gt;

&lt;p&gt;The definition of the struct above is :&lt;br/&gt;
enum specific_state {&lt;br/&gt;
	START_STATE,&lt;br/&gt;
};&lt;br/&gt;
typedef enum specific_state specific_state;&lt;/p&gt;

&lt;p&gt;struct specific_ctx {&lt;br/&gt;
	FILE *header;&lt;br/&gt;
	FILE *source;&lt;br/&gt;
	int depth;&lt;br/&gt;
	specific_state state;&lt;br/&gt;
};&lt;br/&gt;
typedef struct specific_ctx specific_ctx;&lt;/p&gt;

&lt;p&gt;So every instance of ctx-&amp;gt;name fails.....&lt;/p&gt;



</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="13072879">AVRO-2036</key>
            <summary>Avro fails to compile for C</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dsnedigar">Don Snedigar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 May 2017 17:19:51 +0000</created>
                <updated>Thu, 18 May 2017 13:36:45 +0000</updated>
                                            <version>1.8.2</version>
                                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3f4m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
