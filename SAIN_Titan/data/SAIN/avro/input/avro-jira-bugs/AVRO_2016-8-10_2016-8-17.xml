<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:23:53 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2016-8-10+AND+created+%3C%3D+2016-8-17+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="1" total="1"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1898] C++ library cannot parse unions with default values</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1898</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I have a Avro file generated by the Java library, and when I tried to read it using the C++ library, I got:&lt;/p&gt;

&lt;p&gt;Unexpected type for default value: Expected 6, but found 1&lt;/p&gt;

&lt;p&gt;Which basically says the default value should be of type Object, but got type Boolean. After some investigation, I found the exception is thrown when parsing the default value of a union. Looks like the C++ library requires the default value of a union to be an object. This is different from what the Avro specification says, that the default value of a union should be of the first type in the union.&lt;/p&gt;

&lt;p&gt;This field is causing the problem:&lt;br/&gt;
{&lt;br/&gt;
        &quot;name&quot; : &quot;fake_name&quot;,&lt;br/&gt;
        &quot;type&quot; : [ &quot;boolean&quot;, &quot;null&quot; ],&lt;br/&gt;
        &quot;default&quot; : false&lt;br/&gt;
}&lt;br/&gt;
From the code the C++ library is expecting:&lt;br/&gt;
{&lt;br/&gt;
        &quot;name&quot; : &quot;is_track_mau30&quot;,&lt;br/&gt;
        &quot;type&quot; : [ &quot;boolean&quot;, &quot;null&quot; ],&lt;br/&gt;
        &quot;default&quot; : &lt;/p&gt;
{&quot;boolean&quot;: false}
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;The related code is in impl/Compiler.cc, line 284. If I change it to the following, the Avro file can be parsed:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        GenericUnion result(n);
        result.selectBranch(0);
        result.datum() = makeGenericDatum(n-&amp;gt;leafAt(0), e, st);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; GenericDatum(n, result);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why is the C++ library behaves different than the specification? Can/should it be changed to follow the specification? It will be a breaking change though.&lt;/p&gt;

&lt;p&gt;Thanks and I&apos;ll be happy to contribute this change if it&apos;s deemed appropriate.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12997728">AVRO-1898</key>
            <summary>C++ library cannot parse unions with default values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="buckedrain@outlook.com">Hua Zhang</assignee>
                                    <reporter username="buckedrain@outlook.com">Hua Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Aug 2016 21:56:32 +0000</created>
                <updated>Fri, 28 Dec 2018 16:25:29 +0000</updated>
                            <resolved>Sat, 18 Feb 2017 03:23:04 +0000</resolved>
                                    <version>1.8.1</version>
                                                    <component>c++</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15872951" author="jira-bot" created="Sat, 18 Feb 2017 03:22:05 +0000"  >&lt;p&gt;Commit ec8514f711b739307d460b23bcb6eccc784f419a in avro&apos;s branch refs/heads/master from Thiruvalluvan M. G&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=ec8514f&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=ec8514f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1898&quot; title=&quot;C++ library cannot parse unions with default values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1898&quot;&gt;&lt;del&gt;AVRO-1898&lt;/del&gt;&lt;/a&gt;, C++ library cannot parse unions with default values&lt;/p&gt;</comment>
                            <comment id="15872953" author="thiru_mg" created="Sat, 18 Feb 2017 03:23:04 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=buckedrain%40outlook.com&quot; class=&quot;user-hover&quot; rel=&quot;buckedrain@outlook.com&quot;&gt;Hua Zhang&lt;/a&gt;. Your fix works. Committed the change.&lt;/p&gt;</comment>
                            <comment id="16730351" author="thiru_mg" created="Fri, 28 Dec 2018 16:25:29 +0000"  >&lt;p&gt;Closing issues that got resolved in earlier releases.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 18 Feb 2017 03:22:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32e6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
