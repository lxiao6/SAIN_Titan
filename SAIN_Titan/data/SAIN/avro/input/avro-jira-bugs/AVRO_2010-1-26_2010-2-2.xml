<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:13:23 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2010-1-26+AND+created+%3C%3D+2010-2-2+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="15" total="15"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-377] Add getters and setters for all Avro datum types</title>
                <link>https://issues.apache.org/jira/browse/AVRO-377</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch adds getters and setters for all Avro datum types.&lt;/p&gt;

&lt;p&gt;It also renames avro_int functions to avro_int32 and avro_long to avro_int64 in order to remove ambiguity (e.g. longs can be 32 or 64 bits depending).  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12446621">AVRO-377</key>
            <summary>Add getters and setters for all Avro datum types</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="massie">Matt Massie</assignee>
                                    <reporter username="massie">Matt Massie</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jan 2010 00:25:27 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Tue, 26 Jan 2010 00:31:35 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12804815" author="massie" created="Tue, 26 Jan 2010 00:31:35 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431386" name="AVRO-377.patch" size="26862" author="massie" created="Tue, 26 Jan 2010 00:30:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94703</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79756</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-378] Add example code to the C implementation and update documentation</title>
                <link>https://issues.apache.org/jira/browse/AVRO-378</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch adds some example code to help people understand the C API.  It also fixes some memory leaks in record, map and array datatypes found while building the example.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12446716">AVRO-378</key>
            <summary>Add example code to the C implementation and update documentation</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="massie">Matt Massie</assignee>
                                    <reporter username="massie">Matt Massie</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jan 2010 19:03:58 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Tue, 26 Jan 2010 19:07:34 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12805142" author="massie" created="Tue, 26 Jan 2010 19:07:34 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431447" name="AVRO-378.patch" size="396879" author="massie" created="Tue, 26 Jan 2010 19:04:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94704</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzyv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79757</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-379] Changed record getter/setter API to match other datatypes</title>
                <link>https://issues.apache.org/jira/browse/AVRO-379</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch changes the getter/setter methods for record to match the getter/setter methods of the other datatypes.&lt;/p&gt;

&lt;p&gt;It also fixes bugs in getting bytes and fixed data from datum and adds support for file-based avro readers/writers in prep for interop file work.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12446752">AVRO-379</key>
            <summary>Changed record getter/setter API to match other datatypes</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="massie">Matt Massie</assignee>
                                    <reporter username="massie">Matt Massie</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jan 2010 23:51:45 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Wed, 27 Jan 2010 00:00:09 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12805288" author="massie" created="Wed, 27 Jan 2010 00:00:05 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431487" name="AVRO-379.patch" size="13337" author="massie" created="Tue, 26 Jan 2010 23:57:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94705</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79758</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-380] Avro Container File format change:  add block size to block descriptor</title>
                <link>https://issues.apache.org/jira/browse/AVRO-380</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The new file format in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-160&quot; title=&quot;file format should be friendly to streaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-160&quot;&gt;&lt;del&gt;AVRO-160&lt;/del&gt;&lt;/a&gt; limits a few use cases that I have found to be important.&lt;/p&gt;

&lt;p&gt;A block currently contains a count of the number of records, the block data, and a sync marker.  &lt;br/&gt;
This change would add the block size, in bytes, along side the number of records.   &lt;/p&gt;

&lt;p&gt;This allows efficient access to a block&apos;s data without the need to decode the data into individual Datums, which is useful for various use cases.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12446758">AVRO-380</key>
            <summary>Avro Container File format change:  add block size to block descriptor</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jan 2010 01:25:04 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Fri, 29 Jan 2010 19:29:22 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>doc</component>
                    <component>java</component>
                    <component>spec</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12805310" author="scott_carey" created="Wed, 27 Jan 2010 01:26:10 +0000"  >&lt;p&gt;I will work on this patch later this week.  However, I can only contribute the Java and documentation changes.&lt;/p&gt;</comment>
                            <comment id="12805843" author="scott_carey" created="Thu, 28 Jan 2010 09:13:05 +0000"  >&lt;p&gt;This patch adds the block size to the block format.  &lt;/p&gt;

&lt;p&gt;Each block then has:&lt;br/&gt;
blockCount &amp;#8211; the number of records in the block&lt;br/&gt;
blockSize &amp;#8211; the size in bytes of the block data, after compression&lt;br/&gt;
bytes &amp;#8211; blockSize bytes of data encoded by the file&apos;s codec&lt;br/&gt;
sync &amp;#8211; 16 byte sync marker&lt;/p&gt;

&lt;p&gt;The file will fail to read a block if the block size or count does not match the data, or if a sync marker is wrong.&lt;/p&gt;

&lt;p&gt;This worked best by changing the Codec API.  The current deflate and null codecs are not ideal for performance, but this patch focuses on the functionality.  I&apos;ll open a performance enhancement ticket later.&lt;br/&gt;
The Codec API and the file reader/writer will likely also change later due to performance enhancements on the BinaryDecoder and BinaryEncoder that I plan to work on.  These enhancements are all interdependent.&lt;/p&gt;

&lt;p&gt;There is also either a flaw in the Deflate Codec documentation, or the Deflate Codec code.  The document claims that we are using RFC-1951 (unwrapped deflate compression), but the code is writing RFC-1950 (deflate wrapped in a &quot;ZLIB&quot; container).&lt;br/&gt;
I am on the fence as to which we should use.  The right answer is probably &apos;whatever is easiest on all platforms&apos;.  &lt;br/&gt;
If we decide on which to do I can add the fix to this patch, or we can defer to another ticket.&lt;/p&gt;</comment>
                            <comment id="12806025" author="philip" created="Thu, 28 Jan 2010 18:52:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;setSyncInterval()&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you set syncInterval to Integer.MAX_VALUE, I bet things will break, because we allocate a ByteArrayOutputStream of 2*Integer.MAX_VALUE, which is going to overflow.&lt;/p&gt;

&lt;p&gt;If there&apos;s a goal of supporting individual values larger than 2GB (I don&apos;t know that such a goal is useful), then the byte counts need to be a long.  I&apos;m fine with this not being a goal, though.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;DataFileStream: in.read(block);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think it&apos;s your responsibility here to check that block.length bytes were actually read.  I used LenghtLimitedInputStream for that.  You could certainly also read into the buffer until you&apos;ve read the number of bytes you expect to.  I think this also introduces an extra copy for the null codec, but, as you say, there are more things that could be done for performance here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;There is also either a flaw in the Deflate Codec documentation, or the Deflate Codec code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm.  D&apos;oh, I think you&apos;re right.  I think we should do RFC-1951 (for &quot;deflate&quot;; if we called it &quot;zlib&quot;...).  I think this just means changing two &apos;false&apos;&apos;s to &apos;true&apos;&apos;s.  Let&apos;s do it in this patch.&lt;br/&gt;
Hm.  I think you&apos;re right, which is a bit embarassing&lt;/p&gt;</comment>
                            <comment id="12806026" author="philip" created="Thu, 28 Jan 2010 18:53:05 +0000"  >&lt;p&gt;Meant to add: overall approach looks good.&lt;/p&gt;</comment>
                            <comment id="12806039" author="cutting" created="Thu, 28 Jan 2010 19:26:15 +0000"  >&lt;p&gt;I would prefer we use longs instead of ints for both the count and the block size to better future-proof the format.  2GB isn&apos;t as big as it used to be and it&apos;s only getting smaller.  I don&apos;t think there are significant performance benefits to using int over long here.&lt;/p&gt;

&lt;p&gt;Other than that, +1.&lt;/p&gt;</comment>
                            <comment id="12806067" author="scott_carey" created="Thu, 28 Jan 2010 20:12:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;If you set syncInterval to Integer.MAX_VALUE, I bet things will break, because we allocate a ByteArrayOutputStream of 2*Integer.MAX_VALUE, which is going to overflow.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We probably will want to allocate ByteArrayOutputStream to MIN( estimated_need, Integer.MAX_VALUE).  Java can&apos;t create arrays with length larger than Integer.MAX_VALUE anyway.  &lt;/p&gt;

&lt;p&gt;In order to support uncompressed blocks larger than that, we would need significant changed &amp;#8211; outside the scope of this and perhaps never needed.&lt;/p&gt;

&lt;p&gt;I think we might want to limit syncInterval to 1GB though.  If someone tried to set it to near 2GB, and a value was big enough to take the block from just under this size to over 2GB it would break.&lt;/p&gt;

&lt;p&gt;Since this format requires both the size of the block and the count of items before writing, it is probably not the best format for very large blocks.  One would want to stream that volume of data to disk and not buffer it, which means the count and size are unknown when first written.  This can only be done if the count and size is removed, or if the count and size is a fixed size field and the file supports random writes so that those fields can be written after the block.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think it&apos;s your responsibility here to check that block.length bytes were actually read. I used LenghtLimitedInputStream for that. You could certainly also read into the buffer until you&apos;ve read the number of bytes you expect to. I think this also introduces an extra copy for the null codec, but, as you say, there are more things that could be done for performance here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, I was trying to not copy too much, but the best way to do that is to complete the buffering performance and api changes to BinaryEncoder/BinaryDecoder.  I&apos;ll add the extra checks.&lt;/p&gt;</comment>
                            <comment id="12806072" author="scott_carey" created="Thu, 28 Jan 2010 20:23:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;I would prefer we use longs instead of ints for both the count and the block size to better future-proof the format. 2GB isn&apos;t as big as it used to be and it&apos;s only getting smaller. I don&apos;t think there are significant performance benefits to using int over long here. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure. I had assumed that we would never support blocks larger than 2GB because the file format is not designed for large blocks (since the size and count have to be known in advance for appends-only writes).  But it is trivial to make it use a long instead just in case, and as you say its not a performance concern.  &lt;/p&gt;

&lt;p&gt;The code will break however if the size ever gets larger than an int, and it is not possible for the count to get larger than the size.  Is it worth unit testing those corner conditions?  I don&apos;t think it is.  I&apos;ll add javadoc that makes it clear that very large blocks are not recommended.&lt;/p&gt;</comment>
                            <comment id="12806078" author="cutting" created="Thu, 28 Jan 2010 20:31:42 +0000"  >&lt;p&gt;I am okay with the implementation not working for blocks larger than 2GB, but the format should permit larger blocks.&lt;/p&gt;</comment>
                            <comment id="12806274" author="scott_carey" created="Fri, 29 Jan 2010 08:05:22 +0000"  >&lt;p&gt;Updated patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Block size and block record count are longs in both the format and the code.   This reader implementation will throw an exception if a block size is larger than Integer.MAX_VALUE.&lt;/li&gt;
	&lt;li&gt;When a block is read from the underlying stream, the reader checks that the number of bytes read is equal to the block size (that it is not truncated).&lt;/li&gt;
	&lt;li&gt;When a block is finished (blockCount records read), the reader checks that all bytes have been read.  This is done by forcing an EOFException &amp;#8211; which is ugly and I plan to change at a later time as an optimization along with other planned changes.&lt;/li&gt;
	&lt;li&gt;DeflateCodec now writes and reads RFC-1951 &apos;raw&apos; deflate, in line with the documentation.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12806414" author="philip" created="Fri, 29 Jan 2010 18:01:46 +0000"  >&lt;p&gt;+1.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this tomorrow, unless there&apos;s more discussion.&lt;/p&gt;

&lt;p&gt;BTW, I agree that as we do more with the Decoder API, we may be able to have a Decoder.isEof() function, to avoid the exception mess.&lt;/p&gt;</comment>
                            <comment id="12806425" author="cutting" created="Fri, 29 Jan 2010 18:40:08 +0000"  >&lt;p&gt;+1 to the patch.&lt;/p&gt;

&lt;p&gt;&amp;gt; we may be able to have a Decoder.isEof() function, to avoid the exception mess&lt;/p&gt;

&lt;p&gt;Should we file an issue for this?  It&apos;s come up in a few contexts already as an awkward point in the API and would be nice to fix.&lt;/p&gt;</comment>
                            <comment id="12806457" author="philip" created="Fri, 29 Jan 2010 19:29:22 +0000"  >&lt;p&gt;I&apos;ve committed this.  Thanks, Scott!  (I think this is your first code contribution to Avro; excellent!)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431755" name="AVRO-380.patch" size="12870" author="scott_carey" created="Fri, 29 Jan 2010 08:05:22 +0000"/>
                            <attachment id="12431653" name="AVRO-380.patch" size="11748" author="scott_carey" created="Thu, 28 Jan 2010 09:13:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 28 Jan 2010 18:52:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79759</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-381] Update documentation to talk about reference counting and memory management</title>
                <link>https://issues.apache.org/jira/browse/AVRO-381</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description></description>
                <environment></environment>
        <key id="12446759">AVRO-381</key>
            <summary>Update documentation to talk about reference counting and memory management</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="massie">Matt Massie</assignee>
                                    <reporter username="massie">Matt Massie</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jan 2010 02:09:09 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Wed, 27 Jan 2010 02:13:43 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12805320" author="massie" created="Wed, 27 Jan 2010 02:13:43 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431494" name="AVRO-381.patch" size="4437" author="massie" created="Wed, 27 Jan 2010 02:12:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94707</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79760</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-382] hashCode throws a NullPointerException when fields are uninitialized</title>
                <link>https://issues.apache.org/jira/browse/AVRO-382</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;When you call hashCode on an Avro Record with unitialized fields the method throws a NullPointerException.  This is especially troublesome if you are trying to instantiate an object from an interactive console (like scala), as this makes it impossible to create records.  Here is an example, where KVPair is defined as follows:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{
	&quot;namespace&quot;: &quot;edu.berkeley.cs.scads&quot;,
	&quot;protocol&quot;: &quot;Storage&quot;,

	&quot;types&quot;: [
		{&quot;name&quot;: &quot;KVPair&quot;, &quot;type&quot;: &quot;record&quot;, &quot;fields&quot;: [
			{&quot;name&quot;: &quot;key&quot;, &quot;type&quot;: &quot;string&quot;},
			{&quot;name&quot;: &quot;value&quot;, &quot;type&quot;: &quot;string&quot;}]
		}
	]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
scala&amp;gt; val x = new edu.berkeley.cs.scads.KVPair
val x = new edu.berkeley.cs.scads.KVPair
java.lang.NullPointerException
	at org.apache.avro.specific.SpecificRecordBase.hashCode(SpecificRecordBase.java:62)
	at org.apache.avro.specific.SpecificRecordBase.hashCode(SpecificRecordBase.java:55)
	at edu.berkeley.cs.scads.KVPair.hashCode(Record.java:50001)
	at java.lang.Object.toString(Object.java:219)
	at edu.berkeley.cs.scads.KVPair.toString(Record.java:50001)
	at scala.runtime.ScalaRunTime$.stringOf(ScalaRunTime.scala:165)
	at RequestResult$.&amp;lt;init&amp;gt;(&amp;lt;console&amp;gt;:4)
	at RequestResult$.&amp;lt;clinit&amp;gt;(&amp;lt;console&amp;gt;)
	at RequestResult$result(&amp;lt;console&amp;gt;)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at scala.tools.nsc.Interpreter$Request.loadAndRun(Interpreter.scala:889)
	at scala.tools.nsc.Interpreter.interpret(Interpreter.scala:508)
	at scala.tools.nsc.InterpreterLoop.interpretStartingWith(InterpreterLoop.scala:242)
	at scala.tools.nsc.InterpreterLoop.command(InterpreterLoop.scala:230)
	at scala.tools.nsc.InterpreterLoop.repl(InterpreterLoop.scala:142)
	at scala.tools.nsc.InterpreterLoop.main(InterpreterLoop.scala:298)
	at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:141)
	at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </description>
                <environment></environment>
        <key id="12446762">AVRO-382</key>
            <summary>hashCode throws a NullPointerException when fields are uninitialized</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="marmbrus">Michael Armbrust</assignee>
                                    <reporter username="marmbrus">Michael Armbrust</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jan 2010 02:34:03 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Wed, 27 Jan 2010 17:38:45 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12805325" author="marmbrus" created="Wed, 27 Jan 2010 02:35:52 +0000"  >&lt;p&gt;This patch seems to resolve the issue for me.&lt;/p&gt;</comment>
                            <comment id="12805327" author="philip" created="Wed, 27 Jan 2010 02:47:41 +0000"  >&lt;p&gt;Michael,&lt;/p&gt;

&lt;p&gt;Patch makes sense.  Could you add a small unit test that triggers the failure?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12805400" author="marmbrus" created="Wed, 27 Jan 2010 07:39:27 +0000"  >&lt;p&gt;Suggestions welcome if anyone has a better idea where this test belongs, but it should trigger the failure.&lt;/p&gt;</comment>
                            <comment id="12805583" author="philip" created="Wed, 27 Jan 2010 17:27:50 +0000"  >&lt;p&gt;I just committed this.  Thanks, Michael!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431530" name="hashCodeTest.diff" size="640" author="marmbrus" created="Wed, 27 Jan 2010 07:39:27 +0000"/>
                            <attachment id="12431497" name="hashFix.diff" size="471" author="marmbrus" created="Wed, 27 Jan 2010 02:39:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 27 Jan 2010 02:47:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94708</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzzr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79761</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-383] Optimizing ResolvingDecoder for default values</title>
                <link>https://issues.apache.org/jira/browse/AVRO-383</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;When the reader&apos;s and writer&apos;s schemas are records and the reader&apos;s schema has a field with default value and the writer&apos;s schema doesn&apos;t have the field, the ResolvingDecoder keeps the default value in a byte array. This byte array is in Json format. Moving this to Avro binary format improves performance.&lt;/p&gt;

&lt;p&gt;Apply the test patch and try &quot;Perf -M&quot;. Then apply the patch and run it again. On my machine, the performance is three times the original.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12446834">AVRO-383</key>
            <summary>Optimizing ResolvingDecoder for default values</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="thiru_mg">Thiruvalluvan M. G.</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jan 2010 17:22:04 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Tue, 2 Feb 2010 05:07:51 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12805590" author="philip" created="Wed, 27 Jan 2010 17:51:31 +0000"  >&lt;p&gt;Quick question: is it possible to avoid ResolvingParserGenerator.java::encode() having a full switch on all AVRO types?  Or is the reason that you can&apos;t use JsonDecoder here because this is required for JsonDecoder to work?&lt;/p&gt;</comment>
                            <comment id="12805619" author="cutting" created="Wed, 27 Jan 2010 19:10:39 +0000"  >&lt;p&gt;Another way to implement ResolvingParserGenerator.java::encode() might  be to call GenericData#defaultFieldValue() then use GenericDatumWriter to encode this as binary.  This might be a bit slower, but it would use a lot less code, and this is done at schema-compilation time, so shouldn&apos;t be too performance critical.&lt;/p&gt;</comment>
                            <comment id="12805765" author="thiru_mg" created="Thu, 28 Jan 2010 03:54:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;Quick question: is it possible to avoid ResolvingParserGenerator.java::encode() having a full switch on all AVRO types? Or is the reason that you can&apos;t use JsonDecoder here because this is required for JsonDecoder to work?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is relatively easy to convert the JsonNode into a byte array and then read it back using JsonDecoder. The main reason I didn&apos;t want to use JsonDecoder is because JsonDecoder decodes in a streaming mode, it does not read the whole Json objects into memory before decoding the contents. We can decode very large objects without consuming too much of memory, this way. The main drawback of this approach is that records should encode their fields in the same order as that of the schema. We left this limitation in the JsonDecoder because we didn&apos;t want to buffer things.&lt;/p&gt;

&lt;p&gt;But, with default values, you don&apos;t expect the that the authors of the schema to write the default values preserving its field order. Even if they do, if the schema file is passed through some Json tools, the order is not guaranteed to be preserved.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Another way to implement ResolvingParserGenerator.java::encode() might be to call GenericData#defaultFieldValue() then use GenericDatumWriter to encode this as binary. This might be a bit slower, but it would use a lot less code, and this is done at schema-compilation time, so shouldn&apos;t be too performance critical.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I guess you meant GenericDatumReader#defaultFieldValue(). I did consider using defaultFieldValue() function. In fact the ResolvingParserGenerator&apos;s encode() modeled after defaultFieldValue(). The reason I didn&apos;t do so was that I didn&apos;t want to create mess of dependencies. Presently, the dependency is Schema is at layer 0, &lt;/p&gt;
{ BinaryEncoder, BinaryDecoder}
&lt;p&gt; at the layer 1, the classes in io.parsing at layer 2,  the rest of the &quot;advanced&quot; encoders and decoders of io package at layer 3. Everything else is above layer 4. Throwing generic package into the mix, will look a lot complicated.&lt;/p&gt;

&lt;p&gt;There is a proposal to implement GenericDatumReader using ResolvingDecoder. Using GenericDatumReader in ResolvingDecoder will then cause circular dependency.&lt;/p&gt;

&lt;p&gt;I also looked at refactoring defaultFieldValue() into some common place and use it both at GenericDatumReader and ResolvingDecoder. But defaultFieldValue calls virtual methods of GenericDatumReader giving hooks for the users to customize its behavior.&lt;/p&gt;</comment>
                            <comment id="12806036" author="cutting" created="Thu, 28 Jan 2010 19:19:36 +0000"  >&lt;p&gt;I&apos;m +0 with the logic duplication in the patch: it&apos;s unfortunate, since we&apos;ll have to update two places if either (a) this logic has common bugs, or (b) the spec changes.  I suspect (a) is more likely than (b).  But, Thiru, you&apos;ve provided some reasons why sharing this logic might not be easy and I don&apos;t see an easy alternative.&lt;/p&gt;

&lt;p&gt;&amp;gt; There is a proposal to implement GenericDatumReader using ResolvingDecoder.&lt;/p&gt;

&lt;p&gt;Do we yet have a Jira for this?&lt;/p&gt;</comment>
                            <comment id="12806451" author="thiru_mg" created="Fri, 29 Jan 2010 19:18:01 +0000"  >&lt;p&gt;Committed revision 904596.&lt;/p&gt;

&lt;p&gt;I tried to refactor the code with a generic schema walker so that both GenericDatumReader and ResolvingGrammarGenerator can use. But it became much more complex than what we have today. So I settled for the logic and code duplication.&lt;/p&gt;

&lt;p&gt;Thanks Doug and Philip for your review and comments.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&amp;gt; There is a proposal to implement GenericDatumReader using ResolvingDecoder.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Do we yet have a Jira for this?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m still working on benchmark to demonstrate the benefits. I file a JIRA possibly tomorrow.&lt;/p&gt;</comment>
                            <comment id="12806822" author="thiru_mg" created="Sun, 31 Jan 2010 13:52:21 +0000"  >&lt;p&gt;The patch is incomplete:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The skip operation still uses the JSonDecoder. Probably, this problem will never be caught because the default values will never be skipped - the default value come into play when the reader wants it and the writer doesn&apos;t have it. Skip happens when the situation is the other way around - writer has it and reader doesn&apos;t want it. Nevertheless, the API allows skip of default values, we should fix it.&lt;/li&gt;
	&lt;li&gt;With the Json decoder gone, DefaultStartAction no longer needs the the field &quot;root&quot;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The new patch fixes both the problems. &lt;/p&gt;</comment>
                            <comment id="12806835" author="thiru_mg" created="Sun, 31 Jan 2010 14:49:02 +0000"  >&lt;p&gt;There a new unit-test that catches this corner-case.&lt;/p&gt;</comment>
                            <comment id="12828215" author="cutting" created="Mon, 1 Feb 2010 18:37:31 +0000"  >&lt;p&gt;+1.  Thanks!&lt;/p&gt;</comment>
                            <comment id="12828446" author="thiru_mg" created="Tue, 2 Feb 2010 05:07:51 +0000"  >&lt;p&gt;Committed revision 905516. Thanks Doug for reviewing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431907" name="AVRO-383-new-test.patch" size="1281" author="thiru_mg" created="Sun, 31 Jan 2010 14:49:02 +0000"/>
                            <attachment id="12431908" name="AVRO-383-new.patch" size="2223" author="thiru_mg" created="Sun, 31 Jan 2010 14:49:02 +0000"/>
                            <attachment id="12431578" name="AVRO-383-test.patch" size="2480" author="thiru_mg" created="Wed, 27 Jan 2010 17:27:57 +0000"/>
                            <attachment id="12431579" name="AVRO-383.patch" size="11176" author="thiru_mg" created="Wed, 27 Jan 2010 17:27:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 27 Jan 2010 17:51:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0dzzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-384] Add schema projection to the C implementation</title>
                <link>https://issues.apache.org/jira/browse/AVRO-384</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch adds &quot;projection&quot; to the C implementation.  &lt;/p&gt;

&lt;p&gt;It also updated the example code/ documentation to give an example of schema projection and fixes a small bug in the valgrind unit test. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12446873">AVRO-384</key>
            <summary>Add schema projection to the C implementation</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="massie">Matt Massie</assignee>
                                    <reporter username="massie">Matt Massie</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jan 2010 02:02:41 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Thu, 28 Jan 2010 04:29:30 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12805773" author="massie" created="Thu, 28 Jan 2010 04:29:30 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94710</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e007:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79763</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-385] Initializing uninitialized BlockingBinaryEncoder fails</title>
                <link>https://issues.apache.org/jira/browse/AVRO-385</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The problem is the same as in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-375&quot; title=&quot;Initializing uninizialized encoders fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-375&quot;&gt;&lt;del&gt;AVRO-375&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-375&quot; title=&quot;Initializing uninizialized encoders fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-375&quot;&gt;&lt;del&gt;AVRO-375&lt;/del&gt;&lt;/a&gt; missed BlockingBinaryEncoder and fixed others. This patch fixes BlockingBinaryEncoder.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12446881">AVRO-385</key>
            <summary>Initializing uninitialized BlockingBinaryEncoder fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="thiru_mg">Thiruvalluvan M. G.</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jan 2010 07:54:05 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Fri, 29 Jan 2010 10:51:02 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12806022" author="cutting" created="Thu, 28 Jan 2010 18:40:55 +0000"  >&lt;p&gt;+1 Looks good to me.  Thanks, Thiru!&lt;/p&gt;</comment>
                            <comment id="12806299" author="thiru_mg" created="Fri, 29 Jan 2010 10:51:02 +0000"  >&lt;p&gt;Committed revision 904448.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12446490">AVRO-375</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12431650" name="AVRO-385-test.patch" size="648" author="thiru_mg" created="Thu, 28 Jan 2010 07:59:21 +0000"/>
                            <attachment id="12431649" name="AVRO-385.patch" size="985" author="thiru_mg" created="Thu, 28 Jan 2010 07:59:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 28 Jan 2010 18:40:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94711</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e00f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79764</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-386] Python implementation of compression</title>
                <link>https://issues.apache.org/jira/browse/AVRO-386</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-135&quot; title=&quot;add compression to data files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-135&quot;&gt;&lt;del&gt;AVRO-135&lt;/del&gt;&lt;/a&gt; introduced compression.  &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-368&quot; title=&quot;Reserve avro.* in object container files, and rename existing reserved words.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-368&quot;&gt;&lt;del&gt;AVRO-368&lt;/del&gt;&lt;/a&gt; changed some metadata keys.  The patch to follow adds this functionality to the python implementation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12447037">AVRO-386</key>
            <summary>Python implementation of compression</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="philip">Philip Zeyliger</assignee>
                                    <reporter username="philip">Philip Zeyliger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jan 2010 19:10:38 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:22 +0000</updated>
                            <resolved>Wed, 3 Feb 2010 06:49:45 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12806450" author="philip" created="Fri, 29 Jan 2010 19:16:33 +0000"  >&lt;p&gt;Attaching patch.  Note that this implementation is using the &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-380&quot; title=&quot;Avro Container File format change:  add block size to block descriptor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-380&quot;&gt;&lt;del&gt;AVRO-380&lt;/del&gt;&lt;/a&gt; change as well.&lt;/p&gt;

&lt;p&gt;I did a minor amount of manual compatibility checking like so:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;gseq 300 | sed -e &apos;s/^/&quot;/&apos; -e &apos;s/$/&quot;/&apos; | java -jar ../java/build/avro-tools-1.2.0-dev.jar fromjson &apos;&quot;string&quot;&apos; -  --codec &quot;deflate&quot; &amp;gt; /tmp/z
PYTHONPATH=src:lib python src/avro/tool.py  dump - &amp;lt; /tmp/z
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which is to say I wrote a data file with 300 string entries and made sure they came out ok the other end.  I ended up adding a &quot;tool.py&quot; to drive this command-line utility; it&apos;s quite minimal.&lt;/p&gt;

&lt;p&gt;Jeff/Sharad: this was my first time with the python API; nice job... wasn&apos;t hard to figure out at all.&lt;/p&gt;</comment>
                            <comment id="12828889" author="philip" created="Wed, 3 Feb 2010 01:49:57 +0000"  >&lt;p&gt;Jeff, when JIRA was acting up, suggested the following feedback:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;Some comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Remove the TODO&apos;s that you implemented&lt;/li&gt;
	&lt;li&gt;In line 143, you set &lt;tt&gt;uncompressed_data = self.buffer_writer.getvalue()&lt;/tt&gt;; use this variable in line 149 instead of calling &lt;tt&gt;self.buffer_writer.getvalue()&lt;/tt&gt; again?&lt;/li&gt;
	&lt;li&gt;Extra newline added after &lt;tt&gt;self.&lt;em&gt;meta = {&lt;/tt&gt;} in DataFileWriter#&lt;/em&gt;&lt;em&gt;init&lt;/em&gt;_: remove&lt;/li&gt;
	&lt;li&gt;Will &quot;assert&quot; raise a DataFileException? I haven&apos;t tried it.&lt;/li&gt;
	&lt;li&gt;Default &quot;codec&quot; to &quot;&apos;null&apos;&quot; instead of &quot;None&quot; in DFW#_&lt;em&gt;init&lt;/em&gt;_?&lt;/li&gt;
	&lt;li&gt;What are you up to in line 213 with &lt;tt&gt;self.codec = self.codec&lt;/tt&gt;?&lt;/li&gt;
	&lt;li&gt;Line 263 is wider than 80 characters&lt;/li&gt;
	&lt;li&gt;Line 281: if you&apos;re skipping a long, why not use &quot;skip_long()&quot;? Not a big deal.&lt;/li&gt;
	&lt;li&gt;Line 285: comment on what the argument of &quot;-15&quot; means to zlib.decompress&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks for tackling this one, Philip!&lt;/p&gt;</comment>
                            <comment id="12828908" author="philip" created="Wed, 3 Feb 2010 02:38:45 +0000"  >&lt;p&gt;Thanks for the review.  Uploading new patch.  If you want to see just what&apos;s changed since the last one, &lt;a href=&quot;http://github.com/philz/avro/commit/3832584eebe545dfe7431ae8cc7bfa85e58ec430&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://github.com/philz/avro/commit/3832584eebe545dfe7431ae8cc7bfa85e58ec430&lt;/a&gt; .&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Remove the TODO&apos;s that you implemented&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Removed one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In line 143, you set uncompressed_data = self.buffer_writer.getvalue(); use this variable in line 149 instead of calling self.buffer_writer.getvalue() again?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Extra newline added after self.meta = {} in DataFileWriter#init_: remove&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Will &quot;assert&quot; raise a DataFileException? I haven&apos;t tried it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It would have thrown an AssertionError (or something like that).  Changed to use DataFileException.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Default &quot;codec&quot; to &quot;&apos;null&apos;&quot; instead of &quot;None&quot; in DFW#&lt;em&gt;init&lt;/em&gt;?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m using &quot;null&quot; on purpose; that&apos;s the name of the &quot;null codec&quot; in AVRO.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What are you up to in line 213 with self.codec = self.codec?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No idea; removed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Line 263 is wider than 80 characters&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Line 281: if you&apos;re skipping a long, why not use &quot;skip_long()&quot;? Not a big deal.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Java doesn&apos;t have skip_long because it&apos;s the same performance.  Switching to skip; it&apos;s better.&lt;/p&gt;</comment>
                            <comment id="12828943" author="hammer" created="Wed, 3 Feb 2010 04:43:45 +0000"  >&lt;p&gt;Looks great, thanks!&lt;/p&gt;

&lt;p&gt;One last comment: &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Default &quot;codec&quot; to &quot;&apos;null&apos;&quot; instead of &quot;None&quot; in DFW#init?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What I meant here: you assign &quot;None&quot; to the codec parameter as its default value, but in the body of the function, the first thing you do with codec is check to see if it&apos;s &quot;None&quot;, and if so, set it to &quot;&apos;null&apos;&quot;. It&apos;s not a big deal, but I can see an argument for just using &quot;&apos;null&apos;&quot; as the default value and skipping the check to see if it&apos;s &quot;None&quot;. You lose the ability to check if the parameter is unset, but you aren&apos;t using that ability right now. To be honest, more of a question than a recommendation.&lt;/p&gt;

&lt;p&gt;Otherwise, send it on in!&lt;/p&gt;</comment>
                            <comment id="12828982" author="philip" created="Wed, 3 Feb 2010 06:49:28 +0000"  >&lt;p&gt;You&apos;re totally right about the default value.  I&apos;ve been burned by leaving mutable things as default arguments in python (because they bind once), so I tend to use None, but strings are immutable in python, so, voila.  I&apos;ve fixed it.&lt;/p&gt;

&lt;p&gt;I neglected to answer:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Line 285: comment on what the argument of &quot;-15&quot; means to zlib.decompress&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It turns zlib into &quot;raw&quot; mode (that&apos;s negative) and indicates the window size (that&apos;s the maximum, 15).&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(from zlib.h on my system)&lt;br/&gt;
     windowBits can also be -8..-15 for raw inflate. In this case, -windowBits&lt;br/&gt;
   determines the window size. inflate() will then process raw deflate data,   not looking for a zlib or gzip header, not generating a check value, and not&lt;br/&gt;
   looking for any check values for comparison at the end of the stream. This&lt;br/&gt;
   is for use with other formats that use the deflate compressed data format   such as zip.  Those formats provide their own check values. If a custom&lt;br/&gt;
   format is developed using the raw deflate format for compressed data, it is&lt;br/&gt;
   recommended that a check value such as an adler32 or a crc32 be applied to   the uncompressed data as is done in the zlib, gzip, and zip formats.  For&lt;br/&gt;
   most applications, the zlib format should be used as is. Note that comments&lt;br/&gt;
   above on the use in deflateInit2() applies to the magnitude of windowBits.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12434629" name="AVRO-386.patch.txt" size="14316" author="philip" created="Wed, 3 Feb 2010 02:38:45 +0000"/>
                            <attachment id="12431801" name="AVRO-386.patch.txt" size="13945" author="philip" created="Fri, 29 Jan 2010 19:16:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Feb 2010 04:43:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94712</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e00n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-387] Add IndexedRecord interface to share more logic between specific and generic.</title>
                <link>https://issues.apache.org/jira/browse/AVRO-387</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This is a very similar issue to &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-382&quot; title=&quot;hashCode throws a NullPointerException when fields are uninitialized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-382&quot;&gt;&lt;del&gt;AVRO-382&lt;/del&gt;&lt;/a&gt;, except this time it happens for uninitialized unions instead of primitive fields.  Once again, this makes it very difficult to use avro from the scala console.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.avro.AvroRuntimeException: Not in union [{&quot;type&quot;:&quot;record&quot;,&quot;name&quot;:&quot;GetRequest&quot;,&quot;namespace&quot;:&quot;edu.berkeley.cs.scads.comm&quot;,&quot;fields&quot;:[{&quot;name&quot;:&quot;namespace&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;key&quot;,&quot;type&quot;:&quot;bytes&quot;}]}]: null
	at org.apache.avro.generic.GenericData.resolveUnion(GenericData.java:339)
	at org.apache.avro.generic.GenericData.hashCode(GenericData.java:429)
	at org.apache.avro.specific.SpecificData.hashCode(SpecificData.java:227)
	at org.apache.avro.generic.GenericData.hashCodeAdd(GenericData.java:439)
	at org.apache.avro.specific.SpecificData.hashCode(SpecificData.java:223)
	at org.apache.avro.specific.SpecificRecordBase.hashCode(SpecificRecordBase.java:52)
	at java.lang.Object.toString(Object.java:219)
	at scala.runtime.ScalaRunTime$.stringOf(ScalaRunTime.scala:165)
	at RequestResult$.&amp;lt;init&amp;gt;(&amp;lt;console&amp;gt;:4)
	at RequestResult$.&amp;lt;clinit&amp;gt;(&amp;lt;console&amp;gt;)
	at RequestResult$result(&amp;lt;console&amp;gt;)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at scala.tools.nsc.Interpreter$Request.loadAndRun(Interpreter.scala:889)
	at scala.tools.nsc.Interpreter.interpret(Interpreter.scala:508)
	at scala.tools.nsc.InterpreterLoop.interpretStartingWith(InterpreterLoop.scala:242)
	at scala.tools.nsc.InterpreterLoop.command(InterpreterLoop.scala:230)
	at scala.tools.nsc.InterpreterLoop.repl(InterpreterLoop.scala:142)
	at scala.tools.nsc.InterpreterLoop.main(InterpreterLoop.scala:298)
	at scala.tools.nsc.MainGenericRunner$.main(MainGenericRunner.scala:141)
	at scala.tools.nsc.MainGenericRunner.main(MainGenericRunner.scala)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12447056">AVRO-387</key>
            <summary>Add IndexedRecord interface to share more logic between specific and generic.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="marmbrus">Michael Armbrust</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jan 2010 22:07:36 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:23 +0000</updated>
                            <resolved>Tue, 2 Feb 2010 21:53:24 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12828002" author="philip" created="Mon, 1 Feb 2010 04:19:32 +0000"  >&lt;p&gt;This patch should do it.  What do you think?&lt;/p&gt;</comment>
                            <comment id="12828226" author="marmbrus" created="Mon, 1 Feb 2010 19:05:48 +0000"  >&lt;p&gt;I still seem to be having the issue when working with specific types.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scala&amp;gt; val x = new Key                
val x = new Key
java.lang.NullPointerException
	at org.apache.avro.specific.SpecificData.hashCode(SpecificData.java:223)
	at org.apache.avro.generic.GenericData.hashCodeAdd(GenericData.java:443)
	at org.apache.avro.specific.SpecificData.hashCode(SpecificData.java:223)
	at org.apache.avro.specific.SpecificRecordBase.hashCode(SpecificRecordBase.java:40)
	at edu.berkeley.cs.scads.Key.hashCode(Key.java:50001)
	at java.lang.Object.toString(Object.java:219)
	at edu.berkeley.cs.scads.Key.toString(Key.java:50001)
....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will try to create a unit test that triggers the problem.&lt;/p&gt;</comment>
                            <comment id="12828242" author="cutting" created="Mon, 1 Feb 2010 19:42:44 +0000"  >&lt;p&gt;Here&apos;s a version that also fixes this for specific records.&lt;/p&gt;</comment>
                            <comment id="12828246" author="scott_carey" created="Mon, 1 Feb 2010 19:48:57 +0000"  >&lt;p&gt;Perhaps a longer term solution to this is making toString() not depend on hashCode().  AvroSpecific objects can define their own toString methods.&lt;/p&gt;

&lt;p&gt;In fact, in all my use cases of the SpecificAPI so far I avoided these issues by writing my own toString() methods on the wrappers &amp;#8211; it was important for debugging to be able to print object state whether the object conformed to the schema or not.  Finding bugs where data is incorrectly set is much easier with a &quot;safe&quot; toString() that is never expected to fail.&lt;/p&gt;

&lt;p&gt;hashCode() should probably never fail either, but changes there are more dangerous since it needs to be carefully kept consistent with equals().&lt;/p&gt;</comment>
                            <comment id="12828250" author="marmbrus" created="Mon, 1 Feb 2010 20:06:29 +0000"  >&lt;p&gt;Doug&apos;s updated patch fixes the issue for me.  Thanks!&lt;/p&gt;

&lt;p&gt;Also, I agree with Scott that while it&apos;s probably desirable for hashCode to never fail, implementing a toString for Specific records makes debugging much easier and is a good long term solution.  In fact, this is the work-around we have hacked in locally (using the GenericAPI&apos;s toString code).&lt;/p&gt;</comment>
                            <comment id="12828269" author="cutting" created="Mon, 1 Feb 2010 21:03:13 +0000"  >&lt;p&gt;Here&apos;s a patch that adds a new interface, IndexedRecord, that&apos;s used by both specific and generic, so that toString() and hashCode() implementations can be shared.  The SpecificRecord interface is retained only as a marker.  Should we remove this altogether?&lt;/p&gt;</comment>
                            <comment id="12828434" author="scott_carey" created="Tue, 2 Feb 2010 04:01:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Here&apos;s a patch that adds a new interface, IndexedRecord, that&apos;s used by both specific and generic, so that toString() and hashCode() implementations can be shared. The SpecificRecord interface is retained only as a marker. Should we remove this altogether?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like this approach.  My preference in general it is to remove an empty interface.  Converting my code to change SpecificRecord to IndexedRecord is a trivial thing to do.  But I have a suspicion that we&apos;ll have a need to add to the SpecificRecord interface at some point.  &lt;br/&gt;
Maybe SpecificRecordBase should just be renamed SpecificRecord and changed to implement IndexedRecord?  I think that wouldn&apos;t break any of my client code currently referencing the SpecificRecord interface.&lt;/p&gt;</comment>
                            <comment id="12828500" author="philip" created="Tue, 2 Feb 2010 06:39:08 +0000"  >&lt;p&gt;+1 to the &quot;2010-02-01 07:42 PM&quot; patch.  The newest one looks like you did it in an old repository: &quot;src/java/org/apache/avro/generic/GenericRecord.java&quot; is not a normal path any more.&lt;/p&gt;</comment>
                            <comment id="12828684" author="cutting" created="Tue, 2 Feb 2010 17:51:00 +0000"  >&lt;p&gt;&amp;gt; The newest one looks like you did it in an old repository [ ... ]&lt;/p&gt;

&lt;p&gt;Oops.  I just generated it from lang/java.  All changes are in lang/java, so it&apos;s a complete patch.&lt;/p&gt;</comment>
                            <comment id="12828691" author="cutting" created="Tue, 2 Feb 2010 17:59:37 +0000"  >&lt;p&gt;Scott&amp;gt; But I have a suspicion that we&apos;ll have a need to add to the SpecificRecord interface at some point.&lt;/p&gt;

&lt;p&gt;I do too, so my instinct is to leave it as a marker for now.&lt;/p&gt;

&lt;p&gt;Scott&amp;gt; Maybe SpecificRecordBase should just be renamed SpecificRecord and changed to implement IndexedRecord?&lt;/p&gt;

&lt;p&gt;Currently SpecificData uses the SpecificRecord interface, which folks could implement differently, not with SpecificRecordBase.  I&apos;m not convinced we should discard that yet.&lt;/p&gt;</comment>
                            <comment id="12828779" author="philip" created="Tue, 2 Feb 2010 21:40:09 +0000"  >&lt;p&gt;+1 the latest patch.&lt;/p&gt;

&lt;p&gt;Do update the description of this issue to include something about the new IndexedRecord interface.&lt;/p&gt;

&lt;p&gt;The change of set() to put() might screw some clients.  I&apos;m ok with not putting @deprecated everywhere quite yet, but we should make sure to mark this as incompatible.&lt;/p&gt;</comment>
                            <comment id="12828784" author="cutting" created="Tue, 2 Feb 2010 21:53:12 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12434431" name="AVRO-387.patch" size="17570" author="cutting" created="Mon, 1 Feb 2010 21:03:13 +0000"/>
                            <attachment id="12434427" name="AVRO-387.patch" size="4055" author="cutting" created="Mon, 1 Feb 2010 19:42:44 +0000"/>
                            <attachment id="12434363" name="AVRO-387.patch.txt" size="2345" author="philip" created="Mon, 1 Feb 2010 04:19:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Feb 2010 04:19:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e00v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79766</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-388] Using ResolvingDecoder in GenericDatumReader</title>
                <link>https://issues.apache.org/jira/browse/AVRO-388</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch removes GenericDatumReader&apos;s own logic for schema resolution by relying on ResolvingDecoder. The code has become somewhat compact. The duplication logic we were concerned about in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-383&quot; title=&quot;Optimizing ResolvingDecoder for default values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-383&quot;&gt;&lt;del&gt;AVRO-383&lt;/del&gt;&lt;/a&gt; is gone.&lt;/p&gt;

&lt;p&gt;There are three changes to the public interface of GenericDatumReader:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;readInt() and readString() functions no longer provide the writer&apos;s schema. I think it is reasonable that code outside GenericDatumReader should not worry about schema resolution and thus don&apos;t have to know about writer&apos;s schema.&lt;/li&gt;
	&lt;li&gt;setSchema() function of DatumReader may throw IOException.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;None in Avro codebase is affected by these changes.&lt;/p&gt;

&lt;p&gt;In terms of performance:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;When there is no resolution required, that is reader&apos;s and writer&apos;s schemas are identical, there is no change in performance. In fact, ResolvingEncoder is not used in this case. Use Perf -G to measuer.&lt;/li&gt;
	&lt;li&gt;If the resolution involves only promotions (from int to long)  the new code is about 5% faster. User Perf -Gp&lt;/li&gt;
	&lt;li&gt;If the resolution involves supplying default values from the reader&apos;s schema because writer&apos;s schema does have a field, the node is faster about 15%. This improvement is probably due to &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-383&quot; title=&quot;Optimizing ResolvingDecoder for default values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-383&quot;&gt;&lt;del&gt;AVRO-383&lt;/del&gt;&lt;/a&gt;. User Perf -Gd to measure this.&lt;/li&gt;
	&lt;li&gt;If the resolution involves field reordering (reader&apos;s and writer&apos;s schema have the same fields, but in different order) the new code is &lt;em&gt;slower&lt;/em&gt; by about 20%. This is because, ResolvingDecoder provides information on field reordering through a vector of Schema.Field objects. The Field class has the field position but not the field name. But GenericDatumWriter&apos;s setField() function needs the field name. getFieldName() function introduced in this patch does a linear search to find the name from the reader&apos;s schema. This is inefficient. We can handle this problem in any of the following ways:&lt;br/&gt;
      1. Do nothing claiming that field reordering is rare and we can live with this inefficiency. I tried this and saw that the new code performs about 5-10% faster than the old.&lt;br/&gt;
      2. Change the signature of the setField() so that it does not require the field name. This is an incomaptible change to the GenericDatumReader&apos;s public interface. None of the code in the current Avro will need field name. But if somebody has extended GenericDatumReader, they will be affected.&lt;br/&gt;
      3. Have a new class FieldInfo which has the name and position of the field and make ResolvingDecoder return an array of FieldInfo instead of Field. It&apos;s not obvious, which package/class this new class would go to. If one wants a clean dependencies, probably it belongs to io package. I&apos;m not confortable adding another class into the io package at the present. Keeping it as an inner class of ResolvingDecoder will create circular dependencies between the io.parsing package and ResolvingDecoder class.&lt;br/&gt;
     4. Instead of a new class FieldInfo above use Map.Entry&amp;lt;String, Field&amp;gt;.&lt;br/&gt;
     5. Add a new field called &quot;name&quot; to Schema.Field class. It will be somewhat redundant because the key of the fields map of RecordSchema is the field name. With this, the field name will be available both as the key and as a part of value of the map.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     My personal preference is 5 followed by 4.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12447075">AVRO-388</key>
            <summary>Using ResolvingDecoder in GenericDatumReader</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="thiru_mg">Thiruvalluvan M. G.</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Jan 2010 09:38:29 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:23 +0000</updated>
                            <resolved>Wed, 3 Feb 2010 01:52:47 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12828216" author="cutting" created="Mon, 1 Feb 2010 18:41:03 +0000"  >&lt;p&gt;&amp;gt; 5. Add a new field called &quot;name&quot; to Schema.Field class.&lt;/p&gt;

&lt;p&gt;This seems reasonable to me.&lt;/p&gt;</comment>
                            <comment id="12828219" author="cutting" created="Mon, 1 Feb 2010 18:51:59 +0000"  >&lt;p&gt;It&apos;s worth noting that, once this is committed, all Java DatumReader implementations will be parser-based.  This is a bit frightening, since I think few beside Thiru understand fully how the this works.  It does have documentation.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://hadoop.apache.org/avro/docs/current/api/java/org/apache/avro/io/parsing/doc-files/parsing.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hadoop.apache.org/avro/docs/current/api/java/org/apache/avro/io/parsing/doc-files/parsing.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But I have never made it through a detailed read of that document and only claim a partial understanding.&lt;/p&gt;

&lt;p&gt;The parser-based implementation has real advantages: it&apos;s faster and it simplifies things like validation, json encoders/decoders, etc.  So, on the whole, I think this is a good change, but it does scare me a bit, since, without Thiru, we&apos;d have a hard time maintaining it.&lt;/p&gt;</comment>
                            <comment id="12828602" author="thiru_mg" created="Tue, 2 Feb 2010 11:22:02 +0000"  >&lt;p&gt;The new patch has &lt;em&gt;name&lt;/em&gt; field in Schema.Field class.&lt;/p&gt;

&lt;p&gt;With this, resolution involving promotion, resolution involving field-reordering, resolution involving default values are all faster by about 20%.&lt;/p&gt;

&lt;p&gt;What is surprising is that even when there is no resolution involved (reader&apos;s and writer&apos;s schemas are identical), using ResolvingDecoder is about 15% faster. This is probably because, we no longer walk over the field list of the record schema; instead we use the field array returned by readFieldOrder(). So in this patch I use ResolvingDecoder for all cases including where no resolution is required.&lt;/p&gt;

&lt;p&gt;Apply the test.patch and run &quot;Perf -G&quot;, &quot;Perf -Gd&quot;, &quot;Perf -Go&quot; and &quot;Perf -Gp&quot; to measure the performance without the patch. Then apply the new.patch and run the same tests to measure the performance after the patch.&lt;/p&gt;</comment>
                            <comment id="12828698" author="cutting" created="Tue, 2 Feb 2010 18:19:22 +0000"  >&lt;p&gt;+1 Overall this looks good.&lt;/p&gt;

&lt;p&gt;A few minor changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The common call sequence, e.g., when opening a data file or in RPC, is that the DatumReader constructor is passed the expected schema and the actual schema is subsequently set by the container with #setSchema().  In this common case, setResolver() is called twice.  This is only done once per file, but still might be a substantial, redundant, computation.  I wonder if rather setting expected or actual should cause resolver to be set to null, then construct the resolver in #read(D, decoder) when it&apos;s null?&lt;/li&gt;
	&lt;li&gt;I&apos;d prefer if the switch statement in #read(Object,Schema,Decoder) were ordered the same as the symbols in the Type enum.  I&apos;ve tried to everywhere use this same order, for consistency.  So UNION should go between MAP and FIXED.  Not a big deal.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12828891" author="thiru_mg" created="Wed, 3 Feb 2010 01:52:47 +0000"  >&lt;p&gt;Committed revision 905865 incorporating Doug&apos;s suggestions on initializing resolver and order of switch cases. Thanks Doug.&lt;/p&gt;</comment>
                            <comment id="12828997" author="scott_carey" created="Wed, 3 Feb 2010 07:44:44 +0000"  >&lt;p&gt;There is a memory leak somewhere in the test, or in the code.&lt;/p&gt;

&lt;p&gt;If I run all the tests one after another, I get an OutOfMemoryError. If I set it to -Xmx256m, it finishes (barely) while the GC is going nuts (seen in jconsole).&lt;/p&gt;

&lt;p&gt;It might be the test.  I&apos;ll report back if I can fix it by setting some stuff to null in the test.&lt;/p&gt;</comment>
                            <comment id="12829013" author="scott_carey" created="Wed, 3 Feb 2010 10:48:16 +0000"  >&lt;p&gt;It doesn&apos;t seem to be a leak, but it does seem to be a large chunk of state and garbage creation from the Generic tests.&lt;/p&gt;

&lt;p&gt;I modified the test so that it frees the Test instances as it runs them, which helps delay the OOME or avoid it.  increasing the number of iterations does not cause an OOME so its not a leak, but the total memory required to run the test is a lot as there is much memory allocation and GC thrashing. The arrays for all tests are allocated up front.  So the latter tests have more space, but these have GC issues.&lt;/p&gt;

&lt;p&gt;Some jmap -histo output during the Generic tests below:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; num     #instances         #bytes  class name
----------------------------------------------
   1:          1427       59024200  [B
   2:         27956        3624672  [Ljava.lang.Object;
   3:         82825        1987800  java.lang.Integer
   4:         82569        1981656  java.lang.Double
   5:         12289        1575376  &amp;lt;constMethodKlass&amp;gt;
   6:         12289        1480328  &amp;lt;methodKlass&amp;gt;
   7:          1026        1128752  &amp;lt;constantPoolKlass&amp;gt;
   8:         19468         956488  &amp;lt;symbolKlass&amp;gt;
   9:         27523         880736  org.apache.avro.generic.GenericData$Record
  10:          1026         744032  &amp;lt;instanceKlassKlass&amp;gt;
  11:           874         692128  &amp;lt;constantPoolCacheKlass&amp;gt;
  12:           994         629936  [I
  13:          2925         294576  [C
  14:          1161         213624  java.lang.Class

 num     #instances         #bytes  class name
----------------------------------------------
   1:          1427       59024200  [B
   2:        192562       15476304  [Ljava.lang.Object;
   3:        576644       13839456  java.lang.Integer
   4:        576388       13833312  java.lang.Double
   5:        192129        6148128  org.apache.avro.generic.GenericData$Record
   6:         12289        1575376  &amp;lt;constMethodKlass&amp;gt;
   7:         12289        1480328  &amp;lt;methodKlass&amp;gt;
   8:          1026        1128752  &amp;lt;constantPoolKlass&amp;gt;
   9:         19468         956488  &amp;lt;symbolKlass&amp;gt;
  10:          1026         744032  &amp;lt;instanceKlassKlass&amp;gt;
  11:           874         692128  &amp;lt;constantPoolCacheKlass&amp;gt;
  12:           994         636696  [I

 num     #instances         #bytes  class name
----------------------------------------------
   1:        473087       77890584  [B
   2:        236262       23995904  [Ljava.lang.Object;
   3:        707740       16985760  java.lang.Integer
   4:        707483       16979592  java.lang.Double
   5:        471654       15092928  org.apache.avro.util.Utf8
   6:        235828        7546496  org.apache.avro.generic.GenericData$Record
   7:         12289        1575376  &amp;lt;constMethodKlass&amp;gt;
   8:         12289        1480328  &amp;lt;methodKlass&amp;gt;
   9:          7547        1170144  [I
  10:          1026        1128752  &amp;lt;constantPoolKlass&amp;gt;
  11:         19468         956488  &amp;lt;symbolKlass&amp;gt;
  12:          1026         744032  &amp;lt;instanceKlassKlass&amp;gt;
  13:           874         692128  &amp;lt;constantPoolCacheKlass&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It appears as though there is a very large volume of boxed Integer and Double objects, and in one test a lot of Utf8 and Byte[] creation.  There is a large number of reflection related objects as well.&lt;/p&gt;

&lt;p&gt;Performance can improve if allocations of the above can be reduced in the Generic API case.  This is a single threaded test, but with two GC threads active, the CPU usage on my machine during the Generic tests is 130% to 150%.  This indicates that about 30% to 50% of the time is in GC .  A multithreaded test would cause that ratio to go up to close to 66% GC time.&lt;/p&gt;

&lt;p&gt;Details on GC time calculation for 150% CPU usage on single threaded app:&lt;br/&gt;
(1 * (app_time) + 2 * (gc_thread_time) ) = 150% ;&lt;br/&gt;
only a gc thread can go above 100% CPU, so the min time for one gc_thread is 50%.  This leaves 50% of one CPU to the app thread.&lt;br/&gt;
By clock time 50% is the app thread, and 50% is both GC threads at the same time.  &lt;br/&gt;
By total CPU use, GC is 100% of a CPU, and the app is 50%, a 2:1 ratio.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12434520" name="AVRO-388-new.patch" size="23279" author="thiru_mg" created="Tue, 2 Feb 2010 11:22:02 +0000"/>
                            <attachment id="12431860" name="AVRO-388-test.patch" size="14921" author="thiru_mg" created="Sat, 30 Jan 2010 09:50:44 +0000"/>
                            <attachment id="12431862" name="AVRO-388.patch" size="22711" author="thiru_mg" created="Sat, 30 Jan 2010 11:24:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Feb 2010 18:41:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94714</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e013:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-389] ResolvingDecoder does not resolve enum well</title>
                <link>https://issues.apache.org/jira/browse/AVRO-389</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Silly bug. mkEnumAdjust() and its caller don&apos;t agree on the order of the arguments. Strange that the bug existed for so long. The test-patch has some new tests to test untested portions of ResolvingEncoder. The actual patch fixes the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12447114">AVRO-389</key>
            <summary>ResolvingDecoder does not resolve enum well</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="thiru_mg">Thiruvalluvan M. G.</reporter>
                        <labels>
                    </labels>
                <created>Sun, 31 Jan 2010 16:59:24 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:23 +0000</updated>
                            <resolved>Tue, 2 Feb 2010 05:20:48 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12828214" author="cutting" created="Mon, 1 Feb 2010 18:35:55 +0000"  >&lt;p&gt;+1  Thanks!&lt;/p&gt;</comment>
                            <comment id="12828448" author="thiru_mg" created="Tue, 2 Feb 2010 05:20:48 +0000"  >&lt;p&gt;Committed revision 905518. Thanks Doug for reviewing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431914" name="AVRO-389-test.patch" size="1660" author="thiru_mg" created="Sun, 31 Jan 2010 17:27:09 +0000"/>
                            <attachment id="12431913" name="AVRO-389.patch" size="724" author="thiru_mg" created="Sun, 31 Jan 2010 17:27:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Feb 2010 18:35:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94715</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e01b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79768</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-390] ResolvingDecoder does not handle default values for records well</title>
                <link>https://issues.apache.org/jira/browse/AVRO-390</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Default values for simple fields work fine. But if a field is of type record and that field has default value, the values are inserted fine. But since the client has no knowledge that what is being read is a default value, it tries to get the field order of this record using readFieldOrder(). But the current implementation does not expect such a call. The accompanying test patch catches the problem. The actual patch fixes the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12447115">AVRO-390</key>
            <summary>ResolvingDecoder does not handle default values for records well</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="thiru_mg">Thiruvalluvan M. G.</reporter>
                        <labels>
                    </labels>
                <created>Sun, 31 Jan 2010 17:32:46 +0000</created>
                <updated>Mon, 1 Mar 2010 17:09:23 +0000</updated>
                            <resolved>Tue, 2 Feb 2010 05:36:00 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12828212" author="cutting" created="Mon, 1 Feb 2010 18:35:00 +0000"  >&lt;p&gt;+1 Looks good.  Thanks!&lt;/p&gt;</comment>
                            <comment id="12828451" author="thiru_mg" created="Tue, 2 Feb 2010 05:35:59 +0000"  >&lt;p&gt;Committed revision 905520.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12431916" name="AVRO-390-test.patch" size="3237" author="thiru_mg" created="Sun, 31 Jan 2010 17:34:59 +0000"/>
                            <attachment id="12431915" name="AVRO-390.patch" size="799" author="thiru_mg" created="Sun, 31 Jan 2010 17:34:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Feb 2010 18:35:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94716</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e01j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79769</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-391] DoS possible on java rpc servers</title>
                <link>https://issues.apache.org/jira/browse/AVRO-391</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;It is possible to crash an avro rpc server (java) by writing random strings to the socket:&lt;/p&gt;

&lt;p&gt;Try... &lt;br/&gt;
echo &quot;boom&quot; | nc localhost 9160&lt;/p&gt;

&lt;p&gt;You get...&lt;br/&gt;
java.lang.OutOfMemoryError: Java heap space&lt;br/&gt;
	at java.nio.HeapByteBuffer.&amp;lt;init&amp;gt;(HeapByteBuffer.java:57)&lt;br/&gt;
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:329)&lt;br/&gt;
	at org.apache.avro.ipc.SocketTransceiver.readBuffers(SocketTransceiver.java:65)&lt;br/&gt;
	at org.apache.avro.ipc.SocketServer$Connection.run(SocketServer.java:91)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:636)&lt;/p&gt;</description>
                <environment>&lt;p&gt;OpenJDK 1.6, Linux&lt;/p&gt;</environment>
        <key id="12454963">AVRO-391</key>
            <summary>DoS possible on java rpc servers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="urandom">Eric Evans</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Feb 2010 17:50:58 +0000</created>
                <updated>Mon, 5 Apr 2010 17:30:29 +0000</updated>
                                            <version>1.3.0</version>
                                                    <component>java</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12853347" author="jmhodges" created="Mon, 5 Apr 2010 09:36:10 +0000"  >&lt;p&gt;c.f. &lt;a href=&quot;https://issues.apache.org/jira/browse/THRIFT-601&quot; title=&quot;sending random data crashes thrift service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;THRIFT-601&quot;&gt;&lt;del&gt;THRIFT-601&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12853449" author="cutting" created="Mon, 5 Apr 2010 17:30:29 +0000"  >&lt;p&gt;This is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-144&quot; title=&quot;add random RPC request tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-144&quot;&gt;AVRO-144&lt;/a&gt; (adding random data RPC tests).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12438012">AVRO-144</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Apr 2010 09:36:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94717</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e01r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79770</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
