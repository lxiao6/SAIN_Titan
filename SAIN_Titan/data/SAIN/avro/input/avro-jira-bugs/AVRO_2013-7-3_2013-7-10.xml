<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:18:54 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2013-7-3+AND+created+%3C%3D+2013-7-10+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="1" total="1"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1352] Schema for fixed types corrupted when writing out in JSON format</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1352</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;A change made in NodeImpl.cc under &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1026&quot; title=&quot;Add namespace support to C++&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1026&quot;&gt;&lt;del&gt;AVRO-1026&lt;/del&gt;&lt;/a&gt; has introduced a bug that corrupts JSON schemas when writing them to disk or dumping to a stream.  This manifested when using DataFileWriter to generate a data file, and the schema stored in the header was corrupted from the original schema provided.&lt;/p&gt;

&lt;p&gt;e.g &lt;/p&gt;


&lt;p&gt;This:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{
  &#8220;type&#8221;: &#8220;fixed&#8221;,
  &#8220;name&#8221;: &#8220;Unsigned16&#8221;,
  &#8220;size&#8221;: 2
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Becomes this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{
  &#8220;type&#8221;: &#8220;fixed&#8221;,
  &#8220;size&#8221;: 2,
  &#8220;name&#8221; : &#8220;Unsigned16&#8221;,
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note the extraneous comma after the &#8216;name&#8217; attribute.&lt;br/&gt;
The bug exists for Avro &apos;fixed&apos; types, and has not been observed for other types. A test case will be developed.&lt;/p&gt;

&lt;p&gt;The bug can be fixed by simply re-ordering the code in NodeFixed::printJson.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12656542">AVRO-1352</key>
            <summary>Schema for fixed types corrupted when writing out in JSON format</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="roehrss">Steve Roehrs</reporter>
                        <labels>
                            <label>patch,</label>
                    </labels>
                <created>Mon, 8 Jul 2013 01:55:57 +0000</created>
                <updated>Thu, 24 Jul 2014 20:16:22 +0000</updated>
                            <resolved>Sun, 29 Jun 2014 18:30:01 +0000</resolved>
                                    <version>1.7.0</version>
                    <version>1.7.1</version>
                    <version>1.7.2</version>
                    <version>1.7.3</version>
                    <version>1.7.4</version>
                                    <fixVersion>1.7.7</fixVersion>
                                    <component>c++</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13863900" author="roehrss" created="Tue, 7 Jan 2014 04:41:29 +0000"  >&lt;p&gt;Sorry due to restrictions at my workplace I am unable to generate a patch and submit it, but I can describe the change required if someone else is able to submit it for me.&lt;/p&gt;

&lt;p&gt;In NodeImpl.cc,  NodeFixed::PrintJson should look like this:&lt;/p&gt;

&lt;p&gt;void&lt;br/&gt;
NodeFixed::PrintJson(std::ostream &amp;amp;os, int depth) const&lt;br/&gt;
{&lt;br/&gt;
  os &amp;lt;&amp;lt; &quot;&lt;/p&gt;
{\n&quot;;
  os &amp;lt;&amp;lt; indent(++depth) &amp;lt;&amp;lt; &quot;\&quot;type\&quot;: \&quot;fixed\&quot;,\n&quot;;
  printName(os, nameAttribute_.get(),depth);
  os &amp;lt;&amp;lt; indent(depth) &amp;lt;&amp;lt; &quot;\&quot;size\&quot;: &amp;lt;&amp;lt; sizeAttribute_.get() &amp;lt;&amp;lt; &quot;\n&quot;;
  os &amp;lt;&amp;lt; indent(--depth) &amp;lt;&amp;lt; &apos;}
&lt;p&gt;&apos;;&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;ie swap the lines around so that printName can print it&apos;s trailing &apos;,&apos; and be followed with the size: attribute.&lt;/p&gt;

&lt;p&gt;It&apos;d be great it this could make it into 1.7.6.  I&apos;m guessing that not many C++ users are using fixed types, which is why the bug wasn&apos;t found earlier.&lt;/p&gt;

</comment>
                            <comment id="13863902" author="roehrss" created="Tue, 7 Jan 2014 04:45:23 +0000"  >&lt;p&gt;That will teach me for not previewing! Try this :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;void
NodeFixed::PrintJson(std::ostream &amp;amp;os, int depth) const
{
  os &amp;lt;&amp;lt; &quot;{\n&quot;; 
  os &amp;lt;&amp;lt; indent(++depth) &amp;lt;&amp;lt; &quot;\&quot;type\&quot;: \&quot;fixed\&quot;,\n&quot;; 
  printName(os, nameAttribute_.get(),depth); 
  os &amp;lt;&amp;lt; indent(depth) &amp;lt;&amp;lt; &quot;\&quot;size\&quot;: &amp;lt;&amp;lt; sizeAttribute_.get() &amp;lt;&amp;lt; &quot;\n&quot;; 
  os &amp;lt;&amp;lt; indent(--depth) &amp;lt;&amp;lt; &apos;}&apos;;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14011931" author="roehrss" created="Thu, 29 May 2014 01:22:28 +0000"  >&lt;p&gt;Patch was generated under clearcase and hand-edited, hopefully it will apply properly.&lt;/p&gt;</comment>
                            <comment id="14015233" author="roehrss" created="Mon, 2 Jun 2014 07:47:49 +0000"  >&lt;p&gt;Can somebody please test this and commit - it its ok?&lt;/p&gt;</comment>
                            <comment id="14016031" author="jkarp" created="Mon, 2 Jun 2014 23:15:20 +0000"  >&lt;p&gt;Do you have a unit test that fails against trunk avro but passes after the patch is applied? (I don&apos;t have commit rights, I&apos;m just curious.)&lt;/p&gt;</comment>
                            <comment id="14016056" author="steve.roehrs@rlmgroup.com.au" created="Mon, 2 Jun 2014 23:52:02 +0000"  >&lt;p&gt;I don&apos;t have a stand-alone test case unfortunately, only our production&lt;br/&gt;
code which I can&apos;t release. I should be able to put together a small&lt;br/&gt;
test case though.&lt;/p&gt;

&lt;p&gt;Steve Roehrs&lt;/p&gt;

&lt;p&gt;Senior Software Engineer | Lockheed Martin&lt;/p&gt;






&lt;p&gt;This email and any attachment to it remains the property of Lockheed&lt;br/&gt;
Martin and is intended only to be read or used by the named addressee.&lt;br/&gt;
It may contain information that is confidential, commercially valuable&lt;br/&gt;
or subject to legal privilege.  If you receive this email in error,&lt;br/&gt;
please immediately delete it and notify the sender.  Opinions,&lt;br/&gt;
conclusions and other information in this message that do not relate to&lt;br/&gt;
the official business of Lockheed Martin or any companies within&lt;br/&gt;
Lockheed Martin shall be understood as neither given nor endorsed by&lt;br/&gt;
them.&lt;/p&gt;

&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: John Karp (JIRA) &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:jira@apache.org&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;jira@apache.org&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: Tuesday, June 03, 2014 8:46 AM&lt;br/&gt;
To: steve.roehrs@lmal.com.au&lt;br/&gt;
Subject: &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Commented&amp;#93;&lt;/span&gt; (&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1352&quot; title=&quot;Schema for fixed types corrupted when writing out in JSON format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1352&quot;&gt;&lt;del&gt;AVRO-1352&lt;/del&gt;&lt;/a&gt;) Schema for fixed types corrupted&lt;br/&gt;
when writing out in JSON format&lt;/p&gt;


&lt;p&gt;    [&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1352?page=com.atlassian.jira&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1352?page=com.atlassian.jira&lt;/a&gt;.&lt;br/&gt;
plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=14016031#&lt;br/&gt;
comment-14016031 ]&lt;/p&gt;

&lt;p&gt;John Karp commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1352&quot; title=&quot;Schema for fixed types corrupted when writing out in JSON format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1352&quot;&gt;&lt;del&gt;AVRO-1352&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
---------------------------------&lt;/p&gt;

&lt;p&gt;Do you have a unit test that fails against trunk avro but passes after&lt;br/&gt;
the patch is applied? (I don&apos;t have commit rights, I&apos;m just curious.)&lt;/p&gt;

&lt;p&gt;corrupts JSON schemas when writing them to disk or dumping to a stream.&lt;br/&gt;
This manifested when using DataFileWriter to generate a data file, and&lt;br/&gt;
the schema stored in the header was corrupted from the original schema&lt;br/&gt;
provided.&lt;br/&gt;
other types. A test case will be developed.&lt;br/&gt;
NodeFixed::printJson.&lt;/p&gt;



&lt;p&gt;&amp;#8211;&lt;br/&gt;
This message was sent by Atlassian JIRA&lt;br/&gt;
(v6.2#6252)&lt;/p&gt;

&lt;p&gt;This message is intended only for the use of the intended recipient(s)&lt;br/&gt;
If you are not an intended recipient, you are hereby notified that any&lt;br/&gt;
use, dissemination, disclosure or copying of this communication is&lt;br/&gt;
strictly prohibited. If you have received this communication in error&lt;br/&gt;
please destroy all copies of this message and its attachments and notify&lt;br/&gt;
the sender immediately&lt;/p&gt;</comment>
                            <comment id="14016228" author="roehrss" created="Tue, 3 Jun 2014 05:27:50 +0000"  >&lt;p&gt;A patch to the Avro C++ test suite to add a test case for this bug. Test fails on trunk, passes after patch.&lt;/p&gt;</comment>
                            <comment id="14045414" author="thiru_mg" created="Fri, 27 Jun 2014 01:25:35 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Looks good to me. I&apos;ll have it committed this weekend, after testing it on Windows and Mac.&lt;/p&gt;</comment>
                            <comment id="14047198" author="jira-bot" created="Sun, 29 Jun 2014 18:29:33 +0000"  >&lt;p&gt;Commit 1606560 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thiru_mg&quot; class=&quot;user-hover&quot; rel=&quot;thiru_mg&quot;&gt;Thiruvalluvan M. G.&lt;/a&gt; in branch &apos;avro/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1606560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1606560&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1352&quot; title=&quot;Schema for fixed types corrupted when writing out in JSON format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1352&quot;&gt;&lt;del&gt;AVRO-1352&lt;/del&gt;&lt;/a&gt;. Schema for fixed types corrupted when writing out in JSON format&lt;/p&gt;</comment>
                            <comment id="14047199" author="thiru_mg" created="Sun, 29 Jun 2014 18:30:01 +0000"  >&lt;p&gt;Committed revision 1606560.&lt;/p&gt;</comment>
                            <comment id="14047203" author="hudson" created="Sun, 29 Jun 2014 18:36:43 +0000"  >&lt;p&gt;SUCCESS: Integrated in AvroJava #460 (See &lt;a href=&quot;https://builds.apache.org/job/AvroJava/460/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/AvroJava/460/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1352&quot; title=&quot;Schema for fixed types corrupted when writing out in JSON format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1352&quot;&gt;&lt;del&gt;AVRO-1352&lt;/del&gt;&lt;/a&gt;. Schema for fixed types corrupted when writing out in JSON format (thiru: rev 1606560)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/avro/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/avro/trunk/lang/c++/impl/NodeImpl.cc&lt;/li&gt;
	&lt;li&gt;/avro/trunk/lang/c++/test/DataFileTests.cc&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12648078" name="AVRO-1352-Test.patch" size="1743" author="roehrss" created="Tue, 3 Jun 2014 05:27:50 +0000"/>
                            <attachment id="12647273" name="AVRO-1352.patch" size="521" author="roehrss" created="Thu, 29 May 2014 01:22:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Jun 2014 23:15:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1m36v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>337088</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
