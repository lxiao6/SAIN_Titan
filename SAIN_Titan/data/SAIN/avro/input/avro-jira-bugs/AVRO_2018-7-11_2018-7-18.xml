<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:26:57 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2018-7-11+AND+created+%3C%3D+2018-7-18+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="3" total="3"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-2198] BigDecimal (logical type=Decimal / type = bytes) GenericRecord to SpecificRecord Conversion Issue</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2198</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;There seems to be an issue with the conversion process from a byte array to a BigDecimal when converting to a SpecificRecord from a GenericRecord object.&#160;&lt;/p&gt;

&lt;p&gt;Below is a simple avro definition with &quot;amount&quot; defined as logical type &lt;b&gt;decimal&lt;/b&gt; and type &lt;b&gt;bytes&lt;/b&gt;. The avroData specific class has been generated with enablebigdecimal = true.&#160;&lt;/p&gt;

&lt;p&gt;See below example.&lt;/p&gt;

&lt;p&gt;&#160;An amount value of&#160;&lt;b&gt;20000000.11&lt;/b&gt; is converted to BigDecimal value of&#160;&lt;b&gt;606738534879530359915932.65&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; schema = &lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;type\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;record\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;name\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;avroTrans\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;namespace\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;com.demo.KafkaStream\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;fields\&lt;span class=&quot;code-quote&quot;&gt;&quot;:[{\&quot;&lt;/span&gt;name\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;amount\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;type\&lt;span class=&quot;code-quote&quot;&gt;&quot;:{\&quot;&lt;/span&gt;type\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;bytes\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;logicalType\&lt;span class=&quot;code-quote&quot;&gt;&quot;:\&quot;&lt;/span&gt;decimal\&lt;span class=&quot;code-quote&quot;&gt;&quot;,\&quot;&lt;/span&gt;precision\&lt;span class=&quot;code-quote&quot;&gt;&quot;:5,\&quot;&lt;/span&gt;scale\&lt;span class=&quot;code-quote&quot;&gt;&quot;:2}}]}&quot;&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; json = &lt;span class=&quot;code-quote&quot;&gt;&quot;{\&quot;&lt;/span&gt;amount\&lt;span class=&quot;code-quote&quot;&gt;&quot;: \&quot;&lt;/span&gt;20000000.11\&lt;span class=&quot;code-quote&quot;&gt;&quot;}&quot;&lt;/span&gt;;

Schema avroSchema = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.Parser().parse(schema);

GenericRecord obj = Utils.jsonToAvro(json, avroSchema);

&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;GenericRecord &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; Value -&amp;gt;&quot;&lt;/span&gt; + obj);

GenericDatumWriter&amp;lt;GenericRecord&amp;gt; writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericDatumWriter&amp;lt;GenericRecord&amp;gt;(avroTrans.getClassSchema());
ByteArrayOutputStream out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream();
Encoder encoder = EncoderFactory.get().binaryEncoder(out, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
writer.write(obj, encoder);
encoder.flush();

&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] avroData = out.toByteArray();
out.close();

SpecificDatumReader&amp;lt;avroTrans&amp;gt; reader2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SpecificDatumReader&amp;lt;avroTrans&amp;gt;(avroTrans.class);
Decoder decoder2 = DecoderFactory.get().binaryDecoder(avroData, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
avroTrans customRecord = reader2.read(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, decoder2);

&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;SpecificRecord &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; Value -&amp;gt; &quot;&lt;/span&gt; + customRecord);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;b&gt;Output:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;GenericRecord Object Value -&amp;gt;{&quot;amount&quot;: {&quot;bytes&quot;: &quot;20000000.11&quot;}}&lt;br/&gt;
SpecificRecord Object Value -&amp;gt; {&quot;amount&quot;: 606738534879530359915932.65}&lt;/p&gt;

&lt;p&gt;Within &lt;b&gt;org.apache.avro.Conversion&lt;/b&gt; there is a fromBytes conversion method which takes a bytebuffer as input (see below).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; @Override

&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; BigDecimal fromBytes(ByteBuffer value, Schema schema, LogicalType type) {
&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; scale = ((LogicalTypes.Decimal) type).getScale();
&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-comment&quot;&gt;// always copy the bytes out because BigInteger has no offset/length ctor
&lt;/span&gt;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] bytes = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[value.remaining()];
&#160;&#160;&#160;&#160;&#160; value.get(bytes);
&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigDecimal(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BigInteger(bytes), scale);
&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The BigInteger constructor (bytes) used version is to &quot;&lt;b&gt;&lt;em&gt;Translates a byte array containing the two&apos;s-complement binary representation of a BigInteger into a BigInteger&lt;/em&gt;&lt;/b&gt;.&quot;&lt;/p&gt;

&lt;p&gt;Could use of the BigInteger(Bytes) causing the incorrect conversion to huge number?&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;&lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (image-2018-07-12-13-02-20-961.png) not found.&lt;/span&gt;&lt;/p&gt;</environment>
        <key id="13171721">AVRO-2198</key>
            <summary>BigDecimal (logical type=Decimal / type = bytes) GenericRecord to SpecificRecord Conversion Issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bourgamb">ABourg</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jul 2018 12:21:28 +0000</created>
                <updated>Tue, 17 Jul 2018 15:07:27 +0000</updated>
                                            <version>1.8.2</version>
                                    <fixVersion>1.8.2</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="16546759" author="bourgamb" created="Tue, 17 Jul 2018 15:07:27 +0000"  >&lt;p&gt;Duplicate of *&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2087*&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2087*&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vtmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-2199]  Validate that field defaults have the correct type</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2199</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Currently, on the master branch, when a schema is parsed, it is possible to define a field with a type and a default of a totally different type. E.g. if the field has type &quot;string&quot;, the default can be set to &quot;null&quot;.&lt;/p&gt;

&lt;p&gt;I&apos;d like to open a PR which will fix this by running the default through the SchemaValidator whenever a new Field is created. See &lt;a href=&quot;https://github.com/salsify/avro-patches/pull/16&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/salsify/avro-patches/pull/16&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tjwp&quot; class=&quot;user-hover&quot; rel=&quot;tjwp&quot;&gt;Tim Perkins&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13172482">AVRO-2199</key>
            <summary> Validate that field defaults have the correct type</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="daniel.orner">Daniel Orner</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Jul 2018 21:01:08 +0000</created>
                <updated>Thu, 11 Oct 2018 16:55:58 +0000</updated>
                                            <version>1.8.2</version>
                                                    <component>ruby</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="16546795" author="githubbot" created="Tue, 17 Jul 2018 15:33:19 +0000"  >&lt;p&gt;dorner opened a new pull request #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   See &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2199&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Currently, on the master branch, when a schema is parsed, it is possible to define a field with a type and a default of a totally different type. E.g. if the field has type &quot;string&quot;, the default can be set to &quot;null&quot;.&lt;/p&gt;

&lt;p&gt;   This PR fixes this by running the default through the SchemaValidator whenever a new Field is created.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16547252" author="githubbot" created="Wed, 18 Jul 2018 00:29:06 +0000"  >&lt;p&gt;tjwp commented on a change in pull request #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320#discussion_r203220999&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320#discussion_r203220999&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: lang/ruby/lib/avro/schema.rb&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -373,6 +374,18 @@ def to_avro(names=Set.new)&lt;br/&gt;
           avro&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;doc&amp;#39;&amp;#93;&lt;/span&gt; = doc if doc&lt;br/&gt;
         end&lt;br/&gt;
       end&lt;br/&gt;
+&lt;br/&gt;
+      def validate_default!&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Should this method be made private?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16547253" author="githubbot" created="Wed, 18 Jul 2018 00:29:06 +0000"  >&lt;p&gt;tjwp commented on a change in pull request #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320#discussion_r203221105&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320#discussion_r203221105&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: lang/ruby/test/test_default_validation.rb&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,127 @@&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+# or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
+# distributed with this work for additional information&lt;br/&gt;
+# regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
+# to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+# &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+# with the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+# &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+require &apos;test_help&apos;&lt;br/&gt;
+&lt;br/&gt;
+class TestDefaultValidation &amp;lt; Test::Unit::TestCase&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   I separate these tests out for the avro-patches gem, but it may make sense to move them into `test_schema.rb` here.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16547900" author="githubbot" created="Wed, 18 Jul 2018 14:30:35 +0000"  >&lt;p&gt;dorner commented on issue #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320#issuecomment-405951524&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320#issuecomment-405951524&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @tjwp added another commit. Funny thing - once this was in, a different test failed precisely because it was using the wrong type (&quot;false&quot; instead of `false`)! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16645523" author="theturtle32" created="Wed, 10 Oct 2018 20:56:06 +0000"  >&lt;p&gt;This has an unfortunate side effect: it breaks applications from reading existing data that&apos;s been encoded with older versions of schemas that had&#160;incompatible default values specified. The library won&apos;t even finish parsing the old schemas, so you can&apos;t decode existing data.&lt;/p&gt;

&lt;p&gt;The Avro specification says that when you have a union type, any default value must be of the first type specified in the union. We have millions of records of data encoded using a schema where the default value was of the second or third type in the union instead of the first type. This always worked just fine before but with this more stringent validation, our application suddenly fails to decode our existing data because it raises an error while parsing the&#160;writer&apos;s schema.&lt;/p&gt;

&lt;p&gt;I&apos;m going to try to write a monkey-patch to relax this validation temporarily, long enough to read all existing data, migrate it to a newer schema, and re-save it. But that&apos;s a lot of&#160;time and effort to compensate for a sudden change in schema validation.&lt;/p&gt;</comment>
                            <comment id="16645527" author="githubbot" created="Wed, 10 Oct 2018 20:59:00 +0000"  >&lt;p&gt;theturtle32 commented on issue #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320#issuecomment-428729499&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320#issuecomment-428729499&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This has an unfortunate side effect: it breaks applications from reading existing data that&apos;s been encoded with older versions of schemas that had incompatible default values specified. The library won&apos;t even finish parsing the old schemas, so you can&apos;t decode existing data.&lt;/p&gt;

&lt;p&gt;   The Avro specification says that when you have a union type, any default value must be of the first type specified in the union. We have millions of records of data encoded using a schema where the default value was of the second or third type in the union instead of the first type. This always worked just fine before but with this more stringent validation, our application suddenly fails to decode our existing data because it raises an error while parsing the writer&apos;s schema.&lt;/p&gt;

&lt;p&gt;   I&apos;m going to try to write a monkey-patch to relax this validation temporarily, long enough to read all existing data, migrate it to a newer schema, and re-save it. But that&apos;s a lot of time and effort to compensate for a sudden change in schema validation.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16646752" author="githubbot" created="Thu, 11 Oct 2018 16:55:58 +0000"  >&lt;p&gt;dorner commented on issue #320: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2199&quot; title=&quot; Validate that field defaults have the correct type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2199&quot;&gt;AVRO-2199&lt;/a&gt;:  Validate that field defaults have the correct type&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/320#issuecomment-429034100&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/320#issuecomment-429034100&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @theturtle32 I definitely feel your pain. But the fact is that the current implementation is incorrect - the fact that you have bad data out there is a result of the incorrect implementation. In my case we had other Avro consumers not written in Ruby whose parsers were stricter that were crashing because we were sending bad data, so IMO it&apos;s more important to fix the behavior in Ruby which doesn&apos;t match the Avro specification.&lt;/p&gt;

&lt;p&gt;   We should definitely make this a breaking change (1.9.0 instead of 1.8.3) so people can be made aware of this.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jul 2018 15:33:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vy4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-2200] Option to fail when extra fields are in the payload</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2200</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Currently, when passing a datum into the schema validator, the datum will pass even if the datum has more fields than the schema does. This can be dangerous because the client code is assuming that the schema has these values, but they are actually being silently swallowed when they are encoded.&lt;/p&gt;

&lt;p&gt;I&apos;d like to open a PR where we can provide an option to make the validator fail on any extra fields. See &lt;a href=&quot;https://github.com/salsify/avro-patches/pull/15&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/salsify/avro-patches/pull/15&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13172484">AVRO-2200</key>
            <summary>Option to fail when extra fields are in the payload</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="daniel.orner">Daniel Orner</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Jul 2018 21:03:54 +0000</created>
                <updated>Mon, 13 Aug 2018 07:39:40 +0000</updated>
                                                                            <component>ruby</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="16546810" author="githubbot" created="Tue, 17 Jul 2018 15:47:30 +0000"  >&lt;p&gt;dorner opened a new pull request #321: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2200&quot; title=&quot;Option to fail when extra fields are in the payload&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2200&quot;&gt;AVRO-2200&lt;/a&gt;: Option to fail when extra fields are in the payload&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/321&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/321&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   See &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2200&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2200&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   Currently, when passing a datum into the schema validator, the datum will pass even if the datum has more fields than the schema does. This can be dangerous because the client code is assuming that the schema has these values, but they are actually being silently swallowed when they are encoded.&lt;/p&gt;

&lt;p&gt;   This PR provides an option to make the validator fail on any extra fields.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16577926" author="githubbot" created="Mon, 13 Aug 2018 07:39:40 +0000"  >&lt;p&gt;GrafBlutwurst commented on issue #321: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2200&quot; title=&quot;Option to fail when extra fields are in the payload&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2200&quot;&gt;AVRO-2200&lt;/a&gt;: Option to fail when extra fields are in the payload&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/321#issuecomment-412433747&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/321#issuecomment-412433747&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Hi any chance this will also make it into the Java components? I am wrangling currently with a similar issue &lt;a href=&quot;https://stackoverflow.com/questions/51817298/strict-avro-parsing-mode-no-dropping-additional-fields&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://stackoverflow.com/questions/51817298/strict-avro-parsing-mode-no-dropping-additional-fields&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;   Thanks!&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jul 2018 15:47:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vy4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
