<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:16:49 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2012-2-21+AND+created+%3C%3D+2012-2-28+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="4" total="4"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1034] Avro C Resolved reader does not initialize children of arrays, resulting in segmentation faults</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1034</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;As I did in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-984&quot; title=&quot;Avro C - Resolved reader fails to read nested arrays and reads uninitialized memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-984&quot;&gt;&lt;del&gt;AVRO-984&lt;/del&gt;&lt;/a&gt;, I created a test program that creates an avro &lt;br/&gt;
value corresponding to the following schema: &lt;/p&gt;

&lt;p&gt;  {&quot;type&quot;:&quot;array&quot;, &quot;items&quot;: {&quot;type&quot;: &quot;array&quot;, &quot;items&quot;: &quot;long&quot;}}&lt;/p&gt;

&lt;p&gt;The avro_value is then resolved using a resolved_reader, and an &lt;br/&gt;
attempt is made to read from the resolved_reader. This results in a&lt;br/&gt;
segmentation fault on Linux.&lt;/p&gt;

&lt;p&gt;I believe this issue is similar to the issue in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-984&quot; title=&quot;Avro C - Resolved reader fails to read nested arrays and reads uninitialized memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-984&quot;&gt;&lt;del&gt;AVRO-984&lt;/del&gt;&lt;/a&gt;, in which&lt;br/&gt;
nested arrays did not work because avro_resolved_array_writer_init()&lt;br/&gt;
did not recursively call the init function on its children. In that&lt;br/&gt;
case the initialization had to be deferred until a new item was&lt;br/&gt;
appended to the array.&lt;/p&gt;

&lt;p&gt;I believe that avro_resolved_array_reader_init() should also&lt;br/&gt;
recursively call the init function on its children, in a deferred&lt;br/&gt;
manner as in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-984&quot; title=&quot;Avro C - Resolved reader fails to read nested arrays and reads uninitialized memory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-984&quot;&gt;&lt;del&gt;AVRO-984&lt;/del&gt;&lt;/a&gt;, but I don&apos;t know how to implement this yet.&lt;/p&gt;

&lt;p&gt;I will attach a test program that shows the crash. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Vivek&lt;/p&gt;</description>
                <environment>&lt;p&gt;GNU/Linux Ubuntu 11.10 64-bit&lt;/p&gt;</environment>
        <key id="12543614">AVRO-1034</key>
            <summary>Avro C Resolved reader does not initialize children of arrays, resulting in segmentation faults</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vnadkarni">Vivek Nadkarni</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2012 03:51:15 +0000</created>
                <updated>Mon, 19 Mar 2012 16:34:09 +0000</updated>
                            <resolved>Thu, 1 Mar 2012 04:01:45 +0000</resolved>
                                    <version>1.6.2</version>
                                    <fixVersion>1.6.3</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="604800">168h</timeoriginalestimate>
                            <timeestimate seconds="604800">168h</timeestimate>
                                        <comments>
                            <comment id="13213252" author="vnadkarni" created="Wed, 22 Feb 2012 03:59:12 +0000"  >&lt;p&gt;This test file demonstrates a segmentation fault when trying to read a nested array from a resolved-reader. This test file can be added to the list of tests in Avro-C.&lt;/p&gt;</comment>
                            <comment id="13213405" author="vnadkarni" created="Wed, 22 Feb 2012 07:00:42 +0000"  >&lt;p&gt;The attached patch calls avro_resolved_reader_init(), on the value&lt;br/&gt;
previously returned by avro_resolved_array_reader_get_by_index(), and&lt;br/&gt;
returns the result of that call. This patch fixes the segmentation&lt;br/&gt;
fault in the attached test case.&lt;/p&gt;

&lt;p&gt;However, I am not sure if this is the &lt;b&gt;right&lt;/b&gt; way to fix the array&lt;br/&gt;
initialization. I would appreciate it if someone else could review the&lt;br/&gt;
patch. &lt;/p&gt;

&lt;p&gt;One concern with the patch is that the init function is called &lt;b&gt;every&lt;/b&gt;&lt;br/&gt;
time the function avro_resolved_array_reader_get_by_index() is&lt;br/&gt;
called. So for example, the init function is called each time&lt;br/&gt;
avro_value_copy() is called to copy the resolved value into another&lt;br/&gt;
avro value. It is not clear to me whether such behavior is desirable. &lt;/p&gt;

&lt;p&gt;Thanks again,&lt;br/&gt;
Vivek&lt;/p&gt;</comment>
                            <comment id="13213407" author="vnadkarni" created="Wed, 22 Feb 2012 07:02:21 +0000"  >&lt;p&gt;Just posted a patch which fixes the segmentation fault in the uploaded test case.&lt;/p&gt;</comment>
                            <comment id="13218796" author="dcreager" created="Wed, 29 Feb 2012 01:21:05 +0000"  >&lt;p&gt;Here&apos;s a different patch.  It only initializes any given element of the array when that element is created.  That happens the first time that element, or any element that appears after it, is accessed.  This fixes the segfault in Vivek&apos;s test case.&lt;/p&gt;

&lt;p&gt;If I don&apos;t hear objections, I&apos;ll commit this patch to SVN tomorrow so that it makes it in for 1.6.3.&lt;/p&gt;</comment>
                            <comment id="13218957" author="vnadkarni" created="Wed, 29 Feb 2012 07:17:34 +0000"  >&lt;p&gt;I am attaching a new test case avro-1034-test-2.c. This test case&lt;br/&gt;
results in a segmentation fault when I apply Doug&apos;s patch&lt;br/&gt;
0001-&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1034&quot; title=&quot;Avro C Resolved reader does not initialize children of arrays, resulting in segmentation faults&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1034&quot;&gt;&lt;del&gt;AVRO-1034&lt;/del&gt;&lt;/a&gt;.-C-Resolved-reader-initializes-child-array.patch, but&lt;br/&gt;
does not result in a segmentation fault when I apply my patch&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1034&quot; title=&quot;Avro C Resolved reader does not initialize children of arrays, resulting in segmentation faults&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1034&quot;&gt;&lt;del&gt;AVRO-1034&lt;/del&gt;&lt;/a&gt;.patch.&lt;/p&gt;

&lt;p&gt;I don&apos;t know if the problem is with Doug&apos;s patch or if I am operating&lt;br/&gt;
incorrectly on the resolved value in my test case. Specifically, I am&lt;br/&gt;
calling avro_value_reset() on the resolved value.&lt;/p&gt;

&lt;p&gt;In this test case I populate a source value (nested) with a nested&lt;br/&gt;
array and read it using a resolved reader value (resolved_record). I&lt;br/&gt;
then call avro_value_reset on both the source value and the resolved&lt;br/&gt;
reader value. I then re-populate the source value with a larger nested&lt;br/&gt;
array, and proceed to read it using the same resolved reader. &lt;/p&gt;

&lt;p&gt;On this second read attempt, the code seg-faults, when I am using&lt;br/&gt;
Doug&apos;s patch. However, if I do not call avro_value_reset() on the&lt;br/&gt;
resolved reader value, then the code does not seg-fault and appears to&lt;br/&gt;
operate correctly, again using Doug&apos;s patch. &lt;/p&gt;

&lt;p&gt;Is it permissible to call avro_value_reset() on the resolved reader&lt;br/&gt;
value?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Vivek&lt;/p&gt;</comment>
                            <comment id="13219770" author="dcreager" created="Thu, 1 Mar 2012 03:39:41 +0000"  >&lt;p&gt;Here&apos;s an updated version of my patch that eliminates the segfault in the second test case.  Just needed to add an avro_array_raw_clear call to the reset method.&lt;/p&gt;</comment>
                            <comment id="13219779" author="dcreager" created="Thu, 1 Mar 2012 04:01:46 +0000"  >&lt;p&gt;Committed this to SVN to make sure it&apos;s ready for when Doug cuts the 1.6.3 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12516640" name="0001-AVRO-1034.-C-Resolved-reader-initializes-child-array.patch" size="16145" author="dcreager" created="Thu, 1 Mar 2012 03:39:40 +0000"/>
                            <attachment id="12516487" name="0001-AVRO-1034.-C-Resolved-reader-initializes-child-array.patch" size="14816" author="dcreager" created="Wed, 29 Feb 2012 01:21:03 +0000"/>
                            <attachment id="12515544" name="AVRO-1034.patch" size="642" author="vnadkarni" created="Wed, 22 Feb 2012 07:00:42 +0000"/>
                            <attachment id="12516526" name="avro-1034-test-2.c" size="12857" author="vnadkarni" created="Wed, 29 Feb 2012 07:17:33 +0000"/>
                            <attachment id="12515536" name="avro-1034-test.c" size="11869" author="vnadkarni" created="Wed, 22 Feb 2012 03:59:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 29 Feb 2012 01:21:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 47 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3yn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80404</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1035] Add the possibility to append to existing avro files  </title>
                <link>https://issues.apache.org/jira/browse/AVRO-1035</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Currently it is not possible to append to avro files that were written and closed. &lt;/p&gt;

&lt;p&gt;Here is a Scott Carey&apos;s reply on the mailing list:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;It is not possible without modifying DataFileWriter. Please open a JIRA&lt;br/&gt;
ticket.  &lt;/p&gt;

&lt;p&gt;It could not simply append to an OutputStream, since it must either:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Seek to the start to validate the schemas match and find the sync&lt;br/&gt;
marker, or&lt;/li&gt;
	&lt;li&gt;Trust that the schemas match and find the sync marker from the last block&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;DataFileWriter cannot refer to Hadoop classes such as FileSystem, but we&lt;br/&gt;
could add something to the mapred module that takes a Path and FileSystem&lt;br/&gt;
and returns&lt;br/&gt;
something that implemements an interface that DataFileWriter can append&lt;br/&gt;
to.  This would be something that is both a&lt;br/&gt;
&lt;a href=&quot;http://avro.apache.org/docs/1.6.2/api/java/org/apache/avro/file/SeekableInp&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/1.6.2/api/java/org/apache/avro/file/SeekableInp&lt;/a&gt;&lt;br/&gt;
ut.html&lt;br/&gt;
and an OutputStream, or has both an InputStream from the start of the&lt;br/&gt;
existing file and an OutputStream at the end.&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12543699">AVRO-1035</key>
            <summary>Add the possibility to append to existing avro files  </summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="detonator413">Vyacheslav Zholudev</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2012 15:34:05 +0000</created>
                <updated>Thu, 7 Feb 2013 17:54:11 +0000</updated>
                            <resolved>Thu, 7 Feb 2013 00:09:04 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13213874" author="cutting" created="Wed, 22 Feb 2012 19:14:31 +0000"  >&lt;p&gt;Note that append is not reliable in current Hadoop releases.  &quot;Append support&quot; in Hadoop 1.0 just means that flush() works reliably, not that append actually works.  Append should be reliable in 0.23 releases although I doubt it&apos;s been well tested there yet.&lt;/p&gt;</comment>
                            <comment id="13573023" author="cutting" created="Thu, 7 Feb 2013 00:09:05 +0000"  >&lt;p&gt;This was fixed some time ago.&lt;/p&gt;</comment>
                            <comment id="13573711" author="michaelmalak" created="Thu, 7 Feb 2013 17:54:11 +0000"  >&lt;p&gt;harsh@cloudera.com has provided example code on how to accomplish HDFS Avro append at &lt;a href=&quot;https://gist.github.com/QwertyManiac/4724582&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gist.github.com/QwertyManiac/4724582&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Feb 2012 19:14:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228938</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80405</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1036] IDL processing fails with multi-level nested imports</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1036</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The change to support finding IDL related files on the classpath in addition to the maven-plugin defined directory caused the context of the &quot;sourceDirectory&quot; to be lost when the InputStream return by findFile() is used to create a new Idl instance.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543870">AVRO-1036</key>
            <summary>IDL processing fails with multi-level nested imports</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="gffletch">George Fletcher</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Feb 2012 17:48:48 +0000</created>
                <updated>Mon, 19 Mar 2012 16:34:08 +0000</updated>
                            <resolved>Fri, 24 Feb 2012 23:47:16 +0000</resolved>
                                    <version>1.6.2</version>
                                    <fixVersion>1.6.3</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13214888" author="gffletch" created="Thu, 23 Feb 2012 17:53:44 +0000"  >&lt;p&gt;So the bug is that findFile() returns and InputStream and the Idl class constructor that takes an InputStream is created by the javacc processing of the Idl.jj file. This Idl constructor does not set the inputDir field of the Idl class and hence the Idl object created from the stream returned by findFile() has lost the sourceDirectory. This causes an import statement processed by this Idl object to fail, because the file can not be found as the &quot;sourceDirectory is &quot;lost&quot;.&lt;/p&gt;

&lt;p&gt;I&apos;m not very happy with my current solution as it seems a little &quot;hacky&quot;. Suggestions appreciated.&lt;/p&gt;

&lt;p&gt;Current solution...&lt;/p&gt;

&lt;p&gt;1. Add a setSrcDir() method to the Idl class (added to Idl.jj)&lt;br/&gt;
2. Modify the ImportIdl() method to first create the Idl instance from the InputStream returned by findFile() and then call the setSrcDir() setter chaining the current inputDir into the created Idl instance.&lt;/p&gt;</comment>
                            <comment id="13215040" author="gffletch" created="Thu, 23 Feb 2012 20:55:25 +0000"  >&lt;p&gt;Decided a cleaner solution was to create a new constructor public Idl (InputStream, File, ClassLoader) that chains the source directory and classpath resource loader into the new Idl instance.&lt;/p&gt;</comment>
                            <comment id="13215042" author="gffletch" created="Thu, 23 Feb 2012 20:56:26 +0000"  >&lt;p&gt;Patch file created with IntelliJ IDE. Please let me know if that causes problems.&lt;/p&gt;</comment>
                            <comment id="13215113" author="cutting" created="Thu, 23 Feb 2012 22:13:56 +0000"  >&lt;p&gt;Here&apos;s a patch that should fix this.&lt;/p&gt;

&lt;p&gt;Does this fix things for you?&lt;/p&gt;

&lt;p&gt;If so, we still need a unit test that illustrates the problem before we can commit it.&lt;/p&gt;</comment>
                            <comment id="13215125" author="cutting" created="Thu, 23 Feb 2012 22:23:12 +0000"  >&lt;p&gt;Looks like we patched this in parallel!  You added some tests, which is great!&lt;/p&gt;

&lt;p&gt;My patch is a little different.  When you include a file in a different directory then any imports it contains should be relative to its directory, not the directory of the original file, no?  So this.inputDir is not the right value for the new inputDir, but rather it should come from the imported file.&lt;/p&gt;</comment>
                            <comment id="13215214" author="gffletch" created="Thu, 23 Feb 2012 23:53:12 +0000"  >&lt;p&gt;Yes, that&apos;s a good point and I like your patch better. One other thought I had is that we could just add the sourceDirectory to the ClassLoader in the IDLProtocolMojo.java and then just use the ClassLoader mechanism across the board. &lt;/p&gt;</comment>
                            <comment id="13215240" author="cutting" created="Fri, 24 Feb 2012 00:10:32 +0000"  >&lt;p&gt;I don&apos;t think we should use ClassLoader across the board, since I don&apos;t think relative paths would work correctly that way.&lt;/p&gt;

&lt;p&gt;Here&apos;s an updated patch that includes my fix with your tests.  Tests fail without the fix and pass with it.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this tomorrow unless there are objections.&lt;/p&gt;</comment>
                            <comment id="13215285" author="scott_carey" created="Fri, 24 Feb 2012 01:01:36 +0000"  >&lt;p&gt;I do not see any tests in the last patch.&lt;/p&gt;</comment>
                            <comment id="13215297" author="vchau" created="Fri, 24 Feb 2012 01:33:26 +0000"  >&lt;p&gt;Sorry, I guess my change from &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-971&quot; title=&quot;IDL Import from project classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-971&quot;&gt;&lt;del&gt;AVRO-971&lt;/del&gt;&lt;/a&gt; caused this issue.  I just tried out the last patch that Doug uploaded here and nested imports areworking on our environment.&lt;/p&gt;</comment>
                            <comment id="13215301" author="cutting" created="Fri, 24 Feb 2012 01:41:20 +0000"  >&lt;p&gt;Oops.  Here&apos;s the right patch.&lt;/p&gt;</comment>
                            <comment id="13216125" author="cutting" created="Fri, 24 Feb 2012 23:47:16 +0000"  >&lt;p&gt;I committed this.  Thanks, George!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12534281">AVRO-971</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12515863" name="AVRO-1036.patch" size="11719" author="cutting" created="Fri, 24 Feb 2012 01:41:20 +0000"/>
                            <attachment id="12515855" name="AVRO-1036.patch" size="3482" author="cutting" created="Fri, 24 Feb 2012 00:10:32 +0000"/>
                            <attachment id="12515830" name="AVRO-1036.patch" size="3482" author="cutting" created="Thu, 23 Feb 2012 22:13:56 +0000"/>
                            <attachment id="12515814" name="jira-1036.patch" size="10142" author="gffletch" created="Thu, 23 Feb 2012 20:56:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 23 Feb 2012 22:13:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>229108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3z3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80406</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fixes bug preventing nested IDL imports</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>IDL</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1037] Problems using Avro 1.6.2 with Hadoop (CDH3 or 1.0)</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1037</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-972&quot; title=&quot;Avro IDL compiler should support &amp;quot;NaN&amp;quot;, &amp;quot;Infinity&amp;quot;, and &amp;quot;-Infinity&amp;quot; as float literals&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-972&quot;&gt;&lt;del&gt;AVRO-972&lt;/del&gt;&lt;/a&gt; uses a method on JsonNode that was introduced with Jackson 1.6.0.  Unfortunately, Hadoop in a distributed environment places jackson on the mapreduce classpath prior to a user&apos;s Jar.&lt;/p&gt;

&lt;p&gt;Avro should function when this happens.&lt;/p&gt;

&lt;p&gt;There are two things we are using that are new in Jackson 1.6.0 &amp;#8211; JsonNode.getValueAsDouble()  and MinimalPrettyPrinter&lt;/p&gt;

&lt;p&gt;MinimalPrettyPrinter is OK because the class is new, and if there is a Jackson 1.5.x jar on a classpath before one that is &amp;gt;= 1.6.0, it will find the class in the second jar.  We need to avoid JsonNode.getValueAsDouble() however.  There is a replacement that is equivalent and existed prior, JsonNode.getDoubleValue().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543920">AVRO-1037</key>
            <summary>Problems using Avro 1.6.2 with Hadoop (CDH3 or 1.0)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Feb 2012 22:54:13 +0000</created>
                <updated>Mon, 19 Mar 2012 16:34:09 +0000</updated>
                            <resolved>Fri, 24 Feb 2012 22:43:58 +0000</resolved>
                                    <version>1.6.2</version>
                                    <fixVersion>1.6.3</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13215157" author="scott_carey" created="Thu, 23 Feb 2012 22:55:07 +0000"  >&lt;p&gt;The stack trace I ran into was:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.NoSuchMethodError: org.codehaus.jackson.JsonNode.getValueAsDouble()D
        at org.apache.avro.Schema$Field.defaultValueEquals(Schema.java:461)
        at org.apache.avro.Schema$Field.equals(Schema.java:451)
        at java.util.AbstractList.equals(AbstractList.java:507)
        at org.apache.avro.Schema$RecordSchema.equals(Schema.java:647)
        at java.util.HashMap.put(HashMap.java:376)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13215173" author="scott_carey" created="Thu, 23 Feb 2012 23:05:51 +0000"  >&lt;p&gt;If there are no objections, I will check this in tomorrow.  I would like to get a 1.6.3 with this in it out soon.&lt;/p&gt;</comment>
                            <comment id="13215241" author="cutting" created="Fri, 24 Feb 2012 00:14:45 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13216028" author="scott_carey" created="Fri, 24 Feb 2012 22:43:58 +0000"  >&lt;p&gt;Committed revision 1293464&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12515840" name="AVRO-1037.patch" size="760" author="scott_carey" created="Thu, 23 Feb 2012 23:04:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Feb 2012 00:14:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>229158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3zb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80407</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
