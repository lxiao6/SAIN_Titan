<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:17:08 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2012-5-9+AND+created+%3C%3D+2012-5-16+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="11" total="11"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1081] GenericDatumWriter does not support native ByteBuffers</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1081</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;An exception is thrown when trying to encode bytes backed by a file.&lt;/p&gt;

&lt;p&gt;java.lang.UnsupportedOperationException: null&lt;br/&gt;
	at java.nio.ByteBuffer.arrayOffset(ByteBuffer.java:968) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.6.0_31&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.avro.io.BinaryEncoder.writeBytes(BinaryEncoder.java:61) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;avro-1.6.3.jar:1.6.3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Note arrayOffset is an optional method, see:&lt;br/&gt;
&lt;a href=&quot;http://docs.oracle.com/javase/6/docs/api/java/nio/ByteBuffer.html#arrayOffset%28%29&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javase/6/docs/api/java/nio/ByteBuffer.html#arrayOffset%28%29&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;FileChannel returns native ByteBuffer not HeapedByteBuffer&lt;/p&gt;

&lt;p&gt;See here:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/avro-user/201202.mbox/%3CCB57F421.6BFE2%25scott@richrelevance.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/avro-user/201202.mbox/%3CCB57F421.6BFE2%25scott@richrelevance.com%3E&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554684">AVRO-1081</key>
            <summary>GenericDatumWriter does not support native ByteBuffers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="rfuller">Robert Fuller</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 May 2012 14:11:10 +0000</created>
                <updated>Wed, 9 Jan 2013 21:18:27 +0000</updated>
                            <resolved>Thu, 17 May 2012 19:51:15 +0000</resolved>
                                    <version>1.6.3</version>
                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13274569" author="rfuller" created="Mon, 14 May 2012 11:57:43 +0000"  >&lt;p&gt;Attached one possible way of fixing this.&lt;/p&gt;

&lt;p&gt;I am not 100% happy with the solution, but it should work for our case for now. We are writing several avro files concurrently from within a heavily multithreaded application, and cannot afford to load many of the files into memory at once at that point.&lt;/p&gt;

&lt;p&gt;When reading the files again (in hadoop m/r job) it&apos;s ok for now to read the bytes back to memory (will read them into a byte array, but for the purpose of the test wanted to put them into a byte buffer).&lt;/p&gt;

&lt;p&gt;Am also now wondering whether you might consider direct support for &quot;File&quot; (or something like FileData) in avro. This would allow a way to include into avro items which exceed the amount of available memory. But maybe it&apos;s not a requirement anybody else would have...&lt;/p&gt;</comment>
                            <comment id="13274570" author="rfuller" created="Mon, 14 May 2012 11:59:22 +0000"  >&lt;p&gt;Attached one possible way of fixing this.&lt;/p&gt;

&lt;p&gt;I am not 100% happy with the solution, but it should work for our case for now. We are writing several avro files concurrently from within a heavily multithreaded application, and cannot afford to load many of the files into memory at once at that point.&lt;/p&gt;

&lt;p&gt;When reading the files again (in hadoop m/r job) it&apos;s ok for now to read the bytes back to memory (will read them into a byte array, but for the purpose of the test wanted to put them into a byte buffer).&lt;/p&gt;

&lt;p&gt;Am also now wondering whether you might consider direct support for &quot;File&quot; (or something like FileData) in avro. This would allow a way to include into avro items which exceed the amount of available memory. But maybe it&apos;s not a requirement anybody else would have...&lt;/p&gt;</comment>
                            <comment id="13276105" author="cutting" created="Tue, 15 May 2012 18:33:53 +0000"  >&lt;p&gt;Here&apos;s an updated version of the patch.  Instead of changing ReflectData.getField() I changed ReflectDatumReader.readBytes().&lt;/p&gt;

&lt;p&gt;Does this work for you?&lt;/p&gt;</comment>
                            <comment id="13276589" author="rfuller" created="Wed, 16 May 2012 08:32:27 +0000"  >&lt;p&gt;Yes it works for us. Nice one, Doug. Thanks.&lt;/p&gt;</comment>
                            <comment id="13277135" author="cutting" created="Wed, 16 May 2012 20:51:53 +0000"  >&lt;p&gt;Great!  I&apos;ll commit this soon unless someone objects.&lt;/p&gt;</comment>
                            <comment id="13278164" author="cutting" created="Thu, 17 May 2012 19:51:15 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                            <comment id="13540163" author="judy@pepperdata.com" created="Thu, 27 Dec 2012 21:18:12 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m not sure where to send this so please let me know if I should send it somewhere else!&lt;/p&gt;

&lt;p&gt;Maybe this is just the case in 1.7.3, but it seems that ByteBufferTest is not actually run by Maven (because it&apos;s not named TestByteBuffer, so it doesn&apos;t match the test rules), and I am getting failures on its test() method if I force it to run. Specifically, this is happening:&lt;/p&gt;

&lt;p&gt;The test&apos;s X class has two fields, X.name (a String) and X.content (a ByteBuffer). It seems they are expected to maintain that order by the reader and writer.&lt;br/&gt;
The writer first writes X.name as a String to its local buffer.&lt;br/&gt;
The writer calls BufferedBinaryEncoder.writeFixed(ByteBuffer) to write X.content. If the size of the content exceeds 2048 bytes (bulkLimit), writeFixed() bypasses the local buffer and writes directly to the underlying sink (which was previously empty).&lt;br/&gt;
The X.name String is then flushed to the sink after X.content, thus reversing the order of the fields. &lt;br/&gt;
The reader fails because it is expecting the fields in the original order (as the schema and class both specify). &lt;/p&gt;

&lt;p&gt;Also, if the size of X.content is less than 2048 bytes, the contents are in expected order and the test passes.&lt;/p&gt;

&lt;p&gt;The actual reported error message is:&lt;br/&gt;
Tests in error: &lt;br/&gt;
  test(org.apache.avro.reflect.TestByteBuffer): java.io.IOException: Block read partially, the data may be corrupt&lt;/p&gt;

&lt;p&gt;Anyway, I don&apos;t know how important this functionality is, but in any case, it doesn&apos;t appear to be tested in the current Maven setup. Just wanted to let you know!&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Judy Hay&lt;/p&gt;

</comment>
                            <comment id="13549014" author="scott_carey" created="Wed, 9 Jan 2013 21:18:27 +0000"  >&lt;p&gt;I created the bug: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1227&quot; title=&quot;Java: Large ByteBuffers may corrupt binary encoding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1227&quot;&gt;&lt;del&gt;AVRO-1227&lt;/del&gt;&lt;/a&gt; to capture this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12527493" name="AVRO-1081.patch" size="13442" author="cutting" created="Tue, 15 May 2012 18:32:15 +0000"/>
                            <attachment id="12526742" name="ByteBufferTest.java" size="3812" author="rfuller" created="Mon, 14 May 2012 11:58:58 +0000"/>
                            <attachment id="12526740" name="ByteBufferTest.java" size="3812" author="rfuller" created="Mon, 14 May 2012 11:56:54 +0000"/>
                            <attachment id="12526743" name="patch.diff.txt" size="3853" author="rfuller" created="Mon, 14 May 2012 11:59:06 +0000"/>
                            <attachment id="12526741" name="patch.diff.txt" size="3853" author="rfuller" created="Mon, 14 May 2012 11:57:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 May 2012 18:33:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238934</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e48v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80450</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1082] avro-c: avoid leaking open FILE objects</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1082</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;There is a couple of functions where an open FILE object leaks:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file_writer_init_fp (datafile.c)&lt;/li&gt;
	&lt;li&gt;avro_schema_to_specific (schema_specific.c)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12554871">AVRO-1082</key>
            <summary>avro-c: avoid leaking open FILE objects</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpugachev">Pugachev Maxim</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 07:24:22 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:38 +0000</updated>
                            <resolved>Sun, 20 May 2012 13:51:45 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13273100" author="mpugachev" created="Fri, 11 May 2012 07:27:41 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13279760" author="dcreager" created="Sun, 20 May 2012 13:51:45 +0000"  >&lt;p&gt;Committed to SVN&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526492" name="AVRO-1082.patch" size="735" author="mpugachev" created="Fri, 11 May 2012 07:27:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 13:51:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239124</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e493:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80451</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1083] avro-c: multiple memory leaks</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1083</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Multiple memory leaks in error checking code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554881">AVRO-1083</key>
            <summary>avro-c: multiple memory leaks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpugachev">Pugachev Maxim</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 08:48:28 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:37 +0000</updated>
                            <resolved>Sun, 20 May 2012 14:03:28 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13273126" author="mpugachev" created="Fri, 11 May 2012 08:49:14 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13273150" author="mpugachev" created="Fri, 11 May 2012 10:07:19 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13273938" author="mpugachev" created="Sat, 12 May 2012 11:22:32 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13279752" author="dcreager" created="Sun, 20 May 2012 13:39:42 +0000"  >&lt;p&gt;It looks like this patch includes the modifications you made for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1084&quot; title=&quot;acvo-c: reference counting error in file_writer and file_reader code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1084&quot;&gt;&lt;del&gt;AVRO-1084&lt;/del&gt;&lt;/a&gt;, so I&apos;m going to merge that one first.&lt;/p&gt;</comment>
                            <comment id="13279763" author="dcreager" created="Sun, 20 May 2012 14:03:28 +0000"  >&lt;p&gt;Committed to SVN.  There was a missing cast in datafile.c which generated a compiler warning on Mac and an error on Windows.  Added this and all tests pass.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526626" name="AVRO-1083.patch" size="3317" author="mpugachev" created="Sat, 12 May 2012 11:22:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 13:39:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e49b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1084] acvo-c: reference counting error in file_writer and file_reader code</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1084</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Missed incref/decref calls for writer_schema in file_writer_create() and avro_file_reader_get_writer_schema() functions. Crash dump example in the attached code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554885">AVRO-1084</key>
            <summary>acvo-c: reference counting error in file_writer and file_reader code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpugachev">Pugachev Maxim</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 09:49:45 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:34 +0000</updated>
                            <resolved>Sun, 20 May 2012 13:58:13 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13273146" author="mpugachev" created="Fri, 11 May 2012 09:50:22 +0000"  >&lt;p&gt;Crash dump example&lt;/p&gt;</comment>
                            <comment id="13273147" author="mpugachev" created="Fri, 11 May 2012 09:52:05 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13279762" author="dcreager" created="Sun, 20 May 2012 13:58:13 +0000"  >&lt;p&gt;Committed to SVN.  I updated the test case to include the standard copyright notice, and fixed it so that it will compile on Windows.  Also, it now deletes the output file &lt;b&gt;after&lt;/b&gt; running the test, rather than before.  That way the source tree isn&apos;t cluttered with test output files.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526505" name="AVRO-1084.patch" size="823" author="mpugachev" created="Fri, 11 May 2012 09:52:05 +0000"/>
                            <attachment id="12526504" name="example.c" size="1152" author="mpugachev" created="Fri, 11 May 2012 09:50:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 13:58:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239138</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e49j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80453</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1085] Fingerprinting for C#</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1085</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Avro fingerprinting for C#.  This is a direct port of the Java SchemaNormalization class and tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554910">AVRO-1085</key>
            <summary>Fingerprinting for C#</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ewhauser">Eric Hauser</assignee>
                                    <reporter username="ewhauser">Eric Hauser</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 14:03:48 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:34 +0000</updated>
                            <resolved>Wed, 16 May 2012 07:59:54 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>csharp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13274743" author="thiru_mg" created="Mon, 14 May 2012 16:59:33 +0000"  >&lt;p&gt;+1. Looks good to me.&lt;/p&gt;

&lt;p&gt;Built and tested on Windows 7, Visual C# Express 2010.&lt;/p&gt;</comment>
                            <comment id="13276565" author="thiru_mg" created="Wed, 16 May 2012 07:59:56 +0000"  >&lt;p&gt;Committed revision 1339045 after testing on Ubuntu 12.04 with Mono 2.10.&lt;/p&gt;

&lt;p&gt;Thank you Eric.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526720" name="AVRO-1085.patch" size="29981" author="bosman" created="Mon, 14 May 2012 07:39:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 14 May 2012 16:59:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239163</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e49r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80454</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1086] avro-c: Possible crash bug in deflate codec initialization</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1086</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;There is a possible crash bug in codec_deflate() function. If deflateInit2() or inflateInit2() will be not Z_OK, then we&apos;ll get junk pointer codec-&amp;gt;codec_data. Next call to codec_reset() will fail.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12555013">AVRO-1086</key>
            <summary>avro-c: Possible crash bug in deflate codec initialization</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpugachev">Pugachev Maxim</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 May 2012 10:37:05 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:33 +0000</updated>
                            <resolved>Sun, 20 May 2012 14:05:17 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13273920" author="mpugachev" created="Sat, 12 May 2012 10:37:42 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13279766" author="dcreager" created="Sun, 20 May 2012 14:05:18 +0000"  >&lt;p&gt;Committed to SVN&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526620" name="AVRO-1086.patch" size="653" author="mpugachev" created="Sat, 12 May 2012 10:37:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 14:05:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239267</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e49z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1087] avro-c: invoking avro_file_writer_open() produces 100% crash bug</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1087</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Invoking avro_file_writer_open() produces 100% crash bug:&lt;/p&gt;

&lt;p&gt;#0  codec_null (codec=0x0, type=0xbfb11a0d &quot;null&quot;) at /home/mpugachev/work/avro-trunk/lang/c/src/codec.c:36&lt;br/&gt;
#1  avro_codec (codec=0x0, type=0xbfb11a0d &quot;null&quot;) at /home/mpugachev/work/avro-trunk/lang/c/src/codec.c:404&lt;br/&gt;
#2  0x0804971e in file_read_header (reader=0x9a986b0, writers_schema=0x9a88678, codec=0x0, sync=0x9a88684 &quot;&quot;, synclen=16)&lt;br/&gt;
    at /home/mpugachev/work/avro-trunk/lang/c/src/datafile.c:279&lt;br/&gt;
#3  0x08049e57 in file_writer_open (path=0x8067bf5 &quot;test.db&quot;, writer=0xbfb11a9c) at /home/mpugachev/work/avro-trunk/lang/c/src/datafile.c:324&lt;br/&gt;
#4  avro_file_writer_open (path=0x8067bf5 &quot;test.db&quot;, writer=0xbfb11a9c) at /home/mpugachev/work/avro-trunk/lang/c/src/datafile.c:348&lt;br/&gt;
#5  0x0804911d in main ()&lt;/p&gt;

&lt;p&gt;Moreover, append datums to log file is not working at all.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12555014">AVRO-1087</key>
            <summary>avro-c: invoking avro_file_writer_open() produces 100% crash bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mpugachev">Pugachev Maxim</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 May 2012 11:06:14 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:36 +0000</updated>
                            <resolved>Mon, 21 May 2012 12:28:25 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13273932" author="mpugachev" created="Sat, 12 May 2012 11:06:49 +0000"  >&lt;p&gt;Crash dump example&lt;/p&gt;</comment>
                            <comment id="13273933" author="mpugachev" created="Sat, 12 May 2012 11:07:25 +0000"  >&lt;p&gt;Patch for this issue&lt;/p&gt;</comment>
                            <comment id="13280114" author="dcreager" created="Mon, 21 May 2012 12:26:39 +0000"  >&lt;p&gt;Patch looks good; I like how the codec design means that we&apos;ll seamlessly append any new data using the existing codec without any extra effort.  (Assuming that the existing codec is one that we know how to handle, of course.)&lt;/p&gt;</comment>
                            <comment id="13280116" author="dcreager" created="Mon, 21 May 2012 12:28:25 +0000"  >&lt;p&gt;Committed to SVN.  I added the example2.c file as a new test case.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526624" name="AVRO-1087.patch" size="2386" author="mpugachev" created="Sat, 12 May 2012 11:07:24 +0000"/>
                            <attachment id="12526623" name="example2.c" size="1304" author="mpugachev" created="Sat, 12 May 2012 11:06:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 21 May 2012 12:26:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239268</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1088] Avro-C - Add performance tests for schema resolution and arrays.</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1088</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The current performance test in Avro-C measures the performance while&lt;br/&gt;
reading and writing of Avro values using a complex record schema,&lt;br/&gt;
which does not contain any arrays.&lt;/p&gt;

&lt;p&gt;We add tests to measure the performance for simple and nested&lt;br/&gt;
arrays. We also replicate all tests to measure the performance of the&lt;br/&gt;
schema resolution using a resolved reader and a resolved writer.&lt;/p&gt;

&lt;p&gt;Specifically we add the following performance tests:&lt;/p&gt;

&lt;p&gt;Nested Record&lt;br/&gt;
1. Replicating the test &quot;nested record value by index&quot;, using a helper&lt;br/&gt;
   function. Using helper functions adds a little overhead, but it&lt;br/&gt;
   allows us to test various schemas, as well as different modes of&lt;br/&gt;
   schema resolution much more easily.&lt;br/&gt;
2. Using a resolved writer to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while reading a complex record.&lt;br/&gt;
3. Using a resolved reader to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while writing a complex record.&lt;/p&gt;

&lt;p&gt;Simple Array&lt;br/&gt;
4. Test the performance for reading and writing a simple array.&lt;br/&gt;
5. Using a resolved writer to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while reading a simple array.&lt;br/&gt;
6. Using a resolved reader to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while writing a simple array.&lt;/p&gt;

&lt;p&gt;Nested Array&lt;br/&gt;
7. Test the performance for reading and writing a nested array.&lt;br/&gt;
8. Using a resolved writer to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while reading a nested array.&lt;br/&gt;
9. Using a resolved reader to resolve between (identical) reader and&lt;br/&gt;
   writer schemas, while writing a nested array.&lt;/p&gt;

&lt;p&gt;Additionally we fix a minor bug:&lt;br/&gt;
1. The return value of avro_value_equal_fast() was not being&lt;br/&gt;
   tested. Test this return value, and fail if it is FALSE.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Ubuntu Linux 11.10&lt;/p&gt;</environment>
        <key id="12555103">AVRO-1088</key>
            <summary>Avro-C - Add performance tests for schema resolution and arrays.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vnadkarni">Vivek Nadkarni</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2012 08:12:45 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:35 +0000</updated>
                            <resolved>Sun, 20 May 2012 14:14:15 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13274501" author="vnadkarni" created="Mon, 14 May 2012 08:17:15 +0000"  >&lt;p&gt;Uploading patch file implementing the new performance tests. &lt;/p&gt;</comment>
                            <comment id="13274502" author="vnadkarni" created="Mon, 14 May 2012 08:19:16 +0000"  >&lt;p&gt;I ran the performance tests and got the results appended below.&lt;/p&gt;

&lt;p&gt;The results show that, as expected, there is a slight performance hit&lt;br/&gt;
for using a resolved writer or resolved reader for the complex record,&lt;br/&gt;
compared to using the matched schemas.&lt;/p&gt;

&lt;p&gt;However, the results also show that for the simple array and for the&lt;br/&gt;
nested array, the penalty for using the resolved writer is&lt;br/&gt;
substantial. Using the resolved writer takes 30 to 50 times longer&lt;br/&gt;
than using no schema resolution or using the resolved reader for&lt;br/&gt;
simple and nested arrays.&lt;/p&gt;

&lt;p&gt;The performance results indicate that there is a likely bug in the&lt;br/&gt;
resolved writer, when it is trying to resolve simple or nested&lt;br/&gt;
arrays. This bug will be reported in a separate AVRO-JIRA issue.&lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;Running refcount ****&lt;br/&gt;
  100000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.423s&lt;br/&gt;
  Tests/sec:    41265475&lt;/li&gt;
				&lt;li&gt;Running nested record (legacy) ****&lt;br/&gt;
  100000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.270s&lt;br/&gt;
  Tests/sec:    44053&lt;/li&gt;
				&lt;li&gt;Running nested record (value by index) ****&lt;br/&gt;
  1000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.077s&lt;br/&gt;
  Tests/sec:    481541&lt;/li&gt;
				&lt;li&gt;Running nested record (value by name) ****&lt;br/&gt;
  1000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.333s&lt;br/&gt;
  Tests/sec:    428571&lt;/li&gt;
				&lt;li&gt;Running nested record (value by index) matched schemas ****&lt;br/&gt;
  1000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.147s&lt;br/&gt;
  Tests/sec:    465839&lt;/li&gt;
				&lt;li&gt;Running nested record (value by index) resolved writer ****&lt;br/&gt;
  1000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.480s&lt;br/&gt;
  Tests/sec:    403226&lt;/li&gt;
				&lt;li&gt;Running nested record (value by index) resolved reader ****&lt;br/&gt;
  1000000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.230s&lt;br/&gt;
  Tests/sec:    448430&lt;/li&gt;
				&lt;li&gt;Running simple array matched schemas ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.123s&lt;br/&gt;
  Tests/sec:    117739&lt;/li&gt;
				&lt;li&gt;Running simple array resolved writer ****&lt;br/&gt;
  10000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.747s&lt;br/&gt;
  Tests/sec:    3641&lt;/li&gt;
				&lt;li&gt;Running simple array resolved reader ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.270s&lt;br/&gt;
  Tests/sec:    110132&lt;/li&gt;
				&lt;li&gt;Running nested array matched schemas ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 3.030s&lt;br/&gt;
  Tests/sec:    82508&lt;/li&gt;
				&lt;li&gt;Running nested array resolved writer ****&lt;br/&gt;
  10000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 6.650s&lt;br/&gt;
  Tests/sec:    1504&lt;/li&gt;
				&lt;li&gt;Running simple array resolved reader ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 3.313s&lt;br/&gt;
  Tests/sec:    75453&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13279769" author="dcreager" created="Sun, 20 May 2012 14:14:15 +0000"  >&lt;p&gt;Committed to SVN&lt;/p&gt;</comment>
                            <comment id="13280064" author="mpugachev" created="Mon, 21 May 2012 10:16:11 +0000"  >&lt;p&gt;Compilation warnings fixed (Ubuntu 11.04, gcc 4.5.2)&lt;/p&gt;</comment>
                            <comment id="13280065" author="mpugachev" created="Mon, 21 May 2012 10:17:02 +0000"  >&lt;p&gt;This test case gives me a compilation warnings. I`ve fixed it in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1088&quot; title=&quot;Avro-C - Add performance tests for schema resolution and arrays.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1088&quot;&gt;&lt;del&gt;AVRO-1088&lt;/del&gt;&lt;/a&gt;.patch.2&lt;/p&gt;</comment>
                            <comment id="13280106" author="dcreager" created="Mon, 21 May 2012 11:59:58 +0000"  >&lt;p&gt;Thanks for the updated patch; just committed it to SVN.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526727" name="AVRO-1088.patch" size="16086" author="vnadkarni" created="Mon, 14 May 2012 08:17:06 +0000"/>
                            <attachment id="12528405" name="AVRO-1088.patch.2" size="1288" author="mpugachev" created="Mon, 21 May 2012 10:16:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 14:14:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4af:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80457</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Measure performance of reading and writing arrays. Measure performance of schema resolution. </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1089] Avro-C - Penalty 30x to 50x for using resolved writer on arrays</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1089</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The new performance tests created in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1088&quot; title=&quot;Avro-C - Add performance tests for schema resolution and arrays.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1088&quot;&gt;&lt;del&gt;AVRO-1088&lt;/del&gt;&lt;/a&gt; show that using the&lt;br/&gt;
resolved writer takes 30 to 50 times longer than using no schema&lt;br/&gt;
resolution or using the resolved reader for simple and nested arrays.&lt;/p&gt;

&lt;p&gt;For a simple array, using the resolved writer took ~30x longer than&lt;br/&gt;
using the memory reader that assumed a matching schema. For the nested&lt;br/&gt;
array, using the resolved writer took ~50x longer.&lt;/p&gt;

&lt;p&gt;These results suggest that there is a bug in resolved writer. I do not&lt;br/&gt;
have a proposed fix at this time.&lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;Running simple array matched schemas ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.123s&lt;br/&gt;
  Tests/sec:    117739&lt;/li&gt;
				&lt;li&gt;Running simple array resolved writer ****&lt;br/&gt;
  10000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 2.747s&lt;br/&gt;
  Tests/sec:    3641&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;Running nested array matched schemas ****&lt;br/&gt;
  250000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 3.030s&lt;br/&gt;
  Tests/sec:    82508&lt;/li&gt;
				&lt;li&gt;Running nested array resolved writer ****&lt;br/&gt;
  10000 tests per run&lt;br/&gt;
  Run 1&lt;br/&gt;
  Run 2&lt;br/&gt;
  Run 3&lt;br/&gt;
  Average time: 6.650s&lt;br/&gt;
  Tests/sec:    1504&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>&lt;p&gt;Ubuntu Linux&lt;/p&gt;</environment>
        <key id="12555105">AVRO-1089</key>
            <summary>Avro-C - Penalty 30x to 50x for using resolved writer on arrays</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vnadkarni">Vivek Nadkarni</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2012 08:28:09 +0000</created>
                <updated>Mon, 10 Dec 2012 17:57:36 +0000</updated>
                            <resolved>Sat, 1 Dec 2012 17:04:28 +0000</resolved>
                                    <version>1.6.3</version>
                    <version>1.7.0</version>
                                    <fixVersion>1.7.3</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="13274519" author="vnadkarni" created="Mon, 14 May 2012 09:07:44 +0000"  >&lt;p&gt;This screenshot was generated using kcachegrind, after running the&lt;br/&gt;
performance test test_simple_array_resolved_writer(). The plot shows&lt;br/&gt;
that the majority of the time (97%) is spent in the function&lt;br/&gt;
avro_resolved_writer_free_elements() called by&lt;br/&gt;
avro_resolved_array_writer_reset(). This information suggests that the&lt;br/&gt;
bug lies in one of these two functions. Unfortunately, I still don&apos;t&lt;br/&gt;
have a mechanism or a fix for this issue. &lt;/p&gt;
</comment>
                            <comment id="13507978" author="dcreager" created="Sat, 1 Dec 2012 14:56:18 +0000"  >&lt;p&gt;Here&apos;s a one-liner patch that fixes this.  The problem was that an internal array wasn&apos;t being cleared, and was growing not just with the size of each test case, but with the number of test cases.  Iterating through that array was causing the slowdown.&lt;/p&gt;

&lt;p&gt;All tests still pass; running time for the resolved array tests are now comparable with the non-resolved array tests.&lt;/p&gt;</comment>
                            <comment id="13508003" author="dcreager" created="Sat, 1 Dec 2012 17:04:28 +0000"  >&lt;p&gt;Patch committed to SVN&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12555634" name="0001-AVRO-1089.-Fix-performance-penalty-for-array-resolve.patch" size="1934" author="dcreager" created="Sat, 1 Dec 2012 14:56:18 +0000"/>
                            <attachment id="12526732" name="AVRO-1089-performance.png" size="314866" author="vnadkarni" created="Mon, 14 May 2012 09:07:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 1 Dec 2012 14:56:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239364</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4an:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80458</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1090] DataFileWriter should expose &quot;sync marker&quot; to allow concurrent writes to same .avro file</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1090</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;We&apos;re writing to Hadoop via DataFileWriter (FSDataOutputStream). We&apos;re doing this with two threads per node, on 8 nodes. Some of the nodes share the same path. For example, our: TimestampedWriter class, takes a path argument and appends the timestamp to it (ex: SomePath/2012/05/14). Thus, two threads or two nodes can access the same path. The &quot;race&quot; condition when these streams are written, is resolved with a check to see if the file exists (has been created) by a faster thread. If that&apos;s so, it appends, instead of creating the file on the HDFS.&lt;/p&gt;

&lt;p&gt;The problem is that DataFileWriter, generates a 16-byte, random string for each instance. So, two threads with 2 different writer instances, have a different sync marker. That means that data, when trying to read it back, will get an IOException (&quot;Invalid sync!&quot;).&lt;/p&gt;

&lt;p&gt;There&apos;s a big performance penalty here. Because only one writer can write at once to one given path, it becomes a bottleneck. For 1B (billion) rows, it took us 4 hours to generate &amp;amp; load. With 20 concurrent threads, it took only 12.5 minutes. &lt;/p&gt;

&lt;p&gt;If DataFileWriter would expose the &quot;sync&quot; marker, a developer could read that and make sure that the next thread that appends to the file, uses the same sync marker. Don&apos;t know if it&apos;s even possible to expose the sync marker so as other instances of &quot;DataFileWriter&quot; can share the sync marker, from the file. We have a fix for this, making sure each writer is an &quot;unique&quot; instance and generating a path based on that uniqueness. But instead of having &quot;SomePath/2012/05/14/Shard.avro&quot; we&apos;d now have &quot;SomePath/2012/05/14/Shard-some-random-UUID.avro&quot; for each of the writers that write the data in.&lt;/p&gt;

&lt;p&gt;If it can be done, it would be a huge fix for a bottleneck problem. The bottleneck being the single writer that can write to a single path.&lt;/p&gt;

&lt;p&gt;THIS HAS ALSO been requested on the avro-user thread: &lt;a href=&quot;http://grokbase.com/t/avro/user/122m4sjm1y/is-it-possible-to-append-to-an-already-existing-avro-file&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://grokbase.com/t/avro/user/122m4sjm1y/is-it-possible-to-append-to-an-already-existing-avro-file&lt;/a&gt;&lt;br/&gt;
I just could not find the JIRA ticket for this request.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12555119">AVRO-1090</key>
            <summary>DataFileWriter should expose &quot;sync marker&quot; to allow concurrent writes to same .avro file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="catalinalexandru.zamfir@gameloft.com">Catalin Alexandru Zamfir</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2012 11:34:53 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:35 +0000</updated>
                            <resolved>Thu, 17 May 2012 20:16:22 +0000</resolved>
                                    <version>1.6.3</version>
                                    <fixVersion>1.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13274584" author="catalinalexandru.zamfir@gameloft.com" created="Mon, 14 May 2012 13:08:20 +0000"  >&lt;p&gt;From the source-code of DatumFileWriter, the &quot;appendTo&quot; method seems to do what it&apos;s intended. But only accepts a (File) argument. In the case where one writer connects over the network to Hadoop and needs to write a &quot;FSDataOutputStream&quot; instead of a file, the advantages of the appendTo method cannot be used. So it seems it is possible to retrieve the sync marker from an existing .avro file and write forward with the same marker.&lt;/p&gt;

&lt;p&gt;Can this be done here also? Can an appendTo (FSDataOutputStream) method be created? This would allow concurrent writers to create or append on the same output stream using the same marker, thus enabling the data to be read back.&lt;/p&gt;</comment>
                            <comment id="13274592" author="catalinalexandru.zamfir@gameloft.com" created="Mon, 14 May 2012 13:35:28 +0000"  >&lt;p&gt;Also, we&apos;re doing objRecordWriter.create (getHdfs ().append (objPath)) which should make a &quot;DataFileWriter&quot; on the FSDataOutputStream which respects the first sync marker of the written file. So: if thread #1 has already created the file, thread #2 can now &quot;append&quot; to the given path. But because it appends, it does not need to &quot;generateSync&quot; on the sync marker. Instead, it can read the sync marker from the already generated file and use it as it&apos;s own sync marker.&lt;/p&gt;

&lt;p&gt;This does not happen. The fact that we get an &quot;Invalid Sync&quot; because of the fact we are creating multiple writers in different threads, even if one thread finishes first and create the given path, the next thread that should &quot;append&quot; to it does not seem to take in account the fact that it should first read the existing sync marker defined with the file. DataFileWriter should take in account that a file/path/stream written by it already contains a sync marker, and that there&apos;s no need to generate another one. It should get the existing sync marker and use that to append the data to the given HDFS path.&lt;/p&gt;

&lt;p&gt;Thanks for your patience.&lt;/p&gt;</comment>
                            <comment id="13276035" author="cutting" created="Tue, 15 May 2012 17:37:17 +0000"  >&lt;p&gt;Here&apos;s a patch that adds a method that should permit you to append to an HDFS file.  You&apos;d call it with something like:&lt;/p&gt;

&lt;p&gt;writer.appendTo(new FsInput(path, conf), fs.append(path));&lt;/p&gt;

&lt;p&gt;Please let me know if this works for you.&lt;/p&gt;</comment>
                            <comment id="13276208" author="catalinalexandru.zamfir@gameloft.com" created="Tue, 15 May 2012 21:03:41 +0000"  >&lt;p&gt;Thanks Doug! Seems to work. We&apos;ve written some tens of M (millions) of records, and read them back. Seems ok. The environment was: 6 nodes, 2 threads per node, writing 10M each thread. Reading was able to be done as soon as the first shard was written. It passed through almost all records that were written at the time.&lt;/p&gt;

&lt;p&gt;I took your patch, promoted &quot;SeekableFileInput&quot; to &quot;SeekableInput&quot;, because it&apos;s more generic. That way we can use SeekableHadoopInput from wibidata.github.com/odiago-avro and pass it to the &quot;appendTo&quot; patched method you&apos;ve sent:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: dashed;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: dashed;&quot;&gt;&lt;b&gt;Code.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// Append
&lt;/span&gt;bjRecordWriter.appendTo (&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SeekableHadoopInput (App
.getObjConfiguration (), objKeyPath), App.getHdfs ()
.append (objKeyPath, objBufferSize));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll reset the tests, and go full-force for the 12B records we generated with our previous method and see the performance characteristics there. The environment is going to be 12 concurrent threads, via 6 nodes at 2 threads/node, writing for a few hours till it reaches the 1B records/thread mark. After that, we&apos;re going to read those records back, one at a time and count how many we&apos;ve read.&lt;/p&gt;</comment>
                            <comment id="13277141" author="cutting" created="Wed, 16 May 2012 20:57:54 +0000"  >&lt;p&gt;Oops.  Yes, that should be SeekableInput not SeekableFileInput.&lt;/p&gt;

&lt;p&gt;Here&apos;s a new version of the patch with that change.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this soon unless someone objects.&lt;/p&gt;</comment>
                            <comment id="13277605" author="catalinalexandru.zamfir@gameloft.com" created="Thu, 17 May 2012 06:21:03 +0000"  >&lt;p&gt;Doug, patches are identical. Guess you uploaded the same patch. appendTo signature should be appendTo (SeekableInput, etc). in the second patch.&lt;br/&gt;
It&apos;s ok to commit with the &quot;SeekableInput&quot; change. In our tests it passed. Wrote 10M each thread, we were able to read the data back.&lt;/p&gt;</comment>
                            <comment id="13277789" author="catalinalexandru.zamfir@gameloft.com" created="Thu, 17 May 2012 13:18:52 +0000"  >&lt;p&gt;We were doing the 12B tests, an uncovered a NPE (NullPointerException) at:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;716754 [Main] INFO net.RnD.Hadoop.App - ## At: 0:11:54.332 # W: 21000000
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;Main&quot;&lt;/span&gt; java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader.main(JarRsrcLoader.java:58)
Caused by: java.lang.NullPointerException
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.updateBlockInfo(DFSClient.java:1882)
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.openInfo(DFSClient.java:1855)
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.&amp;lt;init&amp;gt;(DFSClient.java:1831)
        at org.apache.hadoop.hdfs.DFSClient.open(DFSClient.java:578)
        at org.apache.hadoop.hdfs.DistributedFileSystem.open(DistributedFileSystem.java:154)
        at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:427)
        at org.apache.avro.file.SeekableHadoopInput.&amp;lt;init&amp;gt;(SeekableHadoopInput.java:56)
        at net.RnD.FileUtils.BufferedTimestampedWriter.spawnConcurrentWriteThreads(BufferedTimestampedWriter.java:251)
        at net.RnD.FileUtils.BufferedTimestampedWriter.syncRecord(BufferedTimestampedWriter.java:159)
        at net.RnD.Hadoop.App.write1BAvros(App.java:270)
        at net.RnD.Hadoop.App.executeCode(App.java:535)
        at net.RnD.Hadoop.App.main(App.java:455)
        ... 5 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13277867" author="catalinalexandru.zamfir@gameloft.com" created="Thu, 17 May 2012 14:48:56 +0000"  >&lt;p&gt;We&apos;re now catching the NullPointerException and retrying to &quot;create&quot; or &quot;appendTo&quot;. This seems to fix it, but the NPE should require a check to see where it&apos;s coming from. It passed writing 125M per 6 threads on 6 nodes. This means over 1B records properly written via the patch to &quot;appendTo&quot;. From our point of view, it passes all possible use-cases. Doug, please consider modifying SeekableFileInput to SeekableInput when you commit. Thanks again!&lt;/p&gt;</comment>
                            <comment id="13278157" author="catalinalexandru.zamfir@gameloft.com" created="Thu, 17 May 2012 19:45:47 +0000"  >&lt;p&gt;Confirmation: it works. Traversing means we&apos;re reading the data back. Tests have written about 700GB of data and are able to read it back.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;22232086 [Main] INFO net.RnD.Hadoop.App - ## Traversed 1142M rows at: 2:35:59.897
22239836 [Main] INFO net.RnD.Hadoop.App - ## Traversed 1143M rows at: 2:36:07.647
22248107 [Main] INFO net.RnD.Hadoop.App - ## Traversed 1144M rows at: 2:36:15.918
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13278207" author="cutting" created="Thu, 17 May 2012 20:16:22 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                            <comment id="13283228" author="catalinalexandru.zamfir@gameloft.com" created="Fri, 25 May 2012 09:10:11 +0000"  >&lt;p&gt;Thanks! It&apos;s been working ever since.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12527706" name="AVRO-1090.patch" size="2103" author="cutting" created="Wed, 16 May 2012 20:57:54 +0000"/>
                            <attachment id="12527474" name="AVRO-1090.patch" size="2103" author="cutting" created="Tue, 15 May 2012 17:37:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 May 2012 17:37:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239378</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80459</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1091] Avro-C - Simple scripts to call cmake from windows and linux</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1091</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;New users to Avro-C may not know the specific commandline options to cmake to compile the Avro library. I would like to add simple scripts document the cmake commands under windows and linux. These scripts treat the Avro-C directory as a standalone project and are independent of the Apache build system and directory tree. &lt;/p&gt;
</description>
                <environment>&lt;p&gt;Windows XP, Windows 7, Ubuntu Linux&lt;/p&gt;</environment>
        <key id="12555839">AVRO-1091</key>
            <summary>Avro-C - Simple scripts to call cmake from windows and linux</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vnadkarni">Vivek Nadkarni</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 May 2012 17:42:57 +0000</created>
                <updated>Mon, 11 Jun 2012 20:01:33 +0000</updated>
                            <resolved>Sun, 20 May 2012 14:29:26 +0000</resolved>
                                    <version>1.7.0</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13276046" author="vnadkarni" created="Tue, 15 May 2012 17:47:52 +0000"  >&lt;p&gt;This patch should be applied in the avro-trunk/lang/c directory. It contains two files.&lt;/p&gt;

&lt;p&gt;cmake_avrolib.bat - for Windows&lt;br/&gt;
o Run cmake under Windows to generate the Visual C++ 2008 solution file. &lt;br/&gt;
o Does not run the compiler. &lt;/p&gt;

&lt;p&gt;cmake_avrolib.sh - for Linux&lt;br/&gt;
o Run cmake to generate the build directory.&lt;br/&gt;
o Run make.&lt;br/&gt;
o Run the tests&lt;br/&gt;
o Install the avro library to a subdirectory in the local build directory.&lt;/p&gt;
</comment>
                            <comment id="13276054" author="vnadkarni" created="Tue, 15 May 2012 17:52:30 +0000"  >&lt;p&gt;The scripts are now &quot;available&quot; for inclusion in Avro-C.&lt;/p&gt;</comment>
                            <comment id="13279780" author="dcreager" created="Sun, 20 May 2012 14:29:26 +0000"  >&lt;p&gt;Committed to SVN&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12527476" name="AVRO-1091.patch" size="1256" author="vnadkarni" created="Tue, 15 May 2012 17:47:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 May 2012 14:29:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4b3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80460</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Standalone build scripts for Avro-C under Windows and Linux.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
