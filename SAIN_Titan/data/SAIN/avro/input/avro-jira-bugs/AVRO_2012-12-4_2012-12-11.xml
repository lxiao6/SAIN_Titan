<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:18:02 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2012-12-4+AND+created+%3C%3D+2012-12-11+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="4" total="4"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1214] Generated protocol&apos;s method should return void instead of Void like one-way message</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1214</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Using the following IDL:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@namespace(&quot;org.apache.avro.test&quot;)
protocol Simple {
  error TestError {
    string message;
  }

  string hello(string greeting);
  void `error`() throws TestError;
  void ping() oneway;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will produce the interface:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.avro.test;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Simple {
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; org.apache.avro.Protocol PROTOCOL = org.apache.avro.Protocol.parse(&lt;span class=&quot;code-quote&quot;&gt;&quot;...&quot;&lt;/span&gt;);
  java.lang.CharSequence hello(java.lang.CharSequence greeting) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; org.apache.avro.AvroRemoteException;
  java.lang.&lt;span class=&quot;code-object&quot;&gt;Void&lt;/span&gt; error() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; org.apache.avro.AvroRemoteException, org.apache.avro.test.TestError;
  void ping();

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Callback &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Simple {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; org.apache.avro.Protocol PROTOCOL = org.apache.avro.test.Simple.PROTOCOL;
    void hello(java.lang.CharSequence greeting, org.apache.avro.ipc.Callback&amp;lt;java.lang.CharSequence&amp;gt; callback) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; java.io.IOException;
    void error(org.apache.avro.ipc.Callback&amp;lt;java.lang.&lt;span class=&quot;code-object&quot;&gt;Void&lt;/span&gt;&amp;gt; callback) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; java.io.IOException;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then one is forced to add &lt;tt&gt;return null;&lt;/tt&gt; statement(s) in the interface implementation for the &lt;tt&gt;error()&lt;/tt&gt; method which can be a bit cumbersome and that&apos;s not the case for the oneway &lt;tt&gt;ping()&lt;/tt&gt; method.&lt;br/&gt;
This is fine on the Callback though because the developer can just ignore the callback argument.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12618932">AVRO-1214</key>
            <summary>Generated protocol&apos;s method should return void instead of Void like one-way message</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="yabon">S&#233;bastien Launay</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Dec 2012 19:54:52 +0000</created>
                <updated>Thu, 17 Jan 2019 20:42:38 +0000</updated>
                            <resolved>Thu, 17 Jan 2019 20:28:48 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.9.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13510729" author="yabon" created="Wed, 5 Dec 2012 20:19:18 +0000"  >&lt;p&gt;Patch for using void instead of Void for two-ways message.&lt;br/&gt;
Method &lt;tt&gt;SpecificCompiler#javaUnbox(Schema&lt;/tt&gt; used in the Velocity template has been kept for compatibility with existing custom templates but is now deprecated in favour of &lt;tt&gt;SpecificCompiler#javaUnbox(Schema, boolean&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This changes generates incompatible Java interface so I guess it should be targeted for 1.8.x.&lt;/p&gt;

&lt;p&gt;Patch is attached but can be found here as well:&lt;br/&gt;
&lt;a href=&quot;https://github.com/slaunay/avro/commits/enhancement/AVRO-1214-unbox-void&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/slaunay/avro/commits/enhancement/AVRO-1214-unbox-void&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13526690" author="cutting" created="Fri, 7 Dec 2012 19:35:16 +0000"  >&lt;p&gt;This looks like a good change, but it is incompatible and will break applications that currently implement interfaces that return Void, so I marked it for inclusion in 1.8.0, where we might include such incompatible changes.  Even then, breaking existing applications is never good.  We could implement this as an option to the compiler, so that folks can choose whether or not to generate interfaces that return Void for compatibility.&lt;/p&gt;</comment>
                            <comment id="13526718" author="yabon" created="Fri, 7 Dec 2012 19:50:50 +0000"  >&lt;p&gt;You are right Apache versioning would require a 2.x major version for that, I can update the patch to add an option to the compiler/maven-plugin like the one for generating String instead of CharSequence.&lt;br/&gt;
Were you thinking of an option to keep Void turned off by default or an option to generate void turned off by default for 1.8.x?&lt;/p&gt;</comment>
                            <comment id="16745466" author="jira-bot" created="Thu, 17 Jan 2019 20:28:30 +0000"  >&lt;p&gt;Commit 05171ee872bb8d6e9173a34b7832f522b2a56763 in avro&apos;s branch refs/heads/master from S&#233;bastien Launay&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=05171ee&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=05171ee&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1214&quot; title=&quot;Generated protocol&amp;#39;s method should return void instead of Void like one-way message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1214&quot;&gt;&lt;del&gt;AVRO-1214&lt;/del&gt;&lt;/a&gt; Use void instead of Void for RPC methods&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;one-way message use void but two-ways messages might use java.lang.Void&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16745490" author="hudson" created="Thu, 17 Jan 2019 20:42:38 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build AvroJava #586 (See &lt;a href=&quot;https://builds.apache.org/job/AvroJava/586/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/AvroJava/586/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1214&quot; title=&quot;Generated protocol&amp;#39;s method should return void instead of Void like one-way message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1214&quot;&gt;&lt;del&gt;AVRO-1214&lt;/del&gt;&lt;/a&gt; Use void instead of Void for RPC methods (dkulp: &lt;a href=&quot;https://github.com/apache/avro/commit/05171ee872bb8d6e9173a34b7832f522b2a56763&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/commit/05171ee872bb8d6e9173a34b7832f522b2a56763&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) lang/java/ipc/src/test/java/org/apache/avro/ipc/TestNettyServerWithCallbacks.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/ipc/src/test/java/org/apache/avro/TestProtocolSpecific.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/compiler/src/main/java/org/apache/avro/compiler/specific/SpecificCompiler.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/grpc/src/test/java/org/apache/avro/grpc/TestAvroProtocolGrpc.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/compiler/src/main/velocity/org/apache/avro/compiler/specific/templates/java/classic/protocol.vm&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/ipc/src/test/java/org/apache/avro/TestNamespaceSpecific.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/ipc/src/test/java/org/apache/avro/TestBulkData.java&lt;/li&gt;
	&lt;li&gt;(edit) lang/java/ipc/src/test/java/org/apache/avro/ipc/TestNettyServerConcurrentExecution.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12556139" name="AVRO-1214-unbox-void-2012-12-05.patch" size="7223" author="yabon" created="Wed, 5 Dec 2012 20:19:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 7 Dec 2012 19:35:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296198</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i146vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232579</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1215] AvroMultipleOutputs not working when specifying baseOutputPath</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1215</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I&apos;m calling the write() method of AvroMultipleOutputs which takes the baseOutputPath.  The reducer appears to begin hanging once it tries writing to a baseOuputPath value not already encountered.  It then fails with:&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: failed to create file ... because current leaseholder is trying to recreate file.&lt;/p&gt;

&lt;p&gt;I think the problem has to do with this line in AvroMultipleOutputs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// get the record writer from context output format
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//FileOutputFormat.setOutputName(taskContext, baseFileName);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This line is not commented out in the similar code from Hadoop.  So I think the baseOutputPath is ignored.  As a result when each record writer is created it uses the same path, leading to the exception.&lt;/p&gt;

&lt;p&gt;Uncommenting this line does not work because of visibility of the method.  However what this method does is set &quot;mapreduce.output.basename&quot;.  But setting this doesn&apos;t work either.  &lt;/p&gt;

&lt;p&gt;After digging through Avro code I found that AvroOutputFormatBase is using &quot;avro.mo.config.namedOutput&quot; to create the path.  If I replace the commented out line with this it seems to work:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;taskContext.getConfiguration().set(&lt;span class=&quot;code-quote&quot;&gt;&quot;avro.mo.config.namedOutput&quot;&lt;/span&gt;, baseFileName);  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12622859">AVRO-1215</key>
            <summary>AvroMultipleOutputs not working when specifying baseOutputPath</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nagav.ashish">Ashish Nagavaram</assignee>
                                    <reporter username="matterhayes">Matthew Hayes</reporter>
                        <labels>
                            <label>avro</label>
                            <label>mapreduce</label>
                    </labels>
                <created>Fri, 7 Dec 2012 04:44:22 +0000</created>
                <updated>Thu, 20 Aug 2015 19:10:36 +0000</updated>
                            <resolved>Mon, 18 Feb 2013 18:31:30 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.4</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13526140" author="matterhayes" created="Fri, 7 Dec 2012 04:45:06 +0000"  >&lt;p&gt;JIRA where this code was created&lt;/p&gt;</comment>
                            <comment id="13526175" author="nagav.ashish" created="Fri, 7 Dec 2012 06:35:27 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Is this in the function write(key,value,baseoutputPath) ??&lt;/p&gt;

&lt;p&gt;I think there is already an issue open, Please take a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1179&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1179&lt;/a&gt; to check if it is the same.&lt;/p&gt;

&lt;p&gt;I have a fix which I am testing right now. &lt;/p&gt;</comment>
                            <comment id="13526187" author="matterhayes" created="Fri, 7 Dec 2012 07:09:32 +0000"  >&lt;p&gt;Yes this is the function and it is the same issue.  If you use only one value for baseOutputPath the task will not fail but it won&apos;t use the correct path.  If however you use different values it will fail.&lt;/p&gt;</comment>
                            <comment id="13526568" author="nagav.ashish" created="Fri, 7 Dec 2012 17:31:09 +0000"  >&lt;p&gt;Patch with necessary changes and Updates TestAvroMultipleOutputs to test the new changes. The Write(key,value,baseoutputpath) will use the default job output Schema to write the output.&lt;/p&gt;</comment>
                            <comment id="13526569" author="nagav.ashish" created="Fri, 7 Dec 2012 17:32:23 +0000"  >&lt;p&gt;Patch with changes for jira avro 1215 bug&lt;/p&gt;</comment>
                            <comment id="13526927" author="matterhayes" created="Sat, 8 Dec 2012 00:36:37 +0000"  >&lt;p&gt;It looks like this should work.  Shouldn&apos;t you update the other write method too?&lt;/p&gt;

&lt;p&gt;There is this one:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void write(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; namedOutput, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; key, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value,
      &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; baseOutputPath)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and this one:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void write(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; key, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; baseOutputPath) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Alternatively you could move this code into getRecordWriter.&lt;/p&gt;</comment>
                            <comment id="13526932" author="qwertymaniac" created="Sat, 8 Dec 2012 00:40:43 +0000"  >&lt;p&gt;Since we&apos;re providing a custom implementation of MultipleOutputs here, we do not need to be overly concerned about extending its API.&lt;/p&gt;

&lt;p&gt;For instance, though the Hadoop MR MO has these write(K, V, P) APIs, it had no notion of schemas. Avro MR MO can provide, on top of this default-pulling APIs, a schema-providing API such as write(K, V, Schema, P). I see no harm in doing that since Avro is all schema-dependent and this may be more useful, than relying on the default job output schema automatically.&lt;/p&gt;</comment>
                            <comment id="13527940" author="nagav.ashish" created="Mon, 10 Dec 2012 14:05:24 +0000"  >&lt;p&gt;for the function&lt;/p&gt;

&lt;p&gt;public void write(String namedOutput, Object key, Object value,&lt;br/&gt;
      String baseOutputPath)&lt;/p&gt;

&lt;p&gt;it is handled by the call to getcontext() from the function. The only function where it fails was &lt;/p&gt;

&lt;p&gt;public void write(Object key, Object value, String baseOutputPath) &lt;/p&gt;

&lt;p&gt;which is handled by the new change.&lt;/p&gt;

&lt;p&gt;It makes sense to have schema in write(K,V,P), this allows us to skip declaring namedoutput for every outputlocation. I will work on this.&lt;/p&gt;</comment>
                            <comment id="13535655" author="priyomustafi" created="Wed, 19 Dec 2012 05:24:40 +0000"  >&lt;p&gt;I am using the write(String namedOutput, Object key, Object value, String baseOutputPath) method with different sets of namedOutput and baseOutputPath so that each namedOutput goes to a different directory.  Somehow all files are getting created in the main output directory instead of the directories given under baseOutputPath.  I converted all our mapreduces to Avro and suddenly found this issue.  Any help greatly appreciated?  &lt;/p&gt;</comment>
                            <comment id="13535691" author="priyomustafi" created="Wed, 19 Dec 2012 06:04:55 +0000"  >&lt;p&gt;I added your patch to the below and it seems to fix the issue for me.  When can this be rolled out?&lt;br/&gt;
   public void write(String namedOutput, Object key, Object value, String baseOutputPath)&lt;/p&gt;

&lt;p&gt;By the way, the AlreadyBeingCreatedException happens when you have baseOutputPath outside of the main output path.  This is a known bug.  &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3772&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/MAPREDUCE-3772&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13536503" author="priyomustafi" created="Wed, 19 Dec 2012 22:43:45 +0000"  >&lt;p&gt;Ashish, please fix you patch to address the other methods mentioned by Matthew.  As noted, they don&apos;t work either without the patch.  &lt;/p&gt;</comment>
                            <comment id="13559383" author="nagav.ashish" created="Tue, 22 Jan 2013 04:20:50 +0000"  >&lt;p&gt;Sorry for the delay, I was on vacation. I am attaching a new Patch with update to function write(K,V,basepath) to accept key and value schemas. This avoids created named outputs for every base path.&lt;/p&gt;

&lt;p&gt;This patch also has the fix for path issues&lt;/p&gt;</comment>
                            <comment id="13559392" author="nagav.ashish" created="Tue, 22 Jan 2013 04:35:01 +0000"  >&lt;p&gt;just to add to the earlier comment, the updated method looks like write(K,V,keySchema,valSchema,baseOutputPath).&lt;/p&gt;
</comment>
                            <comment id="13559927" author="nagav.ashish" created="Tue, 22 Jan 2013 19:42:32 +0000"  >&lt;p&gt;Adding in the old write(K,V,baseoutputpath) so that we can skip specifying schema everytime (default job schema is used)&lt;/p&gt;</comment>
                            <comment id="13560145" author="nagav.ashish" created="Tue, 22 Jan 2013 23:02:38 +0000"  >&lt;p&gt;removed a out.println line from the code.&lt;/p&gt;</comment>
                            <comment id="13568269" author="priyomustafi" created="Fri, 1 Feb 2013 00:11:53 +0000"  >&lt;p&gt;Hi Ashish,&lt;br/&gt;
Are you coming up with a new API?  Would you be having a patch for these as well which I use?&lt;br/&gt;
    public void write(String namedOutput, Object key, Object value, String baseOutputPath)&lt;br/&gt;
    public void write(Object key, Object value, String baseOutputPath) &lt;/p&gt;

&lt;p&gt;I just found another issue.  I have a MR which writes different schemas on different outputs.  My driver registers these using this method in AvroMultipleOutputs. The output of the mapper is a union-schema as each mapper can output to different multipleoutputs using their respective schemas.&lt;/p&gt;

&lt;p&gt;  public static void addNamedOutput(Job job, String namedOutput, Class&amp;lt;? extends OutputFormat&amp;gt; outputFormatClass,&lt;br/&gt;
            Schema keySchema, Schema valueSchema)&lt;/p&gt;

&lt;p&gt;When I run locally everything works fine.  Each output avro file has their respective key and value schema.  When I run on a cluster, all the different avro files have the union schema which is set on the main output otherwise it gives classcastexception.&lt;/p&gt;

&lt;p&gt;Looking deeper into AvroMultipleOutputs I notice that the addNamedOutput() registering method above adds the key and value schema to &quot;private static&quot; map and these schemas are never added to the configuration.  So there is no way this map would be populated on the reducer side and when it tries to lookup the schemas using namedoutput+&quot;_KEYSCHEMA&quot; etc, it is obviously not there and it picks up the main outputschema which in my case is the union.  If we put these on the configuration and read it back on the reducer, this should work.  &lt;/p&gt;</comment>
                            <comment id="13568359" author="nagav.ashish" created="Fri, 1 Feb 2013 01:37:13 +0000"  >&lt;p&gt;Hi Priyo,&lt;/p&gt;

&lt;p&gt;I have already attached a patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12566040/AVRO-1215-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12566040/AVRO-1215-v3.patch&lt;/a&gt; in this bug which has a fix for write(Object key, Object value, String baseOutputPath). I have tested this and it works fine for me. &lt;/p&gt;

&lt;p&gt;I also added another method in the AvroMultipleOutputs, write(K,V, keyschema , valueschema, baseoutputpath) where we can define multiple schemas, can you try testing your code with this method?&lt;/p&gt;

&lt;p&gt;The main reason for using a map to store schemas was to avoid parsing it again (since some schema declarations maybe huge). &lt;/p&gt;

&lt;p&gt;This map is populated from the main function of the mapreduce code and the AvroMultipleOutputs class is instantiated in the setup method of the reducer. &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/repos/asf/avro/trunk/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/avro/trunk/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please let me know if it still doesn&apos;t work. In the meanwhile I will add methods to expose key and value schemas given the job and namedoutput.&lt;/p&gt;</comment>
                            <comment id="13568821" author="nagav.ashish" created="Fri, 1 Feb 2013 15:54:20 +0000"  >&lt;p&gt;Hi priyo,&lt;/p&gt;

&lt;p&gt;my bad, I tried to run the MR code and noticed that you were right. I will add it to existing patch.&lt;/p&gt;</comment>
                            <comment id="13569646" author="baunz" created="Sat, 2 Feb 2013 21:49:51 +0000"  >&lt;p&gt;Hi! Funny thing i ran into the same problem (multiple schemas not working) and created an issue with a patch for it yesterday &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1239&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1239&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;since the problem is adressed in here, this could be closed. There is a patch in there wrapping the schemas in the configuration, but it should be done by now by your patch. I also like the explicit write(K,V, keyschema , valueschema, baseoutputpath) sinc, like Harsh J said above, we don&apos;t have to fulfill an api contract plus you know the type of schema you write mostly in the multiple output case. &lt;/p&gt;</comment>
                            <comment id="13571091" author="nagav.ashish" created="Tue, 5 Feb 2013 06:38:40 +0000"  >&lt;p&gt;Final version - with some code formatting and cleanup&lt;/p&gt;</comment>
                            <comment id="13571348" author="cutting" created="Tue, 5 Feb 2013 14:40:31 +0000"  >&lt;p&gt;A lot of the changes in this patch seem to be whitespace-only.  This makes it hard to see the functional changes.  If you&apos;d like to re-format AvroMultipleOutputs, then that would better be done in a separate patch.&lt;/p&gt;

&lt;p&gt;Can any others (e.g., Johannes, Priyo, Harsh, or Matthew) confirm whether this patch addresses the problems they&apos;ve had?  Thanks!&lt;/p&gt;</comment>
                            <comment id="13571699" author="priyomustafi" created="Tue, 5 Feb 2013 20:25:23 +0000"  >&lt;p&gt;I agree with Doug.  There are too many changes mostly due to code formatting.  Ashish, please post a patch without code formatting changes that we can review.&lt;/p&gt;</comment>
                            <comment id="13571701" author="nagav.ashish" created="Tue, 5 Feb 2013 20:28:56 +0000"  >&lt;p&gt;sorry about that, I used the default eclipse formatting which seems to have altered all of the earlier formatting. I will reformat and attach a patch&lt;/p&gt;</comment>
                            <comment id="13572914" author="nagav.ashish" created="Wed, 6 Feb 2013 22:17:36 +0000"  >&lt;p&gt;Patch for the above after proper formatting. &lt;/p&gt;</comment>
                            <comment id="13572920" author="nagav.ashish" created="Wed, 6 Feb 2013 22:20:30 +0000"  >&lt;p&gt;Forgot to remove commented lines. Final Patch&lt;/p&gt;</comment>
                            <comment id="13578885" author="nagav.ashish" created="Fri, 15 Feb 2013 01:50:07 +0000"  >&lt;p&gt;did anyone get a chance to test the new patch? &lt;/p&gt;</comment>
                            <comment id="13579476" author="cutting" created="Fri, 15 Feb 2013 20:07:22 +0000"  >&lt;p&gt;Shouldn&apos;t this still call createTaskAttemptContext to create the context?&lt;/p&gt;</comment>
                            <comment id="13579540" author="baunz" created="Fri, 15 Feb 2013 22:05:48 +0000"  >&lt;p&gt;Ashish, i tested the patch and it works fine for me (different schemas in the output)&lt;/p&gt;

&lt;p&gt;thanks for the work!&lt;/p&gt;</comment>
                            <comment id="13579545" author="nagav.ashish" created="Fri, 15 Feb 2013 22:17:18 +0000"  >&lt;p&gt;Hi Doug, &lt;/p&gt;

&lt;p&gt;I assume you are referring to the write(k,v,schema,schema,baseoutputfile), it still has a call to create context only that I moved it after schema has been assigned to the AvroJob.&lt;/p&gt;

&lt;p&gt;Thanks Johannes for testing the patch.&lt;/p&gt;
</comment>
                            <comment id="13579838" author="cutting" created="Sat, 16 Feb 2013 17:17:14 +0000"  >&lt;p&gt;I was referring to the following from the patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-    TaskAttemptContext taskContext = createTaskAttemptContext(
-      context.getConfiguration(), context.getTaskAttemptID());
+    Job job = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Job(context.getConfiguration());
+    setSchema(job, keySchema, valSchema);
+    TaskAttemptContext taskContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TaskAttemptContext(
+        job.getConfiguration(), context.getTaskAttemptID());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A call to createTaskAttemptContext is replaced with a call to &apos;new TaskAttemptContext&apos;.  I believe that createTaskAttemptContext should still be used. This is described in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1170&quot; title=&quot;Avro&amp;#39;s new mapreduce APIs don&amp;#39;t work with Hadoop 2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1170&quot;&gt;&lt;del&gt;AVRO-1170&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13580321" author="nagav.ashish" created="Sun, 17 Feb 2013 23:07:09 +0000"  >&lt;p&gt;sorry, my bad I thought I thought I was using the createTaskAttemptContext() method. &lt;/p&gt;

&lt;p&gt;I am uploading a new patch with changes to call the method, rather than creating a new context object.&lt;/p&gt;
</comment>
                            <comment id="13580749" author="cutting" created="Mon, 18 Feb 2013 18:31:30 +0000"  >&lt;p&gt;I committed this.  Thanks, Ashish!&lt;/p&gt;</comment>
                            <comment id="13581095" author="hudson" created="Tue, 19 Feb 2013 07:39:41 +0000"  >&lt;p&gt;Integrated in AvroJava #352 (See &lt;a href=&quot;https://builds.apache.org/job/AvroJava/352/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/AvroJava/352/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1215&quot; title=&quot;AvroMultipleOutputs not working when specifying baseOutputPath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1215&quot;&gt;&lt;del&gt;AVRO-1215&lt;/del&gt;&lt;/a&gt;. Java: Fix AvroMultipleOutputs when specifying baseOutputPath.  Contributed by Ashish Nagavaram. (Revision 1447419)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cutting : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/avro/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/avro/trunk/lang/java/mapred/src/main/java/org/apache/avro/mapreduce/AvroMultipleOutputs.java&lt;/li&gt;
	&lt;li&gt;/avro/trunk/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14705582" author="sakhtar" created="Thu, 20 Aug 2015 19:10:36 +0000"  >&lt;p&gt;Hi - I am facing another problem. from the mapper,  My program writing like this:&lt;br/&gt;
Mapper: &lt;br/&gt;
avroMultipleOutputs.write(&quot;partmap&quot;, avroKey, NullWritable.get(),baseOutputPath);&lt;/p&gt;

&lt;p&gt;Launcher :&lt;br/&gt;
AvroMultipleOutputs.addNamedOutput(job, &quot;partmap&quot;, AvroKeyOutputFormat.class, Avro_0_Prod_Top_L1.getClassSchema(), Schema.create(Schema.Type.NULL));&lt;/p&gt;

&lt;p&gt;while generating the o/p from mapper, it is not considering the named O/p as file names. O/p files name looks like :&lt;br/&gt;
/20150818/00/Map_Out/-m-00000.avro&lt;br/&gt;
have anyone faced this issue? is there a patch already? I tried but could not find. Thanks in advance.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12629760">AVRO-1236</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12612161">AVRO-1179</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12630341">AVRO-1239</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12634674">AVRO-1266</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12558920">AVRO-1106</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12566040" name="AVRO-1215-v3.patch" size="7297" author="nagav.ashish" created="Tue, 22 Jan 2013 23:02:38 +0000"/>
                            <attachment id="12568310" name="AVRO-1215.patch" size="9155" author="nagav.ashish" created="Wed, 6 Feb 2013 22:20:30 +0000"/>
                            <attachment id="12568308" name="AVRO-1215.patch" size="9884" author="nagav.ashish" created="Wed, 6 Feb 2013 22:17:36 +0000"/>
                            <attachment id="12567959" name="AVRO-1215.patch" size="30020" author="nagav.ashish" created="Tue, 5 Feb 2013 06:38:40 +0000"/>
                            <attachment id="12569736" name="AVRO-1215_final.patch" size="9147" author="nagav.ashish" created="Sun, 17 Feb 2013 23:07:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 7 Dec 2012 06:35:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i149cf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232977</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>avro</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1216] Setting precision for the output stream</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1216</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;There&apos;s no way, that I know of, to set the precision level on the output stream.&lt;/p&gt;

&lt;p&gt;I want to take an avro object, with double fields, and json encode it into a string.  However, when I do this the encoded doubles have lost precision.  I suspect this is because the precision I set on the ostringstream and resulting avro::ostreamOutputStream isn&apos;t working.  &lt;/p&gt;

&lt;p&gt;Here&apos;s an example inspired by the tutorial (&lt;a href=&quot;http://avro.apache.org/docs/1.7.2/api/cpp/html/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/1.7.2/api/cpp/html/index.html&lt;/a&gt;). Using their cpx.json&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;00001 {
00002     &quot;type&quot;: &quot;record&quot;, 
00003     &quot;name&quot;: &quot;cpx&quot;,
00004     &quot;fields&quot; : [
00005         {&quot;name&quot;: &quot;re&quot;, &quot;type&quot;: &quot;double&quot;},    
00006         {&quot;name&quot;: &quot;im&quot;, &quot;type&quot; : &quot;double&quot;}
00007     ]
00008 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Generating cpx.hh by &lt;br/&gt;
avrogencpp -i cpx.json -o cpx.hh -n c&lt;/p&gt;

&lt;p&gt;The test program is then:&lt;/p&gt;
 &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 1#include &lt;span class=&quot;code-quote&quot;&gt;&quot;cpx.hh&quot;&lt;/span&gt;
 2#include &lt;span class=&quot;code-quote&quot;&gt;&quot;avro/&lt;span class=&quot;code-object&quot;&gt;Compiler&lt;/span&gt;.hh&quot;&lt;/span&gt;
 3#include &lt;span class=&quot;code-quote&quot;&gt;&quot;avro/Encoder.hh&quot;&lt;/span&gt;
 4#include &lt;span class=&quot;code-quote&quot;&gt;&quot;avro/Decoder.hh&quot;&lt;/span&gt;
 5#include &lt;span class=&quot;code-quote&quot;&gt;&quot;avro/Specific.hh&quot;&lt;/span&gt;
 6#include &lt;span class=&quot;code-quote&quot;&gt;&quot;avro/Generic.hh&quot;&lt;/span&gt;
 7#include &amp;lt;sstream&amp;gt;
 8#include &amp;lt;fstream&amp;gt;
 9
10using namespace std;
11int main()
12{
13  ifstream ifs(&lt;span class=&quot;code-quote&quot;&gt;&quot;cpx.json&quot;&lt;/span&gt;);
14  avro::ValidSchema type_schema;
15  avro::compileJsonSchema(ifs, type_schema);
16
17  ostringstream oss (ostringstream::out);
18  oss.precision(30); &lt;span class=&quot;code-comment&quot;&gt;// doesn&apos;t matter                                                                                                                                                                     
&lt;/span&gt;19  std::auto_ptr&amp;lt;avro::OutputStream&amp;gt; out = avro::ostreamOutputStream(oss);
20  avro::EncoderPtr e = avro::jsonEncoder(type_schema);
21  e-&amp;gt;init(*out);
22  c::cpx complex;
23  complex.re = 1.123456789;
24  complex.im = 2.01;
25  avro::encode(*e, complex);
26  e-&amp;gt;flush();
27  cout.precision(30);
28  cout &amp;lt;&amp;lt; oss.str() &amp;lt;&amp;lt; endl;
29
30  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
31}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we then compile and run this we get:&lt;/p&gt;
{&quot;re&quot;:1.12346,&quot;im&quot;:2.01}
&lt;p&gt;Where as I&apos;d expect something like:&lt;/p&gt;
{&quot;re&quot;:1.12346789,&quot;im&quot;:2.01}
&lt;p&gt;It doesn&apos;t seem to matter where/if we set the precision on the output stream (line 18).&lt;/p&gt;

&lt;p&gt;Is there a different way to handle this? How do I keep the precision from getting stripped off double when doing json encoding?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux x86_64&lt;/p&gt;</environment>
        <key id="12622966">AVRO-1216</key>
            <summary>Setting precision for the output stream</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="comm@squotd.net">John McClean</assignee>
                                    <reporter username="pjacobs">Paul Jacobs</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Dec 2012 20:40:18 +0000</created>
                <updated>Tue, 31 Jan 2017 05:50:46 +0000</updated>
                            <resolved>Tue, 31 Jan 2017 05:39:25 +0000</resolved>
                                    <version>1.7.2</version>
                    <version>1.7.3</version>
                    <version>1.7.4</version>
                    <version>1.7.5</version>
                    <version>1.7.6</version>
                    <version>1.7.7</version>
                    <version>1.8.0</version>
                    <version>1.8.1</version>
                                    <fixVersion>1.8.2</fixVersion>
                                    <component>c++</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15289753" author="comm@squotd.net" created="Wed, 18 May 2016 20:32:50 +0000"  >&lt;p&gt;The problem is that the JsonGenerator converts doubles to strings by streaming them into a stringstream. The default precision of a stringstream is &apos;6&apos;, which effectively removes the extra precision that a double has over a float. I&apos;ll attach a patch.&lt;/p&gt;</comment>
                            <comment id="15307801" author="comm@squotd.net" created="Tue, 31 May 2016 14:32:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thiru_mg&quot; class=&quot;user-hover&quot; rel=&quot;thiru_mg&quot;&gt;Thiruvalluvan M. G.&lt;/a&gt;: can you take a look at this patch when you get a chance?&lt;/p&gt;</comment>
                            <comment id="15387995" author="comm@squotd.net" created="Thu, 21 Jul 2016 16:28:43 +0000"  >&lt;p&gt;Could a committer take a look at this one?&lt;/p&gt;</comment>
                            <comment id="15844385" author="thiru_mg" created="Sun, 29 Jan 2017 12:38:17 +0000"  >&lt;p&gt;The patch did not work for me on mac (both Xcode and gcc). I&apos;ve modified the patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1216&quot; title=&quot;Setting precision for the output stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1216&quot;&gt;&lt;del&gt;AVRO-1216&lt;/del&gt;&lt;/a&gt;-A) by using Boost&apos;s lexical_cast instead of iomanip. It seems to work. If there are no objections, I&apos;ll commit it in a day or two.&lt;/p&gt;</comment>
                            <comment id="15844489" author="comm@squotd.net" created="Sun, 29 Jan 2017 15:51:13 +0000"  >&lt;p&gt;Thanks for looking at this! Your lexical_cast solution looks good to me!&lt;/p&gt;</comment>
                            <comment id="15846416" author="jira-bot" created="Tue, 31 Jan 2017 05:38:41 +0000"  >&lt;p&gt;Commit a974984e6e7150b2c6e757bce9cc994b740094c1 in avro&apos;s branch refs/heads/master from Thiruvalluvan M G&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=a974984&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=a974984&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1216&quot; title=&quot;Setting precision for the output stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1216&quot;&gt;&lt;del&gt;AVRO-1216&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15846417" author="thiru_mg" created="Tue, 31 Jan 2017 05:39:25 +0000"  >&lt;p&gt;Fixed by applying the modified patch. Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=comm%40squotd.net&quot; class=&quot;user-hover&quot; rel=&quot;comm@squotd.net&quot;&gt;John McClean&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15846421" author="comm@squotd.net" created="Tue, 31 Jan 2017 05:50:46 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thiru_mg&quot; class=&quot;user-hover&quot; rel=&quot;thiru_mg&quot;&gt;Thiruvalluvan M. G.&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12849870" name="AVRO-1216-A.patch" size="3639" author="thiru_mg" created="Sun, 29 Jan 2017 12:38:55 +0000"/>
                            <attachment id="12804780" name="AVRO-1216.patch" size="3418" author="comm@squotd.net" created="Wed, 18 May 2016 20:33:59 +0000"/>
                            <attachment id="12559947" name="cpx.json" size="163" author="pjacobs" created="Fri, 7 Dec 2012 20:41:08 +0000"/>
                            <attachment id="12559948" name="precision.cpp" size="742" author="pjacobs" created="Fri, 7 Dec 2012 20:41:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 May 2016 20:32:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296553</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14a4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233105</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1217] Calling set_meta on DataFileWriter does not do anything (in python)</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1217</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;In the code:&lt;/p&gt;

&lt;p&gt;    writer = open(FILENAME, &apos;wb&apos;)&lt;br/&gt;
    with datafile.DataFileWriter(writer, datum_writer, schema_object) as dfw:&lt;br/&gt;
      dfw.set_meta(&apos;test.string&apos;, &apos;foo&apos;)&lt;/p&gt;

&lt;p&gt;the call to set_meta does not actually cause the metadata to be written to the file.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 12.04&lt;/p&gt;</environment>
        <key id="12622972">AVRO-1217</key>
            <summary>Calling set_meta on DataFileWriter does not do anything (in python)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tebeka">Miki Tebeka</assignee>
                                    <reporter username="pjsg">Philip Gladstone</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Fri, 7 Dec 2012 21:21:39 +0000</created>
                <updated>Wed, 27 Feb 2013 00:54:03 +0000</updated>
                            <resolved>Sat, 8 Dec 2012 01:08:39 +0000</resolved>
                                    <version>1.7.2</version>
                                    <fixVersion>1.7.4</fixVersion>
                                    <component>python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13526780" author="pjsg" created="Fri, 7 Dec 2012 21:23:30 +0000"  >&lt;p&gt;The attached patch fixes the problem and adds a test case.&lt;/p&gt;</comment>
                            <comment id="13526782" author="pjsg" created="Fri, 7 Dec 2012 21:25:35 +0000"  >&lt;p&gt;The patch that resolves the issue.&lt;/p&gt;</comment>
                            <comment id="13526950" author="tebeka" created="Sat, 8 Dec 2012 01:08:28 +0000"  >&lt;p&gt;Thanks for the patch, committed in rev 1418584.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12559955" name="meta.pf" size="2702" author="pjsg" created="Fri, 7 Dec 2012 21:25:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 8 Dec 2012 01:08:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296559</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 7 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14a67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233111</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Calls to DataFileWriter set_meta method will now add metadata to the written file if the call is before any datum is appended to the file.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
