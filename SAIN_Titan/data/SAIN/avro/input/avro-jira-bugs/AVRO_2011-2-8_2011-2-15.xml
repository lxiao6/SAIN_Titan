<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:15:09 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2011-2-8+AND+created+%3C%3D+2011-2-15+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="8" total="8"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-759] Field alias not working due to Schema.getFieldAlias return null for fields not aliased</title>
                <link>https://issues.apache.org/jira/browse/AVRO-759</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;When field alias is used, I get NullPointerException in Schema.Field.hashCode() because Field.name is null. This is because Schema.getFieldAlias return null for non-aliased field. Currently the code is as below:&lt;/p&gt;

&lt;p&gt;private static String getFieldAlias(Name record, String field,&lt;br/&gt;
        Map&amp;lt;Name, Map&amp;lt;String, String&amp;gt;&amp;gt; fieldAliases) {&lt;br/&gt;
        Map&amp;lt;String, String&amp;gt; recordAliases = fieldAliases.get(record);&lt;br/&gt;
        if(recordAliases == null) &lt;/p&gt;
{
            return field;
        }&lt;br/&gt;
        return recordAliases.get(field);&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
Given recordAliases only has aliases, it should return field itself if it&apos;s not in recordAliases as below:&lt;br/&gt;
&lt;br/&gt;
private static String getFieldAlias(Name record, String field,&lt;br/&gt;
        Map&amp;lt;Name, Map&amp;lt;String, String&amp;gt;&amp;gt; fieldAliases) {&lt;br/&gt;
        Map&amp;lt;String, String&amp;gt; recordAliases = fieldAliases.get(record);&lt;br/&gt;
        if(recordAliases == null) {            return field;        }
&lt;p&gt;        String ret = recordAliases.get(field);&lt;br/&gt;
        if (ret == null) ret = field;&lt;br/&gt;
        return ret;&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12497991">AVRO-759</key>
            <summary>Field alias not working due to Schema.getFieldAlias return null for fields not aliased</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xiaoluye">Xiaolu Ye</assignee>
                                    <reporter username="xiaoluye">Xiaolu Ye</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Feb 2011 15:25:07 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:48 +0000</updated>
                            <resolved>Tue, 15 Feb 2011 21:50:45 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12992236" author="cutting" created="Tue, 8 Feb 2011 23:38:29 +0000"  >&lt;p&gt;I am unable to duplicate this.  Can you please provide a test that illustrates the NullPointerException?&lt;/p&gt;</comment>
                            <comment id="12992469" author="xiaoluye" created="Wed, 9 Feb 2011 13:01:25 +0000"  >&lt;p&gt;Sorry, I should&apos;ve be more clear about my comment. The NullPointerException happens when creating a resolvingDecoder of a writerSchema using aliased name and a reader schema with alias defined. I will attach the test protocols and a junit test.&lt;/p&gt;</comment>
                            <comment id="12992472" author="xiaoluye" created="Wed, 9 Feb 2011 13:04:27 +0000"  >&lt;p&gt;The reade.avpr defines a protocol with alias, aliased-reader.avpr defines a protocol using the aliased name. Please change the path that points to those two avpr file in AvroAliasTest to run it.&lt;/p&gt;</comment>
                            <comment id="12993724" author="xiaoluye" created="Fri, 11 Feb 2011 22:01:56 +0000"  >&lt;p&gt;Hi Doug,&lt;/p&gt;

&lt;p&gt;Were you able to reproduce the problem? Please let me know if you have any issue with it.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Xiaolu&lt;/p&gt;</comment>
                            <comment id="12994480" author="cutting" created="Mon, 14 Feb 2011 20:43:48 +0000"  >&lt;p&gt;I am able to reproduce it.  Field aliases only worked when all fields of a record had aliases &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  I changed the existing test, adding an un-aliased field.  Tests then failed until I made the change you suggested.&lt;/p&gt;

&lt;p&gt;Thanks for finding this and providing a fix!&lt;/p&gt;</comment>
                            <comment id="12994482" author="cutting" created="Mon, 14 Feb 2011 20:44:52 +0000"  >&lt;p&gt;I will commit this bugfix soon unless there are objections.&lt;/p&gt;</comment>
                            <comment id="12994520" author="scott_carey" created="Mon, 14 Feb 2011 22:04:21 +0000"  >&lt;p&gt;Looks good, +1&lt;/p&gt;</comment>
                            <comment id="12995022" author="cutting" created="Tue, 15 Feb 2011 21:50:45 +0000"  >&lt;p&gt;I committed this.  Thanks, Xiaolu Ye!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12471019" name="AVRO-759.patch" size="1651" author="cutting" created="Mon, 14 Feb 2011 20:43:48 +0000"/>
                            <attachment id="12470673" name="AvroAliasTest.java" size="1132" author="xiaoluye" created="Wed, 9 Feb 2011 13:04:27 +0000"/>
                            <attachment id="12470672" name="aliased-reader.avpr" size="3271" author="xiaoluye" created="Wed, 9 Feb 2011 13:04:27 +0000"/>
                            <attachment id="12470671" name="reader.avpr" size="3354" author="xiaoluye" created="Wed, 9 Feb 2011 13:04:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Feb 2011 23:38:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4210</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2an:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-760] Python str(Protocol) bug in handling namespace</title>
                <link>https://issues.apache.org/jira/browse/AVRO-760</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;If I have a protocol that has record with field of a type defined in a different namespace, Python Protocol can parse it fine, but the str(Protocol) output does not use full name (namespace + name) for the type when referenced in a different namespace. Please see the attachment for example.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498170">AVRO-760</key>
            <summary>Python str(Protocol) bug in handling namespace</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="xiaoluye">Xiaolu Ye</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Feb 2011 19:50:04 +0000</created>
                <updated>Tue, 3 Jan 2012 06:59:16 +0000</updated>
                                            <version>1.4.1</version>
                                                    <component>python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12992693" author="xiaoluye" created="Wed, 9 Feb 2011 19:55:50 +0000"  >&lt;p&gt;test.avpr is the original protocol for python to parse. test-python.avpr is the output of below python script:&lt;/p&gt;

&lt;p&gt;j_str1 = open(&quot;test.avpr&quot;,&apos;rb&apos;).read()    &lt;br/&gt;
P = protocol.parse(j_str1)&lt;br/&gt;
f = open(&quot;test-python.avpr&quot;,&quot;w&quot;)&lt;br/&gt;
f.write(str(P))&lt;br/&gt;
f.close()&lt;/p&gt;

&lt;p&gt;As you can see, the SecuirtyType refered in MyProduct doesn&apos;t have namespace com.foo.bar which causes issue when doing &quot;protocol.parse(str(P))&quot;&lt;/p&gt;</comment>
                            <comment id="12996080" author="xiaoluye" created="Thu, 17 Feb 2011 21:11:01 +0000"  >&lt;p&gt;Didn&apos;t see a response to this. Would appreciate if someone can take a look and make this part of 1.5 release as this breaks with our protocol. Unfortunately, I don&apos;t know Python enough to identify the bug and provide a fix. Thanks! &lt;/p&gt;</comment>
                            <comment id="13178647" author="qwertymaniac" created="Tue, 3 Jan 2012 06:54:37 +0000"  >&lt;p&gt;Sorry to come in late on this.&lt;/p&gt;

&lt;p&gt;Running your test program against your test file produces no error on trunk for me. Was this resolved? If so, can we mark this one resolved?&lt;/p&gt;</comment>
                            <comment id="13178648" author="qwertymaniac" created="Tue, 3 Jan 2012 06:59:16 +0000"  >&lt;p&gt;Or perhaps you&apos;re talking about this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;protocol&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;MyProtocol&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;types&quot;&lt;/span&gt;: [{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo.bar&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;ProductRef&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;: [{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, {&lt;span class=&quot;code-quote&quot;&gt;&quot;symbols&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;AAA&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;BBB&quot;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;SecurityType&quot;&lt;/span&gt;}], &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;securityType&quot;&lt;/span&gt;}]}, {&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;namespace&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo.zoo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;MyProduct&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;: [{&lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;SecurityType&quot;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;securityType&quot;&lt;/span&gt;}]}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not containing com.foo.bar.SecurityType, as intended?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470718" name="test-python.avpr" size="397" author="xiaoluye" created="Wed, 9 Feb 2011 19:55:50 +0000"/>
                            <attachment id="12470717" name="test.avpr" size="1139" author="xiaoluye" created="Wed, 9 Feb 2011 19:55:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 3 Jan 2012 06:54:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94977</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80135</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-761] Requestor sends protocol text on each handshake under certain circumstances</title>
                <link>https://issues.apache.org/jira/browse/AVRO-761</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;When using a stateless transport such as HTTP and different protocol versions on client and server, Requestor will send the local protocol text on each request once a handshake match is established.  For large protocols, this slows things down considerably.  The attached patch resolves the issue by resetting the sendLocalText field after a successful handshake.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498172">AVRO-761</key>
            <summary>Requestor sends protocol text on each handshake under certain circumstances</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="rahrens">Richard Ahrens</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Feb 2011 20:28:33 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:50 +0000</updated>
                            <resolved>Tue, 8 Mar 2011 01:02:53 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12992721" author="cutting" created="Wed, 9 Feb 2011 21:15:47 +0000"  >&lt;p&gt;Thanks for the patch, Richard.&lt;/p&gt;

&lt;p&gt;It would be good to have a test case for this, but I don&apos;t see how to do that easily.  Perhaps we could maintain a HandshakeMatch field RPCPlugin, then add a plugin to TestProtocolHttp whose clientFinishConnect() implementation checks that the match for all but the first call is HandshakeMatch.BOTH?&lt;/p&gt;</comment>
                            <comment id="12996097" author="scott_carey" created="Thu, 17 Feb 2011 21:34:36 +0000"  >&lt;p&gt;Marking 1.5.0 for now, it is a non-blocker and may shortly end up 1.5.1 however.&lt;/p&gt;</comment>
                            <comment id="13003614" author="cutting" created="Mon, 7 Mar 2011 21:14:50 +0000"  >&lt;p&gt;Here&apos;s a patch that includes tests.&lt;/p&gt;

&lt;p&gt;RPCContext is altered to expose the entire handshake to plugins, not just the handshake metadata as before.  TestProtocolSpecific is altered to check that a given client protocol is only transmitted once, and its TestProtocolHttp is altered to make a second request over a different protocol to trigger the bug.  Without the changes to Requestor setting sendLocalText=false TestProtocolHttp now fails, with these changes is passes. &lt;/p&gt;</comment>
                            <comment id="13003625" author="cutting" created="Mon, 7 Mar 2011 21:32:26 +0000"  >&lt;p&gt;Unless there are objections, I will commit this soon.&lt;/p&gt;</comment>
                            <comment id="13003745" author="cutting" created="Tue, 8 Mar 2011 01:02:53 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12472864" name="AVRO-761.patch" size="7106" author="cutting" created="Mon, 7 Mar 2011 21:14:50 +0000"/>
                            <attachment id="12470722" name="Requestor.java.patch" size="532" author="rahrens" created="Wed, 9 Feb 2011 20:29:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 Feb 2011 21:15:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4211</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 46 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2b3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80136</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-762] Better schema resolution</title>
                <link>https://issues.apache.org/jira/browse/AVRO-762</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I&apos;ve been working on a pretty major patch that changes the way the C library implements schema resolution.  Before, we would compare the writer and reader schemas each time we try to read a record from an Avro file.  This is a fair bit of wasted effort.  The approach I&apos;m taking with the new implementation is to separate schema resolution and binary parsing into separate operations.  There&apos;s a new &quot;consumer&quot; API, which defines a set of callbacks for processing Avro data that conforms to a schema.  The new avro_consume_binary function reads binary-encoded Avro data from a buffer or file, and passes that data into a consumer instance.  Each consumer instance is associated with the writer schema of the data that it expects to process.&lt;/p&gt;

&lt;p&gt;Schema resolution is now implemented in the new avro_resolver_new function, which returns a consumer instance that knows how to translate from the writer schema to the reader schema.  As the resolver receives data via the consumer API, it fills in the contents of a destination avro_datum_t (which should be an instance of the reader schema).&lt;/p&gt;

&lt;p&gt;This work isn&apos;t complete yet&#160;&#8212; I still have to implement promotion (int-&amp;gt;long and friends), and have to add support for recursive schemas (via the AVRO_LINK schema type).  But I wanted to get the patch out there for people to view and test in the meantime.  This patch depends on a few other of my patches, that haven&apos;t made it into SVN yet; if you want to test the code without patching yourself, I have a tracking branch on &lt;a href=&quot;https://github.com/dcreager/avro/tree/resolution&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;github&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498176">AVRO-762</key>
            <summary>Better schema resolution</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dcreager">Douglas Creager</assignee>
                                    <reporter username="dcreager">Douglas Creager</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Feb 2011 20:44:33 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:55 +0000</updated>
                            <resolved>Fri, 25 Feb 2011 21:15:58 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12992733" author="dcreager" created="Wed, 9 Feb 2011 21:49:41 +0000"  >&lt;p&gt;And here&apos;s a patch that implements the promotion rules.&lt;/p&gt;</comment>
                            <comment id="12993547" author="dcreager" created="Fri, 11 Feb 2011 15:51:56 +0000"  >&lt;p&gt;And lastly, here is a patch that works with recursive schemas.  I believe that all of the schema resolution rules are implemented correctly now.&lt;/p&gt;</comment>
                            <comment id="12999483" author="cutting" created="Fri, 25 Feb 2011 19:19:52 +0000"  >&lt;p&gt;I&apos;m getting the following 2 test failures on Ubuntu 10.10:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;TEST /home/cutting/src/avro/trunk/lang/c/tests/schema_tests/fail/record_with_non
array_fields.../bin/bash: line 5: 25436 Segmentation fault      ${dir}$tst
FAIL: test_avro_schema
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+ ../libtool execute valgrind --leak-check=full -q test_avro_data
+ grep -E ^==[0-9]+== 
==25529== 1,538 (32 direct, 1,506 indirect) bytes in 1 blocks are definitely los
t in loss record 18 of 18
==25529==    at 0x4025BD3: malloc (vg_replace_malloc.c:236)
==25529==    by 0x4025C5D: realloc (vg_replace_malloc.c:525)
==25529==    by 0x8049888: test_allocator (test_avro_data.c:58)
==25529==    by 0x40319CB: avro_schema_record (schema.c:560)
==25529==    by 0x40329C0: avro_schema_from_json_t (schema.c:853)
==25529==    by 0x4032D46: avro_schema_from_json (schema.c:1104)
==25529==    by 0x804A3A4: test_nested_record (test_avro_data.c:402)
==25529==    by 0x804B09D: main (test_avro_data.c:661)
==25529== 
+ [ 0 -eq 0 ]
+ exit 1
FAIL: test_valgrind
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12999493" author="dcreager" created="Fri, 25 Feb 2011 19:34:29 +0000"  >&lt;p&gt;Is this 32-bit or 64-bit?  I&apos;ve got a 64-bit Ubuntu 10.10 box, and don&apos;t get any segfault on that.  If it&apos;s 32-bit, I&apos;ll spin up another VM and see if I can reproduce.&lt;/p&gt;

&lt;p&gt;The valgrind error is an example of &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;.  It&apos;s not a regression; there wasn&apos;t any test for it before.  The memory leak only affects recursive schemas.  I think fixing it will require a fairly major rewrite of the reference counting mechanism; is that something we want to block 1.5.0 for?&lt;/p&gt;</comment>
                            <comment id="12999507" author="cutting" created="Fri, 25 Feb 2011 19:44:54 +0000"  >&lt;p&gt;32-bit.&lt;/p&gt;</comment>
                            <comment id="12999540" author="cutting" created="Fri, 25 Feb 2011 20:34:38 +0000"  >&lt;p&gt;I don&apos;t think we have to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; for 1.5.0, but maybe we should turn off that test until it&apos;s fixed?&lt;/p&gt;</comment>
                            <comment id="12999541" author="dcreager" created="Fri, 25 Feb 2011 20:34:54 +0000"  >&lt;p&gt;Just committed a fix for the segfault issue.  I think it actually had to with the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-463&quot; title=&quot;C implementation should return json parse errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-463&quot;&gt;&lt;del&gt;AVRO-463&lt;/del&gt;&lt;/a&gt;, though I think I referenced this issue in the commit message.  Hopefully this will resolve the buildbot failures on FreeBSD and Solaris, too.&lt;/p&gt;</comment>
                            <comment id="12999561" author="cutting" created="Fri, 25 Feb 2011 20:57:01 +0000"  >&lt;p&gt;Segfault is fixed for me.  Thanks!&lt;/p&gt;

&lt;p&gt;Should we turn off the failing valgrind test and resolve this issue as &quot;fixed&quot;?&lt;/p&gt;</comment>
                            <comment id="12999573" author="dcreager" created="Fri, 25 Feb 2011 21:12:33 +0000"  >&lt;p&gt;The test will skip the valgrind portion if valgrind isn&apos;t installed...so yeah, we can comment out the valgrind test for now.  I&apos;ll do that.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470725" name="0001-Better-schema-resolution.patch" size="71418" author="dcreager" created="Wed, 9 Feb 2011 20:44:57 +0000"/>
                            <attachment id="12470730" name="0002-Promotion-of-values-during-schema-resolution.patch" size="16530" author="dcreager" created="Wed, 9 Feb 2011 21:49:41 +0000"/>
                            <attachment id="12470865" name="0003-Recursive-schema-resolution.patch" size="30606" author="dcreager" created="Fri, 11 Feb 2011 15:51:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 25 Feb 2011 19:19:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2bb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-763] Java: Mapred API:  allow users to utilize configure() and close() methods on AvroMapper and AvroReducer</title>
                <link>https://issues.apache.org/jira/browse/AVRO-763</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;From avro-user mailing list:&lt;/p&gt;

&lt;blockquote&gt;

&lt;p&gt;Currently the AvroMapper and AvroReducer do not have the configure(..) and&lt;br/&gt;
close() methods from typical MapReduce jobs.  Can they be added to the code?&lt;/p&gt;

&lt;p&gt;Normally I would just extend org.apache.avro.mapred.HadoopReducer so that&lt;br/&gt;
those methods are called on the delegate classes.  However HadoopReducer is&lt;br/&gt;
package protected.  Is there a reason for that?&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12498179">AVRO-763</key>
            <summary>Java: Mapred API:  allow users to utilize configure() and close() methods on AvroMapper and AvroReducer</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mpierce">Marshall Pierce</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Feb 2011 22:08:57 +0000</created>
                <updated>Fri, 6 May 2011 19:14:00 +0000</updated>
                            <resolved>Wed, 20 Apr 2011 19:55:53 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.1</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12992798" author="cutting" created="Wed, 9 Feb 2011 23:50:16 +0000"  >&lt;p&gt;There&apos;s no reason I can think of not to add these methods to AvroMapper and AvroReducer.  +1&lt;/p&gt;</comment>
                            <comment id="12992836" author="cwilkes" created="Thu, 10 Feb 2011 02:19:20 +0000"  >&lt;p&gt;I can submit a patch.  There&apos;s nothing complicated in it.&lt;/p&gt;</comment>
                            <comment id="13006512" author="cutting" created="Mon, 14 Mar 2011 16:57:18 +0000"  >&lt;p&gt;This is a compatible API change, so hopefully we can get this into 1.5.1.&lt;/p&gt;</comment>
                            <comment id="13013725" author="cutting" created="Wed, 30 Mar 2011 23:12:47 +0000"  >&lt;p&gt;Chris, were you going to submit a patch for this?  Thanks!&lt;/p&gt;</comment>
                            <comment id="13021845" author="mpierce" created="Tue, 19 Apr 2011 22:58:05 +0000"  >&lt;p&gt;Patch to add close() and configure() support to AvroMapper and AvroReducer.&lt;/p&gt;</comment>
                            <comment id="13021861" author="cutting" created="Tue, 19 Apr 2011 23:54:10 +0000"  >&lt;p&gt;Looks good.  Passes tests for me, except checkstyle, which complains about a wildcard import.&lt;/p&gt;</comment>
                            <comment id="13021865" author="mpierce" created="Wed, 20 Apr 2011 00:05:48 +0000"  >&lt;p&gt;Ack! Didn&apos;t have the code style set up for the avro project in my IDE to fix the imports &amp;#8211; I&apos;ll update the patch.&lt;/p&gt;</comment>
                            <comment id="13021870" author="mpierce" created="Wed, 20 Apr 2011 00:13:52 +0000"  >&lt;p&gt;Updated patch that also removes star imports.&lt;/p&gt;</comment>
                            <comment id="13022340" author="cutting" created="Wed, 20 Apr 2011 19:55:53 +0000"  >&lt;p&gt;I just committed this.  Thanks, Marshall!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12476802" name="AVRO-763-r2.patch" size="8024" author="mpierce" created="Wed, 20 Apr 2011 00:13:52 +0000"/>
                            <attachment id="12476798" name="mapper-reducer-close-configure.patch" size="7573" author="mpierce" created="Tue, 19 Apr 2011 22:58:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 Feb 2011 23:50:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94978</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2bj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80138</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-764] Possible issue with BinaryData.compare(...) used in Map/Reduce</title>
                <link>https://issues.apache.org/jira/browse/AVRO-764</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;MapReduce&apos;s RawComparator feature has a call &lt;tt&gt;compare(b1, start1, length1, b2, start2, length2)&lt;/tt&gt; which is handled for Avro using &lt;tt&gt;BinaryData.compare(b1, start1, b2, start2, schema)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;BinaryDecoder, used by the BinaryData.compare(b1, start1, b2, start2, schema) utility, has a sub-clause that handles byte array inputs of less than 16 bytes in length.&lt;/p&gt;

&lt;p&gt;This is the exact code which am talking about:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;BinaryDecoder.java Lines 879-893&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ByteArrayByteSource(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] data, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len) {
      &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;();
      &lt;span class=&quot;code-comment&quot;&gt;// make sure data is not too small, otherwise getLong may &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; and
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// read 10 bytes and get index out of bounds.
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (data.length &amp;lt; 16 || len &amp;lt; 16) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.data = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[16];
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.arraycopy(data, start, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.data, 0, len);
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.position = 0;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.max = len;
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-comment&quot;&gt;// use the array passed in
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.data = data;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.position = start;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.max = start + len;
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This clause would fail during &lt;tt&gt;arrayCopy&lt;/tt&gt; since the target &lt;tt&gt;len&lt;/tt&gt; bytes is sent into the constructor as the &lt;tt&gt;length&lt;/tt&gt; of the byte array input itself, and not the length as given by the framework which should be the right one &lt;span class=&quot;error&quot;&gt;&amp;#91;Since the BD.compare() call does not take it as a parameter&amp;#93;&lt;/span&gt;. Thus, arrayCopy would be trying to copy from &lt;tt&gt;start&lt;/tt&gt; byte index to &lt;tt&gt;length&lt;/tt&gt; bytes after it, where &lt;tt&gt;length&lt;/tt&gt; is the byte array&apos;s &lt;tt&gt;.length&lt;/tt&gt; itself &amp;#8211; which leads to an index bounds exception.&lt;/p&gt;

&lt;p&gt;Here is a slightly low level test case that should fail with an &lt;tt&gt;ArrayIndexOutOfBoundsException&lt;/tt&gt; due to a bad &lt;tt&gt;System.arrayCopy&lt;/tt&gt; call:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;TestBinaryData.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.avro.io;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.ByteArrayOutputStream;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.ArrayList;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.List;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.avro.Schema;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.avro.Schema.Field;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.avro.Schema.Type;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericData.Record;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumWriter;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Assert;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestBinaryData {

  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompare() {
    &lt;span class=&quot;code-comment&quot;&gt;// Prepare a schema &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; testing.
&lt;/span&gt;    Field integerField = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Field(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, Schema.create(Type.INT), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    List&amp;lt;Field&amp;gt; fields = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;Field&amp;gt;();
    fields.add(integerField);
    Schema record = Schema.createRecord(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
    record.setFields(fields);
    
    ByteArrayOutputStream b1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream(5);
    ByteArrayOutputStream b2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ByteArrayOutputStream(5);
    BinaryEncoder b1Enc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BinaryEncoder(b1);
    BinaryEncoder b2Enc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BinaryEncoder(b2);
    Record testDatum1 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Record(record);
    testDatum1.put(0, 1);
    Record testDatum2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Record(record);
    testDatum2.put(0, 2);
    GenericDatumWriter&amp;lt;Record&amp;gt; gWriter = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericDatumWriter&amp;lt;Record&amp;gt;(record);
    &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; start1 = 0, start2 = 0;
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      gWriter.write(testDatum1, b1Enc);
      b1Enc.flush();
      start1 = b1.size();
      gWriter.write(testDatum1, b1Enc);
      b1Enc.flush();
      b1.close();
      gWriter.write(testDatum2, b2Enc);
      b2Enc.flush();
      start2 = b2.size();
      gWriter.write(testDatum2, b2Enc);
      b2Enc.flush();
      b2.close();
      BinaryData.compare(b1.toByteArray(), start1, b2.toByteArray(), start2, record);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
      Assert.fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;IOException &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; writing records to output stream.&quot;&lt;/span&gt;);
    }
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A solution would be to let the length, as given by the MapReduce framework itself, be used instead of using &lt;tt&gt;bytearray.length&lt;/tt&gt; in its place. I&apos;ll attach a patch for this soon.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux, CDH3&lt;/p&gt;</environment>
        <key id="12498481">AVRO-764</key>
            <summary>Possible issue with BinaryData.compare(...) used in Map/Reduce</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="qwertymaniac">Harsh J</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                            <label>hadoop</label>
                    </labels>
                <created>Sun, 13 Feb 2011 15:37:29 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:49 +0000</updated>
                            <resolved>Wed, 16 Feb 2011 01:25:31 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="300">5m</timespent>
                                <comments>
                            <comment id="12994116" author="qwertymaniac" created="Sun, 13 Feb 2011 16:07:24 +0000"  >&lt;p&gt;Patch that allows a length for each byte array under comparison to be passed.&lt;/p&gt;

&lt;p&gt;All tests pass even after modification of AvroKeyComparator to use the new function.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.avro.mapred.TestAvroOutputFormat
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.118 sec
Running org.apache.avro.mapred.TestReflectJob
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.504 sec
Running org.apache.avro.mapred.TestWeather
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.655 sec
Running org.apache.avro.mapred.TestWordCount
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.57 sec
Running org.apache.avro.mapred.TestSequenceFileReader
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.745 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No new test-case has been added. Would one be required?&lt;/p&gt;
</comment>
                            <comment id="12994143" author="scott_carey" created="Sun, 13 Feb 2011 19:46:01 +0000"  >&lt;p&gt;Good catch!   It looks like there is a bug in BinaryData.compare() :&lt;/p&gt;

&lt;p&gt;It doesn&apos;t make any sense to me call set with:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;decoders.set(b1, s1, b1.length, b2, s2, b2.length);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It should have been &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;decoders.set(b1, s1, b1.length - s1, b2, s2, b2.length - s2);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The length that BinaryDecoder is interested in is the length of the valid data (like OutputStream.write(byte[], pos, len);&lt;br/&gt;
The length of the array itself is a member variable on the array and not necessary to pass as a parameter.&lt;/p&gt;

&lt;p&gt;So your patch looks correct to me, but we should also change the faulty logic above.&lt;/p&gt;

&lt;p&gt;Please include your test above (TestGenericData is a good place for it).&lt;br/&gt;
Also, try and avoid gratuitous changes to the order of import statements.  Unfortunately, development environments reorder them differently, and keeping the noise down in a patch will help prevent merge collisions.&lt;/p&gt;</comment>
                            <comment id="12994646" author="qwertymaniac" created="Tue, 15 Feb 2011 03:44:49 +0000"  >&lt;p&gt;New patch.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Addressed Scott&apos;s two comments (imports and the fix in the original compare method)&lt;/li&gt;
	&lt;li&gt;Added a testCompare case in TestGenericData&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12994901" author="scott_carey" created="Tue, 15 Feb 2011 17:57:15 +0000"  >&lt;p&gt;+1 looks good.  New test fails without changes, works with changes.  All tests pass after.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this soon unless there are objections.&lt;/p&gt;</comment>
                            <comment id="12994924" author="cutting" created="Tue, 15 Feb 2011 18:42:15 +0000"  >&lt;p&gt;+1 Looks good to me!&lt;/p&gt;</comment>
                            <comment id="12995107" author="scott_carey" created="Wed, 16 Feb 2011 01:25:31 +0000"  >&lt;p&gt;committed in r1071117.  fixed error in CHANGES.txt in r1071118&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470963" name="avro.mapred.binarydata.compare.r1.diff" size="3907" author="qwertymaniac" created="Sun, 13 Feb 2011 16:07:24 +0000"/>
                            <attachment id="12471058" name="avro.mapred.binarydata.compare.r2.diff" size="5193" author="qwertymaniac" created="Tue, 15 Feb 2011 03:44:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 13 Feb 2011 19:46:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4155</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80139</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Allow the BinaryData.compare(...) utility to make use of the lengths as passed by the RawComparator in Map/Reduce.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>avro, map/reduce, rawcomparator, binarydata, binarydecoder</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-765] Java: Improvement to BinaryDecoder readLong performance</title>
                <link>https://issues.apache.org/jira/browse/AVRO-765</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I have found a few enhancements to the BinaryDecoder while I was working on the BinaryEncoders.&lt;/p&gt;

&lt;p&gt;BinaryDecoder&apos;s readLong improves by 75%+ on the latest 64bit Sun JVM&apos;s. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12498494">AVRO-765</key>
            <summary>Java: Improvement to BinaryDecoder readLong performance</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Feb 2011 01:28:29 +0000</created>
                <updated>Tue, 13 Dec 2011 19:06:44 +0000</updated>
                            <resolved>Mon, 14 Feb 2011 19:11:30 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12994183" author="scott_carey" created="Mon, 14 Feb 2011 01:32:50 +0000"  >
&lt;p&gt;readLong is currently about half the speed of readInt, even if operating on the same small numbers.  I was able to reorganize readLong into two methods that the compiler can fully optimize.  The JIT favors smaller methods by attempting more optimizations on them.&lt;/p&gt;

&lt;p&gt;The current performance is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                    test name     time    M entries/sec   M bytes/sec  bytes/cycle
                      IntRead:    761 ms     262.586       661.007        629325
                SmallLongRead:   1606 ms     124.481       313.356        629325
                     LongRead:   2637 ms      75.833       331.346       1092353

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The changes in this patch bring up the readLong performance to be close to readInt.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                    test name     time    M entries/sec   M bytes/sec  bytes/cycle
                      IntRead:    742 ms     269.301       677.911        629325
                SmallLongRead:    833 ms     239.884       603.860        629325
                     LongRead:   1663 ms     120.210       525.247       1092353
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12994390" author="cutting" created="Mon, 14 Feb 2011 17:58:14 +0000"  >&lt;p&gt;+1 Looks great to me.  Thanks, Scott!&lt;/p&gt;</comment>
                            <comment id="12994432" author="scott_carey" created="Mon, 14 Feb 2011 19:11:30 +0000"  >&lt;p&gt;Committed @ r1070613&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470975" name="AVRO-765.patch" size="4513" author="scott_carey" created="Mon, 14 Feb 2011 01:32:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 14 Feb 2011 17:58:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2bz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80140</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-766] C: Memory leak from reference count cycles</title>
                <link>https://issues.apache.org/jira/browse/AVRO-766</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;If you parse a recursive Avro schema, you end up with a cycle in the reference graph for the avro_schema_t objects that are created.  The reference counting mechanism that we&apos;re using can&apos;t detect this, and so you get a memory leak.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498542">AVRO-766</key>
            <summary>C: Memory leak from reference count cycles</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dcreager">Douglas Creager</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Feb 2011 15:08:35 +0000</created>
                <updated>Tue, 11 Dec 2018 19:14:55 +0000</updated>
                                            <version>1.5.0</version>
                                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12994333" author="dcreager" created="Mon, 14 Feb 2011 15:10:31 +0000"  >&lt;p&gt;Here&apos;s a minimal test case that shows the memory leak.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ gcc -o ref-cycle ref-cycle.c -lavro
$ valgrind --leak-check=full ./ref-cycle
[SNIP]
==48091== 2,782 (48 direct, 2,734 indirect) bytes in 1 blocks are definitely lost in loss record 19 of 19
==48091==    at 0x1000121DE: realloc (vg_replace_malloc.c:236)
==48091==    by 0x100030BC3: avro_schema_record (in /usr/local/Cellar/avro-c/HEAD/lib/libavro.1.5.0-SNAPSHOT.dylib)
==48091==    by 0x100031CCE: avro_schema_from_json_t (in /usr/local/Cellar/avro-c/HEAD/lib/libavro.1.5.0-SNAPSHOT.dylib)
==48091==    by 0x10003234D: avro_schema_from_json (in /usr/local/Cellar/avro-c/HEAD/lib/libavro.1.5.0-SNAPSHOT.dylib)
==48091==    by 0x100000E4D: main (in ./ref-cycle)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13456259" author="vnadkarni" created="Sat, 15 Sep 2012 00:40:18 +0000"  >&lt;p&gt;The current AVRO specification requires that AVRO_LINKs are internal to a schema. See comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-530&quot; title=&quot;allow for mutual recursion in type definitions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-530&quot;&gt;AVRO-530&lt;/a&gt;, which indicate that external links are not backwards compatible and may only be introduced in Avro 2.0.&lt;/p&gt;

&lt;p&gt;Currently, when an AVRO_LINK is created in a schema, the reference count of the target schema is incremented. If the schema is recursive, then the reference count of the top-level schema is incremented &amp;#8211; and decrementing the reference count of the top-level schema doesn&apos;t deallocate the schema. Thus, a memory leak is formed.&lt;/p&gt;

&lt;p&gt;Since, all AVRO_LINKs have targets that are internal to the same top-level schema, we could decide that we would not increment the reference count of the targets of any links. The targets would be available as long as the top-level schema is available. But if the top-level schema is not available, then all the internal links would be destroyed too. Therefore, as long as the link itself is valid, the targets would also be valid. Using this internal structural knowledge of the schema, gives us an implicit guarantee of link target validity, while breaking the reference count cycles for recursive schemas.&lt;/p&gt;

&lt;p&gt;To implement this mechanism, we would need to ensure that no AVRO_LINKs are created with targets outside the top-level schema. While we cannot enforce this rule, we can document that external link targets would violate the spec, and could result in memory leaks. &lt;/p&gt;

&lt;p&gt;Unfortunately, avro_schema_copy() currently implements a link to an external target - described in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;. Therefore, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; should not be fixed using the described mechanism until &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt; is also fixed.&lt;/p&gt;

&lt;p&gt;This patch removes the increment and decrement of reference counts for link targets as described above. It also contains a test case test_avro_766.c (derived from ref-cycle.c), which shows the memory leak. It also contains a macro called TEST_AVRO_1167, that is currently enabled. If the test is disabled, you can see that this patch works.&lt;/p&gt;

&lt;p&gt;With TEST_AVRO_1167 set to (0):&lt;/p&gt;

&lt;p&gt;==21796== HEAP SUMMARY:&lt;br/&gt;
==21796==     in use at exit: 0 bytes in 0 blocks&lt;br/&gt;
==21796==   total heap usage: 129 allocs, 129 frees, 6,090 bytes allocated&lt;br/&gt;
==21796== &lt;br/&gt;
==21796== All heap blocks were freed &amp;#8211; no leaks are possible&lt;br/&gt;
==21796== &lt;br/&gt;
==21796== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 4 from 4)&lt;/p&gt;

&lt;p&gt;With TEST_AVRO_1167 set to (1):&lt;/p&gt;

&lt;p&gt;==21417== 4,240 (32 direct, 4,208 indirect) bytes in 1 blocks are definitely lost in loss record 30 of 30&lt;br/&gt;
==21417==    at 0x4C28F9F: malloc (vg_replace_malloc.c:236)&lt;br/&gt;
==21417==    by 0x4C29019: realloc (vg_replace_malloc.c:525)&lt;br/&gt;
==21417==    by 0x40D34C: avro_default_allocator (allocation.c:36)&lt;br/&gt;
==21417==    by 0x404647: avro_schema_union (schema.c:310)&lt;br/&gt;
==21417==    by 0x406886: avro_schema_copy (schema.c:1250)&lt;br/&gt;
==21417==    by 0x40670A: avro_schema_copy (schema.c:1183)&lt;br/&gt;
==21417==    by 0x403EEA: main (test_avro_766.c:64)&lt;br/&gt;
==21417== &lt;br/&gt;
==21417== LEAK SUMMARY:&lt;br/&gt;
==21417==    definitely lost: 56 bytes in 2 blocks&lt;br/&gt;
==21417==    indirectly lost: 4,232 bytes in 44 blocks&lt;br/&gt;
==21417==      possibly lost: 0 bytes in 0 blocks&lt;br/&gt;
==21417==    still reachable: 0 bytes in 0 blocks&lt;br/&gt;
==21417==         suppressed: 0 bytes in 0 blocks&lt;br/&gt;
==21417== &lt;br/&gt;
==21417== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 4 from 4)&lt;/p&gt;


&lt;p&gt;I am posting this test with TEST_AVRO_1167 set to (1) because I don&apos;t know the implications of applying this patch before fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;.&lt;/p&gt;
</comment>
                            <comment id="15970129" author="johnsgill3" created="Sat, 15 Apr 2017 20:37:47 +0000"  >&lt;p&gt;Open a PR on GitHub for this issue. It fixe both &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; at the same time.&lt;/p&gt;</comment>
                            <comment id="16715359" author="jira-bot" created="Mon, 10 Dec 2018 18:56:15 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16715361" author="jira-bot" created="Mon, 10 Dec 2018 18:56:19 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16715362" author="jira-bot" created="Mon, 10 Dec 2018 18:56:20 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16715365" author="jira-bot" created="Mon, 10 Dec 2018 18:56:49 +0000"  >&lt;p&gt;Commit b597c3ab93ef1c6a37a9c1fa3584d86d20723784 in avro&apos;s branch refs/heads/master from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16715367" author="jira-bot" created="Mon, 10 Dec 2018 18:56:52 +0000"  >&lt;p&gt;Commit b597c3ab93ef1c6a37a9c1fa3584d86d20723784 in avro&apos;s branch refs/heads/master from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16715368" author="jira-bot" created="Mon, 10 Dec 2018 18:56:54 +0000"  >&lt;p&gt;Commit b597c3ab93ef1c6a37a9c1fa3584d86d20723784 in avro&apos;s branch refs/heads/master from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=b597c3a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16717798" author="jira-bot" created="Tue, 11 Dec 2018 19:14:50 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16717801" author="jira-bot" created="Tue, 11 Dec 2018 19:14:53 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                            <comment id="16717802" author="jira-bot" created="Tue, 11 Dec 2018 19:14:55 +0000"  >&lt;p&gt;Commit 1f00b1a7a2f76921325ba073de3212a4a22524de in avro&apos;s branch refs/heads/branch-1.8 from John Gill&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=1f00b1a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Fix c AVRO_LINK memory leaks (#217)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;: Enhance avro_schema_copy for AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add hash of named schemas found during copy&lt;/li&gt;
	&lt;li&gt;Find saved named  schema for copy of AVRO_LINK&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt;: Correct memory leaks in AVRO_LINK copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Adds test cases for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-766&quot; title=&quot;C: Memory leak from reference count cycles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-766&quot;&gt;AVRO-766&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1167&quot; title=&quot;Avro-C: avro_schema_copy() does not copy AVRO_LINKs properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1167&quot;&gt;AVRO-1167&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Corrects reference counting for avro_schema_copy&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enable TEST_AVRO_1167 in test_avro_766&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This ensures that both fixes work together and that no valgrind errors are produced from a recrusive schema.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12607729">AVRO-1167</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12545258" name="AVRO-766.patch" size="4488" author="vnadkarni" created="Sat, 15 Sep 2012 00:40:18 +0000"/>
                            <attachment id="12470997" name="ref-cycle.c" size="597" author="dcreager" created="Mon, 14 Feb 2011 15:10:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 15 Sep 2012 00:40:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94979</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e2c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80141</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
