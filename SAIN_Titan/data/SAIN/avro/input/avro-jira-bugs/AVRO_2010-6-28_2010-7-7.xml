<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:14:11 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2010-6-28+AND+created+%3C%3D+2010-7-7+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="5" total="5"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-588] Allow Python implementation of Avro to be used with Python 2.4</title>
                <link>https://issues.apache.org/jira/browse/AVRO-588</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description></description>
                <environment></environment>
        <key id="12468234">AVRO-588</key>
            <summary>Allow Python implementation of Avro to be used with Python 2.4</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="hammer">Jeff Hammerbacher</assignee>
                                    <reporter username="hammer">Jeff Hammerbacher</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jun 2010 09:46:58 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:57 +0000</updated>
                            <resolved>Wed, 25 Aug 2010 19:36:12 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>python</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12883865" author="hammer" created="Wed, 30 Jun 2010 09:47:38 +0000"  >&lt;p&gt;CentOS 5 is still shipping it, so we should make it work.&lt;/p&gt;

&lt;p&gt;Current issue is our use of &lt;tt&gt;struct.Struct&lt;/tt&gt; objects in &lt;tt&gt;io.py&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="12883867" author="hammer" created="Wed, 30 Jun 2010 09:53:15 +0000"  >&lt;p&gt;Same issue in &lt;tt&gt;ipc.py&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="12883870" author="hammer" created="Wed, 30 Jun 2010 10:02:11 +0000"  >&lt;p&gt;Also, in &lt;tt&gt;protocol.py&lt;/tt&gt;, the change introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-451&quot; title=&quot;Try to use hashlib in Python implementation and fall back to md5 if we can&amp;#39;t find it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-451&quot;&gt;&lt;del&gt;AVRO-451&lt;/del&gt;&lt;/a&gt; will break if the &lt;tt&gt;hashlib&lt;/tt&gt; module is not available.&lt;/p&gt;</comment>
                            <comment id="12883873" author="brucem" created="Wed, 30 Jun 2010 10:18:12 +0000"  >&lt;p&gt;Why would the change from &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-451&quot; title=&quot;Try to use hashlib in Python implementation and fall back to md5 if we can&amp;#39;t find it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-451&quot;&gt;&lt;del&gt;AVRO-451&lt;/del&gt;&lt;/a&gt; break? It was written in my patch to still work on Python 2.4.&lt;/p&gt;</comment>
                            <comment id="12883876" author="hammer" created="Wed, 30 Jun 2010 10:25:09 +0000"  >&lt;p&gt;Not sure about the performance impact of this patch, but it should do the trick.&lt;/p&gt;</comment>
                            <comment id="12883877" author="hammer" created="Wed, 30 Jun 2010 10:28:39 +0000"  >&lt;p&gt;Bruce: if we don&apos;t import the module &lt;tt&gt;hashlib&lt;/tt&gt;, then the &lt;tt&gt;hashlib&lt;/tt&gt; name is undefined. If you subsequently say &lt;tt&gt;if hashlib&lt;/tt&gt;, you&apos;re going to throw a &lt;tt&gt;NameError&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="12883878" author="brucem" created="Wed, 30 Jun 2010 10:35:48 +0000"  >&lt;p&gt;Lame error on my part then ... Your fix for that part looks good.&lt;/p&gt;</comment>
                            <comment id="12883879" author="hammer" created="Wed, 30 Jun 2010 10:42:11 +0000"  >&lt;p&gt;Found another fun one: we use &lt;tt&gt;finally&lt;/tt&gt; in &lt;tt&gt;test_protocol.py&lt;/tt&gt; and &lt;tt&gt;test_schema.py&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="12883962" author="euphoria" created="Wed, 30 Jun 2010 16:10:39 +0000"  >&lt;p&gt;Not important, but wouldn&apos;t&lt;br/&gt;
{{&lt;br/&gt;
try: &lt;br/&gt;
   from hashlib import md5&lt;br/&gt;
except ImportError:&lt;br/&gt;
   from md5 import md5&lt;br/&gt;
}}&lt;br/&gt;
be simpler and preferable? or &quot;as compute_md5&quot; if you&apos;re stuck on that.&lt;/p&gt;</comment>
                            <comment id="12884014" author="hammer" created="Wed, 30 Jun 2010 18:34:08 +0000"  >&lt;p&gt;Michael: I&apos;ll check it out. The code currently calls &lt;tt&gt;hashlib.md5()&lt;/tt&gt; or &lt;tt&gt;md5.new()&lt;/tt&gt;, so your idea would not work as it currently stands, as the latter appears to use a factory.&lt;/p&gt;</comment>
                            <comment id="12884021" author="euphoria" created="Wed, 30 Jun 2010 18:47:10 +0000"  >&lt;p&gt;&lt;a href=&quot;http://docs.python.org/library/md5.html#md5.md5&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.python.org/library/md5.html#md5.md5&lt;/a&gt; md5.new and md5.md5 are the same thing.&lt;/p&gt;</comment>
                            <comment id="12884098" author="hammer" created="Wed, 30 Jun 2010 23:38:33 +0000"  >&lt;p&gt;Yep, that&apos;s what I wanted to confirm once I got in front of a computer. Your way is certainly cleaner, so I&apos;ll update the patch.&lt;/p&gt;</comment>
                            <comment id="12884992" author="hammer" created="Sun, 4 Jul 2010 02:53:13 +0000"  >&lt;p&gt;I&apos;ve addressed most of the issues (thanks for the comments!) but I&apos;m stuck on how to modify our use of the uuid module, which appeared in Python 2.5. I&apos;ve asked on Quora about the best way to generate RFC 4122-compliant UUIDs in Python 2.4: &lt;a href=&quot;http://www.quora.com/What&amp;#39;s-the-best-way-to-generate-RFC-4122-compliant-UUIDs-in-Python-2.4&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.quora.com/What&apos;s-the-best-way-to-generate-RFC-4122-compliant-UUIDs-in-Python-2.4&lt;/a&gt;. If you happen to know the answer, please let me know!&lt;/p&gt;</comment>
                            <comment id="12885165" author="hammer" created="Mon, 5 Jul 2010 10:12:21 +0000"  >&lt;p&gt;Okay, added uuid_24.py by taking the source from &lt;a href=&quot;http://svn.python.org/projects/python/trunk/Lib/uuid.py&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.python.org/projects/python/trunk/Lib/uuid.py&lt;/a&gt;. I need to figure out the right way to license it, but I&apos;d love it if someone else could take this patch for a spin on a Python 2.4 installation and see if it works for them.&lt;/p&gt;</comment>
                            <comment id="12887997" author="cutting" created="Tue, 13 Jul 2010 20:42:30 +0000"  >&lt;p&gt;The uuid code is under the PSF license:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.opensource.org/licenses/PythonSoftFoundation.php&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.opensource.org/licenses/PythonSoftFoundation.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This requires that we include a copyright statement and a copy of the license in our distributions.  HTTPD provides a good model.  Look at the end of:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://svn.apache.org/repos/asf/httpd/httpd/trunk/LICENSE&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/httpd/httpd/trunk/LICENSE&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So, in our LICENSE.txt file, we should add sections at the end for sub-components whose licenses differ, providing the relative path for each such subcomponent followed by its copyright and licence.  We already have one such appended license, but it should probably be amended to provide the path, and we should add an introductory paragraph for all sub-component licenses.  In short, we should model the structure of HTTPD&apos;s LICENSE.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12471967">AVRO-618</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12469288">AVRO-597</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12448634" name="AVRO-588-2.patch" size="9090" author="hammer" created="Sun, 4 Jul 2010 02:53:13 +0000"/>
                            <attachment id="12448680" name="AVRO-588-3.patch" size="31799" author="hammer" created="Mon, 5 Jul 2010 10:12:21 +0000"/>
                            <attachment id="12448389" name="AVRO-588.patch" size="5137" author="hammer" created="Wed, 30 Jun 2010 10:25:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 30 Jun 2010 10:18:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e18v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79964</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-589] ClassCastException: org.apache.avro.io.parsing.Symbol$Alternative cannot be cast to org.apache.avro.io.parsing.Symbol$UnionAdjustAction</title>
                <link>https://issues.apache.org/jira/browse/AVRO-589</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I&apos;ve got a complicated schema that when deserializing data gives me the following exception:&lt;/p&gt;

&lt;p&gt;java.lang.ClassCastException: org.apache.avro.io.parsing.Symbol$Alternative cannot be cast to org.apache.avro.io.parsing.Symbol$UnionAdjustAction&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.readIndex(ResolvingDecoder.java:188)&lt;br/&gt;
	at org.apache.avro.io.ParsingDecoder.skipTopSymbol(ParsingDecoder.java:66)&lt;br/&gt;
	at org.apache.avro.io.parsing.SkipParser.skipTo(SkipParser.java:71)&lt;br/&gt;
	at org.apache.avro.io.parsing.SkipParser.skipSymbol(SkipParser.java:93)&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.doAction(ResolvingDecoder.java:207)&lt;br/&gt;
	at org.apache.avro.io.parsing.Parser.processImplicitActions(Parser.java:116)&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.drain(ResolvingDecoder.java:141)&lt;br/&gt;
	at org.apache.avro.generic.GenericDatumReader.read(GenericDatumReader.java:72)&lt;br/&gt;
	at org.apache.avro.file.DataFileStream.next(DataFileStream.java:195)&lt;br/&gt;
	at org.apache.avro.file.DataFileStream.next(DataFileStream.java:182)&lt;/p&gt;


&lt;p&gt;If I go into  ResolvingDecoder.readIndex and modify the code to use an instanceof check, my data deserializes perfectly fine.&lt;/p&gt;

&lt;p&gt;I can send all files and unit tests needed to duplicate the error to whomever is working this ticket&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12468375">AVRO-589</key>
            <summary>ClassCastException: org.apache.avro.io.parsing.Symbol$Alternative cannot be cast to org.apache.avro.io.parsing.Symbol$UnionAdjustAction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="cjcdoomed">Christopher Cooper</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jul 2010 19:41:28 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:58 +0000</updated>
                            <resolved>Mon, 5 Jul 2010 03:18:31 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>1.3.0</version>
                    <version>1.3.1</version>
                    <version>1.3.2</version>
                    <version>1.3.3</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12884395" author="thiru_mg" created="Thu, 1 Jul 2010 20:09:56 +0000"  >&lt;p&gt;Hi Christopher Cooper,&lt;/p&gt;

&lt;p&gt;Thanks for reporting this bug. If it is okay to publicly share, please attach you test data, schemas and unit tests to this JIRA. Otherwise, please send them to my e-mail id.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Thiru&lt;/p&gt;</comment>
                            <comment id="12884647" author="thiru_mg" created="Fri, 2 Jul 2010 11:37:32 +0000"  >&lt;p&gt;Here is a patch that has:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A test that demonstrates the bug&lt;/li&gt;
	&lt;li&gt;The fix for the bug&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem was with union fields that are present in writer&apos;s schema but not in reader&apos;s schema. The ResolvingGrammerGenerator correctly generates a skip action for such fields. The skip action should have a UnionAdjustAction, but instead has a &quot;Alternate&quot; symbol. This is because we by mistake used to call the base super.generate(). The fix is to use an identity resolver for the union.&lt;/p&gt;</comment>
                            <comment id="12885001" author="scott_carey" created="Sun, 4 Jul 2010 05:23:35 +0000"  >&lt;p&gt;+1 this looks good to me.  The test looks good and demonstrates the issue.  The fix works.  &lt;/p&gt;</comment>
                            <comment id="12885096" author="thiru_mg" created="Mon, 5 Jul 2010 03:18:31 +0000"  >&lt;p&gt;Committed revision 960427.&lt;/p&gt;

&lt;p&gt;Thanks Scott for reviewing the patch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12448557" name="AVRO-589.patch" size="2593" author="thiru_mg" created="Fri, 2 Jul 2010 11:37:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Jul 2010 20:09:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94894</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e193:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79965</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-590] IDL: order specifications don&apos;t work</title>
                <link>https://issues.apache.org/jira/browse/AVRO-590</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The IDL compiler has a mechanism for specifying field ordering, but it doesn&apos;t work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12468379">AVRO-590</key>
            <summary>IDL: order specifications don&apos;t work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Jul 2010 20:20:50 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:58 +0000</updated>
                            <resolved>Mon, 23 Aug 2010 20:53:32 +0000</resolved>
                                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12884409" author="cutting" created="Thu, 1 Jul 2010 20:34:57 +0000"  >&lt;p&gt;Currently the IDL documentation suggests using something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@order(&lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; foo;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but this generates a field like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;order&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but order is not a property of the int type but rather of the foo field, so this should rather be:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;order&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One proposal is to change the syntax for order specification to use a keyword like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;decreasing &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; foo;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This would still permit @ to be used to specify attributes on the type, but not on the field.  Alternately we might change @ to modify field attributes rather than type attributes.  Or maybe the two could be distinguished by position relative to the type and field name, e.g.,&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@order(&lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; @java-class(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.math.BigInteger&quot;&lt;/span&gt;) foo;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;would specify one field and one type property, translating to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, 
  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;java-class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;java.math.BigInteger&quot;}, 
  &lt;span class=&quot;code-quote&quot;&gt;&quot;order&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="12900538" author="cutting" created="Fri, 20 Aug 2010 00:33:22 +0000"  >&lt;p&gt;The last proposal above seems best, to permit one to specify arbitrary properties for both the field and for it&apos;s type.  However I think I&apos;d reverse the order, so that properties near to the type would be for the type and properties near the field name would be for the field.  So the above example might become:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@java-class(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.math.BigInteger&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; foo @order(&lt;span class=&quot;code-quote&quot;&gt;&quot;decreasing&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12900870" author="cutting" created="Fri, 20 Aug 2010 21:41:59 +0000"  >&lt;p&gt;Here&apos;s a patch that fixes this.  Attributes modify what they precede.  If they precede a field type, then they modify it&apos;s schema, if they precede a field name, they modify the field itself.  Since ordering is an attribute of a field, order attributes must immediately precede the field name.&lt;/p&gt;

&lt;p&gt;Tests included, documentation updated.&lt;/p&gt;</comment>
                            <comment id="12901583" author="cutting" created="Mon, 23 Aug 2010 20:53:32 +0000"  >&lt;p&gt;I just committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12452670" name="AVRO-590.patch" size="4279" author="cutting" created="Fri, 20 Aug 2010 21:41:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94895</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e19b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-591] Regression in 1.3.3 from 1.3.2: Removing a field can result in a ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/AVRO-591</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Stored as:&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &quot;type&quot;:&quot;record&quot;,&lt;br/&gt;
  &quot;name&quot;:&quot;User&quot;,&lt;br/&gt;
  &quot;namespace&quot;:&quot;bagcheck&quot;,&lt;br/&gt;
  &quot;fields&quot;: [&lt;br/&gt;
    &lt;/p&gt;
{
      &quot;name&quot;:&quot;firstName&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;,&lt;br/&gt;
    &lt;/p&gt;
{
      &quot;name&quot;:&quot;lastName&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;,&lt;br/&gt;
    &lt;/p&gt;
{
      &quot;name&quot;:&quot;email&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;,&lt;/p&gt;
    {
      &quot;name&quot;:&quot;mobile&quot;,
      &quot;type&quot;:[&quot;string&quot;, &quot;null&quot;],
      &quot;default&quot;: &quot;null&quot;
    }     
&lt;p&gt;  ]&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Loaded as:&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &quot;type&quot;:&quot;record&quot;,&lt;br/&gt;
  &quot;name&quot;:&quot;User&quot;,&lt;br/&gt;
  &quot;namespace&quot;:&quot;bagcheck&quot;,&lt;br/&gt;
  &quot;fields&quot;: [&lt;br/&gt;
    &lt;/p&gt;
{
      &quot;name&quot;:&quot;firstName&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;,&lt;br/&gt;
    &lt;/p&gt;
{
      &quot;name&quot;:&quot;lastName&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;,&lt;/p&gt;
    {
      &quot;name&quot;:&quot;email&quot;,
      &quot;type&quot;:&quot;string&quot;,
      &quot;default&quot;: &quot;&quot;
    }
&lt;p&gt;  ]&lt;br/&gt;
}&lt;br/&gt;
java.lang.ClassCastException: org.apache.avro.io.parsing.Symbol$Alternative cannot be cast to org.apache.avro.io.parsing.Symbol$UnionAdjustAction&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.readIndex(ResolvingDecoder.java:188)&lt;br/&gt;
	at org.apache.avro.io.ParsingDecoder.skipTopSymbol(ParsingDecoder.java:66)&lt;br/&gt;
	at org.apache.avro.io.parsing.SkipParser.skipTo(SkipParser.java:71)&lt;br/&gt;
	at org.apache.avro.io.parsing.SkipParser.skipSymbol(SkipParser.java:93)&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.doAction(ResolvingDecoder.java:207)&lt;br/&gt;
	at org.apache.avro.io.parsing.Parser.processImplicitActions(Parser.java:116)&lt;br/&gt;
	at org.apache.avro.io.ResolvingDecoder.drain(ResolvingDecoder.java:141)&lt;br/&gt;
	at org.apache.avro.generic.GenericDatumReader.read(GenericDatumReader.java:72)&lt;br/&gt;
	at havrobase.HABTest.testSchemolution(HABTest.java:224)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)&lt;br/&gt;
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)&lt;br/&gt;
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)&lt;br/&gt;
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)&lt;br/&gt;
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)&lt;br/&gt;
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)&lt;br/&gt;
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)&lt;br/&gt;
	at org.junit.runners.ParentRunner.run(ParentRunner.java:236)&lt;br/&gt;
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)&lt;br/&gt;
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:64)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X 10.6, JDK 1.6_20&lt;/p&gt;</environment>
        <key id="12468596">AVRO-591</key>
            <summary>Regression in 1.3.3 from 1.3.2: Removing a field can result in a ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="thiru_mg">Thiruvalluvan M. G.</assignee>
                                    <reporter username="spullara">Sam Pullara</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jul 2010 00:42:08 +0000</created>
                <updated>Wed, 8 Sep 2010 21:07:58 +0000</updated>
                            <resolved>Tue, 6 Jul 2010 03:32:05 +0000</resolved>
                                    <version>1.3.3</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12885403" author="thiru_mg" created="Tue, 6 Jul 2010 03:32:05 +0000"  >&lt;p&gt;Thanks Sam for reporting this.&lt;/p&gt;

&lt;p&gt;The issue has been reported and fixed a few days back in JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-589&quot; title=&quot;ClassCastException: org.apache.avro.io.parsing.Symbol$Alternative cannot be cast to org.apache.avro.io.parsing.Symbol$UnionAdjustAction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-589&quot;&gt;&lt;del&gt;AVRO-589&lt;/del&gt;&lt;/a&gt;. Is it possible for you to try the latest from the trunk?&lt;/p&gt;</comment>
                            <comment id="12885408" author="spullara" created="Tue, 6 Jul 2010 03:51:57 +0000"  >&lt;p&gt;I did a search for classcastexception but didn&apos;t see it. Will try trunk. &lt;/p&gt;

&lt;p&gt;Sent from my iPhone 4&lt;/p&gt;



</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 6 Jul 2010 03:32:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94896</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e19j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79967</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-592] Pig to Avro translation -- Pig DatumReader/Writer</title>
                <link>https://issues.apache.org/jira/browse/AVRO-592</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;It would be great to use Avro to store Pig outputs.   Because Avro persists the schema as well, one can store data in one script, then load it in another and preserve the schema.&lt;/p&gt;

&lt;p&gt;Additionally, one can serialize pig Tuples to Avro and read Avro into pig Tuples.  Avro Schemas are significantly more rich than Pig schemas, but a limited translation is possible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12468657">AVRO-592</key>
            <summary>Pig to Avro translation -- Pig DatumReader/Writer</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jul 2010 18:09:12 +0000</created>
                <updated>Wed, 25 Aug 2010 19:31:01 +0000</updated>
                                                                            <component>java</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="12885642" author="scott_carey" created="Tue, 6 Jul 2010 19:07:30 +0000"  >&lt;p&gt;Previous discussion on the mailing list led me down several paths.&lt;/p&gt;

&lt;p&gt;What I have so far needs some work in a couple areas and needs more testing, but It is in a good state to share the core.&lt;/p&gt;

&lt;p&gt;Essentially, I wrote a DatumReader / DatumWriter pair for Pig.&lt;/p&gt;

&lt;p&gt;My first attempt was to mimic GenericDatumReader/Writer, but there were a lot of branches in the code that were going to cause a more work for me to complete good unit testing coverage.  Plus, I wanted to use this as a place to try out a DatumReader/Writer pair that did not require traversing the avro Schema for every tuple.  &lt;/p&gt;

&lt;p&gt;In some sense this is a prototype for a performance improvement to GenericDatumReader/Writer but Pig is simpler because there is no recursion or schema resolution.   I will have to learn the Parser better in order to leverage that to create something similar.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;SchemaTranslationDesign&quot;&gt;&lt;/a&gt;Schema Translation Design&lt;/h3&gt;
&lt;p&gt;The core classes where the tricky stuff happens are org.apache.avro.pig.PigDataAssembly and org.apache.avro.pig.SchemaTranslator.  &lt;/p&gt;

&lt;p&gt;PigDataAssembly takes an Avro schema that represents Pig data, and builds a data structure that can read / write Tuples to avro.  Its really just a linked list of Action objects (private inner classes) for each type that can exist in a Tuple &amp;#8211; if this was C they would be structs with a function pointer and some misc data.  But its Java so they&apos;re private inner classes that override a method from a supertype.&lt;br/&gt;
Once this data structure is created, it can efficiently read data from a Decoder or write to an Encoder without parsing the schema.     However this makes it stateful and like a ResolvingDecoder, the initialization is not that cheap (it is still fairly fast).&lt;/p&gt;

&lt;p&gt;SchemaTranslator is responsible for handling Pig Schemas (ResourceSchema) and converting these to Avro Schemas as well as validating that an Avro schema actually represents a Pig Tuple created by the same class.  The current restriction is that you can&apos;t read an arbitrary Avro record and make a Tuple out of it, even though the total number of possible Avro schemas that can be coerced into a Tuple is much larger than supported, I wanted to support that in a separate place.  This one is strict and constrained to reading and writing from pig &amp;#8211; although one can easily read data written by this with GenericDatumReader.&lt;br/&gt;
One of the primary goals was to be able to persist the Pig schema so that when the data was read by Pig, the loader would provide the same schema back that was stored originally.    To accomplish this the Schema translation makes a custom schema from the Pig schema, preserving field names and types.  The only exception is the value type of a Pig Map, which must be generic with no field names and is untyped from the POV of  a Pig schema.  There is a &quot;GENERIC_ELEMENT&quot; Schema that handles this, and corresponding Bag, and Tuple types to handle all types of map values.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;IntegrationwithHadoop%2FPig&quot;&gt;&lt;/a&gt;Integration with Hadoop / Pig&lt;/h3&gt;
&lt;p&gt;The next set of complexities are around Hadoop integration.  Pig 0.7+ requires using the org.apache.hadoop.mapreduce API, not the legacy mapred API.  So, I made org.apache.avro.mapreduce classes &amp;#8211; AvroInputFormat, AvroOutputFormat, and AvroRecordReader modeled mostly after the mapred ones.  However, these are limited to input and output &amp;#8211; not meant to be used for intermediate data between Map and Reduce.&lt;br/&gt;
Pig currently has several hoops you have to jump through to get a StoreFunc and LoadFunc to work correctly.  In particular, you can&apos;t easily read/write to the job configuration and only have a couple points of access to move information from the front-end to the back-end.&lt;br/&gt;
I think the right thing to do is to remove the org.apache.avro.mapreduce classes I have here and simply embed them in the only classes that use them: PigAvroInputFormat and PigAvroOutputFormat. That would significantly clean things up and prevent users from wondering which API to use for non-Pig mapreduce stuff.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;RoughEdges&quot;&gt;&lt;/a&gt;Rough Edges&lt;/h3&gt;
&lt;p&gt;The unit test I&apos;ve done hits the schema translation and serialization / deserialization well, but I have &lt;em&gt;not&lt;/em&gt; tested all of the Pig/Hadoop wrappers.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;OtherPotentialAvroChanges%2FAdditions&quot;&gt;&lt;/a&gt;Other Potential Avro Changes / Additions&lt;/h3&gt;
&lt;p&gt;DatumWriter/Reader are problematic here.  Because the PigDataAssembly is stateful, it would be best to force a DatumWriter or DatumReader to take a Schema and Encoder/Decoder on the constructor and disallow setting them later.  In particular, changing the Schema is expensive.&lt;br/&gt;
The fact that we need to construct a DatumReader before creating a DataFileReader means that the schema has to be set later.  Perhaps we can delay construction by passing around a Factory rather than an already constructed object?  Then we can delay creation of the DatumReader/Writer until later when both the Schema and Decoder/Encoder are available.&lt;/p&gt;

&lt;p&gt;As a more general concept, this is moving Schema resolution and Object serialization out as separate concerns from the Encoder / Decoder.  Right now, a DatumReader/Writer handles object serialization, but the Decoder/Encoder handles Schema resolution.  From a performance and code consolidation perspective, these two actions should be moved closer together &amp;#8211; they both require parsing Schemas and can be optimized together by doing:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;writer Schema&amp;#93;&lt;/span&gt; -&amp;gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Shared Assembly Construction configured for a type -- Generic, Specific, Pig, Hive, etc&amp;#93;&lt;/span&gt; -&amp;gt;&amp;gt; SerializationAssembly&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;reader Schema, actual Schema&amp;#93;&lt;/span&gt; -&amp;gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Shared Assembly Construction for a type&amp;#93;&lt;/span&gt; -&amp;gt;&amp;gt; SerializationAssembly&lt;br/&gt;
The shared assembly stuff could leverage the parser, but I&apos;m not knowledgeable enough with that to do that yet.&lt;/p&gt;</comment>
                            <comment id="12885705" author="scott_carey" created="Tue, 6 Jul 2010 21:48:41 +0000"  >&lt;p&gt;Incomplete Patch, work in progress!&lt;/p&gt;

&lt;p&gt;Missing:  I have to learn Ivy and make it pull the Pig dependencies.  You will need pig 0.7&apos;s jar file in your path to build this.  However, be warned that one of the pig jars has all of its dependencies inside of it &amp;#8211; including ALL of hadoop, including Jackson 1.0.1 which will break a build.&lt;/p&gt;

&lt;p&gt;To do:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Remove org.apache.avro.mapreduce and put that code into PigAvroOutputFormat and PigAvroInputFormat.&lt;/li&gt;
	&lt;li&gt;A pass of code comments, potential name changes and other clarifications.&lt;/li&gt;
	&lt;li&gt;Testing around the Hadoop related bits and AvroStorage class.&lt;/li&gt;
	&lt;li&gt;Concerns raised here by any review.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12888034" author="cutting" created="Tue, 13 Jul 2010 21:56:55 +0000"  >&lt;p&gt;&amp;gt; Missing: I have to learn Ivy and make it pull the Pig dependencies. &lt;/p&gt;

&lt;p&gt;Pig doesn&apos;t currently have any published Maven/Ivy artifacts so this will be tricky until that happens.  Cloudera may start publishing Maven artifacts for Pig soon, though.&lt;/p&gt;</comment>
                            <comment id="12899008" author="scott_carey" created="Mon, 16 Aug 2010 17:53:04 +0000"  >&lt;p&gt;Hopefully Pig will have their Maven story worked out for 0.8&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1334&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-1334&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Until then I&apos;ll keep working on this in jar-limbo.  I&apos;m not sure if this best goes in the Pig project or here from a user perspective, but I feel like the majority of the actual work is Avro related and best reviewed and understood by the comitters here.&lt;/p&gt;</comment>
                            <comment id="12902594" author="cutting" created="Wed, 25 Aug 2010 19:31:01 +0000"  >&lt;p&gt;This doesn&apos;t look like it&apos;s ready for 1.4.0, so I have unset its fix-version.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12448825" name="AVRO-592.patch" size="64560" author="scott_carey" created="Tue, 6 Jul 2010 21:48:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Jul 2010 21:56:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94897</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e19r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>79968</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
