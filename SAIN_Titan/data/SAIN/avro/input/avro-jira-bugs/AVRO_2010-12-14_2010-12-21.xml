<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:14:54 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2010-12-14+AND+created+%3C%3D+2010-12-21+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="5" total="5"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-712] define memcmp&apos;able encoding</title>
                <link>https://issues.apache.org/jira/browse/AVRO-712</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;It would be useful to have an encoding for Avro data that ordered data according to the Avro specification under memcmp.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12493360">AVRO-712</key>
            <summary>define memcmp&apos;able encoding</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Dec 2010 20:42:08 +0000</created>
                <updated>Thu, 13 Dec 2012 21:12:48 +0000</updated>
                                                                            <component>spec</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="12974410" author="awarring" created="Wed, 22 Dec 2010 21:57:56 +0000"  >&lt;p&gt;Here is a first stab at a definition. I&apos;ve written a prototype using these rules in python, and will attach it to this ticket. The spec I&apos;ve defined here is not nearly as efficient in both space and time to encode/decode as the binary encoding currently developed in Avro. It&apos;s support of features like the &quot;ignored&quot; and &quot;decreasing&quot; attributes on record fields is also lacking.&lt;/p&gt;

&lt;p&gt;Spec:&lt;/p&gt;

&lt;p&gt;int and long data is encoded by flipping the sign bit, and encoding as big endian.&lt;/p&gt;

&lt;p&gt;============================================&lt;/p&gt;

&lt;p&gt;float and double data is encoded by flipping the sign bit, and if it is a negative number, taking the compliment of all bits lower than the sign bit. Storing the 4 or 8 bytes as a big endian int or long.&lt;/p&gt;

&lt;p&gt;=============================================&lt;/p&gt;

&lt;p&gt;bytes: bytes should have a delimiter marking the end of the byte array. This value should be the lowest possible value, since the ordering of two byte arrays equal up to one&apos;s delimiter should always order the shorter one less than the longer one. If one were to encode a byte of value 0x00 as two bytes 0x00 0x01, and one were to encode end of byte array as 0x00 0x00, this property would hold true. Some examples:&lt;/p&gt;

&lt;p&gt;Alphabet 0-7&lt;br/&gt;
String1: 012020 -&amp;gt; 0112012100&lt;br/&gt;
String2: 01202 -&amp;gt; 011201200&lt;br/&gt;
String2 is less than String1&lt;/p&gt;

&lt;p&gt;String1: 012021 -&amp;gt; 0112012100&lt;br/&gt;
String2: 012020 -&amp;gt; 01120120100&lt;br/&gt;
String2 is less than String1&lt;/p&gt;

&lt;p&gt;============================&lt;/p&gt;

&lt;p&gt;strings: encoded as bytes defined above, ordering should hold&lt;/p&gt;

&lt;p&gt;============================&lt;/p&gt;

&lt;p&gt;boolean, null: encoded same as binary encoder&lt;/p&gt;

&lt;p&gt;============================&lt;/p&gt;

&lt;p&gt;maps: Not supported. Attempting to encode a map with a memcmp DatumWriter should throw an exception in my opinion.&lt;/p&gt;

&lt;p&gt;=============================&lt;/p&gt;

&lt;p&gt;enum: Encoded the same as DatumWriter using the memcmp encoder, since enums with lesser ordinals come before enums with greater ordinals.&lt;/p&gt;

&lt;p&gt;=============================&lt;/p&gt;

&lt;p&gt;arrays: I don&apos;t have a great answer here. One thing that would work, but isn&apos;t space efficient, is to write out a byte after every element in the array indicating whether it is the last element or not, where 0x00 indicates last element, and 0x01 indicates not. I&apos;ve done this in a prototype I&apos;ll attach to this ticket.&lt;/p&gt;

&lt;p&gt;=============================&lt;/p&gt;

&lt;p&gt;record: Before writing out the fields in a record, the fields should be ordered lexicographically by name. Ignored fields either shouldn&apos;t be written (makes the encoder lossy), or the encoder should throw an exception (something I&apos;ve done in a prototype). In the prototype I created, I also don&apos;t handle the &quot;decreasing&quot; field attribute, but this could be done by allowing the encoder to take an optional parameter specifying whether to encode the value in decreasing, which would invert all the bits before returning the encoded bytes.&lt;/p&gt;

&lt;p&gt;=============================&lt;/p&gt;

&lt;p&gt;union: Encoded the same way as a DatumWriter using a memcmp encoder would encode it currently, first writing out the ordinal of the union using the memcmp encoder, then using the encoder to encode the value.&lt;/p&gt;</comment>
                            <comment id="12974411" author="awarring" created="Wed, 22 Dec 2010 21:59:20 +0000"  >&lt;p&gt;Prototype demonstrating the spec I defined above&lt;/p&gt;</comment>
                            <comment id="12974691" author="scott_carey" created="Thu, 23 Dec 2010 18:45:38 +0000"  >&lt;p&gt;Ints/Longs can be variable length, with the same space cost as before: The first byte in the sequence has the sign bit first, inverted (0 for negative numbers, 1 for positive).  The second bit is the &apos;is last byte in varint&apos; bit &amp;#8211; 1 if there are more, 0 if it is the last byte.  The remaining encoding is like before &amp;#8211; zig-zag packed absolute value of the number.  However, if the number is negative we need to flip those bits as well as the &apos;is last byte in varint&apos; bits.  Both encoding and decoding are more expensive this way, but memcmp would work and the space used would be the same.&lt;/p&gt;

&lt;p&gt;Bytes/Strings/Arrays:&lt;br/&gt;
All are prefixed with a length in the current format.  you can&apos;t prefix with a length and get &quot;abc&quot; &amp;lt; &quot;abcd&quot; as well as &quot;abc&quot; &amp;lt; &quot;b&quot;.  Lexicographic ordering of variable length fields is hard.  We could use a similar tactic to the varints above for Bytes and store 7 bits per byte, with a trailing marker bit indicating the end of the sequence.  This takes more space, and is definitely more expensive to serialize/deserialize.&lt;/p&gt;

&lt;p&gt;I think UTF-8&apos;s binary properties might be beneficial here for Strings.  At least for each sequence of bytes that represents a character, it may already sort properly.  We just need a way to identify the end of the string.  I suppose trailing marker bytes or bits will work here too, with differing space/time tradeoffs.&lt;/p&gt;

&lt;p&gt;Arrays can&apos;t use the trailing marker bit, a trailing marker byte per element would work.&lt;/p&gt;

&lt;p&gt;Records:  I think if &quot;ignored&quot; fields were placed at the end, it would just work for sorting (equal fields would be adjacent) but an equivalence test would fail (one processes as &amp;gt; when they are equal).  &lt;/p&gt;



&lt;p&gt;Overall, I am not convinced such an encoding would have that much value.  The extra time/space cost of encoding and decoding in many use cases would outweigh the savings of sorting and comparison.   For some languages, the cost of doing the comparison on the current binary format is either not too great or could be optimized quite a bit further than they are now (C/C+&amp;#43;/Java).  More dynamic languages may benefit more from being able to call into an optimized memcmp routine since their conditional logic and method call overhead is greater.  For those languages, perhaps we should call out to an optimized Avro C or C+&amp;#43; stub for comparisons?  I wonder if we put our efforts into more optimized comparison, serialization, and deserialization if we would end up in a better place than adding a binary format.&lt;/p&gt;
</comment>
                            <comment id="12974700" author="awarring" created="Thu, 23 Dec 2010 19:15:06 +0000"  >&lt;p&gt;Scott Carey:&lt;/p&gt;

&lt;p&gt;I think some usefulness can come from the ability to use Avro entities with systems that use memcmp to sort binary data. For example, keys in an HBase table. One could create multi-component keys for an HBase table using Avro, and have guarantees about how their data is to be sorted. Say I&apos;m storing blog posts in HBase and want to group blog posts over time by domain within a table. I could create an avro schema:&lt;/p&gt;

&lt;p&gt;{ &quot;type&quot;: &quot;record&quot;,&lt;br/&gt;
  &quot;name&quot;: &quot;author_blog_key&quot;,&lt;br/&gt;
  &quot;fields&quot;: [&lt;br/&gt;
    &lt;/p&gt;
{ &quot;name&quot;: &quot;domain&quot;, &quot;type&quot;: &quot;string&quot; }
&lt;p&gt;,&lt;/p&gt;
    { &quot;name&quot;: &quot;timestamp&quot;: &quot;type&quot;: &quot;long&quot; }
&lt;p&gt;  ]}&lt;/p&gt;

&lt;p&gt;If the memcmp sort ordering could be guaranteed, I can used serialized instances of this within systems that deal with sorted data using memcmp.&lt;/p&gt;

&lt;p&gt;It&apos;s clear that the time/space costs are going to be negatively impacted with this type of encoding, especially dealing with bytes/strings/arrays. Your proposed encoding of Ints and Longs is clever, and I like the idea of putting ignored fields at the end of a record if equivalency isn&apos;t required (which in many cases it isn&apos;t).&lt;/p&gt;</comment>
                            <comment id="12975662" author="cutting" created="Tue, 28 Dec 2010 22:31:53 +0000"  >&lt;p&gt;Scott&amp;gt; Overall, I am not convinced such an encoding would have that much value.&lt;/p&gt;

&lt;p&gt;A use case is systems that don&apos;t permit extensible, user-specified comparators.  Does HBase?&lt;/p&gt;
</comment>
                            <comment id="13530640" author="tlipcon" created="Thu, 13 Dec 2012 03:32:29 +0000"  >&lt;p&gt;Has there been nay further work on this area in the last 2 years?&lt;/p&gt;

&lt;p&gt;Another use case I have is to be able to put avro-encoded data in map data structures that are not item-comparison-based. For example, a trie structure (eg burst trie, Judy tree, or mass tree) relies on simple bytewise comparison and can be significantly more efficient than a comparison-based tree structure like a red-black tree.&lt;/p&gt;

&lt;p&gt;There are also string sort algorithms which are significantly more efficient than comparison sort algorithms, many based on the above structures (eg Alphasort, burst sort)&lt;/p&gt;</comment>
                            <comment id="13531518" author="scott_carey" created="Thu, 13 Dec 2012 21:12:48 +0000"  >&lt;p&gt;I don&apos;t believe there has been any work on this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12466840" name="memcmp_encoding_prototype.py" size="14320" author="awarring" created="Wed, 22 Dec 2010 21:59:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Dec 2010 21:57:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 6 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e20f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80088</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-713] GenericRecord.toString can produce invalid JSON</title>
                <link>https://issues.apache.org/jira/browse/AVRO-713</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The GenericData.toString method can produce invalid JSON. The problem is that enums are printed without quotes, as in&lt;/p&gt;
{&quot;emum_field&quot;:a}
&lt;p&gt;instead of &lt;/p&gt;
{&quot;enum_field&quot;:&quot;a&quot;}

</description>
                <environment></environment>
        <key id="12493367">AVRO-713</key>
            <summary>GenericRecord.toString can produce invalid JSON</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jkreps">Jay Kreps</assignee>
                                    <reporter username="jkreps">Jay Kreps</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Dec 2010 21:54:54 +0000</created>
                <updated>Fri, 9 Nov 2012 15:59:19 +0000</updated>
                            <resolved>Thu, 16 Dec 2010 21:57:59 +0000</resolved>
                                    <version>1.4.1</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12972138" author="jkreps" created="Thu, 16 Dec 2010 16:39:45 +0000"  >&lt;p&gt;Here is a patch that fixes the enum issue. It also includes proper escaping of JSON strings (i.e. so if the string contains a quote the json string isn&apos;t prematurely terminated. The escaping code is adapted from &lt;a href=&quot;http://code.google.com/p/json-simple/source/browse/trunk/src/org/json/simple/JSONValue.java#227&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://code.google.com/p/json-simple/source/browse/trunk/src/org/json/simple/JSONValue.java#227&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Copying the escaping code to write directly to the StringBuilder seems better than using Jackson, since I think with Jackson we would have to instantiate a bunch of objects and double-copy the string.&lt;/p&gt;</comment>
                            <comment id="12972231" author="cutting" created="Thu, 16 Dec 2010 21:57:59 +0000"  >&lt;p&gt;I committed this.  Thanks, Jay!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12615503">AVRO-1201</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12466391" name="avro-tostring-json-fix.diff" size="4241" author="jkreps" created="Thu, 16 Dec 2010 16:39:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Dec 2010 21:57:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4183</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 6 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e20n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80089</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-714] New Java build: Documentation</title>
                <link>https://issues.apache.org/jira/browse/AVRO-714</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-647&quot; title=&quot;Break avro.jar into avro.jar, avro-dev.jar and avro-hadoop.jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-647&quot;&gt;&lt;del&gt;AVRO-647&lt;/del&gt;&lt;/a&gt; changed the Java build significantly.&lt;/p&gt;

&lt;p&gt;We need the following documentation:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Java: how to build, how to test, maven tips, links to more information&lt;/li&gt;
	&lt;li&gt;How to release using Maven&lt;/li&gt;
	&lt;li&gt;About the Java artifacts and their dependencies.&lt;/li&gt;
	&lt;li&gt;How to add a new java artifact&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12493479">AVRO-714</key>
            <summary>New Java build: Documentation</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Dec 2010 01:14:07 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:53 +0000</updated>
                            <resolved>Fri, 28 Jan 2011 05:30:56 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>doc</component>
                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12985247" author="scott_carey" created="Sun, 23 Jan 2011 04:51:28 +0000"  >&lt;p&gt;I have made this page on the Wiki:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/AVRO/Build+Documentation&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/AVRO/Build+Documentation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and also modified:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/AVRO/How+To+Contribute&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/AVRO/How+To+Contribute&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12987947" author="scott_carey" created="Fri, 28 Jan 2011 05:30:56 +0000"  >&lt;p&gt;Enough is done for 1.5.0.  Primary changes are documented.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12472990">AVRO-647</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4204</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e20v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80090</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-715] New Java build: refactor tests to use shared method for identifying temp file location</title>
                <link>https://issues.apache.org/jira/browse/AVRO-715</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Many tests individually write temp files based on relative paths, &apos;/tmp&apos;, or reading from a system property.  These need to be refactored into one utility for handling the location of temp files for unit tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12493480">AVRO-715</key>
            <summary>New Java build: refactor tests to use shared method for identifying temp file location</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Dec 2010 01:17:30 +0000</created>
                <updated>Mon, 7 Feb 2011 18:40:53 +0000</updated>
                                                                            <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12972617" author="cutting" created="Fri, 17 Dec 2010 19:44:49 +0000"  >&lt;p&gt;Note taht with &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1050474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1050474&lt;/a&gt; this is not critical for 1.5.0 but would still be an improvement.&lt;/p&gt;</comment>
                            <comment id="12972661" author="scott_carey" created="Fri, 17 Dec 2010 21:57:50 +0000"  >&lt;p&gt;Also, if the temp directory is just target/ it is a little dangerous &amp;#8211; we might collide with other build output unexpectedly.  If we change it to target/test it currently breaks because we don&apos;t create the directory when it doesn&apos;t exist, and it won&apos;t after &apos;clean&apos;.&lt;/p&gt;</comment>
                            <comment id="12972674" author="cutting" created="Fri, 17 Dec 2010 22:25:31 +0000"  >&lt;p&gt;I agree, target/test would be better.  We could try to get Maven to create that directory or we could change the tests to create it.&lt;/p&gt;</comment>
                            <comment id="12981897" author="scott_carey" created="Fri, 14 Jan 2011 19:43:30 +0000"  >&lt;p&gt;minor, does not block 1.5.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Dec 2010 19:44:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>94970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 2 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e213:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80091</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-716] New Java build: integrate with parent build and remove cruft</title>
                <link>https://issues.apache.org/jira/browse/AVRO-716</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;We have legacy ant and ivy items in lang/java that need to be removed or reduced.   &lt;/p&gt;

&lt;p&gt;&apos;ant clean&apos; &apos;and compile&apos; and &apos;ant test&apos; can simply forward to maven, we might still want to have ant drive interop tests, and it is useful to have ant around as a tool.&lt;/p&gt;

&lt;p&gt;Additionally, buildbot currently fails and build.sh from the top level does not properly build Java.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12493481">AVRO-716</key>
            <summary>New Java build: integrate with parent build and remove cruft</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Dec 2010 01:20:33 +0000</created>
                <updated>Sat, 12 Mar 2011 00:32:50 +0000</updated>
                            <resolved>Tue, 1 Feb 2011 19:25:30 +0000</resolved>
                                                    <fixVersion>1.5.0</fixVersion>
                                    <component>build</component>
                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12977512" author="cutting" created="Tue, 4 Jan 2011 22:45:51 +0000"  >&lt;p&gt;We also need to get &quot;rat&quot; to run on the content of the source tarball.  This is currently done by Java&apos;s build.xml.  We could leave that there.&lt;/p&gt;

&lt;p&gt;As you indicate above, we might also keep driving the interop tests with Ant.  The complication I see is building an appropriate classpath that includes the dependencies.  Any ideas of how to do that?  Should we have Ivy read the pom files and download the jars?  Is there a way to get Maven to put all the dependencies in a directory?&lt;/p&gt;</comment>
                            <comment id="12977534" author="kkrugler" created="Tue, 4 Jan 2011 23:44:21 +0000"  >&lt;p&gt;If you&apos;re trying to use Ant, but specify dependencies via a pom file, then yes it&apos;s possible - that&apos;s what we do in the Bixo project. You need the maven-ant-tasks jar (we use version 2.0.10), which could be auto-downloaded if you wanted to have no lib directory in the project. Then there&apos;s a somewhat funky target that needs to be added to the build.xml, after that it&apos;s straightforward. See the mvn-init target in &lt;a href=&quot;https://github.com/bixo/bixo/blob/master/build.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/bixo/bixo/blob/master/build.xml&lt;/a&gt; for an example.&lt;/p&gt;</comment>
                            <comment id="12977634" author="scott_carey" created="Wed, 5 Jan 2011 05:48:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;We also need to get &quot;rat&quot; to run on the content of the source tarball. This is currently done by Java&apos;s build.xml. We could leave that there. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That is probably the easiest thing to do, unless maven&apos;s RAT plugin works with the exclusion list easily.  I got it working quickly on the Java tree, but it complains about a few things that need to be excluded.  Does the current java ant task run RAT for all languages?  If so, it should remain an ant task since Maven won&apos;t run RAT outside of its directory tree.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;As you indicate above, we might also keep driving the interop tests with Ant. The complication I see is building an appropriate classpath that includes the dependencies. Any ideas of how to do that? Should we have Ivy read the pom files and download the jars? Is there a way to get Maven to put all the dependencies in a directory?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could, but it might be easier to use the Maven facilities for this.  It is easy to have it copy all the dependent jars in one place.  Or, we can use the &apos;failsafe&apos; plugin to run the interop tests as integration tests.    Or, configure a profile with them as a separate set of Unit tests with surefire and activate that profile from the command line after the build  &quot;mvn test -P interop&quot;.   I am planning on working on this ticket early next week, along with the other main tasks to complete the maven migration.&lt;/p&gt;</comment>
                            <comment id="12977843" author="cutting" created="Wed, 5 Jan 2011 16:58:32 +0000"  >&lt;p&gt;&amp;gt; Does the current java ant task run RAT for all languages?&lt;/p&gt;

&lt;p&gt;Yes.  It is run on the full source tree by the top-level &apos;dist&apos; target before building the source tarball.  It only lives in Java&apos;s build.xml for historic reasons, and because it shared some logic (ivy stuff mostly) with Java-specific targets.  If it&apos;s the only target remaining then it should probably move to the top-level.&lt;/p&gt;

&lt;p&gt;&amp;gt;  I am planning on working on this ticket early next week [ ... ]&lt;/p&gt;

&lt;p&gt;Great!  Thanks!&lt;/p&gt;</comment>
                            <comment id="12981905" author="scott_carey" created="Fri, 14 Jan 2011 20:00:44 +0000"  >&lt;p&gt;Additionally we need to build -javadoc and -source jars.  That should be easy.&lt;/p&gt;</comment>
                            <comment id="12981989" author="scott_carey" created="Sat, 15 Jan 2011 00:37:28 +0000"  >&lt;p&gt;The Interop tests use RandomData in order to generate binary data for testing.&lt;/p&gt;

&lt;p&gt;This is used in a few places and we already have two copies of the class.  I think it makes sense to move this from the test tree to o.a.a.util and have a public API for it.  We can then make a Tool and use avro-tools.jar to create the interop data.   Generating random data with the command line tool has many other uses too.&lt;/p&gt;

&lt;p&gt;Does that sound reasonable?  If we do this, I  think it makes sense to put the Tool portion into a different ticket since it will need its own section in CHANGES.txt.&lt;/p&gt;
</comment>
                            <comment id="12982796" author="cutting" created="Mon, 17 Jan 2011 18:52:40 +0000"  >&lt;p&gt;I&apos;m fine adding RandomData as a utility class, especially if a we base a command-line tool on it.  That said, is there no way with Maven to share test utilities between modules without adding them to the primary public artifacts?&lt;/p&gt;</comment>
                            <comment id="12982803" author="scott_carey" created="Mon, 17 Jan 2011 19:12:36 +0000"  >&lt;p&gt;There is a way to share test utilities.  We just create a -tests artifact that downstream artifacts can declare in test scope.&lt;/p&gt;

&lt;p&gt;Example: &lt;a href=&quot;http://www.waltercedric.com/java-j2ee-mainmenu-53/361-maven-build-system/1349-maven-reusing-test-classes-across-multi-modules-projects.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.waltercedric.com/java-j2ee-mainmenu-53/361-maven-build-system/1349-maven-reusing-test-classes-across-multi-modules-projects.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Making this a tool however makes it easier to do the interop tests by simply using the tool in avro-tools.jar to generate the data.   I suppose calling a main method on RandomData from avro-1.5.0-tests.jar would be easy as well.&lt;/p&gt;</comment>
                            <comment id="12983286" author="scott_carey" created="Tue, 18 Jan 2011 17:46:19 +0000"  >&lt;p&gt;this patch addressed remaining build integration:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In lang/java/ it changes the pom.xml files to have a &apos;release&apos; profile for building javadoc and source jars.  To build these, add the command line argument &apos;-P release&apos; to a maven command that completes at least the &apos;package&apos; build phase.&lt;/li&gt;
	&lt;li&gt;In lang/java/ it adds an &apos;interop-data-test&apos; profile that changes the behavior or &apos;mvn test&apos; to execute only the interop data tests.&lt;/li&gt;
	&lt;li&gt;Moves the interop test out from an inner class to its own class.&lt;/li&gt;
	&lt;li&gt;Creates a jar artifact from the &apos;core&apos; project tests for use by downstream projects to avoid duplicating RandomData and AvroTestUtil.&lt;/li&gt;
	&lt;li&gt;Adds a couple missing apache license headers.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Enables RAT on the top level.  This is done by using maven to call the RAT ant task.  An associated pom.xml is now at the root of the project.  This was easier than using ant + ivy to fetch dependencies; the pom.xml is small.  The maven-rat-plugin did not seem to like to use the exclude file and had some configuration bugs.&lt;/li&gt;
	&lt;li&gt;share/rat-excludes.txt needed some minor changes.  I think we might be able to configure RAT to accept the many MIT licenses that cause it to fail rather than excluding them later, but I did not try and figure that out.&lt;/li&gt;
	&lt;li&gt;Modified build.sh and share/test/interop/bin/test_rpc_interop.sh for the above features.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Notes:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;TestFileSpanStorage was failing for me about 2/3 of the time, I modified one of its sleep calls to be 200ms instead of 100ms so that it passes consistently.  This test needs an overhaul later &amp;#8211; it should not sleep at all but instead wait for signals.  Sleeps in unit tests usually indicate that the API of the things being tested are not complete and need methods to await asynchronous completion of tasks.&lt;/li&gt;
	&lt;li&gt;build.sh uses the bash subscript style extensively.  This breaks the &apos;-e&apos; fail-on-error policy with bash 3.x  For example:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;set -e; echo start; (exit 1); echo never;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;prints both &apos;start&apos; and &apos;never&apos; for me. On bash 4.x it would not print &apos;never&apos;.   Essentially, the error result of the subscript does not trigger the -e handling for all users.  We might have to change it to avoid subshells or manually check $? after each one.   I did not address that here, but several commands I modified are not in a subscript.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12983914" author="cutting" created="Wed, 19 Jan 2011 22:41:08 +0000"  >&lt;p&gt;Looks great, Scott!&lt;/p&gt;

&lt;p&gt;A few things I noticed:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;perhaps we should create a lang/java/build.sh that contains the logic for each of the top-level targets, so that the top-level just has something simple like &apos;(cd lang/java; ./build.sh dist)&apos;?&lt;/li&gt;
	&lt;li&gt;i just realized that all of the pom.xml files have the version (1.5.0-SNAPSHOT) duplicated.  prior to the switch to maven, the Avro version was only in a single place, share/VERSION.txt at the top-level.  perhaps lang/java/build.sh could invoke &apos;mvn -Davro.version=`cat ../../share/VERSION.txt`&apos;, and the pom.xml files could be changed to refer to $avro.version?  that would mean that running &apos;mvn&apos; from the command line might not work though.  or maybe we could use the maven properties plugin to have all of the poms read from a common properties file that&apos;s generated from share/VERSION.txt...&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12983922" author="scott_carey" created="Wed, 19 Jan 2011 22:56:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;perhaps we should create a lang/java/build.sh&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good idea.  I might be able to avoid the subshell too (and thus, let &apos;-e&apos; work).&lt;/p&gt;

&lt;p&gt;on POM versions:&lt;/p&gt;

&lt;p&gt;The maven-release-plugin can be used to change the version in the poms during release.   I believe it would be something like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mvn -B release:update-versions -DautoVersionSubmodules=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -DdevelopmentVersion=`cat ../../share/VERSION.txt`
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To change the versions to 1.5.0.  Or, without the -B command it will prompt for the version interactively.&lt;/p&gt;

&lt;p&gt;I&apos;ll look into what the maven-properties-plugin can do.  That might be simpler &amp;#8211; most of the maven tools assume that that the whole build is within maven.  And we&apos;re never realistically going to have the same build system across 5+ languages.&lt;/p&gt;</comment>
                            <comment id="12985231" author="scott_carey" created="Sun, 23 Jan 2011 02:22:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-716&quot; title=&quot;New Java build: integrate with parent build and remove cruft&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-716&quot;&gt;&lt;del&gt;AVRO-716&lt;/del&gt;&lt;/a&gt;.v2.patch&lt;/p&gt;

&lt;p&gt;Ties new java build in with parent build.   Several improvements over the last version.  Interop tests function correctly now as well.&lt;/p&gt;

&lt;p&gt;Also removes ivy and ant related files from lang/java and removes lang/java/lib.  &lt;/p&gt;

&lt;p&gt;There were some licence files in lang/java/lib but they were all out of date, and we don&apos;t have any jars checked into svn.  I don&apos;t think we need these.&lt;/p&gt;

&lt;p&gt;The top level build uses the maven-enforcer-plugin during  &lt;em&gt;./build.sh dist&lt;/em&gt; to enforce that the versions of the artifacts match share/VERSION.txt.  The &lt;em&gt;dist&lt;/em&gt; target will fail if they do not. During a branch or tag process, we can use the maven-versions-plugin to change all the version numbers at the same time that we change VERSION.txt.&lt;/p&gt;
</comment>
                            <comment id="12986229" author="scott_carey" created="Tue, 25 Jan 2011 05:31:35 +0000"  >&lt;p&gt;Updated patch using --no-diff-deleted to reduce its size.  No other difference from the prior patch.&lt;/p&gt;

&lt;p&gt;Patch applies to a clean checkout fine, and &apos;build.sh clean test dist&apos;  works.&lt;/p&gt;
</comment>
                            <comment id="12986557" author="cutting" created="Tue, 25 Jan 2011 18:04:17 +0000"  >&lt;p&gt;&apos;build.sh dist&apos; is failing for me with:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal on project avro-compiler: Could not resolve dependencies for project org.apache.avro:avro-compiler:jar:1.5.0-SNAPSHOT: Could not find artifact org.apache.avro:avro:jar:1.5.0-SNAPSHOT in jboss-public-repository (&lt;a href=&quot;http://repository.jboss.org/nexus/content/groups/public/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://repository.jboss.org/nexus/content/groups/public/&lt;/a&gt;) -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;This works if I first run &apos;cd lang/java; mvn install&apos;.  Is there a way to not require this?  I prefer not to have a snapshot installed locally.&lt;/p&gt;</comment>
                            <comment id="12986595" author="scott_carey" created="Tue, 25 Jan 2011 18:47:08 +0000"  >&lt;p&gt;I&apos;ll run through test cases where I blow away my local repo and run each target individually.   &lt;/p&gt;

&lt;p&gt;I don&apos;t know if there is a way to avoid installing to the local repo.  I hadn&apos;t considered that since we&apos;re only a couple MB.&lt;/p&gt;</comment>
                            <comment id="12986613" author="cutting" created="Tue, 25 Jan 2011 19:06:08 +0000"  >&lt;p&gt;I dislike installing to the local repo unless I&apos;m developing one project against an unreleased version of another.  I worry that as I&apos;m working on different issues within a single project that things will get confused when the common local repo is used.  Should I just get over it?&lt;/p&gt;</comment>
                            <comment id="12986626" author="scott_carey" created="Tue, 25 Jan 2011 19:25:02 +0000"  >&lt;p&gt;That can be an issue.  Generally it is not.&lt;/p&gt;

&lt;p&gt;For example &amp;#8211; if you have (like me)&lt;br/&gt;
src/avro-716/trunk&lt;br/&gt;
src/avro-737/trunk&lt;br/&gt;
src/avro-perf/trunk&lt;/p&gt;

&lt;p&gt;and are using all three at the same time, you might mix/match things.  There are a few solutions: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;build from the top level &amp;#8211; it only uses snapshots in your if the code required is not in the &apos;reactor&apos; of the build.   Note, this may be less reliable (buggy) for the avro-maven-plugin.  I&apos;ve seen it use the local repo over the reactor for the plugin once or twice, but more inside of the m2eclipse plugin than command line.&lt;/li&gt;
	&lt;li&gt;use &apos;install&apos; more regularly &amp;#8211; if your work is interleaved, this should work fine.&lt;/li&gt;
	&lt;li&gt;change your version locally with mvn versions:set to create distinct artifacts.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;I&apos;ll explore this a little more to see what parts of our build are sensitive to the repo and what parts aren&apos;t.  There are a couple places where we call directly to a sub-project instead of the parent, which will trigger dependency on the local repo over the reactor.   The build will be a little slower if we use the top level instead, but probably more stable.&lt;/p&gt;
</comment>
                            <comment id="12988527" author="scott_carey" created="Sun, 30 Jan 2011 01:31:14 +0000"  >&lt;p&gt;Updated patch and script.&lt;/p&gt;

&lt;p&gt;Run the patch before the script.&lt;/p&gt;

&lt;p&gt;Changes:&lt;br/&gt;
./build.sh clean test dist&lt;/p&gt;

&lt;p&gt;does not use the local repo to publish artifacts at any time.  Script includes deletion of old build items and change in svn:ignore.&lt;/p&gt;


&lt;p&gt;With a change like this, do we need to modify CHANGES.txt?  Or is the comment from the parent &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-647&quot; title=&quot;Break avro.jar into avro.jar, avro-dev.jar and avro-hadoop.jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-647&quot;&gt;&lt;del&gt;AVRO-647&lt;/del&gt;&lt;/a&gt; sufficient?  The most we can say is &quot;Java: integrate &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-647&quot; title=&quot;Break avro.jar into avro.jar, avro-dev.jar and avro-hadoop.jar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-647&quot;&gt;&lt;del&gt;AVRO-647&lt;/del&gt;&lt;/a&gt; changes with top level build&quot;.&lt;/p&gt;
</comment>
                            <comment id="12989337" author="cutting" created="Tue, 1 Feb 2011 19:08:28 +0000"  >&lt;p&gt;+1 This looks good to me.  I think adding the one-line message you propose to CHANGES.txt would be good.&lt;/p&gt;</comment>
                            <comment id="12989344" author="scott_carey" created="Tue, 1 Feb 2011 19:25:30 +0000"  >&lt;p&gt;Committed in revision 1066155.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12468662" name="AVRO-716.v1.patch" size="28490" author="scott_carey" created="Tue, 18 Jan 2011 17:46:19 +0000"/>
                            <attachment id="12469058" name="AVRO-716.v2.patch" size="112567" author="scott_carey" created="Sun, 23 Jan 2011 02:14:27 +0000"/>
                            <attachment id="12469241" name="AVRO-716.v3.patch" size="30870" author="scott_carey" created="Tue, 25 Jan 2011 05:31:35 +0000"/>
                            <attachment id="12469760" name="AVRO-716.v4.patch" size="32756" author="scott_carey" created="Sun, 30 Jan 2011 01:31:14 +0000"/>
                            <attachment id="12469759" name="mod_build.v4.sh" size="304" author="scott_carey" created="Sun, 30 Jan 2011 01:31:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 4 Jan 2011 22:45:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4140</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 51 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e21b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80092</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
