<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:25:51 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2017-11-21+AND+created+%3C%3D+2017-11-28+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="1" total="1"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-2107] Unable to deserialize JSON with array type to GenericRecord</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2107</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;I am trying to deserialise the json with array type into GenericRecord and I get the following exception:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.avro.AvroTypeException: Unknown union branch sampleArrayRecordString
	at org.apache.avro.io.JsonDecoder.readIndex(JsonDecoder.java:445)
	at org.apache.avro.io.ResolvingDecoder.doAction(ResolvingDecoder.java:290)
	at org.apache.avro.io.parsing.Parser.advance(Parser.java:88)
	at org.apache.avro.io.ResolvingDecoder.readIndex(ResolvingDecoder.java:267)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readWithoutConversion(GenericDatumReader.java:179)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readArray(GenericDatumReader.java:266)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readWithoutConversion(GenericDatumReader.java:177)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:153)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readField(GenericDatumReader.java:232)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readRecord(GenericDatumReader.java:222)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readWithoutConversion(GenericDatumReader.java:175)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:153)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readWithoutConversion(GenericDatumReader.java:179)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:153)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readField(GenericDatumReader.java:232)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readRecord(GenericDatumReader.java:222)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.readWithoutConversion(GenericDatumReader.java:175)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:153)
	at org.apache.avro.&lt;span class=&quot;code-keyword&quot;&gt;generic&lt;/span&gt;.GenericDatumReader.read(GenericDatumReader.java:145)
	at a.b.c.d.Test2.main(Test2.java:19)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Below is the code:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Schema schema = Schema.parse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(
		&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;schema_file_path&amp;gt;&quot;&lt;/span&gt;));
&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] payload = Files.readAllBytes(Paths.get(
		&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;json_file_path&amp;gt;&quot;&lt;/span&gt;));

GenericRecord record = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericDatumReader&amp;lt;GenericRecord&amp;gt;(schema).read(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;,
		DecoderFactory.get().jsonDecoder(schema, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(payload)));

&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(record);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13120448">AVRO-2107</key>
            <summary>Unable to deserialize JSON with array type to GenericRecord</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10004">Not A Bug</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="darshanmehta2">Darshan Mehta</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Nov 2017 11:25:03 +0000</created>
                <updated>Thu, 7 Dec 2017 15:25:48 +0000</updated>
                            <resolved>Thu, 7 Dec 2017 15:25:48 +0000</resolved>
                                    <version>1.8.1</version>
                    <version>1.8.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="16264206" author="darshanmehta2" created="Thu, 23 Nov 2017 11:25:34 +0000"  >&lt;p&gt;Attached Schema and sample json files.&lt;/p&gt;</comment>
                            <comment id="16281999" author="nkollar" created="Thu, 7 Dec 2017 15:24:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=darshanmehta2&quot; class=&quot;user-hover&quot; rel=&quot;darshanmehta2&quot;&gt;Darshan Mehta&lt;/a&gt; I think the problem is that the type of sampleArray in your schema is &lt;a href=&quot;http://avro.apache.org/docs/current/spec.html#Unions&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;union&lt;/a&gt;, with only one brach. If you&apos;d like store a union of different elements (like string or a record type), then sampleArray in your JSON data should look like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
			&lt;span class=&quot;code-quote&quot;&gt;&quot;sampleArray&quot;&lt;/span&gt;: [
				{
					&lt;span class=&quot;code-quote&quot;&gt;&quot;a.b.sampleArrayRecord&quot;&lt;/span&gt;: {
						&lt;span class=&quot;code-quote&quot;&gt;&quot;sampleArrayRecordString&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;KLMNO&quot;&lt;/span&gt;
					}
				}
			]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I guess your intention is not this though, you&apos;d like to store just records of a certain type in the array, and nothing else. In this case you shouldn&apos;t make elements of the array union, simply drop &quot;[&quot; and &quot;]&quot; near &quot;items&quot;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;sampleArray&quot;&lt;/span&gt;,
                     &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:{
                       &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;array&quot;&lt;/span&gt;,
                       &lt;span class=&quot;code-quote&quot;&gt;&quot;items&quot;&lt;/span&gt;:
                     	{
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;sampleArrayRecord&quot;&lt;/span&gt;,
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;:[
                     		{
                     		  &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;sampleArrayRecordString&quot;&lt;/span&gt;,
                     		  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,
                     		  &lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Sample array record string&quot;&lt;/span&gt;,
                     		  &lt;span class=&quot;code-quote&quot;&gt;&quot;omdFieldSecurity&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;internal&quot;&lt;/span&gt;,
                     		  &lt;span class=&quot;code-quote&quot;&gt;&quot;omdLogicalDataType&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;
                     		}
                     	  ],
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;doc&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Sample array record&quot;&lt;/span&gt;,
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;omdFileSecurity&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;internal&quot;&lt;/span&gt;,
                     	  &lt;span class=&quot;code-quote&quot;&gt;&quot;omdRepositoryTag&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1.4.0&quot;&lt;/span&gt;
                     	}
                     },
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12899049" name="sample.json" size="114" author="darshanmehta2" created="Thu, 23 Nov 2017 11:25:23 +0000"/>
                            <attachment id="12899048" name="test-schema.avsc" size="1550" author="darshanmehta2" created="Thu, 23 Nov 2017 11:25:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Dec 2017 15:24:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3n4x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
