<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:23:44 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2016-7-20+AND+created+%3C%3D+2016-7-27+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="3" total="3"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1887] set up precommit checks via Apache Yetus</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1887</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The lack of automated checks for things like doing a full build is negatively impacting my ability to do timely reviews. We should leverage the work done by other communities and get precommit checks going with Apache Yetus (&lt;a href=&quot;http://yetus.apache.org/documentation/0.3.0/precommit-basic/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;ref Apache Yetus Precommit&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Yetus has built in support for using Docker as a containerized build environment (&lt;a href=&quot;https://yetus.apache.org/documentation/0.3.0/precommit-advanced/#Docker_Support&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;ref docs&lt;/a&gt;), but I don&apos;t know if we can use the one we have directly or if we&apos;ll need to do some refactoring.&lt;/p&gt;

&lt;p&gt;Implementing this will ultimately require a committer (so that they can make changes to builds.apache.org), but a non-cmmitter can get the bulk of the work done by managing to do local yetus checks with the docker feature active.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12991507">AVRO-1887</key>
            <summary>set up precommit checks via Apache Yetus</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Fokko">Fokko Driesprong</assignee>
                                    <reporter username="busbey">Sean Busbey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Jul 2016 15:41:00 +0000</created>
                <updated>Wed, 7 Nov 2018 14:45:16 +0000</updated>
                            <resolved>Wed, 7 Nov 2018 12:53:15 +0000</resolved>
                                                    <fixVersion>1.9.0</fixVersion>
                                    <component>build</component>
                    <component>community</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="15563681" author="sacharya" created="Mon, 10 Oct 2016 22:05:31 +0000"  >&lt;p&gt;So i wrote the plugin for the yetus usage.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[root@sacharya-docker avro]# test-patch.sh --plugins=all --user-plugins=/root/avro/pre_commit/  --list-plugins
Reminder: every plug-in may be enabled via &lt;span class=&quot;code-quote&quot;&gt;&apos;all&apos;&lt;/span&gt;.
 
BUILDTOOLS:
    ant autoconf cmake gradle make maven nobuild build
TESTTYPES:
    asflicense author cc checkstyle findbugs javac javadoc mvnsite mvneclipse perlcritic pylint rubocop ruby_lint scalac scaladoc shellcheck shelldocs test4tests unitveto whitespace xml buildtest
BUGSYSTEMS:
    brieftext bugzilla github htmlout jira
TESTFORMATS:
    ctest junit tap
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The build tool is build and the build test tool is buildtest.&lt;br/&gt;
I tried with a couple different patches and found the results to be pretty consistent.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;| Vote |      Subsystem |  &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt;   | Comment
============================================================================
|   0  |        pylint  |   0m  4s   | Pylint was not available.
|  +1  |       @author  |   0m  0s   | The patch does not contain any @author
|      |                |            | tags.
|  +1  |     buildtest  |   0m  0s   | master passed
|  -1  |    whitespace  |   0m  0s   | The patch has 3 line(s) that end in
|      |                |            | whitespace. Use git apply
|      |                |            | --whitespace=fix &amp;lt;&amp;lt;patch_file&amp;gt;&amp;gt;. Refer
|      |                |            | https:&lt;span class=&quot;code-comment&quot;&gt;//git-scm.com/docs/git-apply
&lt;/span&gt;|  +1  |     buildtest  |   0m 18s   | the patch passed
|      |                |   0m 24s   |
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The usage is something like :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;test-patch.sh --plugins=all --user-plugins=/root/avro/pre_commit/    --build-tool=build   &amp;lt;PATCH FILE&amp;gt;   --robot
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Currently I havent givent any JIRA credentials but the same can be passed to the builds.apache machine.&lt;/p&gt;</comment>
                            <comment id="15563683" author="sacharya" created="Mon, 10 Oct 2016 22:06:22 +0000"  >&lt;p&gt;Initial patch.&lt;/p&gt;</comment>
                            <comment id="15570074" author="sacharya" created="Wed, 12 Oct 2016 22:29:59 +0000"  >&lt;p&gt;Updated some incorrect comment.&lt;/p&gt;

&lt;p&gt;Also tagging &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;Allen Wittenauer&lt;/a&gt; to do some code review since he helped with some yetus implementation.&lt;/p&gt;</comment>
                            <comment id="15626140" author="busbey" created="Tue, 1 Nov 2016 17:50:56 +0000"  >&lt;p&gt;looks good. I&apos;ll play with this a bit before committing.&lt;/p&gt;

&lt;p&gt;One small change, could you locate this in &lt;tt&gt;share/pre_commit&lt;/tt&gt; instead of the top-level &lt;tt&gt;pre_commit&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;That will put it near the other help-run-the-project stuff we have for e.g. Docker and git.&lt;/p&gt;

&lt;p&gt;Have you gotten to try out using our Dockerfile to ensure the yetus run has all of our needed dependencies?&lt;/p&gt;</comment>
                            <comment id="15680006" author="sacharya" created="Sat, 19 Nov 2016 22:57:25 +0000"  >&lt;p&gt;I tried it with docker.&lt;br/&gt;
However, there is a bug in yetus.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/YETUS-470&quot; title=&quot;user_plugin directory is not copied over properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;YETUS-470&quot;&gt;&lt;del&gt;YETUS-470&lt;/del&gt;&lt;/a&gt; is a requirement for using yetus with Docker.&lt;/p&gt;</comment>
                            <comment id="15836286" author="busbey" created="Tue, 24 Jan 2017 16:33:12 +0000"  >&lt;p&gt;Now that Yetus 0.4.0 is out, can we move forward with this?&lt;/p&gt;</comment>
                            <comment id="15867146" author="sacharya" created="Wed, 15 Feb 2017 03:28:01 +0000"  >&lt;p&gt;Created a pull request here : &lt;a href=&quot;https://github.com/apache/avro/pull/196&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/196&lt;/a&gt;&lt;br/&gt;
I have added some comments in the pull request.&lt;br/&gt;
Please test it and let me know your comments.&lt;/p&gt;</comment>
                            <comment id="16640949" author="githubbot" created="Sun, 7 Oct 2018 01:38:27 +0000"  >&lt;p&gt;Fokko opened a new pull request #344: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;WIP&amp;#93;&lt;/span&gt; Setup precommit hooks using Apache Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/344&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/344&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Based on the earlier work of @spacharya &lt;/p&gt;

&lt;p&gt;   The current configuration does not kick off the tests:&lt;br/&gt;
   ```&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Vote &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;      Subsystem &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Runtime   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Comment&lt;br/&gt;
   ============================================================================&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;        reexec  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  9s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Docker mode activated.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Prechecks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     shelldocs  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 25s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Shelldocs was not available.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Compile Tests&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       @author  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 46s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree appears to contain 4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; @author tags which the community has&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; agreed to not allow in code&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; contributions.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;      hadolint  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  1s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 4 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    perlcritic  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 13s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 456 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;        pylint  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   2m 14s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 7623 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       rubocop  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 28s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 1053 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     ruby-lint  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 15s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 885 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    shellcheck  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  3s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 126 issues.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    whitespace  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  3s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 1229 line(s) that&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; end in whitespace.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    whitespace  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m 14s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree 22503 line(s) with tabs.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;           xml  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   1m 40s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The source tree has 9 ill-formed XML&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; file(s).&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  +1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     buildtest  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  0s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; the source passed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Other Tests&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   9m 22s   &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;   ```&lt;br/&gt;
   The buildstep `buildtest` takes `0m 0s`.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16646676" author="githubbot" created="Thu, 11 Oct 2018 16:00:07 +0000"  >&lt;p&gt;Fokko commented on issue #344: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;WIP&amp;#93;&lt;/span&gt; Setup precommit hooks using Apache Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/344#issuecomment-429012884&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/344#issuecomment-429012884&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @busbey I&apos;ve got a first version of the Apache Yetus script working. It took me a while since it is new to me, so be gentle on the review &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
   I&apos;ve written a small plugin that will locate all the `build.sh` scripts, and subsequently invoke the `test` step. I know this is still a bit crude, but this allows us to reuse the existing build scripts.&lt;/p&gt;

&lt;p&gt;   Please note that the tests are still failing, but I&apos;m working on patches in a new PR.&lt;/p&gt;

&lt;p&gt;   ```&lt;br/&gt;
    _____     _ _                _ &lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  ___&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_ &lt;em&gt;(&lt;/em&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_   _ _ __ ___&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_ / _` &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &apos;__/ _ \ &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  _&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; (_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  _&lt;em&gt;/&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  &amp;#95;&lt;em&gt;,&lt;/em&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#95;&lt;em&gt;,&lt;/em&gt;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;_&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  &amp;#95;_&lt;em&gt;(&lt;/em&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;




&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Vote &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;     Subsystem &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Runtime   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Comment&lt;br/&gt;
   ============================================================================&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;       reexec  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   0m  9s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Docker mode activated.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Prechecks&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Compile Tests&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  -1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    buildtest  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  14m 46s   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The testsuite failed, please check the&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; output&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Other Tests&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  14m 55s   &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;   ```&lt;/p&gt;



&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16662024" author="githubbot" created="Wed, 24 Oct 2018 09:44:56 +0000"  >&lt;p&gt;Fokko opened a new pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   All,&lt;/p&gt;

&lt;p&gt;   First PR that will kick off the tests using Apache Yetus. It is a crude implementation since it will only kick off the `./build.sh`, but this will be refined later on. &lt;/p&gt;

&lt;p&gt;   The C++ and the interop tests are failing and are therefore disabled for now. &lt;/p&gt;

&lt;p&gt;   cc @kojiromike&lt;/p&gt;

&lt;p&gt;   Cheers, Fokko&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16664004" author="githubbot" created="Thu, 25 Oct 2018 16:51:58 +0000"  >&lt;p&gt;cutting commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228252518&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228252518&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -54,25 +56,26 @@ do&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;create interop test data&lt;br/&gt;
       mkdir -p build/interop/data&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(cd lang/java/avro; mvn -P interop-data-generate generate-resources)&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;br/&gt;
       (cd lang/py; ant interop-data-generate)&lt;br/&gt;
       (cd lang/c; ./build.sh interop-data-generate)&lt;br/&gt;
       #(cd lang/c++; make interop-data-generate)&lt;br/&gt;
       (cd lang/ruby; rake generate_interop)&lt;br/&gt;
       (cd lang/php; ./build.sh interop-data-generate)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;run interop data tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(cd lang/java; mvn test -P interop-data-test)&lt;br/&gt;
+      (cd lang/java; mvn -B test -P interop-data-test)&lt;br/&gt;
       (cd lang/py; ant interop-data-test)&lt;br/&gt;
       (cd lang/c; ./build.sh interop-data-test)&lt;br/&gt;
       #(cd lang/c++; make interop-data-test)&lt;br/&gt;
       (cd lang/ruby; rake interop)&lt;br/&gt;
       (cd lang/php; ./build.sh test-interop)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;java needs to package the jars for the interop rpc tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(cd lang/java; mvn package -DskipTests)&lt;br/&gt;
+      (cd lang/java; mvn -B package -DskipTests)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
	&lt;li&gt;run interop rpc test&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/bin/bash share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
+      # This is not working for now&lt;br/&gt;
+      # /bin/bash share/test/interop/bin/test_rpc_interop.sh&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Are all interop tests failing, or only a few?  If only a few, I&apos;d rather disable just those.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16664005" author="githubbot" created="Thu, 25 Oct 2018 16:51:58 +0000"  >&lt;p&gt;cutting commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228251149&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228251149&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -41,11 +41,13 @@ do&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # The C++ tests are failing&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2230&quot; title=&quot;./build.sh test fails in c++ due to assignment to const&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-2230&quot;&gt;&lt;del&gt;AVRO-2230&lt;/del&gt;&lt;/a&gt; is now marked as fixed in Jira.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16664006" author="githubbot" created="Thu, 25 Oct 2018 16:51:59 +0000"  >&lt;p&gt;cutting commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228252951&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228252951&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: lang/java/ipc/src/test/java/org/apache/avro/DataFileInteropTest.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,27 +40,27 @@ public static void printDir() &lt;/p&gt;
{
         + DATAFILE_DIR.getAbsolutePath());
   }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;public void testGeneratedGeneric() throws IOException {&lt;/li&gt;
	&lt;li&gt;System.out.println(&quot;Reading with generic:&quot;);&lt;/li&gt;
	&lt;li&gt;DatumReaderProvider&amp;lt;Object&amp;gt; provider = new DatumReaderProvider&amp;lt;Object&amp;gt;() {&lt;/li&gt;
	&lt;li&gt;@Override public DatumReader&amp;lt;Object&amp;gt; get() 
{
-        return new GenericDatumReader&amp;lt;&amp;gt;();
-        }&lt;/li&gt;
	&lt;li&gt;};&lt;/li&gt;
	&lt;li&gt;readFiles(provider);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;@Test&lt;/li&gt;
	&lt;li&gt;public void testGeneratedSpecific() throws IOException {&lt;/li&gt;
	&lt;li&gt;System.out.println(&quot;Reading with specific:&quot;);&lt;/li&gt;
	&lt;li&gt;DatumReaderProvider&amp;lt;Interop&amp;gt; provider = new DatumReaderProvider&amp;lt;Interop&amp;gt;() {&lt;/li&gt;
	&lt;li&gt;@Override public DatumReader&amp;lt;Interop&amp;gt; get() 
{
-        return new SpecificDatumReader&amp;lt;&amp;gt;();
-        }&lt;/li&gt;
	&lt;li&gt;};&lt;/li&gt;
	&lt;li&gt;readFiles(provider);&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
+  // @Test&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Why are these commented out?  Are they failing?  If they&apos;re no longer required then we should just delete them.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16664007" author="githubbot" created="Thu, 25 Oct 2018 16:51:59 +0000"  >&lt;p&gt;cutting commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228253247&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228253247&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: lang/java/tools/src/test/compiler/output-string/avro/examples/baseball/Player.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -541,13 +541,3 @@ public Player build() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
-&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Not sure it&apos;s worth cleaning up auto-generated files...&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16665085" author="githubbot" created="Fri, 26 Oct 2018 12:03:55 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228501492&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228501492&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -41,11 +41,13 @@ do&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # The C++ tests are failing&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Still failing :&apos;(&lt;br/&gt;
   ```&lt;br/&gt;
   Scanning dependencies of target avrocpp_s&lt;br/&gt;
   [  1%] Building CXX object CMakeFiles/avrocpp_s.dir/impl/Compiler.cc.o&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/Compiler.cc:174:15: warning: &#226;&#8364;&#732;std::string avro::nameof(const NodePtr&amp;amp;)&#226;&#8364;&#8482; defined but not used &lt;span class=&quot;error&quot;&gt;&amp;#91;-Wunused-function&amp;#93;&lt;/span&gt;&lt;br/&gt;
    static string nameof(const NodePtr&amp;amp; n)&lt;br/&gt;
                  ^&lt;br/&gt;
   [  2%] Building CXX object CMakeFiles/avrocpp_s.dir/impl/Node.cc.o&lt;br/&gt;
   [  4%] Building CXX object CMakeFiles/avrocpp_s.dir/impl/NodeImpl.cc.o&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc: In function &#226;&#8364;&#732;std::string avro::&lt;/p&gt;
{anonymous}::escape(const string&amp;amp;)&#226;&#8364;&#8482;:&lt;br/&gt;
   /testptch/unknown/lang/c+&lt;ins&gt;/impl/NodeImpl.cc:31:8: warning: &#226;&#8364;&#732;auto&#226;&#8364;&#8482; changes meaning in C&lt;/ins&gt;+11; please remove it &lt;span class=&quot;error&quot;&gt;&amp;#91;-Wc++0x-compat&amp;#93;&lt;/span&gt;&lt;br/&gt;
      for (auto c : unescaped) {&lt;br/&gt;
           ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:31:13: error: &#226;&#8364;&#732;c&#226;&#8364;&#8482; does not name a type&lt;br/&gt;
      for (auto c : unescaped) {&lt;br/&gt;
                ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:67:3: error: expected &#226;&#8364;&#732;;&#226;&#8364;&#8482; before &#226;&#8364;&#732;return&#226;&#8364;&#8482;&lt;br/&gt;
      return s;&lt;br/&gt;
      ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:67:3: error: expected primary-expression before &#226;&#8364;&#732;return&#226;&#8364;&#8482;&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:67:3: error: expected &#226;&#8364;&#732;;&#226;&#8364;&#8482; before &#226;&#8364;&#732;return&#226;&#8364;&#8482;&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:67:3: error: expected primary-expression before &#226;&#8364;&#732;return&#226;&#8364;&#8482;&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:67:3: error: expected &#226;&#8364;&#732;)&#226;&#8364;&#8482; before &#226;&#8364;&#732;return&#226;&#8364;&#8482;&lt;br/&gt;
   In file included from /usr/include/boost/assert.hpp:51:0,&lt;br/&gt;
                    from /usr/include/boost/format/parsing.hpp:21,&lt;br/&gt;
                    from /usr/include/boost/format.hpp:50,&lt;br/&gt;
                    from /testptch/unknown/lang/c++/api/Exception.hh:24,&lt;br/&gt;
                    from /testptch/unknown/lang/c++/api/Node.hh:28,&lt;br/&gt;
                    from /testptch/unknown/lang/c++/api/GenericDatum.hh:29,&lt;br/&gt;
                    from /testptch/unknown/lang/c++/api/NodeImpl.hh:23,&lt;br/&gt;
                    from /testptch/unknown/lang/c++/impl/NodeImpl.cc:21:&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc: In member function &#226;&#8364;&#732;virtual void avro::NodeRecord::printJson(std::ostream&amp;amp;, int) const&#226;&#8364;&#8482;:&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:247:59: warning: comparison between signed and unsigned integer expressions &lt;span class=&quot;error&quot;&gt;&amp;#91;-Wsign-compare&amp;#93;&lt;/span&gt;&lt;br/&gt;
        assert(defaultValues.empty() || (defaultValues.size() == fields));&lt;br/&gt;
                                                              ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc: In member function &#226;&#8364;&#732;virtual void avro::NodePrimitive::printDefaultToJson(const avro::GenericDatum&amp;amp;, std::ostream&amp;amp;, int) const&#226;&#8364;&#8482;:&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:292:13: error: &#226;&#8364;&#732;to_string&#226;&#8364;&#8482; is not a member of &#226;&#8364;&#732;std&#226;&#8364;&#8482;&lt;br/&gt;
          os &amp;lt;&amp;lt; std::to_string(g.value&amp;lt;float&amp;gt;());&lt;br/&gt;
                ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:295:13: error: &#226;&#8364;&#732;to_string&#226;&#8364;&#8482; is not a member of &#226;&#8364;&#732;std&#226;&#8364;&#8482;&lt;br/&gt;
          os &amp;lt;&amp;lt; std::to_string(g.value&amp;lt;double&amp;gt;());&lt;br/&gt;
                ^&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc: In function &#226;&#8364;&#732;std::string avro::{anonymous}
&lt;p&gt;::escape(const string&amp;amp;)&#226;&#8364;&#8482;:&lt;br/&gt;
   /testptch/unknown/lang/c++/impl/NodeImpl.cc:68:1: warning: control reaches end of non-void function &lt;span class=&quot;error&quot;&gt;&amp;#91;-Wreturn-type&amp;#93;&lt;/span&gt;&lt;br/&gt;
    }&lt;br/&gt;
    ^&lt;br/&gt;
   CMakeFiles/avrocpp_s.dir/build.make:100: recipe for target &apos;CMakeFiles/avrocpp_s.dir/impl/NodeImpl.cc.o&apos; failed&lt;br/&gt;
   make&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;CMakeFiles/avrocpp_s.dir/impl/NodeImpl.cc.o&amp;#93;&lt;/span&gt; Error 1&lt;br/&gt;
   make&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;CMakeFiles/avrocpp_s.dir/all&amp;#93;&lt;/span&gt; Error 2&lt;br/&gt;
   CMakeFiles/Makefile2:425: recipe for target &apos;CMakeFiles/avrocpp_s.dir/all&apos; failed&lt;br/&gt;
   make: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;all&amp;#93;&lt;/span&gt; Error 2&lt;br/&gt;
   Makefile:147: recipe for target &apos;all&apos; failed&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16665101" author="githubbot" created="Fri, 26 Oct 2018 12:19:21 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228505487&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228505487&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -41,11 +41,13 @@ do&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # The C++ tests are failing&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/projects/AVRO/issues/AVRO-2230&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I&apos;ve created &lt;span class=&quot;error&quot;&gt;&amp;#91;a new ticket&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2249&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2249&lt;/a&gt;) on Jira, the tests are still failing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666604" author="githubbot" created="Sun, 28 Oct 2018 23:45:11 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228771737&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228771737&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,39 +40,43 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Shouldn&apos;t these be written as `cd ... &amp;amp;&amp;amp;` rather than `cd ...;`?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666605" author="githubbot" created="Sun, 28 Oct 2018 23:45:19 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228771744&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228771744&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,39 +40,43 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;br/&gt;
+      &lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2249&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2249&lt;/a&gt;&lt;br/&gt;
+      # (cd lang/c++; ./build.sh test)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666606" author="githubbot" created="Sun, 28 Oct 2018 23:47:14 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228771815&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228771815&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}

&lt;p&gt; Review comment:&lt;br/&gt;
   Please consider the more portable function definition form&lt;/p&gt;

&lt;p&gt;   ```bash&lt;br/&gt;
   buildtest_usage() &lt;/p&gt;
{
   ...
   }
&lt;p&gt;   ```&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666608" author="githubbot" created="Sun, 28 Oct 2018 23:52:07 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772032&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772032&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Is it important to have the form `-&lt;del&gt;verbose=true` instead of just `&lt;/del&gt;-verbose`?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666613" author="githubbot" created="Mon, 29 Oct 2018 00:04:57 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772674&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772674&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   ```bash&lt;br/&gt;
   $ file=$file f=${file//&lt;span class=&quot;error&quot;&gt;&amp;#91;.\\\/&amp;#93;&lt;/span&gt;/-}&lt;br/&gt;
   + file=&apos;this.is\a/file.with\many/strange\characters/in.it&apos;&lt;br/&gt;
   + f=this-is-a-file-with-many-strange-characters-in-it&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666614" author="githubbot" created="Mon, 29 Oct 2018 00:06:21 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772740&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772740&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;br/&gt;
+      # Write both to stdout and the file using tee&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; | tee &lt;del&gt;a &quot;${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&quot;&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Why `eval` and not a subshell?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666615" author="githubbot" created="Mon, 29 Oct 2018 00:07:05 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772765&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772765&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   ```bash&lt;br/&gt;
   if [[ $VERBOSE = true ]]; then&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;   but it would be better, in my opinion, to consider VERBOSE as true if it&apos;s set at all.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666616" author="githubbot" created="Mon, 29 Oct 2018 00:07:41 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772794&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772794&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;br/&gt;
+      # Write both to stdout and the file using tee&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; | tee &lt;del&gt;a &quot;${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=${PIPESTATUS&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
+    else&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; &amp;gt;&amp;gt; &quot;${PATCH_DIR}/build-${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=$?&lt;br/&gt;
+    fi&lt;br/&gt;
+&lt;br/&gt;
+    if [[ ${result} -ne 0 ]]; then&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Consider arithmetic expression here:&lt;/p&gt;

&lt;p&gt;   ```bash&lt;br/&gt;
   if (( result != 0 )); then&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666617" author="githubbot" created="Mon, 29 Oct 2018 00:08:39 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228772835&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228772835&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -21,29 +21,33 @@ cd `dirname &quot;$0&quot;`/../../../..   # connect to root&lt;/p&gt;

&lt;p&gt; VERSION=`cat share/VERSION.txt`&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   ```bash&lt;br/&gt;
   VERSION=$(&amp;lt;share/VERSION.txt)&lt;br/&gt;
   ```&lt;/p&gt;

&lt;p&gt;   would be a little nicer here. (Obviously take it or leave it since this isn&apos;t actually part of this PR.)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666619" author="githubbot" created="Mon, 29 Oct 2018 00:12:45 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228773024&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228773024&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -21,29 +21,33 @@ cd `dirname &quot;$0&quot;`/../../../..   # connect to root&lt;/p&gt;

&lt;p&gt; VERSION=`cat share/VERSION.txt`&lt;/p&gt;

&lt;p&gt;-#set -x                          # echo commands&lt;br/&gt;
+set -x                          # echo commands&lt;/p&gt;

&lt;p&gt; java_client=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcsend&quot;&lt;br/&gt;
 java_server=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcreceive&quot;&lt;/p&gt;

&lt;p&gt; py_client=&quot;python lang/py/build/src/avro/tool.py rpcsend&quot;&lt;br/&gt;
 py_server=&quot;python lang/py/build/src/avro/tool.py rpcreceive&quot;&lt;/p&gt;

&lt;p&gt;-ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
-ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;br/&gt;
+#ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
+#ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;/p&gt;

&lt;p&gt; export PYTHONPATH=lang/py/build/src      # path to avro Python module&lt;/p&gt;

&lt;p&gt;-clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
-servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+#clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
+#servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+clients=(&quot;$java_client&quot; &quot;$py_client&quot;)&lt;br/&gt;
+servers=(&quot;$java_server&quot; &quot;$py_server&quot;)&lt;/p&gt;

&lt;p&gt; proto=share/test/schemas/simple.avpr&lt;/p&gt;

&lt;p&gt; portfile=/tmp/interop_$$&lt;/p&gt;

&lt;p&gt; function cleanup() {&lt;br/&gt;
   rm -rf $portfile&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Please quote this expansion. An unquoted expansion after `rm -rf` is dangerous.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16666622" author="githubbot" created="Mon, 29 Oct 2018 00:22:18 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228773503&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228773503&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -21,29 +21,33 @@ cd `dirname &quot;$0&quot;`/../../../..   # connect to root&lt;/p&gt;

&lt;p&gt; VERSION=`cat share/VERSION.txt`&lt;/p&gt;

&lt;p&gt;-#set -x                          # echo commands&lt;br/&gt;
+set -x                          # echo commands&lt;/p&gt;

&lt;p&gt; java_client=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcsend&quot;&lt;br/&gt;
 java_server=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcreceive&quot;&lt;/p&gt;

&lt;p&gt; py_client=&quot;python lang/py/build/src/avro/tool.py rpcsend&quot;&lt;br/&gt;
 py_server=&quot;python lang/py/build/src/avro/tool.py rpcreceive&quot;&lt;/p&gt;

&lt;p&gt;-ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
-ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;br/&gt;
+#ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
+#ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;/p&gt;

&lt;p&gt; export PYTHONPATH=lang/py/build/src      # path to avro Python module&lt;/p&gt;

&lt;p&gt;-clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
-servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+#clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
+#servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+clients=(&quot;$java_client&quot; &quot;$py_client&quot;)&lt;br/&gt;
+servers=(&quot;$java_server&quot; &quot;$py_server&quot;)&lt;/p&gt;

&lt;p&gt; proto=share/test/schemas/simple.avpr&lt;/p&gt;

&lt;p&gt; portfile=/tmp/interop_$$&lt;/p&gt;

&lt;p&gt; function cleanup() {&lt;br/&gt;
   rm -rf $portfile&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for job in `jobs -p` ; do kill $job; done&lt;br/&gt;
+  for job in `jobs -p` ; do&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   You can do `kill $(jobs -p) 2&amp;gt;/dev/null || true` here.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667315" author="githubbot" created="Mon, 29 Oct 2018 15:02:07 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228963990&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228963990&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,39 +40,43 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   Good point&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667316" author="githubbot" created="Mon, 29 Oct 2018 15:02:29 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228964128&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228964128&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,39 +40,43 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;br/&gt;
+      &lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2249&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2249&lt;/a&gt;&lt;br/&gt;
+      # (cd lang/c++; ./build.sh test)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   These tests should be fixed, but I&apos;m resolving some other stuff with the Java tests first.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667317" author="githubbot" created="Mon, 29 Oct 2018 15:03:24 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228964567&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228964567&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}

&lt;p&gt; Review comment:&lt;br/&gt;
   Thanks&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667318" author="githubbot" created="Mon, 29 Oct 2018 15:03:43 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228964720&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228964720&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Good point&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667321" author="githubbot" created="Mon, 29 Oct 2018 15:04:46 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228965161&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228965161&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;br/&gt;
+      # Write both to stdout and the file using tee&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; | tee &lt;del&gt;a &quot;${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&quot;&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Good point&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667322" author="githubbot" created="Mon, 29 Oct 2018 15:05:28 +0000"  >&lt;p&gt;Fokko commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r228965441&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r228965441&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: share/precommit/buildtest.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -0,0 +1,81 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+&lt;/p&gt;
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# function buildtest_filefilter&lt;br/&gt;
+# {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;br/&gt;
+      # Write both to stdout and the file using tee&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; | tee &lt;del&gt;a &quot;${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=${PIPESTATUS&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
+    else&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; &amp;gt;&amp;gt; &quot;${PATCH_DIR}/build-${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=$?&lt;br/&gt;
+    fi&lt;br/&gt;
+&lt;br/&gt;
+    if [[ ${result} -ne 0 ]]; then&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Thanks&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667330" author="githubbot" created="Mon, 29 Oct 2018 15:08:20 +0000"  >&lt;p&gt;Fokko commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-433946587&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-433946587&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks for the review @kojiromike &lt;/p&gt;

&lt;p&gt;   Enabling `shellcheck` is easy by adding it in the list of plugins: &lt;a href=&quot;https://github.com/Fokko/avro/blob/fd-fix-tests/.travis.yml#L34&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/Fokko/avro/blob/fd-fix-tests/.travis.yml#L34&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   There is also support for hadolint etc.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16667606" author="githubbot" created="Mon, 29 Oct 2018 19:01:56 +0000"  >&lt;p&gt;kojiromike commented on a change in pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#discussion_r229058535&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#discussion_r229058535&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: build.sh&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -40,39 +40,43 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;br/&gt;
+      &lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      # &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2249&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2249&lt;/a&gt;&lt;br/&gt;
+      # (cd lang/c++; ./build.sh test)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I&apos;ve actually been thinking we should have two run modes for this:&lt;/p&gt;

&lt;p&gt;   1. Exit as soon as something fails&lt;br/&gt;
   2. Keep going, and report all failures at the end.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16674759" author="githubbot" created="Mon, 5 Nov 2018 07:24:24 +0000"  >&lt;p&gt;Fokko closed pull request #344: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt;. Setup precommit hooks using Apache Yetus&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/344&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/344&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/build.sh b/build.sh&lt;br/&gt;
index 8810d6bfa..2abb45aba 100755&lt;br/&gt;
&amp;#8212; a/build.sh&lt;br/&gt;
+++ b/build.sh&lt;br/&gt;
@@ -38,6 +38,8 @@ do&lt;br/&gt;
   case &quot;$target&quot; in&lt;/p&gt;

&lt;p&gt;     test)&lt;br/&gt;
+      java -version&lt;br/&gt;
+&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;br/&gt;
diff --git a/pom.xml b/pom.xml&lt;br/&gt;
index e3f48442c..d0c9d274b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/pom.xml&lt;br/&gt;
+++ b/pom.xml&lt;br/&gt;
@@ -281,6 +281,7 @@&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;lang/csharp/Avro.sln&amp;lt;/exclude&amp;gt; &amp;lt;!-- visual studio --&amp;gt;&lt;br/&gt;
                 &amp;lt;!-- build-related files --&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;BUILD.md&amp;lt;/exclude&amp;gt;&lt;br/&gt;
+                &amp;lt;exclude&amp;gt;share/precommit/README.md&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;**/VERSION.txt&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;**/dependency-reduced-pom.xml&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;lang/perl/.shipit&amp;lt;/exclude&amp;gt;&lt;br/&gt;
diff --git a/share/precommit/README.md b/share/precommit/README.md&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..0219c172e&lt;/li&gt;
			&lt;li&gt;/dev/null&lt;br/&gt;
+++ b/share/precommit/README.md&lt;br/&gt;
@@ -0,0 +1,9 @@&lt;br/&gt;
+# Apache Yetus integration&lt;br/&gt;
+&lt;br/&gt;
+The plugin under `buildtest.sh` will provide the plugin to run the base `build.sh test` which will trigger the tests of the main Avro projects, and the sections below `lang/*/build.sh`. To run this, use:&lt;br/&gt;
+&lt;br/&gt;
+```bash&lt;br/&gt;
+test-patch --plugins=buildtest --user-plugins=share/precommit/ --run-tests --empty-patch --docker --dockerFile=share/docker/Dockerfile --dirty-workspace --verbose=true&lt;br/&gt;
+```&lt;br/&gt;
+&lt;br/&gt;
+Note, that this is still a very crude implementation of Apache Yetus, and in the future we would like to refine this to provide plugins for the different languages.&lt;br/&gt;
diff --git a/share/precommit/buildtest.sh b/share/precommit/buildtest.sh&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..86a82865d&lt;/li&gt;
			&lt;li&gt;/dev/null&lt;br/&gt;
+++ b/share/precommit/buildtest.sh&lt;br/&gt;
@@ -0,0 +1,80 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=()&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage&lt;br/&gt;
+
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+function buildtest_parse_args&lt;br/&gt;
+{&lt;br/&gt;
+  local i&lt;br/&gt;
+&lt;br/&gt;
+  for i in &quot;$@&quot;; do&lt;br/&gt;
+    case ${i} in&lt;br/&gt;
+    --verbose=*)&lt;br/&gt;
+      VERBOSE=${i#*=}&lt;br/&gt;
+    ;;&lt;br/&gt;
+    esac&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_filefilter&lt;br/&gt;
+{&lt;br/&gt;
+  local filename=$1&lt;br/&gt;
+&lt;br/&gt;
+  if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+    yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+    add_test buildtest&lt;br/&gt;
+    yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+  fi&lt;br/&gt;
+}&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile&lt;br/&gt;
+{&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    if [ &quot;$VERBOSE&quot; == &quot;true&quot; ]; then&lt;br/&gt;
+      # Write both to stdout and the file using tee&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; | tee &lt;del&gt;a &quot;${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=${PIPESTATUS&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
+    else&lt;br/&gt;
+      eval &quot;cd ${BASEDIR}; ./${file} test&quot; &amp;gt;&amp;gt; &quot;${PATCH_DIR}/build-${sanitized_filename}.txt&quot;&lt;br/&gt;
+      result=$?&lt;br/&gt;
+    fi&lt;br/&gt;
+&lt;br/&gt;
+    if [[ ${result} -ne 0 ]]; then&lt;br/&gt;
+      add_vote_table -1 buildtest &quot;The testsuite failed, please check the output&quot;&lt;br/&gt;
+      add_footer_table buildtest &quot;@@BASE@@/build-${sanitized_filename}.txt&quot;&lt;br/&gt;
+      return 1&lt;br/&gt;
+    fi&lt;br/&gt;
+&lt;br/&gt;
+    add_vote_table +1 buildtest &quot;The build has passed&quot;&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16675292" author="githubbot" created="Mon, 5 Nov 2018 15:11:43 +0000"  >&lt;p&gt;Fokko commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-435909844&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-435909844&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @kojiromike @cutting PTAL.&lt;/p&gt;

&lt;p&gt;   I know there are a crazy amount of changes. Instead of having fixed paths, I updated all the tests to use TemporaryDirectories using junit. Also, I&apos;ve rewritten a lot of the file operations using `try-with-resource`. A lot of the streams weren&apos;t closed at all.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16675297" author="githubbot" created="Mon, 5 Nov 2018 15:15:54 +0000"  >&lt;p&gt;Fokko commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-435911385&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-435911385&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @kojiromike My suggestion would be to merge this first, and then you can freely rework the shell scripts. You&apos;re much better at it than me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16678184" author="githubbot" created="Wed, 7 Nov 2018 12:52:26 +0000"  >&lt;p&gt;Fokko closed pull request #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/.gitignore b/.gitignore&lt;br/&gt;
index a9fa766f9..83e7336c3 100644&lt;br/&gt;
&amp;#8212; a/.gitignore&lt;br/&gt;
+++ b/.gitignore&lt;br/&gt;
@@ -15,4 +15,4 @@ test-output&lt;br/&gt;
 /dist&lt;br/&gt;
 /lang/java/compiler/nbactions.xml&lt;br/&gt;
 /lang/java/compiler/nb-configuration.xml&lt;br/&gt;
-/lang/java/compiler/nbproject/&lt;br/&gt;
\ No newline at end of file&lt;br/&gt;
+/lang/java/compiler/nbproject/&lt;br/&gt;
diff --git a/.travis.yml b/.travis.yml&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..defdcfb78&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/.travis.yml&lt;br/&gt;
@@ -0,0 +1,34 @@&lt;br/&gt;
+#&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+# or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
+# distributed with this work for additional information&lt;br/&gt;
+# regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
+# to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+# &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+# with the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#   &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+# software distributed under the License is distributed on an&lt;br/&gt;
+# &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+# KIND, either express or implied.  See the License for the&lt;br/&gt;
+# specific language governing permissions and limitations&lt;br/&gt;
+# under the License.&lt;br/&gt;
+#&lt;br/&gt;
+&lt;br/&gt;
+sudo: required&lt;br/&gt;
+&lt;br/&gt;
+services:&lt;br/&gt;
+  - docker&lt;br/&gt;
+&lt;br/&gt;
+language: generic&lt;br/&gt;
+&lt;br/&gt;
+before_install:&lt;br/&gt;
+  - sudo apt-get -q update&lt;br/&gt;
+  - sudo apt-get -q install --no-install-recommends -y curl git gnupg-agent locales pinentry-curses pkg-config rsync software-properties-common&lt;br/&gt;
+  - sudo apt-get -q clean&lt;br/&gt;
+  - sudo rm -rf /var/lib/apt/lists/*&lt;br/&gt;
+  - curl -L &lt;a href=&quot;https://www-us.apache.org/dist/yetus/0.8.0/yetus-0.8.0-bin.tar.gz&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://www-us.apache.org/dist/yetus/0.8.0/yetus-0.8.0-bin.tar.gz&lt;/a&gt; | tar xvz -C /tmp/&lt;br/&gt;
+&lt;br/&gt;
+script: /tmp/yetus-0.8.0/bin/test-patch --plugins=buildtest --user-plugins=share/precommit/ --run-tests --empty-patch --docker --dockerfile=share/docker/Dockerfile --dirty-workspace --verbose=true&lt;br/&gt;
diff --git a/README.txt b/README.md&lt;br/&gt;
similarity index 65%&lt;br/&gt;
rename from README.txt&lt;br/&gt;
rename to README.md&lt;br/&gt;
index 566f192c6..a8878a157 100644&lt;br/&gt;
&amp;#8212; a/README.txt&lt;br/&gt;
+++ b/README.md&lt;br/&gt;
@@ -1,3 +1,7 @@&lt;br/&gt;
+[!&lt;span class=&quot;error&quot;&gt;&amp;#91;Build Status&amp;#93;&lt;/span&gt;(&lt;a href=&quot;https://travis-ci.org/apache/avro.svg?branch=master)](https://travis-ci.org/apache/avro&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://travis-ci.org/apache/avro.svg?branch=master)](https://travis-ci.org/apache/avro&lt;/a&gt;)&lt;br/&gt;
+&lt;br/&gt;
+# Apache Avro&#8482;&lt;br/&gt;
+&lt;br/&gt;
 Apache Avro&#8482; is a data serialization system.&lt;/p&gt;

&lt;p&gt; Learn more about Avro, please visit our website at:&lt;br/&gt;
diff --git a/build.sh b/build.sh&lt;br/&gt;
index 8810d6bfa..9ce4ae683 100755&lt;br/&gt;
&amp;#8212; a/build.sh&lt;br/&gt;
+++ b/build.sh&lt;br/&gt;
@@ -40,21 +40,23 @@ do&lt;br/&gt;
     test)&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;run lang-specific tests&lt;br/&gt;
       (cd lang/java; ./build.sh test)&lt;br/&gt;
+&lt;br/&gt;
+      # create interop test data&lt;br/&gt;
+      mkdir -p build/interop/data&lt;br/&gt;
+      (cd lang/java/avro; mvn -B -P interop-data-generate generate-resources)&lt;br/&gt;
+&lt;/li&gt;
	&lt;li&gt;install java artifacts required by other builds and interop tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mvn install -DskipTests&lt;br/&gt;
+      mvn -B install -DskipTests&lt;br/&gt;
       (cd lang/py; ./build.sh test)&lt;br/&gt;
       (cd lang/py3; ./build.sh test)&lt;br/&gt;
       (cd lang/c; ./build.sh test)&lt;/li&gt;
	&lt;li&gt;(cd lang/c++; ./build.sh test)&lt;br/&gt;
+      #(cd lang/c++; ./build.sh test)&lt;br/&gt;
       (cd lang/csharp; ./build.sh test)&lt;br/&gt;
       (cd lang/js; ./build.sh test)&lt;br/&gt;
       (cd lang/ruby; ./build.sh test)&lt;br/&gt;
       (cd lang/php; ./build.sh test)&lt;br/&gt;
       (cd lang/perl; ./build.sh test)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;# create interop test data&lt;/li&gt;
	&lt;li&gt;mkdir -p build/interop/data&lt;/li&gt;
	&lt;li&gt;(cd lang/java/avro; mvn -P interop-data-generate generate-resources)&lt;br/&gt;
       (cd lang/py; ant interop-data-generate)&lt;br/&gt;
       (cd lang/c; ./build.sh interop-data-generate)&lt;br/&gt;
       #(cd lang/c++; make interop-data-generate)&lt;br/&gt;
@@ -62,7 +64,7 @@ do&lt;br/&gt;
       (cd lang/php; ./build.sh interop-data-generate)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;run interop data tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(cd lang/java; mvn test -P interop-data-test)&lt;br/&gt;
+      (cd lang/java; mvn -B test -P interop-data-test)&lt;br/&gt;
       (cd lang/py; ant interop-data-test)&lt;br/&gt;
       (cd lang/c; ./build.sh interop-data-test)&lt;br/&gt;
       #(cd lang/c++; make interop-data-test)&lt;br/&gt;
@@ -70,9 +72,10 @@ do&lt;br/&gt;
       (cd lang/php; ./build.sh test-interop)&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;java needs to package the jars for the interop rpc tests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(cd lang/java; mvn package -DskipTests)&lt;br/&gt;
+      (cd lang/java; mvn -B package -DskipTests)&lt;br/&gt;
+&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
	&lt;li&gt;run interop rpc test&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/bin/bash share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
+      ./share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
     ;;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     dist)&lt;br/&gt;
@@ -165,7 +168,7 @@ do&lt;br/&gt;
       rm -rf build dist&lt;br/&gt;
       (cd doc; ant clean)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;(mvn clean)&lt;br/&gt;
+      (mvn -B clean)&lt;br/&gt;
       rm -rf lang/java/*/userlogs/&lt;br/&gt;
       rm -rf lang/java/*/dependency-reduced-pom.xml&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/avro/pom.xml b/lang/java/avro/pom.xml&lt;br/&gt;
index 9d6ee2ee1..817bb3aa0 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/pom.xml&lt;br/&gt;
+++ b/lang/java/avro/pom.xml&lt;br/&gt;
@@ -194,4 +194,3 @@&lt;br/&gt;
   &amp;lt;/dependencies&amp;gt;&lt;/p&gt;

&lt;p&gt; &amp;lt;/project&amp;gt;&lt;br/&gt;
-&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/AvroTestUtil.java b/lang/java/avro/src/test/java/org/apache/avro/AvroTestUtil.java&lt;br/&gt;
deleted file mode 100644&lt;br/&gt;
index bf4b2cbd9..000000000&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/AvroTestUtil.java&lt;br/&gt;
+++ /dev/null&lt;br/&gt;
@@ -1,54 +0,0 @@&lt;br/&gt;
-/*&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* Licensed to the Apache Software Foundation (ASF) under one&lt;/li&gt;
	&lt;li&gt;* or more contributor license agreements.  See the NOTICE file&lt;/li&gt;
	&lt;li&gt;* distributed with this work for additional information&lt;/li&gt;
	&lt;li&gt;* regarding copyright ownership.  The ASF licenses this file&lt;/li&gt;
	&lt;li&gt;* to you under the Apache License, Version 2.0 (the&lt;/li&gt;
	&lt;li&gt;* &quot;License&quot;); you may not use this file except in compliance&lt;/li&gt;
	&lt;li&gt;* with the License.  You may obtain a copy of the License at&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;*     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;* Unless required by applicable law or agreed to in writing, software&lt;/li&gt;
	&lt;li&gt;* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;/li&gt;
	&lt;li&gt;* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;/li&gt;
	&lt;li&gt;* See the License for the specific language governing permissions and&lt;/li&gt;
	&lt;li&gt;* limitations under the License.&lt;/li&gt;
	&lt;li&gt;*/&lt;br/&gt;
-package org.apache.avro;&lt;br/&gt;
-&lt;br/&gt;
-import java.io.File;&lt;br/&gt;
-&lt;br/&gt;
-/** Utilities for Avro tests. */&lt;br/&gt;
-public class AvroTestUtil {&lt;/li&gt;
	&lt;li&gt;static final File TMPDIR = new File(System.getProperty(&quot;test.dir&quot;, System.getProperty(&quot;java.io.tmpdir&quot;, &quot;/tmp&quot;)), &quot;tmpfiles&quot;);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;private AvroTestUtil() 
{
-  }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;/**&lt;/li&gt;
	&lt;li&gt;* Create a temporary file in a test-appropriate directory.&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;* @param testClass The test case class requesting the file creation&lt;/li&gt;
	&lt;li&gt;* @param name The name of the file to be created&lt;/li&gt;
	&lt;li&gt;*/&lt;/li&gt;
	&lt;li&gt;public static File tempFile(Class testClass, String name) 
{
-    File testClassDir = new File(TMPDIR, testClass.getName());
-    testClassDir.mkdirs();
-    return new File(testClassDir, name);
-  }
&lt;p&gt;-&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;/**&lt;/li&gt;
	&lt;li&gt;* Create a temporary directory in a test-appropriate directory.&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;* @param testClass The test case class requesting the directory creation&lt;/li&gt;
	&lt;li&gt;* @param name The name of the directory to be created&lt;/li&gt;
	&lt;li&gt;*/&lt;/li&gt;
	&lt;li&gt;public static File tempDirectory(Class testClass, String name) 
{
-    File tmpFile = tempFile(testClass, name);
-    tmpFile.delete();
-    tmpFile.mkdir();
-    return tmpFile;
-  }
&lt;p&gt;-&lt;br/&gt;
-}&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/FooBarSpecificRecord.java b/lang/java/avro/src/test/java/org/apache/avro/FooBarSpecificRecord.java&lt;br/&gt;
index e2737864c..6e4870295 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/avro/src/test/java/org/apache/avro/FooBarSpecificRecord.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/FooBarSpecificRecord.java&lt;br/&gt;
@@ -21,10 +21,10 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import org.apache.avro.specific.SpecificData;&lt;br/&gt;
-import org.apache.avro.message.BinaryMessageEncoder;&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageDecoder;&lt;br/&gt;
+import org.apache.avro.message.BinaryMessageEncoder;&lt;br/&gt;
 import org.apache.avro.message.SchemaStore;&lt;br/&gt;
+import org.apache.avro.specific.SpecificData;&lt;/p&gt;

&lt;p&gt; @org.apache.avro.specific.AvroGenerated&lt;br/&gt;
 public class FooBarSpecificRecord extends org.apache.avro.specific.SpecificRecordBase implements org.apache.avro.specific.SpecificRecord {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/GenerateBlockingData.java b/lang/java/avro/src/test/java/org/apache/avro/GenerateBlockingData.java&lt;br/&gt;
index 75484fbe6..d5440c2a4 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/GenerateBlockingData.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/GenerateBlockingData.java&lt;br/&gt;
@@ -17,16 +17,16 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
-import org.apache.avro.io.DatumWriter;&lt;br/&gt;
-import org.apache.avro.io.Encoder;&lt;br/&gt;
-import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
-&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.FileOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;/p&gt;

&lt;p&gt;+import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
+import org.apache.avro.io.DatumWriter;&lt;br/&gt;
+import org.apache.avro.io.Encoder;&lt;br/&gt;
+import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
+&lt;br/&gt;
 /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Generates file with objects of a specific schema(that doesn&apos;t contain nesting&lt;/li&gt;
	&lt;li&gt;of arrays and maps) with random data. This is only for testing.&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/RandomData.java b/lang/java/avro/src/test/java/org/apache/avro/RandomData.java&lt;br/&gt;
index e250b6c11..89a4321d6 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/avro/src/test/java/org/apache/avro/RandomData.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/RandomData.java&lt;br/&gt;
@@ -19,11 +19,7 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import java.io.File;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.Iterator;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
-import java.util.Random;&lt;br/&gt;
+import java.util.*;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.file.CodecFactory;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestCircularReferences.java b/lang/java/avro/src/test/java/org/apache/avro/TestCircularReferences.java&lt;br/&gt;
index cdfd1a563..7acec0830 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestCircularReferences.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestCircularReferences.java&lt;br/&gt;
@@ -21,6 +21,7 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.util.*;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.file.FileReader;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFile.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFile.java&lt;br/&gt;
index 64e673009..6e2398dff 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestDataFile.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFile.java&lt;br/&gt;
@@ -28,19 +28,14 @@&lt;br/&gt;
 import java.util.Random;&lt;/p&gt;

&lt;p&gt; import junit.framework.Assert;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.file.CodecFactory;&lt;br/&gt;
-import org.apache.avro.file.FileReader;&lt;br/&gt;
-import org.apache.avro.file.DataFileReader;&lt;br/&gt;
-import org.apache.avro.file.DataFileStream;&lt;br/&gt;
-import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
-import org.apache.avro.file.SeekableFileInput;&lt;br/&gt;
-import org.apache.avro.file.Syncable;&lt;br/&gt;
+import org.apache.avro.file.*;&lt;br/&gt;
 import org.apache.avro.generic.GenericData;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.io.DatumReader;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.Parameterized;&lt;br/&gt;
 import org.junit.runners.Parameterized.Parameters;&lt;br/&gt;
@@ -52,7 +47,10 @@&lt;br/&gt;
   private static final Logger LOG =&lt;br/&gt;
     LoggerFactory.getLogger(TestDataFile.class);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CodecFactory codec = null;&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  private final CodecFactory codec;&lt;br/&gt;
   public TestDataFile(CodecFactory codec) {&lt;br/&gt;
     this.codec = codec;&lt;br/&gt;
     LOG.info(&quot;Running with codec: &quot; + codec);&lt;br/&gt;
@@ -78,8 +76,8 @@ public TestDataFile(CodecFactory codec) {&lt;br/&gt;
     Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;200&quot;));&lt;br/&gt;
   private static final boolean VALIDATE =&lt;br/&gt;
     !&quot;false&quot;.equals(System.getProperty(&quot;test.validate&quot;, &quot;true&quot;));&lt;/li&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
   private static final long SEED = System.currentTimeMillis();&lt;br/&gt;
   private static final String SCHEMA_JSON =&lt;br/&gt;
     &quot;{\&quot;type\&quot;: \&quot;record\&quot;, \&quot;name\&quot;: \&quot;Test\&quot;, \&quot;fields\&quot;: [&quot;&lt;br/&gt;
@@ -88,7 +86,7 @@ public TestDataFile(CodecFactory codec) {&lt;br/&gt;
   private static final Schema SCHEMA = new Schema.Parser().parse(SCHEMA_JSON);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private File makeFile() &lt;/p&gt;
{
-    return new File(DIR, &quot;test-&quot; + codec + &quot;.avro&quot;);
+    return new File(DIR.getRoot().getPath(), &quot;test-&quot; + codec + &quot;.avro&quot;);
   }

&lt;p&gt;   @Test public void runTestsInOrder() throws Exception {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileConcat.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileConcat.java&lt;br/&gt;
index 56b2bf4f0..dfb68fa36 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileConcat.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileConcat.java&lt;br/&gt;
@@ -17,7 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.*;&lt;br/&gt;
+import static org.junit.Assert.assertEquals;&lt;/p&gt;

&lt;p&gt; import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
@@ -29,7 +29,9 @@&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.Parameterized;&lt;br/&gt;
 import org.junit.runners.Parameterized.Parameters;&lt;br/&gt;
@@ -41,8 +43,11 @@&lt;br/&gt;
   private static final Logger LOG =&lt;br/&gt;
     LoggerFactory.getLogger(TestDataFileConcat.class);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CodecFactory codec = null;&lt;/li&gt;
	&lt;li&gt;CodecFactory codec2 = null;&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  CodecFactory codec;&lt;br/&gt;
+  CodecFactory codec2;&lt;br/&gt;
   boolean recompress;&lt;br/&gt;
   public TestDataFileConcat(CodecFactory codec, CodecFactory codec2, Boolean recompress) {&lt;br/&gt;
     this.codec = codec;&lt;br/&gt;
@@ -80,8 +85,7 @@ public TestDataFileConcat(CodecFactory codec, CodecFactory codec2, Boolean recom&lt;br/&gt;
     Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;200&quot;));&lt;br/&gt;
   private static final boolean VALIDATE =&lt;br/&gt;
     !&quot;false&quot;.equals(System.getProperty(&quot;test.validate&quot;, &quot;true&quot;));&lt;/li&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+&lt;br/&gt;
   private static final long SEED = System.currentTimeMillis();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static final String SCHEMA_JSON =&lt;br/&gt;
@@ -93,7 +97,7 @@ public TestDataFileConcat(CodecFactory codec, CodecFactory codec2, Boolean recom&lt;br/&gt;
   private static final Schema SCHEMA = new Schema.Parser().parse(SCHEMA_JSON);&lt;/p&gt;

&lt;p&gt;   private File makeFile(String name) &lt;/p&gt;
{
-    return new File(DIR, &quot;test-&quot; + name + &quot;.avro&quot;);
+    return new File(DIR.getRoot().getPath(), &quot;test-&quot; + name + &quot;.avro&quot;);
   }

&lt;p&gt;   @Test&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCorruption.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCorruption.java&lt;br/&gt;
index 40c2dd66c..60689e19c 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCorruption.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCorruption.java&lt;br/&gt;
@@ -17,10 +17,13 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.FileOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileConstants;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
@@ -30,14 +33,9 @@&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
-&lt;br/&gt;
 public class TestDataFileCorruption {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+  private static final File DIR = new File( &quot;/tmp&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private File makeFile(String name) {&lt;br/&gt;
     return new File(DIR, &quot;test-&quot; + name + &quot;.avro&quot;);&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCustomSync.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCustomSync.java&lt;br/&gt;
index d9f564d74..81d6d8617 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCustomSync.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileCustomSync.java&lt;br/&gt;
@@ -17,21 +17,22 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.assertFalse;&lt;br/&gt;
+import static org.junit.Assert.assertTrue;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.security.MessageDigest;&lt;br/&gt;
 import java.security.NoSuchAlgorithmException;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.UUID;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-&lt;br/&gt;
 public class TestDataFileCustomSync {&lt;br/&gt;
   private byte[] createDataFile(byte[] sync) throws IOException {&lt;br/&gt;
     Schema schema = Schema.create(Type.STRING);&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileMeta.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileMeta.java&lt;br/&gt;
index d927f00f1..bebf85030 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileMeta.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileMeta.java&lt;br/&gt;
@@ -26,15 +26,20 @@&lt;br/&gt;
 import java.io.IOException;&lt;/p&gt;

&lt;p&gt; import junit.framework.Assert;&lt;br/&gt;
-&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileStream;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestDataFileMeta {&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   @Test(expected=AvroRuntimeException.class)&lt;br/&gt;
   public void testUseReservedMeta() {&lt;br/&gt;
     DataFileWriter&amp;lt;?&amp;gt; w = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;());&lt;br/&gt;
@@ -44,7 +49,7 @@ public void testUseReservedMeta() {&lt;br/&gt;
   @Test()&lt;br/&gt;
   public void testUseMeta() throws IOException {&lt;br/&gt;
     DataFileWriter&amp;lt;?&amp;gt; w = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File f = AvroTestUtil.tempFile(getClass(), &quot;testDataFileMeta.avro&quot;);&lt;br/&gt;
+    File f = new File(DIR.getRoot().getPath(), &quot;testDataFileMeta.avro&quot;);&lt;br/&gt;
     w.setMeta(&quot;hello&quot;, &quot;bar&quot;);&lt;br/&gt;
     w.create(Schema.create(Type.NULL), f);&lt;br/&gt;
     w.close();&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileReflect.java b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileReflect.java&lt;br/&gt;
index 2739807bb..a21f76fcc 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/avro/src/test/java/org/apache/avro/TestDataFileReflect.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestDataFileReflect.java&lt;br/&gt;
@@ -31,13 +31,14 @@&lt;br/&gt;
 import org.apache.avro.reflect.ReflectDatumReader;&lt;br/&gt;
 import org.apache.avro.reflect.ReflectDatumWriter;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; public class TestDataFileReflect {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR = new File(System.getProperty(&quot;test.dir&quot;,&lt;/li&gt;
	&lt;li&gt;&quot;/tmp&quot;));&lt;/li&gt;
	&lt;li&gt;private static final File FILE = new File(DIR, &quot;test.avro&quot;);&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /*&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test that using multiple schemas in a file works doing a union before&lt;br/&gt;
@@ -45,33 +46,37 @@&lt;br/&gt;
    */&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testMultiReflectWithUnionBeforeWriting() throws IOException {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FileOutputStream fos = new FileOutputStream(FILE);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;ReflectData reflectData = ReflectData.get();&lt;/li&gt;
	&lt;li&gt;List&amp;lt;Schema&amp;gt; schemas = Arrays.asList(new Schema[] 
{
-        reflectData.getSchema(FooRecord.class),
-        reflectData.getSchema(BarRecord.class) }
&lt;p&gt;);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;Schema union = Schema.createUnion(schemas);&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Object&amp;gt; writer =&lt;/li&gt;
	&lt;li&gt;new DataFileWriter&amp;lt;&amp;gt;(new ReflectDatumWriter&amp;lt;&amp;gt;(union))&lt;/li&gt;
	&lt;li&gt;.create(union, fos);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;// test writing to a file&lt;br/&gt;
+    File file = new File(DIR.getRoot().getPath(), &quot;testMultiReflectWithUnionBeforeWriting.avro&quot;);&lt;br/&gt;
     CheckList&amp;lt;Object&amp;gt; check = new CheckList&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;write(writer, new BarRecord(&quot;One beer please&quot;), check);&lt;/li&gt;
	&lt;li&gt;write(writer, new FooRecord(10), check);&lt;/li&gt;
	&lt;li&gt;write(writer, new BarRecord(&quot;Two beers please&quot;), check);&lt;/li&gt;
	&lt;li&gt;write(writer, new FooRecord(20), check);&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
-&lt;br/&gt;
+    try(FileOutputStream fos = new FileOutputStream(file)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {++      ReflectData reflectData = ReflectData.get();+      List&amp;lt;Schema&amp;gt; schemas = Arrays.asList(+              reflectData.getSchema(FooRecord.class),+              reflectData.getSchema(BarRecord.class)+      );+      Schema union = Schema.createUnion(schemas);++      try (DataFileWriter&amp;lt;Object&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(new ReflectDatumWriter&amp;lt;&amp;gt;(union))) {
+        writer.create(union, fos);
+
+        // test writing to a file
+        write(writer, new BarRecord(&quot;One beer please&quot;), check);
+        write(writer, new FooRecord(10), check);
+        write(writer, new BarRecord(&quot;Two beers please&quot;), check);
+        write(writer, new FooRecord(20), check);
+      }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+    //new File(DIR.getRoot().getPath(), &quot;test.avro&quot;);&lt;br/&gt;
     ReflectDatumReader&amp;lt;Object&amp;gt; din = new ReflectDatumReader&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;SeekableFileInput sin = new SeekableFileInput(FILE);&lt;/li&gt;
	&lt;li&gt;DataFileReader&amp;lt;Object&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(sin, din);&lt;/li&gt;
	&lt;li&gt;int count = 0;&lt;/li&gt;
	&lt;li&gt;for (Object datum : reader)&lt;/li&gt;
	&lt;li&gt;check.assertEquals(datum, count++);&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(count, check.size());&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
+    SeekableFileInput sin = new SeekableFileInput(file);&lt;br/&gt;
+    try(DataFileReader&amp;lt;Object&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(sin, din)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      int count = 0;+      for (Object datum }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /*&lt;br/&gt;
@@ -79,30 +84,32 @@ public void testMultiReflectWithUnionBeforeWriting() throws IOException {&lt;br/&gt;
    */&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testNull() throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FileOutputStream fos = new FileOutputStream(FILE);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;ReflectData reflectData = ReflectData.AllowNull.get();&lt;/li&gt;
	&lt;li&gt;Schema schema = reflectData.getSchema(BarRecord.class);&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;BarRecord&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;&lt;/li&gt;
	&lt;li&gt;(new ReflectDatumWriter&amp;lt;&amp;gt;(BarRecord.class, reflectData))&lt;/li&gt;
	&lt;li&gt;.create(schema, fos);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;// test writing to a file&lt;br/&gt;
+    File file = new File(DIR.getRoot().getPath(), &quot;testNull.avro&quot;);&lt;br/&gt;
     CheckList&amp;lt;BarRecord&amp;gt; check = new CheckList&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;write(writer, new BarRecord(&quot;One beer please&quot;), check);&lt;/li&gt;
	&lt;li&gt;// null record here, fails when using the default reflectData instance&lt;/li&gt;
	&lt;li&gt;write(writer, new BarRecord(), check);&lt;/li&gt;
	&lt;li&gt;write(writer, new BarRecord(&quot;Two beers please&quot;), check);&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
+&lt;br/&gt;
+    try(FileOutputStream fos = new FileOutputStream(file)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      ReflectData reflectData = ReflectData.AllowNull.get();+      Schema schema = reflectData.getSchema(BarRecord.class);+      try(DataFileWriter&amp;lt;BarRecord&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(new ReflectDatumWriter&amp;lt;&amp;gt;(BarRecord.class, reflectData))) {
+        writer.create(schema, fos);
+        // test writing to a file
+        write(writer, new BarRecord(&quot;One beer please&quot;), check);
+        // null record here, fails when using the default reflectData instance
+        write(writer, new BarRecord(), check);
+        write(writer, new BarRecord(&quot;Two beers please&quot;), check);
+      }+    }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     ReflectDatumReader&amp;lt;BarRecord&amp;gt; din = new ReflectDatumReader&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;SeekableFileInput sin = new SeekableFileInput(FILE);&lt;/li&gt;
	&lt;li&gt;DataFileReader&amp;lt;BarRecord&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(sin, din);&lt;/li&gt;
	&lt;li&gt;int count = 0;&lt;/li&gt;
	&lt;li&gt;for (BarRecord datum : reader)&lt;/li&gt;
	&lt;li&gt;check.assertEquals(datum, count++);&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(count, check.size());&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
+    try(SeekableFileInput sin = new SeekableFileInput(file)) {&lt;br/&gt;
+      try (DataFileReader&amp;lt;BarRecord&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(sin, din)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        int count = 0;+        for (BarRecord datum }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+    }&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private &amp;lt;T&amp;gt; void write(DataFileWriter&amp;lt;T&amp;gt; writer, T o, CheckList&amp;lt;T&amp;gt; l)&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestLogicalType.java b/lang/java/avro/src/test/java/org/apache/avro/TestLogicalType.java&lt;br/&gt;
index 2fb9c67d6..ec143b980 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestLogicalType.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestLogicalType.java&lt;br/&gt;
@@ -20,6 +20,7 @@&lt;/p&gt;

&lt;p&gt; import java.util.Arrays;&lt;br/&gt;
 import java.util.concurrent.Callable;&lt;br/&gt;
+&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestProtocol.java b/lang/java/avro/src/test/java/org/apache/avro/TestProtocol.java&lt;br/&gt;
index 4109f6a9c..d28c10d08 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestProtocol.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestProtocol.java&lt;br/&gt;
@@ -17,9 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.assertNotNull;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import org.junit.Test;&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestReadingWritingDataInEvolvedSchemas.java b/lang/java/avro/src/test/java/org/apache/avro/TestReadingWritingDataInEvolvedSchemas.java&lt;br/&gt;
index 85a3ca705..d7c0fcbae 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestReadingWritingDataInEvolvedSchemas.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestReadingWritingDataInEvolvedSchemas.java&lt;br/&gt;
@@ -17,9 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertArrayEquals;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertNull;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
@@ -31,11 +29,7 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
-import org.apache.avro.io.DatumWriter;&lt;br/&gt;
-import org.apache.avro.io.Decoder;&lt;br/&gt;
-import org.apache.avro.io.DecoderFactory;&lt;br/&gt;
-import org.apache.avro.io.Encoder;&lt;br/&gt;
-import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
+import org.apache.avro.io.*;&lt;br/&gt;
 import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.rules.ExpectedException;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchema.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
index 25858b5f9..0ca1437d7 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
@@ -17,10 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertNotNull;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaBuilder.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaBuilder.java&lt;br/&gt;
index bb0b0554a..fa6370c95 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaBuilder.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaBuilder.java&lt;br/&gt;
@@ -20,14 +20,9 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.Iterator;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
+import java.util.*;&lt;/p&gt;

&lt;p&gt;+import com.fasterxml.jackson.databind.node.NullNode;&lt;br/&gt;
 import org.apache.avro.Schema.Field.Order;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
@@ -36,14 +31,14 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericRecordBuilder;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
-&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.NullNode;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestSchemaBuilder {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR = new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;/li&gt;
	&lt;li&gt;private static final File FILE = new File(DIR, &quot;test.avro&quot;);&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testRecord() {&lt;br/&gt;
@@ -985,12 +980,14 @@ public void testDefaults() throws IOException {&lt;br/&gt;
     Assert.assertEquals(13, rec2.get(&quot;nullableIntWithDefault&quot;));&lt;/p&gt;

&lt;p&gt;     // write to file&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Object&amp;gt; writer =&lt;/li&gt;
	&lt;li&gt;new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;());&lt;/li&gt;
	&lt;li&gt;writer.create(writeSchema, FILE);&lt;/li&gt;
	&lt;li&gt;writer.append(rec1);&lt;/li&gt;
	&lt;li&gt;writer.append(rec2);&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
+&lt;br/&gt;
+    File file = new File(DIR.getRoot().getPath(), &quot;testDefaults.avro&quot;);&lt;br/&gt;
+&lt;br/&gt;
+    try(DataFileWriter&amp;lt;Object&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;())) 
{
+      writer.create(writeSchema, file);
+      writer.append(rec1);
+      writer.append(rec2);
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Schema readSchema = SchemaBuilder.record(&quot;r&quot;).fields()&lt;br/&gt;
         .name(&quot;requiredInt&quot;).type().intType().noDefault()&lt;br/&gt;
@@ -1001,21 +998,21 @@ public void testDefaults() throws IOException &lt;/p&gt;
{
         .endRecord();
 
     DataFileReader&amp;lt;GenericData.Record&amp;gt; reader =
-        new DataFileReader&amp;lt;&amp;gt;(FILE,
+        new DataFileReader&amp;lt;&amp;gt;(file,
             new GenericDatumReader&amp;lt;&amp;gt;(writeSchema, readSchema));
 
     GenericData.Record rec1read = reader.iterator().next();
     Assert.assertEquals(1, rec1read.get(&quot;requiredInt&quot;));
-    Assert.assertEquals(null, rec1read.get(&quot;optionalInt&quot;));
+    Assert.assertNull(rec1read.get(&quot;optionalInt&quot;));
     Assert.assertEquals(3, rec1read.get(&quot;nullableIntWithDefault&quot;));
-    Assert.assertEquals(null, rec1read.get(&quot;newOptionalInt&quot;));
+    Assert.assertNull(rec1read.get(&quot;newOptionalInt&quot;));
     Assert.assertEquals(5, rec1read.get(&quot;newNullableIntWithDefault&quot;));
 
     GenericData.Record rec2read = reader.iterator().next();
     Assert.assertEquals(1, rec2read.get(&quot;requiredInt&quot;));
     Assert.assertEquals(2, rec2read.get(&quot;optionalInt&quot;));
     Assert.assertEquals(13, rec2read.get(&quot;nullableIntWithDefault&quot;));
-    Assert.assertEquals(null, rec2read.get(&quot;newOptionalInt&quot;));
+    Assert.assertNull(rec2read.get(&quot;newOptionalInt&quot;));
     Assert.assertEquals(5, rec2read.get(&quot;newNullableIntWithDefault&quot;));
   }

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibility.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibility.java&lt;br/&gt;
index 05726e989..4953a10c9 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibility.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibility.java&lt;br/&gt;
@@ -18,79 +18,19 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static java.util.Arrays.asList;&lt;br/&gt;
-import static org.apache.avro.SchemaCompatibility.checkReaderWriterCompatibility;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_B_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_B_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_LONG_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BOOLEAN_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_ABC_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_BC_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_AB_FIELD_DEFAULT_A_ENUM_DEFAULT_B_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_ABC_FIELD_DEFAULT_B_ENUM_DEFAULT_A_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_AB_ENUM_DEFAULT_A_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_ABC_ENUM_DEFAULT_A_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_AB_ENUM_DEFAULT_A_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM_ABC_ENUM_DEFAULT_A_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_4_BYTES;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_FLOAT_DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.NULL_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_INT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.assertSchemaContains;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.list;&lt;br/&gt;
+import static org.apache.avro.SchemaCompatibility.*;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
 import static org.junit.Assert.assertEquals;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayOutputStream;&lt;br/&gt;
-import java.util.ArrayDeque;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
-import java.util.Collections;&lt;br/&gt;
-import java.util.Deque;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.SchemaCompatibility.Incompatibility;&lt;br/&gt;
-import org.apache.avro.SchemaCompatibility.SchemaCompatibilityResult;&lt;br/&gt;
-import org.apache.avro.SchemaCompatibility.SchemaCompatibilityType;&lt;br/&gt;
-import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
-import org.apache.avro.SchemaCompatibility.SchemaPairCompatibility;&lt;br/&gt;
+import java.util.*;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.SchemaCompatibility.*;&lt;br/&gt;
 import org.apache.avro.TestSchemas.ReaderWriter;&lt;br/&gt;
-import org.apache.avro.generic.GenericData;&lt;br/&gt;
 import org.apache.avro.generic.GenericData.EnumSymbol;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
-import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
-import org.apache.avro.io.DatumReader;&lt;br/&gt;
-import org.apache.avro.io.DatumWriter;&lt;br/&gt;
-import org.apache.avro.io.Decoder;&lt;br/&gt;
-import org.apache.avro.io.DecoderFactory;&lt;br/&gt;
-import org.apache.avro.io.Encoder;&lt;br/&gt;
-import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
+import org.apache.avro.io.*;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.slf4j.Logger;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityEnumDefaults.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityEnumDefaults.java&lt;br/&gt;
index 159733ac7..f85f3979a 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityEnumDefaults.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityEnumDefaults.java&lt;br/&gt;
@@ -17,27 +17,19 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+import static org.junit.Assert.assertEquals;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.ByteArrayOutputStream;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.generic.GenericData;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
-import org.apache.avro.io.DatumReader;&lt;br/&gt;
-import org.apache.avro.io.DatumWriter;&lt;br/&gt;
-import org.apache.avro.io.Decoder;&lt;br/&gt;
-import org.apache.avro.io.DecoderFactory;&lt;br/&gt;
-import org.apache.avro.io.Encoder;&lt;br/&gt;
-import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
+import org.apache.avro.io.*;&lt;br/&gt;
 import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.rules.ExpectedException;&lt;br/&gt;
-import org.junit.runner.RunWith;&lt;br/&gt;
-import org.junit.runners.Parameterized;&lt;br/&gt;
-&lt;br/&gt;
-import java.io.ByteArrayOutputStream;&lt;br/&gt;
-&lt;br/&gt;
-import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;/p&gt;

&lt;p&gt; public class TestSchemaCompatibilityEnumDefaults {&lt;br/&gt;
   @Rule&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityFixedSizeMismatch.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityFixedSizeMismatch.java&lt;br/&gt;
index 48657e8d6..3e220866c 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityFixedSizeMismatch.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityFixedSizeMismatch.java&lt;br/&gt;
@@ -18,12 +18,11 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DFIXED_4_BYTES_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DFIXED_8_BYTES_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_4_BYTES;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_8_BYTES;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingEnumSymbols.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingEnumSymbols.java&lt;br/&gt;
index 9b1b606f8..02ddb18f4 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingEnumSymbols.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingEnumSymbols.java&lt;br/&gt;
@@ -18,11 +18,11 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_ABC_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_BC_SCHEMA;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingUnionBranch.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingUnionBranch.java&lt;br/&gt;
index 9075c9ecf..87e7cdf7f 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingUnionBranch.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityMissingUnionBranch.java&lt;br/&gt;
@@ -19,27 +19,12 @@&lt;/p&gt;

&lt;p&gt; import static java.util.Arrays.asList;&lt;br/&gt;
 import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DINT_STRING_UNION_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DINT_UNION_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BOOLEAN_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_4_BYTES;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_FLOAT_DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.NULL_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.list;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityNameMismatch.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityNameMismatch.java&lt;br/&gt;
index ed55ff224..961192e4b 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityNameMismatch.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityNameMismatch.java&lt;br/&gt;
@@ -18,15 +18,11 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DENUM_1_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_B_DENUM_2_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD2;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM2_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_4_BYTES;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityReaderFieldMissingDefaultValue.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityReaderFieldMissingDefaultValue.java&lt;br/&gt;
index 71a8dcb33..3c61ee165 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityReaderFieldMissingDefaultValue.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityReaderFieldMissingDefaultValue.java&lt;br/&gt;
@@ -18,11 +18,11 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_B_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD1;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityTypeMismatch.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityTypeMismatch.java&lt;br/&gt;
index 844e4cde6..0cc4cb2e6 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityTypeMismatch.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaCompatibilityTypeMismatch.java&lt;br/&gt;
@@ -18,27 +18,11 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.apache.avro.TestSchemaCompatibility.validateIncompatibleSchemas;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BOOLEAN_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM2_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FIXED_4_BYTES;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_FLOAT_DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.NULL_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_SCHEMA;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.SchemaCompatibility.SchemaIncompatibilityType;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaNormalization.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaNormalization.java&lt;br/&gt;
index 1459b633f..063e0b6e1 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaNormalization.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaNormalization.java&lt;br/&gt;
@@ -17,23 +17,23 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.assertEquals;&lt;br/&gt;
+import static org.junit.Assert.assertTrue;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.BufferedReader;&lt;br/&gt;
 import java.io.FileReader;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Formatter;&lt;br/&gt;
+import java.util.List;&lt;br/&gt;
 import java.util.Locale;&lt;/p&gt;

&lt;p&gt;+import org.apache.avro.util.CaseFinder;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.experimental.runners.Enclosed;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.Parameterized;&lt;br/&gt;
 import org.junit.runners.Parameterized.Parameters;&lt;br/&gt;
-import org.junit.experimental.runners.Enclosed;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.util.CaseFinder;&lt;/p&gt;


&lt;p&gt; @RunWith(Enclosed.class)&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaValidation.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaValidation.java&lt;br/&gt;
index fc933c9eb..1ede75721 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemaValidation.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemaValidation.java&lt;br/&gt;
@@ -17,50 +17,14 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt;-import static org.apache.avro.TestSchemas.A_DINT_B_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_B_DINT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_B_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_INT_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.A_LONG_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BOOLEAN_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.BYTES_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD1;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_RECORD2;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.EMPTY_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_ABC_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM1_BC_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.ENUM2_AB_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_FLOAT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_FLOAT_DOUBLE_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_LONG_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.INT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_ARRAY_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_LIST_RECORD;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_MAP_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.LONG_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.NULL_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_INT_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.STRING_UNION_SCHEMA;&lt;br/&gt;
-import static org.apache.avro.TestSchemas.list;&lt;br/&gt;
+import static org.apache.avro.TestSchemas.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
-import org.apache.avro.TestSchemas.ReaderWriter;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.TestSchemas.*;&lt;br/&gt;
 import org.apache.avro.reflect.ReflectData;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Rule;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java b/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
index 466f1fd63..94a48a6e9 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/TestSchemas.java&lt;br/&gt;
@@ -18,10 +18,9 @@&lt;br/&gt;
 package org.apache.avro;&lt;/p&gt;

&lt;p&gt; import static org.junit.Assert.assertTrue;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
-import java.util.List;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.Schema.Field;&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/data/TestJsr310TimeConversions.java b/lang/java/avro/src/test/java/org/apache/avro/data/TestJsr310TimeConversions.java&lt;br/&gt;
index caf699e7d..ba9e9baa6 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/data/TestJsr310TimeConversions.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/data/TestJsr310TimeConversions.java&lt;br/&gt;
@@ -18,23 +18,15 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.data;&lt;/p&gt;

&lt;p&gt;+import java.time.*;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.LogicalTypes;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.data.Jsr310TimeConversions.DateConversion;&lt;br/&gt;
-import org.apache.avro.data.Jsr310TimeConversions.TimeMillisConversion;&lt;br/&gt;
-import org.apache.avro.data.Jsr310TimeConversions.TimeMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.Jsr310TimeConversions.TimestampMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.Jsr310TimeConversions.TimestampMillisConversion;&lt;br/&gt;
+import org.apache.avro.data.Jsr310TimeConversions.*;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.BeforeClass;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import java.time.Instant;&lt;br/&gt;
-import java.time.LocalDate;&lt;br/&gt;
-import java.time.LocalTime;&lt;br/&gt;
-import java.time.ZonedDateTime;&lt;br/&gt;
-import java.time.ZoneOffset;&lt;br/&gt;
-&lt;br/&gt;
 public class TestJsr310TimeConversions {&lt;/p&gt;

&lt;p&gt;   public static Schema DATE_SCHEMA;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/data/TestTimeConversions.java b/lang/java/avro/src/test/java/org/apache/avro/data/TestTimeConversions.java&lt;br/&gt;
index 7ea44a5df..536e9ce23 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/data/TestTimeConversions.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/data/TestTimeConversions.java&lt;br/&gt;
@@ -18,16 +18,12 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.data;&lt;/p&gt;

&lt;p&gt;+import java.util.Date;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Conversion;&lt;br/&gt;
 import org.apache.avro.LogicalTypes;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.DateConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.LossyTimeMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.LossyTimestampMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.TimeMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.TimestampMicrosConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.TimeConversion;&lt;br/&gt;
-import org.apache.avro.data.TimeConversions.TimestampConversion;&lt;br/&gt;
+import org.apache.avro.data.TimeConversions.*;&lt;br/&gt;
 import org.apache.avro.reflect.ReflectData;&lt;br/&gt;
 import org.joda.time.DateTime;&lt;br/&gt;
 import org.joda.time.DateTimeZone;&lt;br/&gt;
@@ -37,8 +33,6 @@&lt;br/&gt;
 import org.junit.BeforeClass;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import java.util.Date;&lt;br/&gt;
-&lt;br/&gt;
 public class TestTimeConversions {&lt;/p&gt;

&lt;p&gt;   public static Schema DATE_SCHEMA;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/file/TestBZip2Codec.java b/lang/java/avro/src/test/java/org/apache/avro/file/TestBZip2Codec.java&lt;br/&gt;
index 3e5e81832..dfa95afa1 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/file/TestBZip2Codec.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/file/TestBZip2Codec.java&lt;br/&gt;
@@ -17,11 +17,12 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.file;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.assertTrue;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;/p&gt;

&lt;p&gt; import org.junit.Test;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;/p&gt;

&lt;p&gt; public class TestBZip2Codec {&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/file/TestCustomCodec.java b/lang/java/avro/src/test/java/org/apache/avro/file/TestCustomCodec.java&lt;br/&gt;
index e5f68117f..77c01ad5a 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/file/TestCustomCodec.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/file/TestCustomCodec.java&lt;br/&gt;
@@ -19,15 +19,13 @@&lt;br/&gt;
 package org.apache.avro.file;&lt;/p&gt;


&lt;p&gt;-import org.apache.avro.file.codec.CustomCodec;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.IOException;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
+import org.apache.avro.file.codec.CustomCodec;&lt;br/&gt;
+import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public class TestCustomCodec {&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/file/codec/CustomCodec.java b/lang/java/avro/src/test/java/org/apache/avro/file/codec/CustomCodec.java&lt;br/&gt;
index dfcc5fbd2..2a0fbf1e2 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/file/codec/CustomCodec.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/file/codec/CustomCodec.java&lt;br/&gt;
@@ -18,10 +18,10 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.file.codec;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.file.Codec;&lt;br/&gt;
-&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.nio.*;&lt;br/&gt;
+import java.nio.ByteBuffer;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.file.Codec;&lt;/p&gt;

&lt;p&gt; /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Simple Custom Codec to validate making Codec Public&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericData.java b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericData.java&lt;br/&gt;
index 8bc160e15..ac896a0f9 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericData.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericData.java&lt;br/&gt;
@@ -17,38 +17,30 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.generic;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import java.io.ByteArrayOutputStream;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
-import java.util.ArrayDeque;&lt;br/&gt;
-&lt;br/&gt;
 import static org.apache.avro.TestCircularReferences.Reference;&lt;br/&gt;
 import static org.apache.avro.TestCircularReferences.Referenceable;&lt;br/&gt;
 import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt;-import java.util.Arrays;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
+import java.io.ByteArrayOutputStream;&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.nio.ByteBuffer;&lt;br/&gt;
+import java.util.*;&lt;/p&gt;

&lt;p&gt;+import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
+import com.fasterxml.jackson.core.JsonParseException;&lt;br/&gt;
+import com.fasterxml.jackson.core.JsonParser;&lt;br/&gt;
+import com.fasterxml.jackson.databind.ObjectMapper;&lt;br/&gt;
+import org.apache.avro.AvroRuntimeException;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Field;&lt;br/&gt;
-import org.apache.avro.AvroRuntimeException;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.SchemaBuilder;&lt;br/&gt;
 import org.apache.avro.TestCircularReferences.ReferenceManager;&lt;br/&gt;
+import org.apache.avro.generic.GenericData.Record;&lt;br/&gt;
 import org.apache.avro.io.BinaryData;&lt;br/&gt;
 import org.apache.avro.io.BinaryEncoder;&lt;br/&gt;
 import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
-import org.apache.avro.generic.GenericData.Record;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonParseException;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonParser;&lt;br/&gt;
-import com.fasterxml.jackson.databind.ObjectMapper;&lt;br/&gt;
-&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public class TestGenericData {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericDatumWriter.java b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericDatumWriter.java&lt;br/&gt;
index 6734def64..832871a65 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericDatumWriter.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericDatumWriter.java&lt;br/&gt;
@@ -17,9 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.generic;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
@@ -28,21 +26,16 @@&lt;br/&gt;
 import java.util.ConcurrentModificationException;&lt;br/&gt;
 import java.util.HashMap;&lt;br/&gt;
 import java.util.Map;&lt;br/&gt;
-import java.util.concurrent.Callable;&lt;br/&gt;
-import java.util.concurrent.CountDownLatch;&lt;br/&gt;
-import java.util.concurrent.ExecutionException;&lt;br/&gt;
-import java.util.concurrent.ExecutorService;&lt;br/&gt;
-import java.util.concurrent.Executors;&lt;br/&gt;
-import java.util.concurrent.Future;&lt;br/&gt;
+import java.util.concurrent.*;&lt;/p&gt;

&lt;p&gt;+import org.apache.avro.AvroTypeException;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.io.BinaryEncoder;&lt;br/&gt;
 import org.apache.avro.io.DecoderFactory;&lt;br/&gt;
 import org.apache.avro.io.Encoder;&lt;br/&gt;
 import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
-import org.apache.avro.AvroTypeException;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
+import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public class TestGenericDatumWriter {&lt;br/&gt;
   @Test&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericLogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericLogicalTypes.java&lt;br/&gt;
index cfd75d4d8..6cab57709 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericLogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/generic/TestGenericLogicalTypes.java&lt;br/&gt;
@@ -26,11 +26,8 @@&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 import java.util.UUID;&lt;br/&gt;
-import org.apache.avro.Conversion;&lt;br/&gt;
-import org.apache.avro.Conversions;&lt;br/&gt;
-import org.apache.avro.LogicalType;&lt;br/&gt;
-import org.apache.avro.LogicalTypes;&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.*;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.file.FileReader;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestBinaryDecoder.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestBinaryDecoder.java&lt;br/&gt;
index 96e62d7c5..76f4df3dc 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestBinaryDecoder.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestBinaryDecoder.java&lt;br/&gt;
@@ -17,19 +17,15 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt;-import java.io.ByteArrayInputStream;&lt;br/&gt;
-import java.io.ByteArrayOutputStream;&lt;br/&gt;
-import java.io.EOFException;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.io.InputStream;&lt;br/&gt;
+import java.io.*;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collection;&lt;/p&gt;

&lt;p&gt;+import org.apache.avro.AvroRuntimeException;&lt;br/&gt;
 import org.apache.avro.RandomData;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.AvroRuntimeException;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.util.ByteBufferInputStream;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO.java&lt;br/&gt;
index 1e6c886ea..baaba95c3 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO.java&lt;br/&gt;
@@ -17,22 +17,21 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.Stack;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
+import java.util.Collection;&lt;br/&gt;
+import java.util.Stack;&lt;/p&gt;

&lt;p&gt; import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
 import com.fasterxml.jackson.core.JsonParser;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.Parameterized;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;/p&gt;

&lt;p&gt; @RunWith(Parameterized.class)&lt;br/&gt;
 public class TestBlockingIO {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO2.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO2.java&lt;br/&gt;
index 2aaefd4c6..54e03aa45 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO2.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestBlockingIO2.java&lt;br/&gt;
@@ -19,8 +19,8 @@&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
+import java.util.Collection;&lt;/p&gt;

&lt;p&gt; import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestEncoders.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestEncoders.java&lt;br/&gt;
index 1517693e5..f8f440765 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestEncoders.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestEncoders.java&lt;br/&gt;
@@ -17,6 +17,11 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt;+import static java.util.Arrays.asList;&lt;br/&gt;
+import static org.hamcrest.Matchers.equalTo;&lt;br/&gt;
+import static org.hamcrest.Matchers.is;&lt;br/&gt;
+import static org.junit.Assert.assertThat;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.io.OutputStream;&lt;br/&gt;
@@ -25,23 +30,21 @@&lt;br/&gt;
 import java.nio.channels.FileChannel;&lt;br/&gt;
 import java.nio.file.Files;&lt;br/&gt;
 import java.nio.file.Path;&lt;br/&gt;
+import java.nio.file.Paths;&lt;br/&gt;
 import java.nio.file.StandardOpenOption;&lt;/p&gt;

&lt;p&gt;+import com.fasterxml.jackson.core.JsonEncoding;&lt;br/&gt;
+import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
+import com.fasterxml.jackson.core.JsonGenerator;&lt;br/&gt;
 import org.apache.avro.AvroTypeException;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonEncoding;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonGenerator;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
-&lt;br/&gt;
-import static java.util.Arrays.asList;&lt;br/&gt;
-import static org.hamcrest.Matchers.equalTo;&lt;br/&gt;
-import static org.hamcrest.Matchers.is;&lt;br/&gt;
-import static org.junit.Assert.assertThat;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestEncoders {&lt;br/&gt;
   private static final int ENCODER_BUFFER_SIZE = 32;&lt;br/&gt;
@@ -49,11 +52,14 @@&lt;/p&gt;

&lt;p&gt;   private static EncoderFactory factory = EncoderFactory.get();&lt;/p&gt;

&lt;p&gt;+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testBinaryEncoderInit() throws IOException &lt;/p&gt;
{
     OutputStream out = new ByteArrayOutputStream();
     BinaryEncoder enc = factory.binaryEncoder(out, null);
-    Assert.assertTrue(enc == factory.binaryEncoder(out, enc));
+    Assert.assertSame(enc, factory.binaryEncoder(out, enc));
   }

&lt;p&gt;   @Test(expected=NullPointerException.class)&lt;br/&gt;
@@ -66,7 +72,7 @@ public void testBlockingBinaryEncoderInit() throws IOException &lt;/p&gt;
{
     OutputStream out = new ByteArrayOutputStream();
     BinaryEncoder reuse = null;
     reuse = factory.blockingBinaryEncoder(out, reuse);
-    Assert.assertTrue(reuse == factory.blockingBinaryEncoder(out, reuse));
+    Assert.assertSame(reuse, factory.blockingBinaryEncoder(out, reuse));
     // comparison
   }

&lt;p&gt;@@ -79,7 +85,7 @@ public void testBadBlockintBinaryEncoderInit() {&lt;br/&gt;
   public void testDirectBinaryEncoderInit() throws IOException &lt;/p&gt;
{
     OutputStream out = new ByteArrayOutputStream();
     BinaryEncoder enc = factory.directBinaryEncoder(out, null);
-    Assert.assertTrue(enc ==  factory.directBinaryEncoder(out, enc));
+    Assert.assertSame(enc, factory.directBinaryEncoder(out, enc));
   }

&lt;p&gt;   @Test(expected=NullPointerException.class)&lt;br/&gt;
@@ -216,7 +222,7 @@ public void testArrayBackedByteBuffer() throws IOException {&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
   public void testMappedByteBuffer() throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Path file = Files.createTempFile(&quot;test&quot;, &quot;data&quot;);&lt;br/&gt;
+    Path file = Paths.get(DIR.getRoot().getPath() + &quot;testMappedByteBuffer.avro&quot;);&lt;br/&gt;
     Files.write(file, someBytes(EXAMPLE_DATA_SIZE));&lt;br/&gt;
     MappedByteBuffer buffer = FileChannel.open(file, StandardOpenOption.READ).map(FileChannel.MapMode.READ_ONLY, 0, EXAMPLE_DATA_SIZE);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestJsonDecoder.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestJsonDecoder.java&lt;br/&gt;
index c63749840..eab6f25b3 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestJsonDecoder.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestJsonDecoder.java&lt;br/&gt;
@@ -18,11 +18,10 @@&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
-&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
+import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public class TestJsonDecoder {&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIO.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIO.java&lt;br/&gt;
index 3c96b5155..0b86b08b4 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIO.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIO.java&lt;br/&gt;
@@ -26,8 +26,8 @@&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.io.TestValidatingIO.Encoding;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
-import org.junit.runners.Parameterized;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
+import org.junit.runners.Parameterized;&lt;/p&gt;

&lt;p&gt; @RunWith(Parameterized.class)&lt;br/&gt;
 public class TestResolvingIO {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIOResolving.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIOResolving.java&lt;br/&gt;
index 4d5135de2..64e3aa6e6 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIOResolving.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestResolvingIOResolving.java&lt;br/&gt;
@@ -17,14 +17,14 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt;-import org.junit.Test;&lt;br/&gt;
-import org.junit.runners.Parameterized;&lt;br/&gt;
-import org.junit.runner.RunWith;&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
-&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
+import java.util.Collection;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.Schema;&lt;br/&gt;
+import org.junit.Test;&lt;br/&gt;
+import org.junit.runner.RunWith;&lt;br/&gt;
+import org.junit.runners.Parameterized;&lt;/p&gt;

&lt;p&gt; @RunWith(Parameterized.class)&lt;br/&gt;
 public class TestResolvingIOResolving {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/TestValidatingIO.java b/lang/java/avro/src/test/java/org/apache/avro/io/TestValidatingIO.java&lt;br/&gt;
index 6efe039a8..0d4112aaa 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/TestValidatingIO.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/TestValidatingIO.java&lt;br/&gt;
@@ -17,21 +17,14 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.io;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertArrayEquals;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
-import java.util.Iterator;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Random;&lt;br/&gt;
+import java.util.*;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/SymbolTest.java b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/SymbolTest.java&lt;br/&gt;
index 68a7bc673..ce4d7df96 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/SymbolTest.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/SymbolTest.java&lt;br/&gt;
@@ -20,6 +20,7 @@&lt;br/&gt;
 import java.util.HashMap;&lt;br/&gt;
 import java.util.HashSet;&lt;br/&gt;
 import java.util.Set;&lt;br/&gt;
+&lt;br/&gt;
 import junit.framework.Assert;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator.java b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator.java&lt;br/&gt;
index d96f771ce..bd0df52bc 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator.java&lt;br/&gt;
@@ -24,6 +24,9 @@&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collection;&lt;/p&gt;

&lt;p&gt;+import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
+import com.fasterxml.jackson.databind.JsonNode;&lt;br/&gt;
+import com.fasterxml.jackson.databind.ObjectMapper;&lt;br/&gt;
 import org.apache.avro.AvroTypeException;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.SchemaBuilder;&lt;br/&gt;
@@ -35,9 +38,6 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericRecordBuilder;&lt;br/&gt;
 import org.apache.avro.io.Encoder;&lt;br/&gt;
 import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
-import com.fasterxml.jackson.core.JsonFactory;&lt;br/&gt;
-import com.fasterxml.jackson.databind.JsonNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.ObjectMapper;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator2.java b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator2.java&lt;br/&gt;
index 494af621b..f83c9762e 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator2.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/io/parsing/TestResolvingGrammarGenerator2.java&lt;br/&gt;
@@ -18,10 +18,11 @@&lt;br/&gt;
 package org.apache.avro.io.parsing;&lt;/p&gt;

&lt;p&gt; import java.util.Arrays;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.SchemaBuilder;&lt;br/&gt;
 import org.apache.avro.SchemaValidationException;&lt;br/&gt;
 import org.apache.avro.SchemaValidatorBuilder;&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/message/TestBinaryMessageEncoding.java b/lang/java/avro/src/test/java/org/apache/avro/message/TestBinaryMessageEncoding.java&lt;br/&gt;
index 0685964a0..0c87189f1 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/message/TestBinaryMessageEncoding.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/message/TestBinaryMessageEncoding.java&lt;br/&gt;
@@ -19,6 +19,11 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.message;&lt;/p&gt;

&lt;p&gt;+import java.nio.ByteBuffer;&lt;br/&gt;
+import java.util.Arrays;&lt;br/&gt;
+import java.util.List;&lt;br/&gt;
+import java.util.Set;&lt;br/&gt;
+&lt;br/&gt;
 import com.google.common.collect.Iterables;&lt;br/&gt;
 import com.google.common.collect.Lists;&lt;br/&gt;
 import com.google.common.collect.Ordering;&lt;br/&gt;
@@ -31,10 +36,6 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericRecordBuilder;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
-import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Set;&lt;/p&gt;

&lt;p&gt; public class TestBinaryMessageEncoding {&lt;br/&gt;
   public static final Schema SCHEMA_V1 = SchemaBuilder.record(&quot;TestRecord&quot;)&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestByteBuffer.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestByteBuffer.java&lt;br/&gt;
index a8a8b7498..a46e1dc8a 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestByteBuffer.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestByteBuffer.java&lt;br/&gt;
@@ -20,12 +20,7 @@&lt;/p&gt;

&lt;p&gt; import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt;-import java.io.ByteArrayOutputStream;&lt;br/&gt;
-import java.io.File;&lt;br/&gt;
-import java.io.FileInputStream;&lt;br/&gt;
-import java.io.FileNotFoundException;&lt;br/&gt;
-import java.io.FileOutputStream;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
+import java.io.*;&lt;br/&gt;
 import java.math.BigInteger;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
 import java.nio.channels.FileChannel;&lt;br/&gt;
@@ -33,20 +28,22 @@&lt;br/&gt;
 import java.security.NoSuchAlgorithmException;&lt;br/&gt;
 import java.util.Iterator;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.file.FileReader;&lt;br/&gt;
 import org.apache.avro.file.SeekableByteArrayInput;&lt;br/&gt;
 import org.apache.avro.io.DatumWriter;&lt;br/&gt;
-import org.apache.avro.reflect.ReflectData;&lt;br/&gt;
-import org.apache.avro.reflect.ReflectDatumReader;&lt;br/&gt;
-import org.apache.avro.reflect.ReflectDatumWriter;&lt;br/&gt;
 import org.junit.Before;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestByteBuffer {&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   static class X{&lt;br/&gt;
     String name = &quot;&quot;;&lt;br/&gt;
     ByteBuffer content;&lt;br/&gt;
@@ -54,13 +51,12 @@&lt;br/&gt;
   File content;&lt;/p&gt;

&lt;p&gt;   @Before public void before() throws IOException{&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File tmpdir = AvroTestUtil.tempDirectory(getClass(), &quot;content&quot;);&lt;/li&gt;
	&lt;li&gt;content = new File(tmpdir,&quot;test-content&quot;);&lt;/li&gt;
	&lt;li&gt;FileOutputStream out = new FileOutputStream(content);&lt;/li&gt;
	&lt;li&gt;for(int i=0;i&amp;lt;100000;i++){&lt;/li&gt;
	&lt;li&gt;out.write(&quot;hello world\n&quot;.getBytes());&lt;br/&gt;
+    content = new File(DIR.getRoot().getPath(),&quot;test-content&quot;);&lt;br/&gt;
+    try(FileOutputStream out = new FileOutputStream(content)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (int i = 0; i &amp;lt; 100000; i++) {
+        out.write(&quot;hello world\n&quot;.getBytes());
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test public void test() throws Exception{&lt;br/&gt;
@@ -89,42 +85,30 @@ private X readOneXFromAvro(Schema schema, ByteArrayOutputStream bout)&lt;br/&gt;
   private void writeOneXAsAvro(Schema schema, ByteArrayOutputStream bout)&lt;br/&gt;
     throws IOException, FileNotFoundException {&lt;br/&gt;
     DatumWriter&amp;lt;X&amp;gt; datumWriter = new ReflectDatumWriter&amp;lt;&amp;gt;(schema);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileWriter&amp;lt;X&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(datumWriter);&lt;/li&gt;
	&lt;li&gt;writer.create(schema, bout);&lt;/li&gt;
	&lt;li&gt;X x = new X();&lt;/li&gt;
	&lt;li&gt;x.name = &quot;xxx&quot;;&lt;/li&gt;
	&lt;li&gt;FileInputStream fis = new FileInputStream(content);&lt;/li&gt;
	&lt;li&gt;try{&lt;/li&gt;
	&lt;li&gt;FileChannel channel = fis.getChannel();&lt;/li&gt;
	&lt;li&gt;try
{
-        long contentLength = content.length();
-        //set the content to be a file channel.
-        ByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, contentLength);
-        x.content = buffer;
-        writer.append(x);
-      }
&lt;p&gt;finally{&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;channel.close();&lt;br/&gt;
+    try(DataFileWriter&amp;lt;X&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(datumWriter)) {&lt;br/&gt;
+      writer.create(schema, bout);&lt;br/&gt;
+      X x = new X();&lt;br/&gt;
+      x.name = &quot;xxx&quot;;&lt;br/&gt;
+      try (FileInputStream fis = new FileInputStream(content)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        try (FileChannel channel = fis.getChannel()) {
+          long contentLength = content.length();
+          //set the content to be a file channel.
+          ByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, contentLength);
+          x.content = buffer;
+          writer.append(x);
+        }       }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;}finally
{
-      fis.close();
+      writer.flush();
     }&lt;/li&gt;
	&lt;li&gt;writer.flush();&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private String getmd5(File file) throws Exception{&lt;/li&gt;
	&lt;li&gt;FileInputStream fis = new FileInputStream(content);&lt;/li&gt;
	&lt;li&gt;try{&lt;/li&gt;
	&lt;li&gt;FileChannel channel = fis.getChannel();&lt;/li&gt;
	&lt;li&gt;try{&lt;br/&gt;
+  private String getmd5(File content) throws Exception{&lt;br/&gt;
+    try (FileInputStream fis = new FileInputStream(content)) {&lt;br/&gt;
+      try (FileChannel channel = fis.getChannel()) 
{
         long contentLength = content.length();
         ByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, contentLength);
         return getmd5(buffer);
-      }
&lt;p&gt;finally&lt;/p&gt;
{
-        channel.close();
       }&lt;/li&gt;
	&lt;li&gt;}finally
{
-      fis.close();
     }
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestNonStringMapKeys.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestNonStringMapKeys.java&lt;br/&gt;
index 458d52c29..2784fa238 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestNonStringMapKeys.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestNonStringMapKeys.java&lt;br/&gt;
@@ -17,19 +17,12 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.reflect;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.*;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.Iterator;&lt;br/&gt;
-import java.util.LinkedHashMap;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
+import java.util.*;&lt;br/&gt;
 import java.util.Map.Entry;&lt;br/&gt;
-&lt;br/&gt;
-import static org.junit.Assert.*;&lt;br/&gt;
-&lt;br/&gt;
-import java.util.TreeMap;&lt;br/&gt;
 import java.util.concurrent.ConcurrentHashMap;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.Schema;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflect.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflect.java&lt;br/&gt;
index 3208f169c..45ee2af93 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflect.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflect.java&lt;br/&gt;
@@ -17,9 +17,7 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.reflect;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertNotNull;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
@@ -27,20 +25,9 @@&lt;br/&gt;
 import java.lang.reflect.Array;&lt;br/&gt;
 import java.lang.reflect.Type;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.Arrays;&lt;br/&gt;
-import java.util.Collection;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
-import java.util.Random;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.AvroRuntimeException;&lt;br/&gt;
-import org.apache.avro.AvroTypeException;&lt;br/&gt;
-import org.apache.avro.JsonProperties;&lt;br/&gt;
-import org.apache.avro.Protocol;&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.SchemaBuilder;&lt;br/&gt;
+import java.util.*;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.*;&lt;br/&gt;
 import org.apache.avro.Schema.Field;&lt;br/&gt;
 import org.apache.avro.generic.GenericData;&lt;br/&gt;
 import org.apache.avro.io.Decoder;&lt;br/&gt;
@@ -50,8 +37,6 @@&lt;br/&gt;
 import org.apache.avro.reflect.TestReflect.SampleRecord.AnotherSampleRecord;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import com.fasterxml.jackson.databind.node.NullNode;&lt;br/&gt;
-&lt;br/&gt;
 public class TestReflect {&lt;/p&gt;

&lt;p&gt;   EncoderFactory factory = new EncoderFactory();&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectAllowNulls.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectAllowNulls.java&lt;br/&gt;
index 1d374a444..948858884 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectAllowNulls.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectAllowNulls.java&lt;br/&gt;
@@ -18,6 +18,7 @@&lt;br/&gt;
 package org.apache.avro.reflect;&lt;/p&gt;

&lt;p&gt; import java.util.Arrays;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectData.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectData.java&lt;br/&gt;
index 3525d7b64..6528ad889 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectData.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectData.java&lt;br/&gt;
@@ -18,13 +18,13 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.reflect;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.Schema;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import static org.hamcrest.Matchers.lessThan;&lt;br/&gt;
+import static org.junit.Assert.assertThat;&lt;/p&gt;

&lt;p&gt; import java.util.Collections;&lt;/p&gt;

&lt;p&gt;-import static org.hamcrest.Matchers.lessThan;&lt;br/&gt;
-import static org.junit.Assert.assertThat;&lt;br/&gt;
+import org.apache.avro.Schema;&lt;br/&gt;
+import org.junit.Test;&lt;/p&gt;

&lt;p&gt; public class TestReflectData {&lt;br/&gt;
   @Test&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectLogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectLogicalTypes.java&lt;br/&gt;
index 23348be2d..356afe3fe 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectLogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/reflect/TestReflectLogicalTypes.java&lt;br/&gt;
@@ -25,12 +25,8 @@&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 import java.util.UUID;&lt;br/&gt;
-import org.apache.avro.Conversion;&lt;br/&gt;
-import org.apache.avro.Conversions;&lt;br/&gt;
-import org.apache.avro.LogicalType;&lt;br/&gt;
-import org.apache.avro.LogicalTypes;&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.SchemaBuilder;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.avro.*;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
 import org.apache.avro.file.FileReader;&lt;br/&gt;
@@ -40,11 +36,7 @@&lt;br/&gt;
 import org.apache.avro.io.DatumReader;&lt;br/&gt;
 import org.apache.avro.io.DatumWriter;&lt;br/&gt;
 import org.apache.avro.specific.SpecificData;&lt;br/&gt;
-import org.junit.Assert;&lt;br/&gt;
-import org.junit.Assume;&lt;br/&gt;
-import org.junit.BeforeClass;&lt;br/&gt;
-import org.junit.Rule;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.junit.*;&lt;br/&gt;
 import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; /**&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithJsr310LogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithJsr310LogicalTypes.java&lt;br/&gt;
index c42b3ca0d..56e31f4b7 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithJsr310LogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithJsr310LogicalTypes.java&lt;br/&gt;
@@ -5,8 +5,8 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.message.BinaryMessageEncoder;&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageDecoder;&lt;br/&gt;
+import org.apache.avro.message.BinaryMessageEncoder;&lt;br/&gt;
 import org.apache.avro.message.SchemaStore;&lt;/p&gt;

&lt;p&gt; @SuppressWarnings(&quot;all&quot;)&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithLogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithLogicalTypes.java&lt;br/&gt;
index 17e74ae2f..3029e39c0 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithLogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithLogicalTypes.java&lt;br/&gt;
@@ -5,12 +5,12 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;+import java.math.BigDecimal;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.data.TimeConversions;&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageDecoder;&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageEncoder;&lt;/p&gt;

&lt;p&gt;-import java.math.BigDecimal;&lt;br/&gt;
-&lt;br/&gt;
 @SuppressWarnings(&quot;all&quot;)&lt;br/&gt;
 @org.apache.avro.specific.AvroGenerated&lt;br/&gt;
 public class TestRecordWithLogicalTypes extends org.apache.avro.specific.SpecificRecordBase implements org.apache.avro.specific.SpecificRecord {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithoutLogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithoutLogicalTypes.java&lt;br/&gt;
index 21d2d6f3b..2fe601254 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithoutLogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestRecordWithoutLogicalTypes.java&lt;br/&gt;
@@ -5,9 +5,10 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;+import java.nio.ByteBuffer;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageDecoder;&lt;br/&gt;
 import org.apache.avro.message.BinaryMessageEncoder;&lt;br/&gt;
-import java.nio.ByteBuffer;&lt;/p&gt;

&lt;p&gt; @SuppressWarnings(&quot;all&quot;)&lt;br/&gt;
 @org.apache.avro.specific.AvroGenerated&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificData.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificData.java&lt;br/&gt;
index 6dede6904..037ea6221 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificData.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificData.java&lt;br/&gt;
@@ -18,17 +18,12 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.assertNotNull;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
 import java.io.ObjectInputStream;&lt;br/&gt;
 import java.io.ObjectOutputStream;&lt;br/&gt;
-&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificLogicalTypes.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificLogicalTypes.java&lt;br/&gt;
index 9a9fec410..ba8923980 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificLogicalTypes.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificLogicalTypes.java&lt;br/&gt;
@@ -17,6 +17,20 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;+import static java.time.format.DateTimeFormatter.ISO_INSTANT;&lt;br/&gt;
+import static java.time.format.DateTimeFormatter.ISO_LOCAL_DATE;&lt;br/&gt;
+import static org.hamcrest.Matchers.*;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.math.BigDecimal;&lt;br/&gt;
+import java.time.format.DateTimeFormatter;&lt;br/&gt;
+import java.time.format.DateTimeFormatterBuilder;&lt;br/&gt;
+import java.time.temporal.ChronoField;&lt;br/&gt;
+import java.time.temporal.ChronoUnit;&lt;br/&gt;
+import java.util.ArrayList;&lt;br/&gt;
+import java.util.List;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Conversions;&lt;br/&gt;
 import org.apache.avro.LogicalTypes;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
@@ -37,21 +51,6 @@&lt;br/&gt;
 import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 import org.junit.rules.TemporaryFolder;&lt;br/&gt;
-import java.io.File;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.math.BigDecimal;&lt;br/&gt;
-import java.time.format.DateTimeFormatter;&lt;br/&gt;
-import java.time.temporal.ChronoUnit;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-&lt;br/&gt;
-import static java.time.format.DateTimeFormatter.ISO_INSTANT;&lt;br/&gt;
-import static java.time.format.DateTimeFormatter.ISO_LOCAL_DATE;&lt;br/&gt;
-import static java.time.format.DateTimeFormatter.ISO_LOCAL_TIME;&lt;br/&gt;
-import static org.hamcrest.Matchers.comparesEqualTo;&lt;br/&gt;
-import static org.hamcrest.Matchers.empty;&lt;br/&gt;
-import static org.hamcrest.Matchers.is;&lt;br/&gt;
-import static org.hamcrest.Matchers.not;&lt;/p&gt;

&lt;p&gt; /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This tests compatibility between classes generated before and after&lt;br/&gt;
@@ -71,6 +70,21 @@&lt;br/&gt;
  */&lt;br/&gt;
 public class TestSpecificLogicalTypes {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+  // Override the default ISO_LOCAL_TIME to make sure that there are&lt;br/&gt;
+  // trailing zero&apos;s in the format:&lt;br/&gt;
+  // Expected: is &quot;22:07:33.880&quot;&lt;br/&gt;
+  //     but: was &quot;22:07:33.88&quot;&lt;br/&gt;
+  private static final DateTimeFormatter ISO_LOCAL_TIME = new DateTimeFormatterBuilder()&lt;br/&gt;
+          .appendValue(ChronoField.HOUR_OF_DAY, 2)&lt;br/&gt;
+          .appendLiteral(&apos;:&apos;)&lt;br/&gt;
+          .appendValue(ChronoField.MINUTE_OF_HOUR, 2)&lt;br/&gt;
+          .optionalStart()&lt;br/&gt;
+          .appendLiteral(&apos;:&apos;)&lt;br/&gt;
+          .appendValue(ChronoField.SECOND_OF_MINUTE, 2)&lt;br/&gt;
+          .optionalStart()&lt;br/&gt;
+          .appendFraction(ChronoField.NANO_OF_SECOND, 3, 3, true)&lt;br/&gt;
+          .toFormatter();&lt;br/&gt;
+&lt;br/&gt;
   @Rule&lt;br/&gt;
   public final TemporaryFolder temp = new TemporaryFolder();&lt;/p&gt;

&lt;p&gt;diff --git a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificToFromByteArray.java b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificToFromByteArray.java&lt;br/&gt;
index 9cc10e302..b151003d7 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificToFromByteArray.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/specific/TestSpecificToFromByteArray.java&lt;br/&gt;
@@ -17,6 +17,12 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.specific;&lt;/p&gt;

&lt;p&gt;+import static org.junit.Assert.assertEquals;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.math.BigDecimal;&lt;br/&gt;
+import java.nio.ByteBuffer;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Conversions;&lt;br/&gt;
 import org.apache.avro.LogicalTypes;&lt;br/&gt;
 import org.apache.avro.data.TimeConversions;&lt;br/&gt;
@@ -26,11 +32,6 @@&lt;br/&gt;
 import org.joda.time.LocalDate;&lt;br/&gt;
 import org.joda.time.LocalTime;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.math.BigDecimal;&lt;br/&gt;
-import java.nio.ByteBuffer;&lt;br/&gt;
-&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;/p&gt;

&lt;p&gt; public class TestSpecificToFromByteArray {&lt;br/&gt;
   @Test&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/util/CaseFinder.java b/lang/java/avro/src/test/java/org/apache/avro/util/CaseFinder.java&lt;br/&gt;
index 56a24a6b2..ea5bf2b20 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/util/CaseFinder.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/util/CaseFinder.java&lt;br/&gt;
@@ -20,8 +20,8 @@&lt;br/&gt;
 import java.io.BufferedReader;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
-import java.util.regex.Pattern;&lt;br/&gt;
 import java.util.regex.Matcher;&lt;br/&gt;
+import java.util.regex.Pattern;&lt;/p&gt;

&lt;p&gt; /** Parser for files containing test cases consisting of&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&amp;lt;code&amp;gt;&amp;lt;String,String&amp;gt;&amp;lt;/code&amp;gt; pairs, where the first string is&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/util/TestCaseFinder.java b/lang/java/avro/src/test/java/org/apache/avro/util/TestCaseFinder.java&lt;br/&gt;
index 4cf6bdaf8..cd958be16 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/avro/src/test/java/org/apache/avro/util/TestCaseFinder.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/util/TestCaseFinder.java&lt;br/&gt;
@@ -17,19 +17,19 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.util;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+import static org.junit.Assert.assertTrue;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.BufferedReader;&lt;br/&gt;
+import java.io.StringReader;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
-import java.io.BufferedReader;&lt;br/&gt;
-import java.io.StringReader;&lt;/p&gt;

&lt;p&gt; import org.junit.Test;&lt;br/&gt;
+import org.junit.experimental.runners.Enclosed;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.Parameterized;&lt;br/&gt;
 import org.junit.runners.Parameterized.Parameters;&lt;br/&gt;
-import org.junit.experimental.runners.Enclosed;&lt;br/&gt;
-&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;/p&gt;

&lt;p&gt; @RunWith(Enclosed.class)&lt;br/&gt;
 public class TestCaseFinder {&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/util/TestUtf8.java b/lang/java/avro/src/test/java/org/apache/avro/util/TestUtf8.java&lt;br/&gt;
index 3272ea378..04709f57e 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/util/TestUtf8.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/util/TestUtf8.java&lt;br/&gt;
@@ -17,13 +17,13 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.util;&lt;/p&gt;

&lt;p&gt;+import static junit.framework.Assert.assertSame;&lt;br/&gt;
+import static org.junit.Assert.assertEquals;&lt;br/&gt;
+&lt;br/&gt;
 import java.io.UnsupportedEncodingException;&lt;/p&gt;

&lt;p&gt; import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import static junit.framework.Assert.assertSame;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-&lt;br/&gt;
 public class TestUtf8 {&lt;br/&gt;
   @Test public void testByteConstructor() throws Exception {&lt;br/&gt;
     byte[] bs = &quot;Foo&quot;.getBytes(&quot;UTF-8&quot;);&lt;br/&gt;
diff --git a/lang/java/avro/src/test/java/org/apache/avro/util/internal/TestJacksonUtils.java b/lang/java/avro/src/test/java/org/apache/avro/util/internal/TestJacksonUtils.java&lt;br/&gt;
index 556a91a1c..9ad0eb734 100644&lt;br/&gt;
&amp;#8212; a/lang/java/avro/src/test/java/org/apache/avro/util/internal/TestJacksonUtils.java&lt;br/&gt;
+++ b/lang/java/avro/src/test/java/org/apache/avro/util/internal/TestJacksonUtils.java&lt;br/&gt;
@@ -17,27 +17,19 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro.util.internal;&lt;/p&gt;

&lt;p&gt;+import static org.apache.avro.util.internal.JacksonUtils.toJsonNode;&lt;br/&gt;
+import static org.apache.avro.util.internal.JacksonUtils.toObject;&lt;br/&gt;
+import static org.junit.Assert.assertArrayEquals;&lt;br/&gt;
+import static org.junit.Assert.assertEquals;&lt;br/&gt;
+&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
+&lt;br/&gt;
+import com.fasterxml.jackson.databind.node.*;&lt;br/&gt;
 import org.apache.avro.JsonProperties;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.SchemaBuilder;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.ArrayNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.BooleanNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.DoubleNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.FloatNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.IntNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.JsonNodeFactory;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.LongNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.NullNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.ObjectNode;&lt;br/&gt;
-import com.fasterxml.jackson.databind.node.TextNode;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt;-import static org.apache.avro.util.internal.JacksonUtils.toJsonNode;&lt;br/&gt;
-import static org.apache.avro.util.internal.JacksonUtils.toObject;&lt;br/&gt;
-import static org.junit.Assert.assertArrayEquals;&lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-&lt;br/&gt;
 public class TestJacksonUtils {&lt;/p&gt;

&lt;p&gt;   enum Direction {&lt;br/&gt;
diff --git a/lang/java/compiler/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java b/lang/java/compiler/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
index ceae52c12..d9936726a 100644&lt;br/&gt;
&amp;#8212; a/lang/java/compiler/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
+++ b/lang/java/compiler/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
@@ -31,22 +31,19 @@&lt;br/&gt;
 import java.io.FileInputStream;&lt;br/&gt;
 import java.io.FileReader;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
-import java.net.URISyntaxException;&lt;br/&gt;
 import java.nio.charset.Charset;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Collection;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
 import java.util.List;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.LogicalTypes;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.SchemaBuilder;&lt;br/&gt;
 import org.apache.avro.generic.GenericData.StringType;&lt;br/&gt;
-import org.junit.After;&lt;br/&gt;
-import org.junit.Assert;&lt;br/&gt;
-import org.junit.Before;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.junit.*;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;br/&gt;
 import org.junit.runner.RunWith;&lt;br/&gt;
 import org.junit.runners.JUnit4;&lt;br/&gt;
 import org.slf4j.Logger;&lt;br/&gt;
@@ -63,65 +60,51 @@&lt;br/&gt;
 public class TestSpecificCompiler {&lt;br/&gt;
   private static final Logger LOG = LoggerFactory.getLogger(TestSpecificCompiler.class);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private final String schemaSrcPath = &quot;src/test/resources/simple_record.avsc&quot;;&lt;/li&gt;
	&lt;li&gt;private final String velocityTemplateDir =&lt;/li&gt;
	&lt;li&gt;&quot;src/main/velocity/org/apache/avro/compiler/specific/templates/java/classic/&quot;;&lt;/li&gt;
	&lt;li&gt;private File src;&lt;/li&gt;
	&lt;li&gt;private File outputDir;&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule public TestName name = new TestName();&lt;br/&gt;
+&lt;br/&gt;
   private File outputFile;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Before&lt;br/&gt;
   public void setUp() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;this.src = new File(this.schemaSrcPath);&lt;/li&gt;
	&lt;li&gt;this.outputDir = AvroTestUtil.tempDirectory(getClass(), &quot;specific-output&quot;);&lt;/li&gt;
	&lt;li&gt;this.outputFile = new File(this.outputDir, &quot;SimpleRecord.java&quot;);&lt;/li&gt;
	&lt;li&gt;if (outputFile.exists() &amp;amp;&amp;amp; !outputFile.delete()) 
{
-      throw new IllegalStateException(&quot;unable to delete &quot; + outputFile);
-    }
&lt;p&gt;+    this.outputFile = new File(this.OUTPUT_DIR.getRoot(), &quot;SimpleRecord.java&quot;);&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@After&lt;/li&gt;
	&lt;li&gt;public void tearDown() {&lt;/li&gt;
	&lt;li&gt;if (this.outputFile != null) 
{
-      this.outputFile.delete();
-    }&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
+  private File src = new File(&quot;src/test/resources/simple_record.avsc&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /** Uses the system&apos;s java compiler to actually compile the generated code. */&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;static void assertCompilesWithJavaCompiler(Collection&amp;lt;SpecificCompiler.OutputFile&amp;gt; outputs)&lt;/li&gt;
	&lt;li&gt;throws IOException {&lt;/li&gt;
	&lt;li&gt;if (outputs.isEmpty())&lt;br/&gt;
+  static void assertCompilesWithJavaCompiler(File dstDir, Collection&amp;lt;SpecificCompiler.OutputFile&amp;gt; outputs) throws IOException {&lt;br/&gt;
+    if (outputs.isEmpty()) 
{
       return;               // Nothing to compile!
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();&lt;br/&gt;
     StandardJavaFileManager fileManager =&lt;br/&gt;
             compiler.getStandardFileManager(null, null, null);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File dstDir = AvroTestUtil.tempFile(TestSpecificCompiler.class, &quot;realCompiler&quot;);&lt;br/&gt;
     List&amp;lt;File&amp;gt; javaFiles = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
     for (SpecificCompiler.OutputFile o : outputs) 
{
       javaFiles.add(o.writeToDestination(null, dstDir));
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     final List&amp;lt;Diagnostic&amp;lt;?&amp;gt;&amp;gt; warnings = new ArrayList&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DiagnosticListener&amp;lt;JavaFileObject&amp;gt; diagnosticListener = new DiagnosticListener&amp;lt;JavaFileObject&amp;gt;() {&lt;/li&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;public void report(Diagnostic&amp;lt;? extends JavaFileObject&amp;gt; diagnostic) {&lt;/li&gt;
	&lt;li&gt;switch (diagnostic.getKind()) {&lt;/li&gt;
	&lt;li&gt;case ERROR:&lt;/li&gt;
	&lt;li&gt;// Do not add these to warnings because they will fail the compile, anyway.&lt;/li&gt;
	&lt;li&gt;LOG.error(&quot;{}&quot;, diagnostic);&lt;/li&gt;
	&lt;li&gt;break;&lt;/li&gt;
	&lt;li&gt;case WARNING:&lt;/li&gt;
	&lt;li&gt;case MANDATORY_WARNING:&lt;/li&gt;
	&lt;li&gt;LOG.warn(&quot;{}&quot;, diagnostic);&lt;/li&gt;
	&lt;li&gt;warnings.add(diagnostic);&lt;/li&gt;
	&lt;li&gt;break;&lt;/li&gt;
	&lt;li&gt;case NOTE:&lt;/li&gt;
	&lt;li&gt;case OTHER:&lt;/li&gt;
	&lt;li&gt;LOG.debug(&quot;{}&quot;, diagnostic);&lt;/li&gt;
	&lt;li&gt;break;&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
+    DiagnosticListener&amp;lt;JavaFileObject&amp;gt; diagnosticListener = diagnostic -&amp;gt; {&lt;br/&gt;
+      switch (diagnostic.getKind()) {&lt;br/&gt;
+      case ERROR:&lt;br/&gt;
+        // Do not add these to warnings because they will fail the compile, anyway.&lt;br/&gt;
+        LOG.error(&quot;{}&quot;, diagnostic);&lt;br/&gt;
+        break;&lt;br/&gt;
+      case WARNING:&lt;br/&gt;
+      case MANDATORY_WARNING:&lt;br/&gt;
+        LOG.warn(&quot;{}&quot;, diagnostic);&lt;br/&gt;
+        warnings.add(diagnostic);&lt;br/&gt;
+        break;&lt;br/&gt;
+      case NOTE:&lt;br/&gt;
+      case OTHER:&lt;br/&gt;
+        LOG.debug(&quot;{}&quot;, diagnostic);&lt;br/&gt;
+        break;&lt;br/&gt;
       }&lt;br/&gt;
     };&lt;br/&gt;
     JavaCompiler.CompilationTask cTask = compiler.getTask(null, fileManager,&lt;br/&gt;
@@ -151,16 +134,17 @@ private SpecificCompiler createCompiler(SpecificCompiler.DateTimeLogicalTypeImpl&lt;br/&gt;
     Schema.Parser parser = new Schema.Parser();&lt;br/&gt;
     Schema schema = parser.parse(this.src);&lt;br/&gt;
     SpecificCompiler compiler = new SpecificCompiler(schema, dateTimeLogicalTypeImplementation);&lt;/li&gt;
	&lt;li&gt;compiler.setTemplateDir(this.velocityTemplateDir);&lt;br/&gt;
+    String velocityTemplateDir = &quot;src/main/velocity/org/apache/avro/compiler/specific/templates/java/classic/&quot;;&lt;br/&gt;
+    compiler.setTemplateDir(velocityTemplateDir);&lt;br/&gt;
     compiler.setStringType(StringType.CharSequence);&lt;br/&gt;
     return compiler;&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testCanReadTemplateFilesOnTheFilesystem() throws IOException, URISyntaxException{&lt;br/&gt;
+  public void testCanReadTemplateFilesOnTheFilesystem() throws IOException 
{
     SpecificCompiler compiler = createCompiler();
-    compiler.compileToDestination(this.src, this.outputDir);
-    assertTrue(this.outputFile.exists());
+    compiler.compileToDestination(this.src, OUTPUT_DIR.getRoot());
+    assertTrue(new File(OUTPUT_DIR.getRoot(),&quot;SimpleRecord.java&quot;).exists());
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -170,54 +154,54 @@ public void testPublicFieldVisibility() throws IOException {&lt;br/&gt;
     assertFalse(compiler.deprecatedFields());&lt;br/&gt;
     assertTrue(compiler.publicFields());&lt;br/&gt;
     assertFalse(compiler.privateFields());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;/li&gt;
	&lt;li&gt;BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;/li&gt;
	&lt;li&gt;String line = null;&lt;/li&gt;
	&lt;li&gt;while ((line = reader.readLine()) != null) {&lt;/li&gt;
	&lt;li&gt;// No line, once trimmed, should start with a deprecated field declaration&lt;/li&gt;
	&lt;li&gt;// nor a private field declaration.  Since the nested builder uses private&lt;/li&gt;
	&lt;li&gt;// fields, we cannot do the second check.&lt;/li&gt;
	&lt;li&gt;line = line.trim();&lt;/li&gt;
	&lt;li&gt;assertFalse(&quot;Line started with a deprecated field declaration: &quot; + line,&lt;/li&gt;
	&lt;li&gt;line.startsWith(&quot;@Deprecated public int value&quot;));&lt;br/&gt;
+    try(BufferedReader reader = new BufferedReader(new FileReader(this.outputFile))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      String line;+      while ((line = reader.readLine()) != null) {
+        // No line, once trimmed, should start with a deprecated field declaration
+        // nor a private field declaration.  Since the nested builder uses private
+        // fields, we cannot do the second check.
+        line = line.trim();
+        assertFalse(&quot;Line started with a deprecated field declaration: &quot; + line,
+                line.startsWith(&quot;@Deprecated public int value&quot;));
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testCreateAllArgsConstructor() throws Exception {&lt;br/&gt;
     SpecificCompiler compiler = createCompiler();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;/li&gt;
	&lt;li&gt;BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;/li&gt;
	&lt;li&gt;String line = null;&lt;br/&gt;
     boolean foundAllArgsConstructor = false;&lt;/li&gt;
	&lt;li&gt;while (!foundAllArgsConstructor &amp;amp;&amp;amp; (line = reader.readLine()) != null) {&lt;/li&gt;
	&lt;li&gt;foundAllArgsConstructor = line.contains(&quot;All-args constructor&quot;);&lt;br/&gt;
+    try(BufferedReader reader = new BufferedReader(new FileReader(this.outputFile))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      String line;+      while (!foundAllArgsConstructor &amp;amp;&amp;amp; (line = reader.readLine()) != null) {
+        foundAllArgsConstructor = line.contains(&quot;All-args constructor&quot;);
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
     assertTrue(foundAllArgsConstructor);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testMaxValidParameterCounts() throws Exception &lt;/p&gt;
{
     Schema validSchema1 = createSampleRecordSchema(SpecificCompiler.MAX_FIELD_PARAMETER_UNIT_COUNT, 0);
-    assertCompilesWithJavaCompiler(new SpecificCompiler(validSchema1).compile());
+    assertCompilesWithJavaCompiler(new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;1&quot;), new SpecificCompiler(validSchema1).compile());
 
     Schema validSchema2 = createSampleRecordSchema(SpecificCompiler.MAX_FIELD_PARAMETER_UNIT_COUNT - 2, 1);
-    assertCompilesWithJavaCompiler(new SpecificCompiler(validSchema1).compile());
+    assertCompilesWithJavaCompiler(new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;2&quot;), new SpecificCompiler(validSchema1).compile());
   }

&lt;p&gt;   @Test&lt;br/&gt;
   public void testInvalidParameterCounts() throws Exception &lt;/p&gt;
{
     Schema invalidSchema1 = createSampleRecordSchema(SpecificCompiler.MAX_FIELD_PARAMETER_UNIT_COUNT + 1, 0);
     SpecificCompiler compiler = new SpecificCompiler(invalidSchema1);
-    assertCompilesWithJavaCompiler(compiler.compile());
+    assertCompilesWithJavaCompiler(new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;1&quot;), compiler.compile());
 
     Schema invalidSchema2 = createSampleRecordSchema(SpecificCompiler.MAX_FIELD_PARAMETER_UNIT_COUNT, 10);
     compiler = new SpecificCompiler(invalidSchema2);
-    assertCompilesWithJavaCompiler(compiler.compile());
+    assertCompilesWithJavaCompiler(new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;2&quot;), compiler.compile());
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -247,10 +231,10 @@ public void testPublicDeprecatedFieldVisibility() throws IOException {&lt;br/&gt;
     assertTrue(compiler.deprecatedFields());&lt;br/&gt;
     assertTrue(compiler.publicFields());&lt;br/&gt;
     assertFalse(compiler.privateFields());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;br/&gt;
     BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;/li&gt;
	&lt;li&gt;String line = null;&lt;br/&gt;
+    String line;&lt;br/&gt;
     while ((line = reader.readLine()) != null) {&lt;br/&gt;
       // No line, once trimmed, should start with a public field declaration&lt;br/&gt;
       line = line.trim();&lt;br/&gt;
@@ -267,7 +251,7 @@ public void testPrivateFieldVisibility() throws IOException {&lt;br/&gt;
     assertFalse(compiler.deprecatedFields());&lt;br/&gt;
     assertFalse(compiler.publicFields());&lt;br/&gt;
     assertTrue(compiler.privateFields());&lt;/li&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;br/&gt;
     BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;br/&gt;
     String line = null;&lt;br/&gt;
@@ -287,19 +271,19 @@ public void testPrivateFieldVisibility() throws IOException {&lt;br/&gt;
   public void testSettersCreatedByDefault() throws IOException {&lt;br/&gt;
     SpecificCompiler compiler = createCompiler();&lt;br/&gt;
     assertTrue(compiler.isCreateSetters());&lt;/li&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;/li&gt;
	&lt;li&gt;BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;br/&gt;
     int foundSetters = 0;&lt;/li&gt;
	&lt;li&gt;String line = null;&lt;/li&gt;
	&lt;li&gt;while ((line = reader.readLine()) != null) {&lt;/li&gt;
	&lt;li&gt;// We should find the setter in the main class&lt;/li&gt;
	&lt;li&gt;line = line.trim();&lt;/li&gt;
	&lt;li&gt;if (line.startsWith(&quot;public void setValue(&quot;)) {&lt;/li&gt;
	&lt;li&gt;foundSetters++;&lt;br/&gt;
+    try(BufferedReader reader = new BufferedReader(new FileReader(this.outputFile))) {&lt;br/&gt;
+      String line;&lt;br/&gt;
+      while ((line = reader.readLine()) != null) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        // We should find the setter in the main class+        line = line.trim();+        if (line.startsWith(&amp;quot;public void setValue(&amp;quot;)) {
+          foundSetters++;
+        }       }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
     assertEquals(&quot;Found the wrong number of setters&quot;, 1, foundSetters);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -308,24 +292,24 @@ public void testSettersNotCreatedWhenOptionTurnedOff() throws IOException {&lt;br/&gt;
     SpecificCompiler compiler = createCompiler();&lt;br/&gt;
     compiler.setCreateSetters(false);&lt;br/&gt;
     assertFalse(compiler.isCreateSetters());&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     assertTrue(this.outputFile.exists());&lt;/li&gt;
	&lt;li&gt;BufferedReader reader = new BufferedReader(new FileReader(this.outputFile));&lt;/li&gt;
	&lt;li&gt;String line = null;&lt;/li&gt;
	&lt;li&gt;while ((line = reader.readLine()) != null) {&lt;/li&gt;
	&lt;li&gt;// No setter should be found&lt;/li&gt;
	&lt;li&gt;line = line.trim();&lt;/li&gt;
	&lt;li&gt;assertFalse(&quot;No line should include the setter: &quot; + line,&lt;/li&gt;
	&lt;li&gt;line.startsWith(&quot;public void setValue(&quot;));&lt;br/&gt;
+    try(BufferedReader reader = new BufferedReader(new FileReader(this.outputFile))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      String line;+      while ((line = reader.readLine()) != null) {
+        // No setter should be found
+        line = line.trim();
+        assertFalse(&quot;No line should include the setter: &quot; + line,
+                line.startsWith(&quot;public void setValue(&quot;));
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testSettingOutputCharacterEncoding() throws Exception {&lt;br/&gt;
     SpecificCompiler compiler = createCompiler();&lt;br/&gt;
     // Generated file in default encoding&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     byte[] fileInDefaultEncoding = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;(int) this.outputFile.length()&amp;#93;&lt;/span&gt;;&lt;br/&gt;
     FileInputStream is = new FileInputStream(this.outputFile);&lt;br/&gt;
     is.read(fileInDefaultEncoding);&lt;br/&gt;
@@ -336,7 +320,7 @@ public void testSettingOutputCharacterEncoding() throws Exception {&lt;br/&gt;
     // Generate file in another encoding (make sure it has different number of bytes per character)&lt;br/&gt;
     String differentEncoding = Charset.defaultCharset().equals(Charset.forName(&quot;UTF-16&quot;)) ? &quot;UTF-32&quot; : &quot;UTF-16&quot;;&lt;br/&gt;
     compiler.setOutputCharacterEncoding(differentEncoding);&lt;/li&gt;
	&lt;li&gt;compiler.compileToDestination(this.src, this.outputDir);&lt;br/&gt;
+    compiler.compileToDestination(this.src, this.OUTPUT_DIR.getRoot());&lt;br/&gt;
     byte[] fileInDifferentEncoding = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;(int) this.outputFile.length()&amp;#93;&lt;/span&gt;;&lt;br/&gt;
     is = new FileInputStream(this.outputFile);&lt;br/&gt;
     is.read(fileInDifferentEncoding);&lt;br/&gt;
@@ -546,7 +530,7 @@ public void testNullableTypesJavaUnbox() throws Exception {&lt;br/&gt;
   public void testLogicalTypesWithMultipleFields() throws Exception 
{
     Schema logicalTypesWithMultipleFields = new Schema.Parser().parse(
         new File(&quot;src/test/resources/logical_types_with_multiple_fields.avsc&quot;));
-    assertCompilesWithJavaCompiler(
+    assertCompilesWithJavaCompiler(new File(OUTPUT_DIR.getRoot(), name.getMethodName()),
         new SpecificCompiler(logicalTypesWithMultipleFields).compile());
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -554,7 +538,7 @@ public void testLogicalTypesWithMultipleFields() throws Exception {&lt;br/&gt;
   public void testUnionAndFixedFields() throws Exception &lt;/p&gt;
{
     Schema unionTypesWithMultipleFields = new Schema.Parser().parse(
         new File(&quot;src/test/resources/union_and_fixed_fields.avsc&quot;));
-    assertCompilesWithJavaCompiler(
+    assertCompilesWithJavaCompiler(new File(this.outputFile, name.getMethodName()),
         new SpecificCompiler(unionTypesWithMultipleFields).compile());
   }

&lt;p&gt;@@ -562,7 +546,7 @@ public void testUnionAndFixedFields() throws Exception {&lt;br/&gt;
   public void testLogicalTypesWithMultipleFieldsJsr310DateTime() throws Exception &lt;/p&gt;
{
     Schema logicalTypesWithMultipleFields = new Schema.Parser().parse(
         new File(&quot;src/test/resources/logical_types_with_multiple_fields.avsc&quot;));
-    assertCompilesWithJavaCompiler(
+    assertCompilesWithJavaCompiler(new File(this.outputFile, name.getMethodName()),
         new SpecificCompiler(logicalTypesWithMultipleFields, JSR310).compile());
   }

&lt;p&gt;diff --git a/lang/java/ipc/src/test/java/org/apache/avro/DataFileInteropTest.java b/lang/java/ipc/src/test/java/org/apache/avro/DataFileInteropTest.java&lt;br/&gt;
index ed4c95b41..08c872714 100644&lt;br/&gt;
&amp;#8212; a/lang/java/ipc/src/test/java/org/apache/avro/DataFileInteropTest.java&lt;br/&gt;
+++ b/lang/java/ipc/src/test/java/org/apache/avro/DataFileInteropTest.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;/p&gt;

&lt;p&gt; import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
+import java.util.Objects;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.FileReader;&lt;br/&gt;
@@ -32,33 +33,25 @@&lt;br/&gt;
 public class DataFileInteropTest {&lt;/p&gt;

&lt;p&gt;   private static final File DATAFILE_DIR =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+          new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @BeforeClass&lt;br/&gt;
   public static void printDir() &lt;/p&gt;
{
     System.out.println(&quot;Reading data files from directory: &quot;
-        + DATAFILE_DIR.getAbsolutePath());
+            + DATAFILE_DIR.getAbsolutePath());
   }

&lt;p&gt;   @Test&lt;br/&gt;
   public void testGeneratedGeneric() throws IOException {&lt;br/&gt;
     System.out.println(&quot;Reading with generic:&quot;);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumReaderProvider&amp;lt;Object&amp;gt; provider = new DatumReaderProvider&amp;lt;Object&amp;gt;() {&lt;/li&gt;
	&lt;li&gt;@Override public DatumReader&amp;lt;Object&amp;gt; get() 
{
-        return new GenericDatumReader&amp;lt;&amp;gt;();
-        }&lt;/li&gt;
	&lt;li&gt;};&lt;br/&gt;
+    DatumReaderProvider&amp;lt;Object&amp;gt; provider = GenericDatumReader::new;&lt;br/&gt;
     readFiles(provider);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testGeneratedSpecific() throws IOException {&lt;br/&gt;
     System.out.println(&quot;Reading with specific:&quot;);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumReaderProvider&amp;lt;Interop&amp;gt; provider = new DatumReaderProvider&amp;lt;Interop&amp;gt;() {&lt;/li&gt;
	&lt;li&gt;@Override public DatumReader&amp;lt;Interop&amp;gt; get() 
{
-        return new SpecificDatumReader&amp;lt;&amp;gt;();
-        }&lt;/li&gt;
	&lt;li&gt;};&lt;br/&gt;
+    DatumReaderProvider&amp;lt;Interop&amp;gt; provider = SpecificDatumReader::new;&lt;br/&gt;
     readFiles(provider);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -85,12 +78,12 @@ public void testGeneratedSpecific() throws IOException &lt;/p&gt;
{
 //   }

&lt;p&gt;   private  &amp;lt;T extends Object&amp;gt; void readFiles(DatumReaderProvider&amp;lt;T&amp;gt; provider) throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for (File f : DATAFILE_DIR.listFiles()) {&lt;br/&gt;
+    for (File f : Objects.requireNonNull(DATAFILE_DIR.listFiles())) {&lt;br/&gt;
       System.out.println(&quot;Reading: &quot; + f.getName());&lt;/li&gt;
	&lt;li&gt;FileReader&amp;lt;? extends Object&amp;gt; reader = DataFileReader.openReader(f,&lt;/li&gt;
	&lt;li&gt;provider.get());&lt;/li&gt;
	&lt;li&gt;for (Object datum : reader) {&lt;/li&gt;
	&lt;li&gt;Assert.assertNotNull(datum);&lt;br/&gt;
+      try(FileReader&amp;lt;? extends Object&amp;gt; reader = DataFileReader.openReader(f, provider.get())) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        for (Object datum }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     }&lt;br/&gt;
   }&lt;br/&gt;
@@ -99,4 +92,4 @@ public void testGeneratedSpecific() throws IOException &lt;/p&gt;
{
     public DatumReader&amp;lt;T&amp;gt; get();
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-}&lt;br/&gt;
+}&lt;br/&gt;
\ No newline at end of file&lt;br/&gt;
diff --git a/lang/java/ipc/src/test/java/org/apache/avro/TestDataFileSpecific.java b/lang/java/ipc/src/test/java/org/apache/avro/TestDataFileSpecific.java&lt;br/&gt;
index 19374b416..da7ea8cf4 100644&lt;br/&gt;
&amp;#8212; a/lang/java/ipc/src/test/java/org/apache/avro/TestDataFileSpecific.java&lt;br/&gt;
+++ b/lang/java/ipc/src/test/java/org/apache/avro/TestDataFileSpecific.java&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;/p&gt;

&lt;p&gt; import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
+import java.nio.file.Files;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.file.DataFileWriter;&lt;br/&gt;
@@ -27,47 +28,49 @@&lt;br/&gt;
 import org.apache.avro.specific.SpecificDatumReader;&lt;/p&gt;

&lt;p&gt; import org.junit.Assert;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.Foo;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestDataFileSpecific {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR =&lt;/li&gt;
	&lt;li&gt;new File(System.getProperty(&quot;test.dir&quot;,&quot;/tmp&quot;));&lt;/li&gt;
	&lt;li&gt;private static final File FILE = new File(DIR, &quot;specific.avro&quot;);&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /* Test when using SpecificDatumReader&amp;lt;T&amp;gt;() constructor to read from a file&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;with a different schema that both reader &amp;amp; writer schemas are found.*/&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testSpecificDatumReaderDefaultCtor() throws IOException {&lt;br/&gt;
+    File file = new File(DIR.getRoot().getPath(), &quot;testSpecificDatumReaderDefaultCtor&quot;);&lt;br/&gt;
+&lt;br/&gt;
     // like the specific Foo, but with another field&lt;br/&gt;
     Schema s1 = Schema.parse(&quot;{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Foo\&quot;,&quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;+&quot;\&quot;namespace\&quot;:\&quot;org.apache.avro\&quot;,\&quot;fields\&quot;:[&quot;&lt;/li&gt;
	&lt;li&gt;+&quot;
{\&quot;name\&quot;:\&quot;label\&quot;,\&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;,&quot;&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;+&quot;
{\&quot;name\&quot;:\&quot;id\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;]}&quot;);&lt;br/&gt;
+            + &quot;\&quot;namespace\&quot;:\&quot;org.apache.avro\&quot;,\&quot;fields\&quot;:[&quot;&lt;br/&gt;
+            + &quot;&lt;/p&gt;
{\&quot;name\&quot;:\&quot;label\&quot;,\&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;,&quot;&lt;br/&gt;
+            + &quot;&lt;/p&gt;
{\&quot;name\&quot;:\&quot;id\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;]}&quot;);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // write a file using generic objects&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Record&amp;gt; writer&lt;/li&gt;
	&lt;li&gt;= new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;Record&amp;gt;(s1))&lt;/li&gt;
	&lt;li&gt;.create(s1, FILE);&lt;/li&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; 10; i++) {&lt;/li&gt;
	&lt;li&gt;Record r = new Record(s1);&lt;/li&gt;
	&lt;li&gt;r.put(&quot;label&quot;, &quot;&quot;+i);&lt;/li&gt;
	&lt;li&gt;r.put(&quot;id&quot;, i);&lt;/li&gt;
	&lt;li&gt;writer.append(r);&lt;br/&gt;
+    try (DataFileWriter&amp;lt;Record&amp;gt; writer =&lt;br/&gt;
+                 new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;Record&amp;gt;(s1)).create(s1, file)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (int i = 0; i &amp;lt; 10; i++) {
+        Record r = new Record(s1);
+        r.put(&quot;label&quot;, &quot;&quot; + i);
+        r.put(&quot;id&quot;, i);
+        writer.append(r);
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // read using a &apos;new SpecificDatumReader&amp;lt;T&amp;gt;()&apos; to force inference of&lt;br/&gt;
     // reader&apos;s schema from runtime&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;Foo&amp;gt; reader =&lt;/li&gt;
	&lt;li&gt;new DataFileReader&amp;lt;&amp;gt;(FILE, new SpecificDatumReader&amp;lt;&amp;gt;());&lt;/li&gt;
	&lt;li&gt;int i = 0;&lt;/li&gt;
	&lt;li&gt;for (Foo f : reader)&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(&quot;&quot;&lt;ins&gt;(i&lt;/ins&gt;+), f.getLabel());&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals(10, i);&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
+    try (DataFileReader&amp;lt;Foo&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(file, new SpecificDatumReader&amp;lt;&amp;gt;())) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      int i = 0;+      for (Foo f }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; }&lt;br/&gt;
diff --git a/lang/java/ipc/src/test/java/org/apache/avro/TestProtocolSpecific.java b/lang/java/ipc/src/test/java/org/apache/avro/TestProtocolSpecific.java&lt;br/&gt;
index 77340fc3b..ea79b27eb 100644&lt;br/&gt;
&amp;#8212; a/lang/java/ipc/src/test/java/org/apache/avro/TestProtocolSpecific.java&lt;br/&gt;
+++ b/lang/java/ipc/src/test/java/org/apache/avro/TestProtocolSpecific.java&lt;br/&gt;
@@ -51,17 +51,13 @@&lt;br/&gt;
 import java.net.InetSocketAddress;&lt;br/&gt;
 import java.net.URL;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
-import java.util.Random;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.ArrayList;&lt;br/&gt;
-import java.util.HashSet;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
+import java.util.*;&lt;/p&gt;


&lt;p&gt; public class TestProtocolSpecific {&lt;/p&gt;

&lt;p&gt;   protected static final int REPEATING = -1;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected static final File SERVER_PORTS_DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;)+&quot;/server-ports/&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   public static int ackCount;&lt;/p&gt;

&lt;p&gt;@@ -312,23 +308,32 @@ protected int getExpectedHandshakeCount() {&lt;/p&gt;

&lt;p&gt;   public static class InteropTest {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
+    private static File SERVER_PORTS_DIR;&lt;br/&gt;
+    static 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      try {
+        SERVER_PORTS_DIR = Files.createTempDirectory(TestProtocolSpecific.class.getSimpleName()).toFile();
+      } catch (IOException e) {
+        e.printStackTrace();
+      }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+&lt;br/&gt;
+    @Test&lt;br/&gt;
     public void testClient() throws Exception {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;for (File f : SERVER_PORTS_DIR.listFiles()) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (File f }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -337,8 +342,8 @@ public void testClient() throws Exception {&lt;br/&gt;
      */&lt;br/&gt;
     public static void main(String[] args) throws Exception {&lt;br/&gt;
       SocketServer server = new SocketServer(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new SpecificResponder(Simple.class, new TestImpl()),&lt;/li&gt;
	&lt;li&gt;new InetSocketAddress(0));&lt;br/&gt;
+              new SpecificResponder(Simple.class, new TestImpl()),&lt;br/&gt;
+              new InetSocketAddress(0));&lt;br/&gt;
       server.start();&lt;br/&gt;
       File portFile = new File(SERVER_PORTS_DIR, &quot;java-port&quot;);&lt;br/&gt;
       FileWriter w = new FileWriter(portFile);&lt;br/&gt;
diff --git a/lang/java/ipc/src/test/java/org/apache/avro/TestSchema.java b/lang/java/ipc/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
index 31d194323..cc04e3331 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/ipc/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
+++ b/lang/java/ipc/src/test/java/org/apache/avro/TestSchema.java&lt;br/&gt;
@@ -17,16 +17,12 @@&lt;br/&gt;
  */&lt;br/&gt;
 package org.apache.avro;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertFalse;&lt;br/&gt;
-import static org.junit.Assert.assertNull;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
-import static org.junit.Assert.fail;&lt;br/&gt;
-&lt;br/&gt;
 import java.io.ByteArrayInputStream;&lt;br/&gt;
 import java.io.ByteArrayOutputStream;&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
+import java.nio.charset.StandardCharsets;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collection;&lt;br/&gt;
@@ -49,10 +45,21 @@&lt;br/&gt;
 import org.apache.avro.io.Encoder;&lt;br/&gt;
 import org.apache.avro.io.EncoderFactory;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;br/&gt;
+&lt;br/&gt;
+import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; public class TestSchema {&lt;/p&gt;

&lt;p&gt;+  @Rule&lt;br/&gt;
+  public TestName name = new TestName();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   public static final String LISP_SCHEMA = &quot;{\&quot;type\&quot;: \&quot;record\&quot;, \&quot;name\&quot;: \&quot;Lisp\&quot;, \&quot;fields\&quot;: [&quot;&lt;br/&gt;
             +&quot;{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:[\&quot;null\&quot;, \&quot;string\&quot;,&quot;&lt;br/&gt;
             +&quot;{\&quot;type\&quot;: \&quot;record\&quot;, \&quot;name\&quot;: \&quot;Cons\&quot;, \&quot;fields\&quot;: [&quot;&lt;br/&gt;
@@ -87,7 +94,7 @@&lt;br/&gt;
   public void testNull() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.NULL), Schema.parse(&quot;\&quot;null\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.NULL), Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;null\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;null\&quot;&quot;, &quot;null&quot;, null);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()), &quot;\&quot;null\&quot;&quot;, &quot;null&quot;, null);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -95,7 +102,7 @@ public void testBoolean() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.BOOLEAN), Schema.parse(&quot;\&quot;boolean\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.BOOLEAN),&lt;br/&gt;
                  Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;boolean\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;boolean\&quot;&quot;, &quot;true&quot;, Boolean.TRUE);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;boolean\&quot;&quot;, &quot;true&quot;, Boolean.TRUE);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -103,7 +110,7 @@ public void testString() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.STRING), Schema.parse(&quot;\&quot;string\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.STRING),&lt;br/&gt;
                  Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;string\&quot;&quot;, &quot;\&quot;foo\&quot;&quot;, new Utf8(&quot;foo&quot;));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;string\&quot;&quot;, &quot;\&quot;foo\&quot;&quot;, new Utf8(&quot;foo&quot;));&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -111,7 +118,7 @@ public void testBytes() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.BYTES), Schema.parse(&quot;\&quot;bytes\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.BYTES),&lt;br/&gt;
                  Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;bytes\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;bytes\&quot;&quot;, &quot;\&quot;\\u0000ABC\\u00FF\&quot;&quot;,&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;bytes\&quot;&quot;, &quot;\&quot;\\u0000ABC\\u00FF\&quot;&quot;,&lt;br/&gt;
           ByteBuffer.wrap(new byte[]
{0,65,66,67,-1}
&lt;p&gt;));&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -119,14 +126,14 @@ public void testBytes() throws Exception {&lt;br/&gt;
   public void testInt() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.INT), Schema.parse(&quot;\&quot;int\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.INT), Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;int\&quot;&quot;, &quot;9&quot;, new Integer(9));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;int\&quot;&quot;, &quot;9&quot;, 9);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testLong() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.LONG), Schema.parse(&quot;\&quot;long\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.LONG), Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;long\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;long\&quot;&quot;, &quot;11&quot;, new Long(11));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;long\&quot;&quot;, &quot;11&quot;, 11L);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -134,7 +141,7 @@ public void testFloat() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.FLOAT), Schema.parse(&quot;\&quot;float\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.FLOAT),&lt;br/&gt;
                  Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;float\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;\&quot;float\&quot;&quot;, &quot;1.1&quot;, new Float(1.1));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;float\&quot;&quot;, &quot;1.1&quot;, 1.1f);&lt;br/&gt;
     checkDefault(&quot;\&quot;float\&quot;&quot;, &quot;\&quot;NaN\&quot;&quot;, Float.NaN);&lt;br/&gt;
     checkDefault(&quot;\&quot;float\&quot;&quot;, &quot;\&quot;Infinity\&quot;&quot;, Float.POSITIVE_INFINITY);&lt;br/&gt;
     checkDefault(&quot;\&quot;float\&quot;&quot;, &quot;\&quot;-Infinity\&quot;&quot;, Float.NEGATIVE_INFINITY);&lt;br/&gt;
@@ -145,7 +152,7 @@ public void testDouble() throws Exception {&lt;br/&gt;
     assertEquals(Schema.create(Type.DOUBLE), Schema.parse(&quot;\&quot;double\&quot;&quot;));&lt;br/&gt;
     assertEquals(Schema.create(Type.DOUBLE),&lt;br/&gt;
                  Schema.parse(&quot;
{\&quot;type\&quot;:\&quot;double\&quot;}
&lt;p&gt;&quot;));&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;check(&quot;\&quot;double\&quot;&quot;, &quot;1.2&quot;, new Double(1.2));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;\&quot;double\&quot;&quot;, &quot;1.2&quot;, 1.2);&lt;br/&gt;
     checkDefault(&quot;\&quot;double\&quot;&quot;, &quot;\&quot;NaN\&quot;&quot;, Double.NaN);&lt;br/&gt;
     checkDefault(&quot;\&quot;double\&quot;&quot;, &quot;\&quot;Infinity\&quot;&quot;, Double.POSITIVE_INFINITY);&lt;br/&gt;
     checkDefault(&quot;\&quot;double\&quot;&quot;, &quot;\&quot;-Infinity\&quot;&quot;, Double.NEGATIVE_INFINITY);&lt;br/&gt;
@@ -157,10 +164,10 @@ public void testArray() throws Exception {&lt;br/&gt;
     Schema schema = Schema.parse(json);&lt;br/&gt;
     Collection&amp;lt;Long&amp;gt; array = new GenericData.Array&amp;lt;&amp;gt;(1, schema);&lt;br/&gt;
     array.add(1L);&lt;/li&gt;
	&lt;li&gt;check(json, &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&quot;, array);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),json, &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&quot;, array);&lt;br/&gt;
     array = new ArrayList&amp;lt;&amp;gt;(1);&lt;br/&gt;
     array.add(1L);&lt;/li&gt;
	&lt;li&gt;check(json, &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&quot;, array);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),json, &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&quot;, array);&lt;br/&gt;
     checkParseError(&quot;
{\&quot;type\&quot;:\&quot;array\&quot;}
&lt;p&gt;&quot;);      // items required&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -168,7 +175,7 @@ public void testArray() throws Exception {&lt;br/&gt;
   public void testMap() throws Exception {&lt;br/&gt;
     HashMap&amp;lt;Utf8,Long&amp;gt; map = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
     map.put(new Utf8(&quot;a&quot;), 1L);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;
{\&quot;type\&quot;:\&quot;map\&quot;, \&quot;values\&quot;:\&quot;long\&quot;}
&lt;p&gt;&quot;, &quot;&lt;/p&gt;
{\&quot;a\&quot;:1}
&lt;p&gt;&quot;, map);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;map\&quot;, \&quot;values\&quot;:\&quot;long\&quot;}
&lt;p&gt;&quot;, &quot;&lt;/p&gt;
{\&quot;a\&quot;:1}
&lt;p&gt;&quot;, map);&lt;br/&gt;
     checkParseError(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;map\&quot;}
&lt;p&gt;&quot;);        // values required&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -181,7 +188,7 @@ public void testUnionMap() throws Exception &lt;/p&gt;
{
         &quot;    \&quot;null\&quot;]&quot; +
         &quot;   }
&lt;p&gt;]&quot; +&lt;br/&gt;
         &quot; }&quot;;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(unionMapSchema, true);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),unionMapSchema, true);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -192,7 +199,7 @@ public void testRecord() throws Exception {&lt;/p&gt;

&lt;p&gt;     GenericData.Record record = new GenericData.Record(schema);&lt;br/&gt;
     record.put(&quot;f&quot;, 11L);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(recordJson, &quot;
{\&quot;f\&quot;:11}
&lt;p&gt;&quot;, record, false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),recordJson, &quot;&lt;/p&gt;
{\&quot;f\&quot;:11}
&lt;p&gt;&quot;, record, false);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // test field props&lt;br/&gt;
     assertEquals(&quot;bar&quot;, schema.getField(&quot;f&quot;).getProp(&quot;foo&quot;));&lt;br/&gt;
@@ -236,13 +243,13 @@ public void testMapInRecord() throws Exception {&lt;br/&gt;
     map.put(new Utf8(&quot;a&quot;), 1L);&lt;br/&gt;
     GenericData.Record record = new GenericData.Record(schema);&lt;br/&gt;
     record.put(&quot;f&quot;, map);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(json, &quot;{\&quot;f\&quot;:{\&quot;a\&quot;:1}}&quot;, record, false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),json, &quot;{\&quot;f\&quot;:{\&quot;a\&quot;:1}}&quot;, record, false);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;   @Test&lt;br/&gt;
   public void testEnum() throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(BASIC_ENUM_SCHEMA, &quot;\&quot;B\&quot;&quot;,&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),BASIC_ENUM_SCHEMA, &quot;\&quot;B\&quot;&quot;,&lt;br/&gt;
           new GenericData.EnumSymbol(Schema.parse(BASIC_ENUM_SCHEMA), &quot;B&quot;),&lt;br/&gt;
           false);&lt;br/&gt;
     checkParseError(&quot;
{\&quot;type\&quot;:\&quot;enum\&quot;}
&lt;p&gt;&quot;);        // symbols required&lt;br/&gt;
@@ -259,14 +266,15 @@ public void testEnum() throws Exception {&lt;br/&gt;
   public void testFixed() throws Exception {&lt;br/&gt;
     String json = &quot;&lt;/p&gt;
{\&quot;type\&quot;: \&quot;fixed\&quot;, \&quot;name\&quot;:\&quot;Test\&quot;, \&quot;size\&quot;: 1}
&lt;p&gt;&quot;;&lt;br/&gt;
     Schema schema = Schema.parse(json);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;check(json, &quot;\&quot;a\&quot;&quot;,&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),json, &quot;\&quot;a\&quot;&quot;,&lt;br/&gt;
           new GenericData.Fixed(schema, new byte[]
{(byte)&apos;a&apos;}
&lt;p&gt;), false);&lt;br/&gt;
     checkParseError(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;fixed\&quot;}
&lt;p&gt;&quot;);        // size required&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testRecursive() throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;{\&quot;type\&quot;: \&quot;record\&quot;, \&quot;name\&quot;: \&quot;Node\&quot;, \&quot;fields\&quot;: [&quot;&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&lt;br/&gt;
+            &quot;{\&quot;type\&quot;: \&quot;record\&quot;, \&quot;name\&quot;: \&quot;Node\&quot;, \&quot;fields\&quot;: [&quot;&lt;br/&gt;
           +&quot;
{\&quot;name\&quot;:\&quot;label\&quot;, \&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;,&quot;&lt;br/&gt;
           +&quot;{\&quot;name\&quot;:\&quot;children\&quot;, \&quot;type\&quot;:&quot;&lt;br/&gt;
           +&quot;{\&quot;type\&quot;: \&quot;array\&quot;, \&quot;items\&quot;: \&quot;Node\&quot; }}]}&quot;,&lt;br/&gt;
@@ -312,13 +320,13 @@ public void testSchemaExplosion() throws Exception {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testLisp() throws Exception &lt;/p&gt;
{
-    check(LISP_SCHEMA, false);
+    check(new File(DIR.getRoot(), name.getMethodName()),LISP_SCHEMA, false);
   }

&lt;p&gt;   @Test&lt;br/&gt;
   public void testUnion() throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;\&amp;quot;string\&amp;quot;, \&amp;quot;long\&amp;quot;&amp;#93;&lt;/span&gt;&quot;, false);&lt;/li&gt;
	&lt;li&gt;checkDefault(&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;\&amp;quot;double\&amp;quot;, \&amp;quot;long\&amp;quot;&amp;#93;&lt;/span&gt;&quot;, &quot;1.1&quot;, new Double(1.1));&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;\&amp;quot;string\&amp;quot;, \&amp;quot;long\&amp;quot;&amp;#93;&lt;/span&gt;&quot;, false);&lt;br/&gt;
+    checkDefault(&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;\&amp;quot;double\&amp;quot;, \&amp;quot;long\&amp;quot;&amp;#93;&lt;/span&gt;&quot;, &quot;1.1&quot;, 1.1);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // test that erroneous default values cause errors&lt;br/&gt;
     for (String type : new String[]&lt;br/&gt;
@@ -374,8 +382,8 @@ public void testComplexUnions() throws Exception {&lt;br/&gt;
     &quot; &lt;/p&gt;
{\&quot;type\&quot;:\&quot;fixed\&quot;,\&quot;name\&quot;:\&quot;Bar2\&quot;,\&quot;size\&quot;: 1}
&lt;p&gt;,&quot; +&lt;br/&gt;
     &quot; &lt;/p&gt;
{\&quot;type\&quot;:\&quot;enum\&quot;,\&quot;name\&quot;:\&quot;Baz2\&quot;,\&quot;symbols\&quot;: [\&quot;X\&quot;]}
&lt;p&gt;&quot;;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(partial + namedTypes + &quot;]&quot;, false);&lt;/li&gt;
	&lt;li&gt;check(partial + namedTypes + namedTypes2 + &quot;]&quot;, false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),partial + namedTypes + &quot;]&quot;, false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),partial + namedTypes + namedTypes2 + &quot;]&quot;, false);&lt;br/&gt;
     checkParseError(partial + namedTypes + namedTypes + &quot;]&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // fail with two branches of the same unnamed type&lt;br/&gt;
@@ -399,19 +407,19 @@ public void testComplexUnions() throws Exception {&lt;br/&gt;
     u = buildUnion(new Schema[] {&lt;br/&gt;
         Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;x.A\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;),&lt;br/&gt;
         Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;y.A\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;)});&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(u.toString(), false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),u.toString(), false);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     u = buildUnion(new Schema[] {&lt;br/&gt;
         Schema.parse&lt;br/&gt;
         (&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;enum\&quot;,\&quot;name\&quot;:\&quot;x.A\&quot;,\&quot;symbols\&quot;:[\&quot;X\&quot;]}
&lt;p&gt;&quot;),&lt;br/&gt;
         Schema.parse&lt;br/&gt;
         (&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;enum\&quot;,\&quot;name\&quot;:\&quot;y.A\&quot;,\&quot;symbols\&quot;:[\&quot;Y\&quot;]}
&lt;p&gt;&quot;)});&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(u.toString(), false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),u.toString(), false);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     u = buildUnion(new Schema[] {&lt;br/&gt;
         Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;fixed\&quot;,\&quot;name\&quot;:\&quot;x.A\&quot;,\&quot;size\&quot;:4}
&lt;p&gt;&quot;),&lt;br/&gt;
         Schema.parse(&quot;&lt;/p&gt;
{\&quot;type\&quot;:\&quot;fixed\&quot;,\&quot;name\&quot;:\&quot;y.A\&quot;,\&quot;size\&quot;:8}
&lt;p&gt;&quot;)});&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check(u.toString(), false);&lt;br/&gt;
+    check(new File(DIR.getRoot(), name.getMethodName()),u.toString(), false);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // fail with two branches of the same named type, but same names&lt;br/&gt;
     checkUnionError(new Schema[] {Schema.createRecord(&quot;Foo&quot;, null, &quot;org.test&quot;, false),&lt;br/&gt;
@@ -427,13 +435,13 @@ public void testComplexUnions() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testComplexProp() throws Exception {&lt;br/&gt;
+  public void testComplexProp() {&lt;br/&gt;
     String json = &quot;
{\&quot;type\&quot;:\&quot;null\&quot;, \&quot;foo\&quot;: [0]}
&lt;p&gt;&quot;;&lt;br/&gt;
     Schema s = Schema.parse(json);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;assertEquals(null, s.getProp(&quot;foo&quot;));&lt;br/&gt;
+    assertNull(s.getProp(&quot;foo&quot;));&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test public void testPropOrdering() throws Exception {&lt;br/&gt;
+  @Test public void testPropOrdering() {&lt;br/&gt;
     String json = &quot;
{\&quot;type\&quot;:\&quot;int\&quot;,\&quot;z\&quot;:\&quot;c\&quot;,\&quot;yy\&quot;:\&quot;b\&quot;,\&quot;x\&quot;:\&quot;a\&quot;}
&lt;p&gt;&quot;;&lt;br/&gt;
     Schema s = Schema.parse(json);&lt;br/&gt;
     assertEquals(json, s.toString());&lt;br/&gt;
@@ -442,12 +450,12 @@ public void testComplexProp() throws Exception {&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testParseInputStream() throws IOException &lt;/p&gt;
{
     Schema s = Schema.parse(
-        new ByteArrayInputStream(&quot;\&quot;boolean\&quot;&quot;.getBytes(&quot;UTF-8&quot;)));
+        new ByteArrayInputStream(&quot;\&quot;boolean\&quot;&quot;.getBytes(StandardCharsets.UTF_8)));
     assertEquals(Schema.parse(&quot;\&quot;boolean\&quot;&quot;), s);
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNamespaceScope() throws Exception {&lt;br/&gt;
+  public void testNamespaceScope() {&lt;br/&gt;
     String z = &quot;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Z\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;;&lt;br/&gt;
     String y = &quot;&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;type&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;;&lt;br/&gt;
@@ -462,7 +470,7 @@ public void testNamespaceScope() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNamespaceNesting() throws Exception {&lt;br/&gt;
+  public void testNamespaceNesting() {&lt;br/&gt;
     String y = &quot;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;type&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;;&lt;br/&gt;
     String x = &quot;{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;x.X\&quot;,\&quot;fields\&quot;:[&quot;&lt;br/&gt;
@@ -473,7 +481,7 @@ public void testNamespaceNesting() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNestedNullNamespace() throws Exception {&lt;br/&gt;
+  public void testNestedNullNamespace() {&lt;br/&gt;
     Schema inner =&lt;br/&gt;
       Schema.parse(&quot;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Inner\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;);&lt;br/&gt;
     Schema outer = Schema.createRecord(&quot;Outer&quot;, null, &quot;space&quot;, false);&lt;br/&gt;
@@ -503,7 +511,7 @@ public void testNestedNullNamespaceReferencingWithUnion() {&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNestedNonNullNamespace1() throws Exception {&lt;br/&gt;
+  public void testNestedNonNullNamespace1() {&lt;br/&gt;
     Schema inner1 = Schema.createEnum(&quot;InnerEnum&quot;, null, &quot;space&quot;, Arrays.asList(&quot;x&quot;));&lt;br/&gt;
     Schema inner2 = Schema.parse(&quot;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;namespace\&quot;:\&quot;space\&quot;,\&quot;name\&quot;:&quot;
       +&quot;\&quot;InnerRecord\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;);&lt;br/&gt;
@@ -514,7 +522,7 @@ public void testNestedNonNullNamespace1() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNestedNonNullNamespace2() throws Exception {&lt;br/&gt;
+  public void testNestedNonNullNamespace2() {&lt;br/&gt;
     Schema inner1 = Schema.createFixed(&quot;InnerFixed&quot;, null, &quot;space&quot;, 1);&lt;br/&gt;
     Schema inner2 = Schema.parse(&quot;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;namespace\&quot;:\&quot;space\&quot;,\&quot;name\&quot;:&quot;
       +&quot;\&quot;InnerRecord\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;);&lt;br/&gt;
@@ -525,7 +533,7 @@ public void testNestedNonNullNamespace2() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testNullNamespaceAlias() throws Exception {&lt;br/&gt;
+  public void testNullNamespaceAlias() {&lt;br/&gt;
     Schema s =&lt;br/&gt;
       Schema.parse(&quot;
{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Z\&quot;,\&quot;fields\&quot;:[]}
&lt;p&gt;&quot;);&lt;br/&gt;
     Schema t =&lt;br/&gt;
@@ -564,9 +572,7 @@ private static void checkUnionError(Schema[] branches) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {     try {
       Schema.createUnion(branchList);
       fail(&quot;Union should not have constructed from: &quot; + branchList);
-    } catch (AvroRuntimeException are) {
-      return;
-    }&lt;br/&gt;
+    } catch (AvroRuntimeException ignored) { }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   private static Schema buildUnion(Schema[] branches) {&lt;br/&gt;
@@ -606,7 +612,7 @@ public void testFieldDocs() {&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
-  public void testAliases() throws Exception {&lt;br/&gt;
+  public void testAliases() {&lt;br/&gt;
     String t1 = &quot;{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;a.b\&quot;,\&quot;fields\&quot;:[&quot;&lt;br/&gt;
       +&quot;{\&quot;name\&quot;:\&quot;f\&quot;,\&quot;type\&quot;:\&quot;long\&quot;},&quot;&lt;br/&gt;
       +&quot;{\&quot;name\&quot;:\&quot;h\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}]}&quot;;&lt;br/&gt;
@@ -622,7 +628,7 @@ public void testAliases() throws Exception {&lt;br/&gt;
     assertEquals(s2.getField(&quot;g&quot;).aliases(), Collections.singleton(&quot;f&quot;));&lt;br/&gt;
 &lt;br/&gt;
     Schema s3 = Schema.applyAliases(s1,s2);&lt;br/&gt;
-    assertFalse(s2 == s3);&lt;br/&gt;
+    assertNotSame(s2, s3);&lt;br/&gt;
     assertEquals(s2, s3);&lt;br/&gt;
 &lt;br/&gt;
     t1 = &quot;{\&quot;type\&quot;:\&quot;enum\&quot;,\&quot;name\&quot;:\&quot;a.b\&quot;,&quot;&lt;br/&gt;
@@ -632,7 +638,7 @@ public void testAliases() throws Exception {&lt;br/&gt;
     s1 = Schema.parse(t1);&lt;br/&gt;
     s2 = Schema.parse(t2);&lt;br/&gt;
     s3 = Schema.applyAliases(s1,s2);&lt;br/&gt;
-    assertFalse(s2 == s3);&lt;br/&gt;
+    assertNotSame(s2, s3);&lt;br/&gt;
     assertEquals(s2, s3);&lt;br/&gt;
 &lt;br/&gt;
     t1 = &quot;{\&quot;type\&quot;:\&quot;fixed\&quot;,\&quot;name\&quot;:\&quot;a\&quot;,&quot;&lt;br/&gt;
@@ -642,23 +648,20 @@ public void testAliases() throws Exception {
     s1 = Schema.parse(t1);
     s2 = Schema.parse(t2);
     s3 = Schema.applyAliases(s1,s2);
-    assertFalse(s2 == s3);
+    assertNotSame(s2, s3);
     assertEquals(s2, s3);
   }&lt;br/&gt;
 &lt;br/&gt;
-  private static void check(String schemaJson, String defaultJson,&lt;br/&gt;
-                            Object defaultValue) throws Exception {&lt;br/&gt;
-    check(schemaJson, defaultJson, defaultValue, true);&lt;br/&gt;
+  private static void check(File dst, String schemaJson, String defaultJson, Object defaultValue) throws Exception {
+    check(dst, schemaJson, defaultJson, defaultValue, true);
   }&lt;br/&gt;
-  private static void check(String schemaJson, String defaultJson,&lt;br/&gt;
-                            Object defaultValue, boolean induce)&lt;br/&gt;
-    throws Exception {&lt;br/&gt;
-    check(schemaJson, induce);&lt;br/&gt;
+&lt;br/&gt;
+  private static void check(File dst, String schemaJson, String defaultJson, Object defaultValue, boolean induce) throws Exception {
+    check(dst, schemaJson, induce);
     checkDefault(schemaJson, defaultJson, defaultValue);
   }&lt;br/&gt;
 &lt;br/&gt;
-  private static void check(String jsonSchema, boolean induce)&lt;br/&gt;
-    throws Exception {&lt;br/&gt;
+  private static void check(File dst, String jsonSchema, boolean induce) throws Exception {&lt;br/&gt;
     Schema schema = Schema.parse(jsonSchema);&lt;br/&gt;
     checkProp(schema);&lt;br/&gt;
     Object reuse = null;&lt;br/&gt;
@@ -689,7 +692,7 @@ private static void check(String jsonSchema, boolean induce)&lt;br/&gt;
           new GenericDatumReader&amp;lt;&amp;gt;());&lt;br/&gt;
 &lt;br/&gt;
       // Check that we can generate the code for every schema we see.&lt;br/&gt;
-      TestSpecificCompiler.assertCompiles(schema, false);&lt;br/&gt;
+      TestSpecificCompiler.assertCompiles(dst, schema, false);&lt;br/&gt;
 &lt;br/&gt;
       // Check that we can read/write the json of every schema we see.&lt;br/&gt;
       checkBinaryJson(jsonSchema);&lt;br/&gt;
@@ -698,15 +701,15 @@ private static void check(String jsonSchema, boolean induce)&lt;br/&gt;
 &lt;br/&gt;
   private static void checkProp(Schema s0) throws Exception {
     if(s0.getType().equals(Schema.Type.UNION)) return; // unions have no props
-    assertEquals(null, s0.getProp(&quot;foo&quot;));
+    assertNull(s0.getProp(&quot;foo&quot;));
     Schema s1 = Schema.parse(s0.toString());
     s1.addProp(&quot;foo&quot;, &quot;bar&quot;);
     assertEquals(&quot;bar&quot;, s1.getProp(&quot;foo&quot;));
-    assertFalse(s0.equals(s1));
+    assertNotEquals(s0, s1);
     Schema s2 = Schema.parse(s1.toString());
     assertEquals(&quot;bar&quot;, s2.getProp(&quot;foo&quot;));
     assertEquals(s1, s2);
-    assertFalse(s0.equals(s2));
+    assertNotEquals(s0, s2);
   }&lt;br/&gt;
 &lt;br/&gt;
   public static void checkBinary(Schema schema, Object datum,&lt;br/&gt;
@@ -806,7 +809,7 @@ private static void checkJson(Schema schema, Object datum,&lt;br/&gt;
     encoder.flush();&lt;br/&gt;
     byte[] data = out.toByteArray();&lt;br/&gt;
 &lt;br/&gt;
-    String encoded = new String(data, &quot;UTF-8&quot;);&lt;br/&gt;
+    String encoded = new String(data, StandardCharsets.UTF_8);&lt;br/&gt;
     assertEquals(&quot;Encoded data does not match.&quot;, json, encoded);&lt;br/&gt;
 &lt;br/&gt;
     DatumReader&amp;lt;Object&amp;gt; reader = new GenericDatumReader&amp;lt;&amp;gt;();&lt;br/&gt;
@@ -862,9 +865,7 @@ private static void checkValidateDefaults(String schemaJson, String defaultJson)&lt;br/&gt;
               &lt;ins&gt;&quot;\&quot;default\&quot;:&quot;+defaultJson&lt;/ins&gt;&quot;}]}&quot;;&lt;br/&gt;
       parser.parse(recordJson);&lt;br/&gt;
       fail(&quot;Schema of type &quot; + schemaJson + &quot; should not have default &quot; + defaultJson);&lt;br/&gt;
-    } catch (AvroTypeException e) {-      return;-    }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; catch (AvroTypeException ignored) { }&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test(expected=AvroTypeException.class)&lt;br/&gt;
@@ -932,8 +933,7 @@ public void testImmutability2() {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   private static List&amp;lt;String&amp;gt; lockedArrayList() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new Schema.LockableArrayList&amp;lt;&amp;gt;(Arrays.asList(new String[]
{
-        &quot;a&quot;, &quot;b&quot;, &quot;c&quot;}
&lt;p&gt;)).lock();&lt;br/&gt;
+    return new Schema.LockableArrayList&amp;lt;&amp;gt;(Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)).lock();&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test(expected=IllegalStateException.class)&lt;br/&gt;
@@ -948,25 +948,22 @@ public void testLockedArrayList2() {&lt;/p&gt;

&lt;p&gt;   @Test(expected=IllegalStateException.class)&lt;br/&gt;
   public void testLockedArrayList3() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lockedArrayList().addAll(Arrays.asList(new String[] 
{ &quot;p&quot; }));&lt;br/&gt;
+    lockedArrayList().addAll(Collections.singletonList(&quot;p&quot;));&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test(expected=IllegalStateException.class)&lt;br/&gt;
   public void testLockedArrayList4() {&lt;br/&gt;
-    lockedArrayList().addAll(0,&lt;br/&gt;
-        Arrays.asList(new String[] { &quot;p&quot; }
&lt;p&gt;));&lt;br/&gt;
+    lockedArrayList().addAll(0, Collections.singletonList(&quot;p&quot;));&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test(expected=IllegalStateException.class)&lt;br/&gt;
   public void testLockedArrayList5() {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lockedArrayList().&lt;/li&gt;
	&lt;li&gt;removeAll(Arrays.asList(new String[] 
{ &quot;a&quot; }));&lt;br/&gt;
+    lockedArrayList().removeAll(Collections.singletonList(&quot;a&quot;));&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test(expected=IllegalStateException.class)&lt;br/&gt;
   public void testLockedArrayList6() {&lt;br/&gt;
-    lockedArrayList().&lt;br/&gt;
-      retainAll(Arrays.asList(new String[] { &quot;a&quot; }
&lt;p&gt;));&lt;br/&gt;
+    lockedArrayList().retainAll(Collections.singletonList(&quot;a&quot;));&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test(expected=IllegalStateException.class)&lt;br/&gt;
diff --git a/lang/java/ipc/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java b/lang/java/ipc/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
index cb39b5a75..a39ab27a3 100644&lt;br/&gt;
&amp;#8212; a/lang/java/ipc/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
+++ b/lang/java/ipc/src/test/java/org/apache/avro/compiler/specific/TestSpecificCompiler.java&lt;br/&gt;
@@ -24,6 +24,7 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.FileWriter;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collection;&lt;br/&gt;
@@ -35,7 +36,6 @@&lt;br/&gt;
 import javax.tools.ToolProvider;&lt;br/&gt;
 import javax.tools.JavaCompiler.CompilationTask;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Protocol;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Field;&lt;br/&gt;
@@ -51,9 +51,22 @@&lt;br/&gt;
 import org.apache.avro.test.Kind;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.compiler.specific.SpecificCompiler.OutputFile;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;/p&gt;

&lt;p&gt; public class TestSpecificCompiler {&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TestName name = new TestName();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   static final String PROTOCOL = &quot;&quot; +&lt;br/&gt;
         &quot;{ \&quot;protocol\&quot;: \&quot;default\&quot;,\n&quot; +&lt;br/&gt;
         &quot;  \&quot;types\&quot;:\n&quot; +&lt;br/&gt;
@@ -96,7 +109,7 @@ public void testSimpleEnumSchema() throws IOException &lt;/p&gt;
{
     OutputFile o = outputs.iterator().next();
     assertEquals(o.path, &quot;Test.java&quot;);
     assertTrue(o.contents.contains(&quot;public enum Test&quot;));
-    assertCompilesWithJavaCompiler(outputs);
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), outputs);
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -107,10 +120,8 @@ public void testMangleIfReserved() {&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
   public void testManglingForProtocols() throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String protocolDef = PROTOCOL;&lt;/li&gt;
	&lt;li&gt;Collection&amp;lt;OutputFile&amp;gt; c =&lt;/li&gt;
	&lt;li&gt;new SpecificCompiler(Protocol.parse(protocolDef)).compile();&lt;/li&gt;
	&lt;li&gt;Iterator&amp;lt;OutputFile&amp;gt; i = c.iterator();&lt;br/&gt;
+    Collection&amp;lt;OutputFile&amp;gt; outputs = new SpecificCompiler(Protocol.parse(PROTOCOL)).compile();&lt;br/&gt;
+    Iterator&amp;lt;OutputFile&amp;gt; i = outputs.iterator();&lt;br/&gt;
     String errType = i.next().contents;&lt;br/&gt;
     String protocol = i.next().contents;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -121,7 +132,7 @@ public void testManglingForProtocols() throws IOException &lt;/p&gt;
{
     assertTrue(protocol.contains(&quot;public interface default$&quot;));
     assertTrue(protocol.contains(&quot;throws org.apache.avro.AvroRemoteException, finally$&quot;));
 
-    assertCompilesWithJavaCompiler(c);
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), outputs);
 
   }

&lt;p&gt;@@ -137,16 +148,15 @@ public void testManglingForProtocols() throws IOException {&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
   public void testManglingForRecords() throws IOException &lt;/p&gt;
{
-    Collection&amp;lt;OutputFile&amp;gt; c =
-      new SpecificCompiler(Schema.parse(SCHEMA)).compile();
-    assertEquals(1, c.size());
-    String contents = c.iterator().next().contents;
+    Collection&amp;lt;OutputFile&amp;gt; outputs = new SpecificCompiler(Schema.parse(SCHEMA)).compile();
+    assertEquals(1, outputs.size());
+    String contents = outputs.iterator().next().contents;
 
     assertTrue(contents.contains(&quot;public java.lang.CharSequence package$;&quot;));
     assertTrue(contents.contains(&quot;class volatile$ extends&quot;));
     assertTrue(contents.contains(&quot;volatile$ short$;&quot;));
 
-    assertCompilesWithJavaCompiler(c);
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), outputs);
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -154,14 +164,14 @@ public void testManglingForEnums() throws IOException {&lt;br/&gt;
     String enumSchema = &quot;&quot; +&lt;br/&gt;
       &quot;&lt;/p&gt;
{ \&quot;name\&quot;: \&quot;instanceof\&quot;, \&quot;type\&quot;: \&quot;enum\&quot;,&quot; +
       &quot;  \&quot;symbols\&quot;: [\&quot;new\&quot;, \&quot;super\&quot;, \&quot;switch\&quot;] }
&lt;p&gt;&quot;;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Collection&amp;lt;OutputFile&amp;gt; c =&lt;br/&gt;
+    Collection&amp;lt;OutputFile&amp;gt; outputs =&lt;br/&gt;
       new SpecificCompiler(Schema.parse(enumSchema)).compile();&lt;/li&gt;
	&lt;li&gt;assertEquals(1, c.size());&lt;/li&gt;
	&lt;li&gt;String contents = c.iterator().next().contents;&lt;br/&gt;
+    assertEquals(1, outputs.size());&lt;br/&gt;
+    String contents = outputs.iterator().next().contents;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     assertTrue(contents.contains(&quot;new$&quot;));&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;assertCompilesWithJavaCompiler(c);&lt;br/&gt;
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), outputs);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -169,7 +179,7 @@ public void testSchemaSplit() throws IOException &lt;/p&gt;
{
     SpecificCompiler compiler = new SpecificCompiler(Schema.parse(SCHEMA));
     compiler.maxStringChars = 10;
     Collection&amp;lt;OutputFile&amp;gt; files = compiler.compile();
-    assertCompilesWithJavaCompiler(files);
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), files);
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -177,7 +187,7 @@ public void testProtocolSplit() throws IOException &lt;/p&gt;
{
     SpecificCompiler compiler = new SpecificCompiler(Protocol.parse(PROTOCOL));
     compiler.maxStringChars = 10;
     Collection&amp;lt;OutputFile&amp;gt; files = compiler.compile();
-    assertCompilesWithJavaCompiler(files);
+    assertCompilesWithJavaCompiler(new File(INPUT_DIR.getRoot(), name.getMethodName()), files);
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -230,13 +240,13 @@ public void testNeedCompile() throws IOException, InterruptedException {&lt;br/&gt;
       &quot;{ \&quot;name\&quot;: \&quot;Foo\&quot;, \&quot;type\&quot;: \&quot;record\&quot;, &quot; +&lt;br/&gt;
       &quot;  \&quot;fields\&quot;: [ &lt;/p&gt;
{\&quot;name\&quot;: \&quot;package\&quot;, \&quot;type\&quot;: \&quot;string\&quot; }
&lt;p&gt;,&quot; +&lt;br/&gt;
       &quot;                &lt;/p&gt;
{\&quot;name\&quot;: \&quot;short\&quot;, \&quot;type\&quot;: \&quot;Foo\&quot; }
&lt;p&gt; ] }&quot;;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File inputFile = AvroTestUtil.tempFile(getClass(), &quot;input.avsc&quot;);&lt;/li&gt;
	&lt;li&gt;FileWriter fw = new FileWriter(inputFile);&lt;/li&gt;
	&lt;li&gt;fw.write(schema);&lt;/li&gt;
	&lt;li&gt;fw.close();&lt;br/&gt;
+    File inputFile = new File(INPUT_DIR.getRoot().getPath(), &quot;input.avsc&quot;);&lt;br/&gt;
+    try(FileWriter fw = new FileWriter(inputFile)) 
{
+      fw.write(schema);
+    }&lt;br/&gt;
+&lt;br/&gt;
+    File outputDir = OUTPUT_DIR.getRoot();&lt;br/&gt;
 &lt;br/&gt;
-    File outputDir = new File(System.getProperty(&quot;test.dir&quot;, &quot;target/test&quot;) +&lt;br/&gt;
-      System.getProperty(&quot;file.separator&quot;) + &quot;test_need_compile&quot;);&lt;br/&gt;
     File outputFile = new File(outputDir, &quot;Foo.java&quot;);&lt;br/&gt;
     outputFile.delete();&lt;br/&gt;
     assertTrue(!outputFile.exists());&lt;br/&gt;
@@ -251,9 +261,9 @@ public void testNeedCompile() throws IOException, InterruptedException {&lt;br/&gt;
     SpecificCompiler.compileSchema(inputFile, outputDir);&lt;br/&gt;
     assertEquals(lastModified, outputFile.lastModified());&lt;br/&gt;
 &lt;br/&gt;
-    fw = new FileWriter(inputFile);&lt;br/&gt;
-    fw.write(schema);&lt;br/&gt;
-    fw.close();&lt;br/&gt;
+    try(FileWriter fw = new FileWriter(inputFile)) {+      fw.write(schema);+    }
&lt;p&gt;     SpecificCompiler.compileSchema(inputFile, outputDir);&lt;br/&gt;
     assertTrue(lastModified != outputFile.lastModified());&lt;br/&gt;
   }&lt;br/&gt;
@@ -265,8 +275,7 @@ public void testNeedCompile() throws IOException, InterruptedException {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;@param fields the field(s) to add to the schema.&lt;/li&gt;
	&lt;li&gt;@return the schema.&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private Schema createRecord(String name,&lt;/li&gt;
	&lt;li&gt;boolean isError, Field... fields) {&lt;br/&gt;
+  private Schema createRecord(String name, boolean isError, Field... fields) {&lt;br/&gt;
     Schema record = Schema.createRecord(name, null, null, isError);&lt;br/&gt;
     record.setFields(Arrays.asList(fields));&lt;br/&gt;
     return record;&lt;br/&gt;
@@ -405,7 +414,6 @@ public void generateSetMethod() {&lt;br/&gt;
     assertEquals(&quot;setCause$&quot;, SpecificCompiler.generateSetMethod(&lt;br/&gt;
         createRecord(&quot;test&quot;, true, cause), cause));&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-&lt;br/&gt;
     assertEquals(&quot;setClass$&quot;, SpecificCompiler.generateSetMethod(&lt;br/&gt;
         createRecord(&quot;test&quot;, false, clasz), clasz));&lt;br/&gt;
     clasz = new Field(&quot;class&quot;, Schema.create(Type.STRING), null, null);&lt;br/&gt;
@@ -694,13 +702,11 @@ public void testAliases() throws IOException {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;optionally, uses the system&apos;s Java compiler to check&lt;/li&gt;
	&lt;li&gt;that the generated code is valid.&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void&lt;/li&gt;
	&lt;li&gt;assertCompiles(Schema schema, boolean useJavaCompiler)&lt;/li&gt;
	&lt;li&gt;throws IOException {&lt;br/&gt;
+  public static void assertCompiles(File dstDir,Schema schema, boolean useJavaCompiler) throws IOException {&lt;br/&gt;
     Collection&amp;lt;OutputFile&amp;gt; outputs = new SpecificCompiler(schema).compile();&lt;/li&gt;
	&lt;li&gt;assertTrue(null != outputs);&lt;br/&gt;
+    assertNotNull(outputs);&lt;br/&gt;
     if (useJavaCompiler) 
{
-      assertCompilesWithJavaCompiler(outputs);
+      assertCompilesWithJavaCompiler(dstDir, outputs);
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -709,22 +715,20 @@ public void testAliases() throws IOException {&lt;br/&gt;
    * and, optionally, uses the system&apos;s Java compiler to check&lt;br/&gt;
    * that the generated code is valid.&lt;br/&gt;
    */&lt;br/&gt;
-  public static void assertCompiles(Protocol protocol, boolean useJavaCompiler)&lt;br/&gt;
-  throws IOException {&lt;br/&gt;
+  public static void assertCompiles(File dstDir, Protocol protocol, boolean useJavaCompiler) throws IOException {&lt;br/&gt;
     Collection&amp;lt;OutputFile&amp;gt; outputs = new SpecificCompiler(protocol).compile();&lt;br/&gt;
-    assertTrue(null != outputs);&lt;br/&gt;
+    assertNotNull(outputs);&lt;br/&gt;
     if (useJavaCompiler) {-      assertCompilesWithJavaCompiler(outputs);+      assertCompilesWithJavaCompiler(dstDir, outputs);     }
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /** Uses the system&apos;s java compiler to actually compile the generated code. */&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;static void assertCompilesWithJavaCompiler(Collection&amp;lt;OutputFile&amp;gt; outputs)&lt;/li&gt;
	&lt;li&gt;throws IOException {&lt;br/&gt;
+  static void assertCompilesWithJavaCompiler(File dstDir, Collection&amp;lt;OutputFile&amp;gt; outputs) throws IOException {&lt;br/&gt;
     if (outputs.isEmpty()) 
{
-      return;               // Nothing to compile!
+      return; // Nothing to compile!
     }&lt;/li&gt;
	&lt;li&gt;File dstDir = AvroTestUtil.tempFile(TestSpecificCompiler.class, &quot;realCompiler&quot;);&lt;br/&gt;
+&lt;br/&gt;
     List&amp;lt;File&amp;gt; javaFiles = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
     for (OutputFile o : outputs) 
{
       javaFiles.add(o.writeToDestination(null, dstDir));
@@ -736,8 +740,8 @@ static void assertCompilesWithJavaCompiler(Collection&amp;lt;OutputFile&amp;gt; outputs)
 
     CompilationTask cTask = compiler.getTask(null, fileManager, null, null,
         null,
-        fileManager.getJavaFileObjects(
-            javaFiles.toArray(new File[javaFiles.size()])));
+        fileManager.getJavaFileObjects(javaFiles.toArray(new File[javaFiles.size()]))
+    );
     assertTrue(cTask.call());
   }
&lt;p&gt; }&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroInputFormat.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroInputFormat.java&lt;br/&gt;
index 2ef1fcda3..350dc7f08 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroInputFormat.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroInputFormat.java&lt;br/&gt;
@@ -18,12 +18,7 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; package org.apache.avro.mapred;&lt;/p&gt;

&lt;p&gt;-import java.io.File;&lt;br/&gt;
-import java.util.HashSet;&lt;br/&gt;
-import java.util.Set;&lt;br/&gt;
-&lt;br/&gt;
 import junit.framework.Assert;&lt;br/&gt;
-&lt;br/&gt;
 import org.apache.hadoop.fs.FileStatus;&lt;br/&gt;
 import org.apache.hadoop.fs.FileSystem;&lt;br/&gt;
 import org.apache.hadoop.fs.Path;&lt;br/&gt;
@@ -31,12 +26,20 @@&lt;br/&gt;
 import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
 import org.junit.After;&lt;br/&gt;
 import org.junit.Before;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
+import java.util.HashSet;&lt;br/&gt;
+import java.util.Set;&lt;/p&gt;

&lt;p&gt; public class TestAvroInputFormat {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final String TEST_DIR = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) +&lt;/li&gt;
	&lt;li&gt;File.separator + TestAvroInputFormat.class.getName();&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   private JobConf conf;&lt;br/&gt;
   private FileSystem fs;&lt;br/&gt;
   private Path inputDir;&lt;br/&gt;
@@ -45,10 +48,9 @@&lt;br/&gt;
   public void setUp() throws Exception 
{
     conf = new JobConf();
     fs = FileSystem.getLocal(conf);
-    inputDir = new Path(TEST_DIR);
+    inputDir = new Path(DIR.getRoot().getPath());
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-&lt;br/&gt;
   @After&lt;br/&gt;
   public void tearDown() throws Exception {&lt;br/&gt;
     fs.delete(inputDir, true);&lt;br/&gt;
@@ -65,7 +67,6 @@ public void testIgnoreFilesWithoutExtension() throws Exception {&lt;/p&gt;

&lt;p&gt;     FileInputFormat.setInputPaths(conf, inputDir);&lt;/p&gt;

&lt;p&gt;-&lt;br/&gt;
     AvroInputFormat inputFormat = new AvroInputFormat();&lt;br/&gt;
     FileStatus[] statuses = inputFormat.listStatus(conf);&lt;br/&gt;
     Assert.assertEquals(1, statuses.length);&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleInputs.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleInputs.java&lt;br/&gt;
index 3eb849c05..1ba918949 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleInputs.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleInputs.java&lt;br/&gt;
@@ -37,18 +37,32 @@&lt;br/&gt;
 import org.apache.avro.reflect.ReflectData;&lt;br/&gt;
 import org.apache.avro.reflect.ReflectDatumWriter;&lt;br/&gt;
 import org.apache.avro.reflect.ReflectDatumReader;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; import static org.junit.Assert.*;&lt;/p&gt;

&lt;p&gt; public class TestAvroMultipleInputs {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/** The input-1 record. */&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR_1 = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR_2 = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  /**&lt;br/&gt;
+   * The input-1 record.&lt;br/&gt;
+   */&lt;br/&gt;
   public static class NamesRecord {&lt;br/&gt;
     private int id = -1;&lt;br/&gt;
     private CharSequence name = &quot;&quot;;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public NamesRecord() {}&lt;br/&gt;
+    public NamesRecord() 
{
+    }&lt;br/&gt;
 &lt;br/&gt;
     public NamesRecord(int id, CharSequence name) {&lt;br/&gt;
       this.id = id;&lt;br/&gt;
@@ -61,12 +75,15 @@ public String toString() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
-  /** The input-2 record. */&lt;br/&gt;
+  /**&lt;br/&gt;
+   * The input-2 record.&lt;br/&gt;
+   */&lt;br/&gt;
   public static class BalancesRecord {&lt;br/&gt;
     private int id = -1;&lt;br/&gt;
     private long balance = 0L;&lt;br/&gt;
 &lt;br/&gt;
-    public BalancesRecord() {}&lt;br/&gt;
+    public BalancesRecord() {+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     public BalancesRecord(int id, long balance) {&lt;br/&gt;
       this.id = id;&lt;br/&gt;
@@ -79,11 +96,14 @@ public String toString() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/** The map output key record. */&lt;br/&gt;
+  /**&lt;br/&gt;
+   * The map output key record.&lt;br/&gt;
+   */&lt;br/&gt;
   public static class KeyRecord {&lt;br/&gt;
     private int id = -1;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public KeyRecord() {}&lt;br/&gt;
+    public KeyRecord() 
{
+    }&lt;br/&gt;
 &lt;br/&gt;
     public KeyRecord(int id) {&lt;br/&gt;
       this.id = id;&lt;br/&gt;
@@ -95,9 +115,10 @@ public String toString() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
-  /** The common map output value record.&lt;br/&gt;
-   *  Carries a tag specifying what source&lt;br/&gt;
-   *  record type was.&lt;br/&gt;
+  /**&lt;br/&gt;
+   * The common map output value record.&lt;br/&gt;
+   * Carries a tag specifying what source&lt;br/&gt;
+   * record type was.&lt;br/&gt;
    */&lt;br/&gt;
   public static class JoinableRecord {&lt;br/&gt;
     private int id = -1;&lt;br/&gt;
@@ -105,13 +126,14 @@ public String toString() {&lt;br/&gt;
     private long balance = 0L;&lt;br/&gt;
     private CharSequence recType = &quot;&quot;;&lt;br/&gt;
 &lt;br/&gt;
-    public JoinableRecord() {}&lt;br/&gt;
+    public JoinableRecord() {+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     public JoinableRecord(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CharSequence recType,&lt;/li&gt;
	&lt;li&gt;int id,&lt;/li&gt;
	&lt;li&gt;CharSequence name,&lt;/li&gt;
	&lt;li&gt;long balance) {&lt;br/&gt;
+            CharSequence recType,&lt;br/&gt;
+            int id,&lt;br/&gt;
+            CharSequence name,&lt;br/&gt;
+            long balance) {&lt;br/&gt;
       this.id = id;&lt;br/&gt;
       this.recType = recType;&lt;br/&gt;
       this.name = name;&lt;br/&gt;
@@ -124,13 +146,16 @@ public String toString() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;/** The output, combined record. */&lt;br/&gt;
+  /**&lt;br/&gt;
+   * The output, combined record.&lt;br/&gt;
+   */&lt;br/&gt;
   public static class CompleteRecord {&lt;br/&gt;
     private int id = -1;&lt;br/&gt;
     private CharSequence name = &quot;&quot;;&lt;br/&gt;
     private long balance = 0L;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public CompleteRecord() {}&lt;br/&gt;
+    public CompleteRecord() 
{
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     public CompleteRecord(int id, CharSequence name, long balance) {&lt;br/&gt;
       this.name = name;&lt;br/&gt;
@@ -138,11 +163,17 @@ public CompleteRecord(int id, CharSequence name, long balance) &lt;/p&gt;
{
       this.balance = balance;
     }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;void setId(int id) 
{ this.id = id; }
&lt;p&gt;;&lt;br/&gt;
+    void setId(int id) &lt;/p&gt;
{
+      this.id = id;
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;void setName(CharSequence name) 
{ this.name = name; }
&lt;p&gt;;&lt;br/&gt;
+    void setName(CharSequence name) &lt;/p&gt;
{
+      this.name = name;
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;void setBalance(long balance) 
{ this.balance = balance; }
&lt;p&gt;;&lt;br/&gt;
+    void setBalance(long balance) &lt;/p&gt;
{
+      this.balance = balance;
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;br/&gt;
     public String toString() {&lt;br/&gt;
@@ -151,41 +182,41 @@ public String toString() {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   public static class NamesMapImpl&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends AvroMapper&amp;lt;NamesRecord, Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; {&lt;br/&gt;
+          extends AvroMapper&amp;lt;NamesRecord, Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;br/&gt;
     public void map(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;NamesRecord nameRecord,&lt;/li&gt;
	&lt;li&gt;AvroCollector&amp;lt;Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; collector,&lt;/li&gt;
	&lt;li&gt;Reporter reporter) throws IOException {&lt;br/&gt;
+            NamesRecord nameRecord,&lt;br/&gt;
+            AvroCollector&amp;lt;Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; collector,&lt;br/&gt;
+            Reporter reporter) throws IOException 
{
       collector.collect(
-          new Pair&amp;lt;&amp;gt;(
-              new KeyRecord(nameRecord.id),
-              new JoinableRecord(nameRecord.getClass().getName(),
-                  nameRecord.id, nameRecord.name, -1L)));
+              new Pair&amp;lt;&amp;gt;(
+                      new KeyRecord(nameRecord.id),
+                      new JoinableRecord(nameRecord.getClass().getName(),
+                              nameRecord.id, nameRecord.name, -1L)));
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   }&lt;/p&gt;

&lt;p&gt;   public static class BalancesMapImpl&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends AvroMapper&amp;lt;BalancesRecord, Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; {&lt;br/&gt;
+          extends AvroMapper&amp;lt;BalancesRecord, Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void map(&lt;/li&gt;
	&lt;li&gt;BalancesRecord balanceRecord,&lt;/li&gt;
	&lt;li&gt;AvroCollector&amp;lt;Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; collector,&lt;/li&gt;
	&lt;li&gt;Reporter reporter) throws IOException {&lt;br/&gt;
+    public void map(&lt;br/&gt;
+            BalancesRecord balanceRecord,&lt;br/&gt;
+            AvroCollector&amp;lt;Pair&amp;lt;KeyRecord, JoinableRecord&amp;gt;&amp;gt; collector,&lt;br/&gt;
+            Reporter reporter) throws IOException 
{
       collector.collect(
-          new Pair&amp;lt;&amp;gt;(
-              new KeyRecord(balanceRecord.id),
-              new JoinableRecord(balanceRecord.getClass().getName(),
-                  balanceRecord.id, &quot;&quot;, balanceRecord.balance)));
+              new Pair&amp;lt;&amp;gt;(
+                      new KeyRecord(balanceRecord.id),
+                      new JoinableRecord(balanceRecord.getClass().getName(),
+                              balanceRecord.id, &quot;&quot;, balanceRecord.balance)));
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   }&lt;/p&gt;

&lt;p&gt;   public static class ReduceImpl&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends AvroReducer&amp;lt;KeyRecord, JoinableRecord, CompleteRecord&amp;gt; {&lt;br/&gt;
+          extends AvroReducer&amp;lt;KeyRecord, JoinableRecord, CompleteRecord&amp;gt; {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;br/&gt;
     public void reduce(KeyRecord ID, Iterable&amp;lt;JoinableRecord&amp;gt; joinables,&lt;br/&gt;
@@ -208,31 +239,27 @@ public void reduce(KeyRecord ID, Iterable&amp;lt;JoinableRecord&amp;gt; joinables,&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testJob() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) +&lt;/li&gt;
	&lt;li&gt;&quot;target/testAvroMultipleInputs&quot;;&lt;/li&gt;
	&lt;li&gt;Path inputPath1 = new Path(dir + &quot;/in1&quot;);&lt;/li&gt;
	&lt;li&gt;Path inputPath2 = new Path(dir + &quot;/in2&quot;);&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+    Path inputPath1 = new Path(INPUT_DIR_1.getRoot().getPath());&lt;br/&gt;
+    Path inputPath2 = new Path(INPUT_DIR_2.getRoot().getPath());&lt;br/&gt;
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;outputPath.getFileSystem(job).delete(outputPath, true);&lt;/li&gt;
	&lt;li&gt;inputPath1.getFileSystem(job).delete(inputPath1, true);&lt;/li&gt;
	&lt;li&gt;inputPath2.getFileSystem(job).delete(inputPath2, true);&lt;br/&gt;
+    outputPath.getFileSystem(job).delete(outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     writeNamesFiles(new File(inputPath1.toUri().getPath()));&lt;br/&gt;
     writeBalancesFiles(new File(inputPath2.toUri().getPath()));&lt;/p&gt;

&lt;p&gt;     job.setJobName(&quot;multiple-inputs-join&quot;);&lt;br/&gt;
     AvroMultipleInputs.addInputPath(job, inputPath1, NamesMapImpl.class,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ReflectData.get().getSchema(NamesRecord.class));&lt;br/&gt;
+            ReflectData.get().getSchema(NamesRecord.class));&lt;br/&gt;
     AvroMultipleInputs.addInputPath(job, inputPath2, BalancesMapImpl.class,&lt;/li&gt;
	&lt;li&gt;ReflectData.get().getSchema(BalancesRecord.class));&lt;br/&gt;
+            ReflectData.get().getSchema(BalancesRecord.class));&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Schema keySchema = ReflectData.get().getSchema(KeyRecord.class);&lt;br/&gt;
     Schema valueSchema = ReflectData.get().getSchema(JoinableRecord.class);&lt;br/&gt;
     AvroJob.setMapOutputSchema(job,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Pair.getPairSchema(keySchema, valueSchema));&lt;br/&gt;
+            Pair.getPairSchema(keySchema, valueSchema));&lt;br/&gt;
     AvroJob.setOutputSchema(job,&lt;/li&gt;
	&lt;li&gt;ReflectData.get().getSchema(CompleteRecord.class));&lt;br/&gt;
+            ReflectData.get().getSchema(CompleteRecord.class));&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     AvroJob.setReducerClass(job, ReduceImpl.class);&lt;br/&gt;
     job.setNumReduceTasks(1);&lt;br/&gt;
@@ -243,7 +270,7 @@ public void testJob() throws Exception &lt;/p&gt;
{
 
     JobClient.runJob(job);
 
-    validateCompleteFile(new File(new File(dir, &quot;out&quot;), &quot;part-00000.avro&quot;));
+    validateCompleteFile(new File(OUTPUT_DIR.getRoot(), &quot;part-00000.avro&quot;));
   }

&lt;p&gt;   /**&lt;br/&gt;
@@ -251,45 +278,42 @@ public void testJob() throws Exception {&lt;br/&gt;
    */&lt;br/&gt;
   private void writeNamesFiles(File dir) throws IOException {&lt;br/&gt;
     DatumWriter&amp;lt;NamesRecord&amp;gt; writer = new ReflectDatumWriter&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileWriter&amp;lt;NamesRecord&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer);&lt;/li&gt;
	&lt;li&gt;File namesFile = new File(dir+&quot;/names.avro&quot;);&lt;/li&gt;
	&lt;li&gt;dir.mkdirs();&lt;/li&gt;
	&lt;li&gt;out.create(ReflectData.get().getSchema(NamesRecord.class), namesFile);&lt;/li&gt;
	&lt;li&gt;for (int i=0; i &amp;lt; 5; i++)&lt;/li&gt;
	&lt;li&gt;out.append(new NamesRecord(i, &quot;record&quot;+i));&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+    File namesFile = new File(dir + &quot;/names.avro&quot;);&lt;br/&gt;
+    try (DataFileWriter&amp;lt;NamesRecord&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      out.create(ReflectData.get().getSchema(NamesRecord.class), namesFile);+      for (int i = 0; i &amp;lt; 5; i++) {
+        out.append(new NamesRecord(i, &quot;record&quot; + i));
+      }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Writes a &quot;balances.avro&quot; file with five sequential &amp;lt;id, balance&amp;gt; pairs.&lt;br/&gt;
    */&lt;br/&gt;
   private void writeBalancesFiles(File dir) throws IOException {&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumWriter&amp;lt;BalancesRecord&amp;gt; writer =&lt;/li&gt;
	&lt;li&gt;new ReflectDatumWriter&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;BalancesRecord&amp;gt; out =&lt;/li&gt;
	&lt;li&gt;new DataFileWriter&amp;lt;&amp;gt;(writer);&lt;/li&gt;
	&lt;li&gt;File namesFile = new File(dir+&quot;/balances.avro&quot;);&lt;/li&gt;
	&lt;li&gt;dir.mkdirs();&lt;/li&gt;
	&lt;li&gt;out.create(ReflectData.get().getSchema(BalancesRecord.class), namesFile);&lt;/li&gt;
	&lt;li&gt;for (int i=0; i &amp;lt; 5; i++)&lt;/li&gt;
	&lt;li&gt;out.append(new BalancesRecord(i, (long) i+100));&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+    DatumWriter&amp;lt;BalancesRecord&amp;gt; writer = new ReflectDatumWriter&amp;lt;&amp;gt;();&lt;br/&gt;
+    File namesFile = new File(dir + &quot;/balances.avro&quot;);&lt;br/&gt;
+    try (DataFileWriter&amp;lt;BalancesRecord&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      out.create(ReflectData.get().getSchema(BalancesRecord.class), namesFile);+      for (int i = 0; i &amp;lt; 5; i++) {
+        out.append(new BalancesRecord(i, (long) i + 100));
+      }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private void validateCompleteFile(File file) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumReader&amp;lt;CompleteRecord&amp;gt; reader =&lt;/li&gt;
	&lt;li&gt;new ReflectDatumReader&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;InputStream in = new BufferedInputStream(new FileInputStream(file));&lt;/li&gt;
	&lt;li&gt;DataFileStream&amp;lt;CompleteRecord&amp;gt; records =&lt;/li&gt;
	&lt;li&gt;new DataFileStream&amp;lt;&amp;gt;(in, reader);&lt;br/&gt;
+    DatumReader&amp;lt;CompleteRecord&amp;gt; reader = new ReflectDatumReader&amp;lt;&amp;gt;();&lt;br/&gt;
     int numRecs = 0;&lt;/li&gt;
	&lt;li&gt;for (CompleteRecord rec : records) {&lt;/li&gt;
	&lt;li&gt;assertEquals(rec.id, numRecs);&lt;/li&gt;
	&lt;li&gt;assertEquals(rec.balance-100, rec.id);&lt;/li&gt;
	&lt;li&gt;assertEquals(rec.name, &quot;record&quot;+rec.id);&lt;/li&gt;
	&lt;li&gt;numRecs++;&lt;br/&gt;
+    try(InputStream in = new BufferedInputStream(new FileInputStream(file))) {&lt;br/&gt;
+      try (DataFileStream&amp;lt;CompleteRecord&amp;gt; records = new DataFileStream&amp;lt;&amp;gt;(in, reader)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        for (CompleteRecord rec }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;records.close();&lt;br/&gt;
     assertEquals(5, numRecs);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleOutputs.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleOutputs.java&lt;br/&gt;
index feb328a56..7e84e5d9f 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleOutputs.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroMultipleOutputs.java&lt;br/&gt;
@@ -18,29 +18,29 @@&lt;/p&gt;

&lt;p&gt; package org.apache.avro.mapred;&lt;/p&gt;

&lt;p&gt;-import java.io.IOException;&lt;br/&gt;
-import java.util.StringTokenizer;&lt;br/&gt;
-&lt;br/&gt;
 import junit.framework.Assert;&lt;br/&gt;
-&lt;br/&gt;
+import org.apache.avro.Schema;&lt;br/&gt;
+import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.apache.hadoop.fs.FileStatus;&lt;br/&gt;
 import org.apache.hadoop.fs.FileSystem;&lt;br/&gt;
 import org.apache.hadoop.fs.Path;&lt;br/&gt;
 import org.apache.hadoop.io.NullWritable;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileSplit;&lt;br/&gt;
-import org.apache.hadoop.mapred.JobClient;&lt;br/&gt;
-import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileInputFormat;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileOutputFormat;&lt;br/&gt;
-import org.apache.hadoop.mapred.Reporter;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.util.Utf8;&lt;br/&gt;
+import org.apache.hadoop.mapred.*;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.util.StringTokenizer;&lt;/p&gt;

&lt;p&gt; public class TestAvroMultipleOutputs {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final String UTF8 = &quot;UTF-8&quot;;&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   public static class MapImpl extends AvroMapper&amp;lt;Utf8, Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; {&lt;br/&gt;
     private AvroMultipleOutputs amos;&lt;br/&gt;
@@ -50,120 +50,116 @@ public void configure(JobConf Job) {&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void map(Utf8 text, AvroCollector&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; collector,&lt;/li&gt;
	&lt;li&gt;Reporter reporter) throws IOException {&lt;br/&gt;
+    public void map(Utf8 text, AvroCollector&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; collector, Reporter reporter) throws IOException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {       StringTokenizer tokens = new StringTokenizer(text.toString());       while (tokens.hasMoreTokens()) {
         String tok = tokens.nextToken();
         collector.collect(new Pair&amp;lt;&amp;gt;(new Utf8(tok), 1L));
-        amos.getCollector(&quot;myavro2&quot;,reporter)
-          .collect(new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(tok),1L).toString());
+        amos.getCollector(&quot;myavro2&quot;, reporter).collect(new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(tok), 1L).toString());
       }-     }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+&lt;br/&gt;
     public void close() throws IOException &lt;/p&gt;
{
       amos.close();
     }&lt;br/&gt;
-&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
-  public static class ReduceImpl&lt;br/&gt;
-    extends AvroReducer&amp;lt;Utf8, Long, Pair&amp;lt;Utf8, Long&amp;gt; &amp;gt; {&lt;br/&gt;
+  public static class ReduceImpl extends AvroReducer&amp;lt;Utf8, Long, Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; {&lt;br/&gt;
     private AvroMultipleOutputs amos;&lt;br/&gt;
 &lt;br/&gt;
-    public void configure(JobConf Job)&lt;br/&gt;
-    {&lt;br/&gt;
-        amos=new AvroMultipleOutputs(Job);&lt;br/&gt;
+    public void configure(JobConf Job) {
+      amos = new AvroMultipleOutputs(Job);
     }&lt;br/&gt;
 &lt;br/&gt;
     @Override&lt;br/&gt;
     public void reduce(Utf8 word, Iterable&amp;lt;Long&amp;gt; counts,&lt;br/&gt;
-                       AvroCollector&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
+                       AvroCollector&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
                        Reporter reporter) throws IOException {
       long sum = 0;
       for (long count : counts)
         sum += count;
-      Pair&amp;lt;Utf8,Long&amp;gt; outputvalue= new Pair&amp;lt;&amp;gt;(word, sum);
-      amos.getCollector(&quot;myavro&quot;,reporter).collect(outputvalue);
-      amos.collect(&quot;myavro1&quot;,reporter,outputvalue.toString());
-      amos.collect(&quot;myavro&quot;,reporter,new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema(),outputvalue,&quot;testavrofile&quot;);
-      amos.collect(&quot;myavro&quot;,reporter,Schema.create(Schema.Type.STRING),outputvalue.toString(),&quot;testavrofile1&quot;);
+      Pair&amp;lt;Utf8, Long&amp;gt; outputvalue = new Pair&amp;lt;&amp;gt;(word, sum);
+      amos.getCollector(&quot;myavro&quot;, reporter).collect(outputvalue);
+      amos.collect(&quot;myavro1&quot;, reporter, outputvalue.toString());
+      amos.collect(&quot;myavro&quot;, reporter, new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema(), outputvalue, &quot;testavrofile&quot;);
+      amos.collect(&quot;myavro&quot;, reporter, Schema.create(Schema.Type.STRING), outputvalue.toString(), &quot;testavrofile1&quot;);
       collector.collect(new Pair&amp;lt;&amp;gt;(word, sum));
     }&lt;br/&gt;
-    public void close() throws IOException&lt;br/&gt;
-    {&lt;br/&gt;
+&lt;br/&gt;
+    public void close() throws IOException {       amos.close();     }
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test public void runTestsInOrder() throws Exception {&lt;/li&gt;
	&lt;li&gt;testJob();&lt;/li&gt;
	&lt;li&gt;testProjection();&lt;/li&gt;
	&lt;li&gt;testProjection_newmethods();&lt;/li&gt;
	&lt;li&gt;testProjection_newmethods_1();&lt;/li&gt;
	&lt;li&gt;testProjection1();&lt;/li&gt;
	&lt;li&gt;testJob_noreducer();&lt;/li&gt;
	&lt;li&gt;testProjection_noreducer();&lt;br/&gt;
+  @Test&lt;br/&gt;
+  public void runTestsInOrder() throws Exception 
{
+    String avroPath = OUTPUT_DIR.getRoot().getPath();
+    testJob(avroPath);
+    testProjection(avroPath);
+    testProjectionNewMethodsOne(avroPath);
+    testProjectionNewMethodsTwo(avroPath);
+    testProjection1(avroPath);
+    testJobNoreducer();
+    testProjectionNoreducer(avroPath);
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @SuppressWarnings(&quot;deprecation&quot;)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testJob() throws Exception {&lt;br/&gt;
+  public void testJob(String pathOut) throws Exception 
{
     JobConf job = new JobConf();
 
-//    private static final String UTF8 = &quot;UTF-8&quot;;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;
-    Path outputPath = new Path(dir + &quot;/out&quot;);
+    String pathIn = INPUT_DIR.getRoot().getPath();
+
+    File fileIn = new File(pathIn, &quot;lines.avro&quot;);
+    Path outputPath = new Path(pathOut);
 
     outputPath.getFileSystem(job).delete(outputPath);
-    WordCountUtil.writeLinesFile();
+
+    WordCountUtil.writeLinesFile(fileIn);
 
     job.setJobName(&quot;AvroMultipleOutputs&quot;);
 
     AvroJob.setInputSchema(job, Schema.create(Schema.Type.STRING));
     AvroJob.setOutputSchema(job,
-                            new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
+            new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
 
     AvroJob.setMapperClass(job, MapImpl.class);
     AvroJob.setReducerClass(job, ReduceImpl.class);
 
-    FileInputFormat.setInputPaths(job, new Path(dir + &quot;/in&quot;));
+    FileInputFormat.setInputPaths(job, pathIn);
     FileOutputFormat.setOutputPath(job, outputPath);
     FileOutputFormat.setCompressOutput(job, false);
-    AvroMultipleOutputs.addNamedOutput(job,&quot;myavro&quot;,AvroOutputFormat.class, new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
-    AvroMultipleOutputs.addNamedOutput(job,&quot;myavro1&quot;,AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
-    AvroMultipleOutputs.addNamedOutput(job,&quot;myavro2&quot;,AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro&quot;, AvroOutputFormat.class, new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro1&quot;, AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro2&quot;, AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
     WordCountUtil.setMeta(job);
 
-
     JobClient.runJob(job);
 
-    WordCountUtil.validateCountsFile();
+    WordCountUtil.validateCountsFile(new File(outputPath.toString(), &quot;/part-00000.avro&quot;));
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @SuppressWarnings(&quot;deprecation&quot;)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public void testProjection() throws Exception {&lt;br/&gt;
+  public void testProjection(String inputDirectory) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Integer defaultRank = new Integer(-1);&lt;br/&gt;
+    Integer defaultRank = -1;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     String jsonSchema =&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;{\&quot;type\&quot;:\&quot;record\&quot;,&quot; +&lt;/li&gt;
	&lt;li&gt;&quot;\&quot;name\&quot;:\&quot;org.apache.avro.mapred.Pair\&quot;,&quot;+&lt;/li&gt;
	&lt;li&gt;&quot;\&quot;fields\&quot;: [ &quot; +&lt;/li&gt;
	&lt;li&gt;&quot;
{\&quot;name\&quot;:\&quot;rank\&quot;, \&quot;type\&quot;:\&quot;int\&quot;, \&quot;default\&quot;: -1}
&lt;p&gt;,&quot; +&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;&quot;
{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:\&quot;long\&quot;}
&lt;p&gt;&quot; +&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;&quot;]}&quot;;&lt;br/&gt;
+            &quot;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;type&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Schema readerSchema = Schema.parse(jsonSchema);&lt;/p&gt;

&lt;p&gt;     AvroJob.setInputSchema(job, readerSchema);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/myavro-r-00000.avro&quot;);&lt;br/&gt;
+    Path inputPath = new Path(inputDirectory + &quot;/myavro-r-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-&lt;br/&gt;
     AvroRecordReader&amp;lt;Pair&amp;lt;Integer, Long&amp;gt;&amp;gt; recordReader = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;/p&gt;

&lt;p&gt;     AvroWrapper&amp;lt;Pair&amp;lt;Integer, Long&amp;gt;&amp;gt; inputPair = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
@@ -171,8 +167,8 @@ public void testProjection() throws Exception {&lt;/p&gt;

&lt;p&gt;     long sumOfCounts = 0;&lt;br/&gt;
     long numOfCounts = 0;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;while(recordReader.next(inputPair, ignore)) {&lt;/li&gt;
	&lt;li&gt;Assert.assertEquals((Integer)inputPair.datum().get(0), defaultRank);&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) 
{
+      Assert.assertEquals(inputPair.datum().get(0), defaultRank);
       sumOfCounts += (Long) inputPair.datum().get(1);
       numOfCounts++;
     }&lt;br/&gt;
@@ -180,38 +176,35 @@ public void testProjection() throws Exception {&lt;br/&gt;
     Assert.assertEquals(numOfCounts, WordCountUtil.COUNTS.size());&lt;br/&gt;
 &lt;br/&gt;
     long actualSumOfCounts = 0;&lt;br/&gt;
-    for(Long count : WordCountUtil.COUNTS.values()) {&lt;br/&gt;
+    for (Long count : WordCountUtil.COUNTS.values()) {
       actualSumOfCounts += count;
     }&lt;br/&gt;
 &lt;br/&gt;
     Assert.assertEquals(sumOfCounts, actualSumOfCounts);&lt;br/&gt;
-&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
-  public void testProjection_newmethods() throws Exception {&lt;br/&gt;
+  public void testProjectionNewMethodsOne(String inputDirectory) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
 &lt;br/&gt;
-    Integer defaultRank = new Integer(-1);&lt;br/&gt;
+    Integer defaultRank = -1;&lt;br/&gt;
 &lt;br/&gt;
     String jsonSchema =&lt;br/&gt;
-      &quot;{\&quot;type\&quot;:\&quot;record\&quot;,&quot; +&lt;br/&gt;
-      &quot;\&quot;name\&quot;:\&quot;org.apache.avro.mapred.Pair\&quot;,&quot;+&lt;br/&gt;
-      &quot;\&quot;fields\&quot;: [ &quot; +&lt;br/&gt;
-        &quot;{\&quot;name\&quot;:\&quot;rank\&quot;, \&quot;type\&quot;:\&quot;int\&quot;, \&quot;default\&quot;: -1},&quot; +&lt;br/&gt;
-        &quot;{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:\&quot;long\&quot;}&quot; +&lt;br/&gt;
-      &quot;]}&quot;;&lt;br/&gt;
+            &quot;{\&quot;type\&quot;:\&quot;record\&quot;,&quot; +&lt;br/&gt;
+                    &quot;\&quot;name\&quot;:\&quot;org.apache.avro.mapred.Pair\&quot;,&quot; +&lt;br/&gt;
+                    &quot;\&quot;fields\&quot;: [ &quot; +&lt;br/&gt;
+                    &quot;{\&quot;name\&quot;:\&quot;rank\&quot;, \&quot;type\&quot;:\&quot;int\&quot;, \&quot;default\&quot;: -1},&quot; +&lt;br/&gt;
+                    &quot;{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:\&quot;long\&quot;}&quot; +&lt;br/&gt;
+                    &quot;]}&quot;;&lt;br/&gt;
 &lt;br/&gt;
     Schema readerSchema = Schema.parse(jsonSchema);&lt;br/&gt;
 &lt;br/&gt;
     AvroJob.setInputSchema(job, readerSchema);&lt;br/&gt;
 &lt;br/&gt;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;br/&gt;
-    Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/testavrofile-r-00000.avro&quot;);&lt;br/&gt;
+    Path inputPath = new Path(inputDirectory + &quot;/testavrofile-r-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;br/&gt;
 &lt;br/&gt;
-&lt;br/&gt;
     AvroRecordReader&amp;lt;Pair&amp;lt;Integer, Long&amp;gt;&amp;gt; recordReader = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;br/&gt;
 &lt;br/&gt;
     AvroWrapper&amp;lt;Pair&amp;lt;Integer, Long&amp;gt;&amp;gt; inputPair = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
@@ -219,8 +212,8 @@ public void testProjection_newmethods() throws Exception {&lt;br/&gt;
 &lt;br/&gt;
     long sumOfCounts = 0;&lt;br/&gt;
     long numOfCounts = 0;&lt;br/&gt;
-    while(recordReader.next(inputPair, ignore)) {&lt;br/&gt;
-      Assert.assertEquals((Integer)inputPair.datum().get(0), defaultRank);&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) {+      Assert.assertEquals(inputPair.datum().get(0), defaultRank);       sumOfCounts += (Long) inputPair.datum().get(1);       numOfCounts++;     }
&lt;p&gt;@@ -228,7 +221,7 @@ public void testProjection_newmethods() throws Exception {&lt;br/&gt;
     Assert.assertEquals(numOfCounts, WordCountUtil.COUNTS.size());&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     long actualSumOfCounts = 0;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for(Long count : WordCountUtil.COUNTS.values()) {&lt;br/&gt;
+    for (Long count : WordCountUtil.COUNTS.values()) 
{
       actualSumOfCounts += count;
     }&lt;br/&gt;
 &lt;br/&gt;
@@ -236,16 +229,14 @@ public void testProjection_newmethods() throws Exception {&lt;br/&gt;
 &lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
-&lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
   // Test for a different schema output&lt;br/&gt;
-  public void testProjection1() throws Exception {&lt;br/&gt;
+  public void testProjection1(String inputDirectory) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
     Schema readerSchema = Schema.create(Schema.Type.STRING);&lt;br/&gt;
     AvroJob.setInputSchema(job, readerSchema);&lt;br/&gt;
 &lt;br/&gt;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;br/&gt;
-    Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/myavro1-r-00000.avro&quot;);&lt;br/&gt;
+    Path inputPath = new Path(inputDirectory + &quot;/myavro1-r-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;br/&gt;
     AvroWrapper&amp;lt;Utf8&amp;gt; inputPair = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
@@ -253,27 +244,26 @@ public void testProjection1() throws Exception {&lt;br/&gt;
     AvroRecordReader&amp;lt;Utf8&amp;gt; recordReader = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;br/&gt;
     long sumOfCounts = 0;&lt;br/&gt;
     long numOfCounts = 0;&lt;br/&gt;
-    while(recordReader.next(inputPair, ignore)) {
-        sumOfCounts += Long.parseLong(inputPair.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;,&quot;&quot;).trim());&lt;br/&gt;
-        numOfCounts++;&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) {
+      sumOfCounts += Long.parseLong(inputPair.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;, &quot;&quot;).trim());&lt;br/&gt;
+      numOfCounts++;&lt;br/&gt;
     }&lt;br/&gt;
     Assert.assertEquals(numOfCounts, WordCountUtil.COUNTS.size());&lt;br/&gt;
     long actualSumOfCounts = 0;&lt;br/&gt;
-    for(Long count : WordCountUtil.COUNTS.values()) {&lt;br/&gt;
-     actualSumOfCounts += count;&lt;br/&gt;
+    for (Long count : WordCountUtil.COUNTS.values()) {
+      actualSumOfCounts += count;
     }&lt;br/&gt;
     Assert.assertEquals(sumOfCounts, actualSumOfCounts);&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
   // Test for a different schema output&lt;br/&gt;
-  public void testProjection_newmethods_1() throws Exception {&lt;br/&gt;
+  public void testProjectionNewMethodsTwo(String inputDirectory) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
     Schema readerSchema = Schema.create(Schema.Type.STRING);&lt;br/&gt;
     AvroJob.setInputSchema(job, readerSchema);&lt;br/&gt;
 &lt;br/&gt;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;br/&gt;
-    Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/testavrofile1-r-00000.avro&quot;);&lt;br/&gt;
+    Path inputPath = new Path(inputDirectory + &quot;/testavrofile1-r-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;br/&gt;
     AvroWrapper&amp;lt;Utf8&amp;gt; inputPair = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
@@ -281,60 +271,56 @@ public void testProjection_newmethods_1() throws Exception {&lt;br/&gt;
     AvroRecordReader&amp;lt;Utf8&amp;gt; recordReader = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;br/&gt;
     long sumOfCounts = 0;&lt;br/&gt;
     long numOfCounts = 0;&lt;br/&gt;
-    while(recordReader.next(inputPair, ignore)) {
-        sumOfCounts += Long.parseLong(inputPair.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;,&quot;&quot;).trim());&lt;br/&gt;
-        numOfCounts++;&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) {
+      sumOfCounts += Long.parseLong(inputPair.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;, &quot;&quot;).trim());&lt;br/&gt;
+      numOfCounts++;&lt;br/&gt;
     }&lt;br/&gt;
     Assert.assertEquals(numOfCounts, WordCountUtil.COUNTS.size());&lt;br/&gt;
     long actualSumOfCounts = 0;&lt;br/&gt;
-    for(Long count : WordCountUtil.COUNTS.values()) {&lt;br/&gt;
-     actualSumOfCounts += count;&lt;br/&gt;
+    for (Long count : WordCountUtil.COUNTS.values()) {+      actualSumOfCounts += count;     }&lt;br/&gt;
     Assert.assertEquals(sumOfCounts, actualSumOfCounts);&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
-  public void testJob_noreducer() throws Exception {&lt;br/&gt;
+  public void testJobNoreducer() throws Exception {
     JobConf job = new JobConf();
     job.setNumReduceTasks(0);
-//    private static final String UTF8 = &quot;UTF-8&quot;;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;
-    Path outputPath = new Path(dir + &quot;/out&quot;);
 
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());
     outputPath.getFileSystem(job).delete(outputPath);
-    WordCountUtil.writeLinesFile();
+
+    WordCountUtil.writeLinesFile(new File(INPUT_DIR.getRoot(),&quot;lines.avro&quot;));
 
     job.setJobName(&quot;AvroMultipleOutputs_noreducer&quot;);
 
     AvroJob.setInputSchema(job, Schema.create(Schema.Type.STRING));
-    AvroJob.setOutputSchema(job,
-                            new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
+    AvroJob.setOutputSchema(job, new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
 
     AvroJob.setMapperClass(job, MapImpl.class);
 
-    FileInputFormat.setInputPaths(job, new Path(dir + &quot;/in&quot;));
+    FileInputFormat.setInputPaths(job, new Path(INPUT_DIR.getRoot().toString()));
     FileOutputFormat.setOutputPath(job, outputPath);
     FileOutputFormat.setCompressOutput(job, false);
-    AvroMultipleOutputs.addNamedOutput(job,&quot;myavro2&quot;,AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro2&quot;, AvroOutputFormat.class, Schema.create(Schema.Type.STRING));
     JobClient.runJob(job);
   }&lt;br/&gt;
 &lt;br/&gt;
-  public void testProjection_noreducer() throws Exception {&lt;br/&gt;
+  public void testProjectionNoreducer(String inputDirectory) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
     long onel = 1;&lt;br/&gt;
     Schema readerSchema = Schema.create(Schema.Type.STRING);&lt;br/&gt;
     AvroJob.setInputSchema(job, readerSchema);&lt;br/&gt;
-    String dir= System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;br/&gt;
-    Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/myavro2-m-00000.avro&quot;);&lt;br/&gt;
+    Path inputPath = new Path(inputDirectory + &quot;/myavro2-m-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;br/&gt;
-    AvroRecordReader&amp;lt;Utf8&amp;gt; recordReader_new = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;br/&gt;
-    AvroWrapper&amp;lt;Utf8&amp;gt; inputPair_new = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
+    AvroRecordReader&amp;lt;Utf8&amp;gt; recordReader = new AvroRecordReader&amp;lt;&amp;gt;(job, fileSplit);&lt;br/&gt;
+    AvroWrapper&amp;lt;Utf8&amp;gt; inputPair = new AvroWrapper&amp;lt;&amp;gt;(null);&lt;br/&gt;
     NullWritable ignore = NullWritable.get();&lt;br/&gt;
-    long testl=0;&lt;br/&gt;
-     while(recordReader_new.next(inputPair_new, ignore)) {
-       testl=Long.parseLong(inputPair_new.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;,&quot;&quot;).trim());&lt;br/&gt;
-       Assert.assertEquals(onel,testl);&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) {
+      long testl = Long.parseLong(inputPair.datum().toString().split(&quot;:&quot;)[2].replace(&quot;}&quot;, &quot;&quot;).trim());&lt;br/&gt;
+      Assert.assertEquals(onel, testl);&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroOutputFormat.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroOutputFormat.java&lt;br/&gt;
index d710ac18b..6d356b8af 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroOutputFormat.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroOutputFormat.java&lt;br/&gt;
@@ -21,8 +21,7 @@&lt;br/&gt;
 import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
 &lt;br/&gt;
-import static org.junit.Assert.assertEquals;&lt;br/&gt;
-import static org.junit.Assert.assertTrue;&lt;br/&gt;
+import static org.junit.Assert.*;&lt;br/&gt;
 &lt;br/&gt;
 public class TestAvroOutputFormat {&lt;br/&gt;
   @Test&lt;br/&gt;
@@ -32,23 +31,23 @@ public void testSetSyncInterval() {
     AvroOutputFormat.setSyncInterval(jobConf, newSyncInterval);
 
     assertEquals(newSyncInterval, jobConf.getInt(
-        AvroOutputFormat.SYNC_INTERVAL_KEY, -1));
+            AvroOutputFormat.SYNC_INTERVAL_KEY, -1));
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
   public void testNoCodec() {
     JobConf job = new JobConf();
-    assertTrue(AvroOutputFormat.getCodecFactory(job) == null);
+    assertNull(AvroOutputFormat.getCodecFactory(job));
 
     job = new JobConf();
     job.set(&quot;mapred.output.compress&quot;, &quot;false&quot;);
     job.set(&quot;mapred.output.compression.codec&quot;, &quot;org.apache.hadoop.io.compress.BZip2Codec&quot;);
-    assertTrue(AvroOutputFormat.getCodecFactory(job) == null);
+    assertNull(AvroOutputFormat.getCodecFactory(job));
 
     job = new JobConf();
     job.set(&quot;mapred.output.compress&quot;, &quot;false&quot;);
     job.set(AvroJob.OUTPUT_CODEC, &quot;bzip2&quot;);
-    assertTrue(AvroOutputFormat.getCodecFactory(job) == null);
+    assertNull(AvroOutputFormat.getCodecFactory(job));
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -59,8 +58,8 @@ public void testBZip2CodecUsingHadoopClass() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(&quot;mapred.output.compression.codec&quot;, &quot;org.apache.hadoop.io.compress.BZip2Codec&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroBZip2Codec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroBZip2Codec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -71,8 +70,8 @@ public void testBZip2CodecUsingAvroCodec() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(AvroJob.OUTPUT_CODEC, &quot;bzip2&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroBZip2Codec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroBZip2Codec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -83,8 +82,8 @@ public void testDeflateCodecUsingHadoopClass() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(&quot;mapred.output.compression.codec&quot;, &quot;org.apache.hadoop.io.compress.DeflateCodec&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroDeflateCodec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroDeflateCodec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -95,8 +94,8 @@ public void testDeflateCodecUsingAvroCodec() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(AvroJob.OUTPUT_CODEC, &quot;deflate&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroDeflateCodec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroDeflateCodec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -107,8 +106,8 @@ public void testSnappyCodecUsingHadoopClass() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(&quot;mapred.output.compression.codec&quot;, &quot;org.apache.hadoop.io.compress.SnappyCodec&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroSnappyCodec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroSnappyCodec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -119,8 +118,8 @@ public void testSnappyCodecUsingAvroCodec() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(AvroJob.OUTPUT_CODEC, &quot;snappy&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroSnappyCodec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroSnappyCodec.getClass());
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
@@ -131,9 +130,7 @@ public void testGZipCodecUsingHadoopClass() {
     job.set(&quot;mapred.output.compress&quot;, &quot;true&quot;);
     job.set(&quot;mapred.output.compression.codec&quot;, &quot;org.apache.hadoop.io.compress.GZipCodec&quot;);
     CodecFactory factory = AvroOutputFormat.getCodecFactory(job);
-    assertTrue(factory != null);
-    assertTrue(factory.getClass().equals(avroDeflateCodec.getClass()));
+    assertNotNull(factory);
+    assertEquals(factory.getClass(), avroDeflateCodec.getClass());
   }&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextOutputFormat.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextOutputFormat.java&lt;br/&gt;
index 1e1d77ad3..13846d9d3 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextOutputFormat.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextOutputFormat.java&lt;br/&gt;
@@ -35,15 +35,19 @@&lt;br/&gt;
 import org.apache.hadoop.io.NullWritable;&lt;br/&gt;
 import org.apache.hadoop.io.Text;&lt;br/&gt;
 import org.apache.hadoop.mapred.RecordWriter;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
 &lt;br/&gt;
 public class TestAvroTextOutputFormat {&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder tmpFolder = new TemporaryFolder();&lt;br/&gt;
 &lt;br/&gt;
   private static final String UTF8 = &quot;UTF-8&quot;;&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
   public void testAvroTextRecordWriter() throws Exception {&lt;br/&gt;
-    File file = new File(System.getProperty(&quot;test.dir&quot;, &quot;.&quot;), &quot;writer&quot;);&lt;br/&gt;
+    File file = new File(tmpFolder.getRoot().getPath(), &quot;writer&quot;);&lt;br/&gt;
     Schema schema = Schema.create(Schema.Type.BYTES);&lt;br/&gt;
     DatumWriter&amp;lt;ByteBuffer&amp;gt; datumWriter =&lt;br/&gt;
       new GenericDatumWriter&amp;lt;&amp;gt;(schema);&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextSort.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextSort.java&lt;br/&gt;
index 6f0b618d4..a468f4e1c 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextSort.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestAvroTextSort.java&lt;br/&gt;
@@ -24,10 +24,21 @@&lt;br/&gt;
 import org.apache.hadoop.mapred.FileOutputFormat;&lt;br/&gt;
 import org.apache.hadoop.mapred.JobClient;&lt;br/&gt;
 import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
+import org.apache.hadoop.yarn.webapp.hamlet.Hamlet;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 &lt;br/&gt;
 public class TestAvroTextSort {&lt;br/&gt;
 &lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   @Test&lt;br/&gt;
   /**&lt;br/&gt;
    * Run the identity job on a &quot;bytes&quot; Avro file using AvroAsTextInputFormat&lt;br/&gt;
@@ -35,22 +46,22 @@&lt;br/&gt;
    */&lt;br/&gt;
   public void testSort() throws Exception {
     JobConf job = new JobConf();
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;
-    Path outputPath = new Path(dir + &quot;/out&quot;);
-
+    String inputPath = INPUT_DIR.getRoot().getPath();
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());
     outputPath.getFileSystem(job).delete(outputPath);
-    WordCountUtil.writeLinesBytesFile();
+
+    WordCountUtil.writeLinesBytesFile(inputPath);
 
     job.setInputFormat(AvroAsTextInputFormat.class);
     job.setOutputFormat(AvroTextOutputFormat.class);
     job.setOutputKeyClass(Text.class);
 
-    FileInputFormat.setInputPaths(job, new Path(dir + &quot;/in&quot;));
+    FileInputFormat.setInputPaths(job, new Path(inputPath));
     FileOutputFormat.setOutputPath(job, outputPath);
 
     JobClient.runJob(job);
 
-    WordCountUtil.validateSortedFile();
+    WordCountUtil.validateSortedFile(outputPath.toString() + &quot;/part-00000.avro&quot;);
   }&lt;br/&gt;
 &lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestGenericJob.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestGenericJob.java&lt;br/&gt;
index b5ff707ad..495eae459 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestGenericJob.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestGenericJob.java&lt;br/&gt;
@@ -20,8 +20,10 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.io.RandomAccessFile;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
+import java.util.Collections;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 &lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
@@ -49,12 +51,14 @@&lt;br/&gt;
 import org.apache.hadoop.mapred.TextInputFormat;&lt;br/&gt;
 import org.junit.After;&lt;br/&gt;
 import org.junit.Before;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
 &lt;br/&gt;
 @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
 public class TestGenericJob {&lt;br/&gt;
-  private static final String dir =&lt;br/&gt;
-    System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;target/testGenericJob&quot;;&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
 &lt;br/&gt;
   private static Schema createSchema() {&lt;br/&gt;
     List&amp;lt;Field&amp;gt; fields = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
@@ -80,15 +84,14 @@ private static Schema createArraySchema() {&lt;br/&gt;
   private static Schema createInnerSchema(String name) {
     Schema innerrecord = Schema.createRecord(name, &quot;&quot;, &quot;&quot;, false);
     innerrecord.setFields
-      (Arrays.asList(new Field(name, Schema.create(Type.LONG), &quot;&quot;, 0L)));
+      (Collections.singletonList(new Field(name, Schema.create(Type.LONG), &quot;&quot;, 0L)));
     return innerrecord;
   }&lt;br/&gt;
 &lt;br/&gt;
   @Before&lt;br/&gt;
     public void setup() throws IOException {&lt;br/&gt;
     // needed to satisfy the framework only - input ignored in mapper&lt;br/&gt;
-    File indir = new File(dir);&lt;br/&gt;
-    indir.mkdirs();&lt;br/&gt;
+    String dir = DIR.getRoot().getPath();&lt;br/&gt;
     File infile = new File(dir + &quot;/in&quot;);&lt;br/&gt;
     RandomAccessFile file = new RandomAccessFile(infile, &quot;rw&quot;);&lt;br/&gt;
     // add some data so framework actually calls our mapper&lt;br/&gt;
@@ -96,11 +99,6 @@ public void setup() throws IOException {
     file.close();
   }&lt;br/&gt;
 &lt;br/&gt;
-  @After&lt;br/&gt;
-    public void tearDown() throws IOException {
-    FileUtil.fullyDelete(new File(dir));
-  }&lt;br/&gt;
-&lt;br/&gt;
   static class AvroTestConverter&lt;br/&gt;
     extends MapReduceBase&lt;br/&gt;
     implements Mapper&amp;lt;LongWritable, Text,&lt;br/&gt;
@@ -128,11 +126,11 @@ public void map(LongWritable key, Text value,&lt;br/&gt;
   @Test&lt;br/&gt;
     public void testJob() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+    Path outputPath = new Path(DIR.getRoot().getPath() + &quot;/out&quot;);&lt;br/&gt;
     outputPath.getFileSystem(job).delete(outputPath);&lt;br/&gt;
 &lt;br/&gt;
     job.setInputFormat(TextInputFormat.class);&lt;br/&gt;
-    FileInputFormat.setInputPaths(job, dir + &quot;/in&quot;);&lt;br/&gt;
+    FileInputFormat.setInputPaths(job, DIR.getRoot().getPath() + &quot;/in&quot;);&lt;br/&gt;
 &lt;br/&gt;
     job.setMapperClass(AvroTestConverter.class);&lt;br/&gt;
     job.setNumReduceTasks(0);&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestReflectJob.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestReflectJob.java&lt;br/&gt;
index 8fdb5fb0f..05c6be25f 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestReflectJob.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestReflectJob.java&lt;br/&gt;
@@ -99,7 +99,7 @@ public void reduce(Text word, Iterable&amp;lt;Count&amp;gt; counts,&lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
   public void testJob() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;target/testReflectJob&quot;;&lt;br/&gt;
+    String dir = &quot;target/testReflectJob&quot;;&lt;br/&gt;
     Path inputPath = new Path(dir + &quot;/in&quot;);&lt;br/&gt;
     Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
 &lt;br/&gt;
@@ -122,7 +122,7 @@ public void testJob() throws Exception {&lt;br/&gt;
     FileInputFormat.setInputPaths(job, inputPath);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;br/&gt;
 &lt;br/&gt;
-    AvroJob.setReflect(job);                      // use reflection&lt;br/&gt;
+    AvroJob.setReflect(job); // use reflection&lt;br/&gt;
 &lt;br/&gt;
     JobClient.runJob(job);&lt;br/&gt;
 &lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestSequenceFileReader.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestSequenceFileReader.java&lt;br/&gt;
index 394a496aa..c17154097 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestSequenceFileReader.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestSequenceFileReader.java&lt;br/&gt;
@@ -22,6 +22,7 @@&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.net.URI;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 import java.util.Iterator;&lt;br/&gt;
 &lt;br/&gt;
 import org.apache.hadoop.io.SequenceFile;&lt;br/&gt;
@@ -50,41 +51,51 @@&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 &lt;br/&gt;
 import org.junit.BeforeClass;&lt;br/&gt;
+import org.junit.ClassRule;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
 &lt;br/&gt;
 public class TestSequenceFileReader {&lt;br/&gt;
-  private static final int COUNT =&lt;br/&gt;
-    Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;10&quot;));&lt;br/&gt;
-  private static final File DIR&lt;br/&gt;
-    = new File(System.getProperty(&quot;test.dir&quot;, &quot;.&quot;));&lt;br/&gt;
-  private static final File FILE = new File(DIR, &quot;test.seq&quot;);&lt;br/&gt;
 &lt;br/&gt;
-  private static final Schema SCHEMA&lt;br/&gt;
-    = Pair.getPairSchema(Schema.create(Schema.Type.LONG),&lt;br/&gt;
-                         Schema.create(Schema.Type.STRING));&lt;br/&gt;
+  private static final int COUNT = Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;10&quot;));&lt;br/&gt;
+&lt;br/&gt;
+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  public static File file() {
+    return new File(INPUT_DIR.getRoot().getPath(), &quot;test.seq&quot;);
+  }&lt;br/&gt;
+&lt;br/&gt;
+  private static final Schema SCHEMA = Pair.getPairSchema(&lt;br/&gt;
+          Schema.create(Schema.Type.LONG),&lt;br/&gt;
+          Schema.create(Schema.Type.STRING)&lt;br/&gt;
+  );&lt;br/&gt;
 &lt;br/&gt;
   @BeforeClass&lt;br/&gt;
   public static void testWriteSequenceFile() throws IOException {&lt;br/&gt;
-    FILE.delete();&lt;br/&gt;
     Configuration c = new Configuration();&lt;br/&gt;
-    URI uri = FILE.toURI();&lt;br/&gt;
-    SequenceFile.Writer writer&lt;br/&gt;
+    URI uri = file().toURI();&lt;br/&gt;
+    try(SequenceFile.Writer writer&lt;br/&gt;
       = new SequenceFile.Writer(FileSystem.get(uri, c), c,&lt;br/&gt;
                                 new Path(uri.toString()),&lt;br/&gt;
-                                LongWritable.class, Text.class);&lt;br/&gt;
-    final LongWritable key = new LongWritable();&lt;br/&gt;
-    final Text val = new Text();&lt;br/&gt;
-    for (int i = 0; i &amp;lt; COUNT; ++i) {&lt;br/&gt;
-      key.set&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
-      val.set(Integer.toString&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;br/&gt;
-      writer.append(key, val);&lt;br/&gt;
+                                LongWritable.class, Text.class)) {&lt;br/&gt;
+      final LongWritable key = new LongWritable();&lt;br/&gt;
+      final Text val = new Text();&lt;br/&gt;
+      for (int i = 0; i &amp;lt; COUNT; ++i) {
+        key.set(i);
+        val.set(Integer.toString(i));
+        writer.append(key, val);
+      }&lt;br/&gt;
     }&lt;br/&gt;
-    writer.close();&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   @Test&lt;br/&gt;
   public void testReadSequenceFile() throws Exception {
-    checkFile(new SequenceFileReader&amp;lt;&amp;gt;(FILE));
+    checkFile(new SequenceFileReader&amp;lt;&amp;gt;(file()));
   }&lt;br/&gt;
 &lt;br/&gt;
   public void checkFile(FileReader&amp;lt;Pair&amp;lt;Long,CharSequence&amp;gt;&amp;gt; reader) throws Exception {&lt;br/&gt;
@@ -101,13 +112,12 @@ public void checkFile(FileReader&amp;lt;Pair&amp;lt;Long,CharSequence&amp;gt;&amp;gt; reader) throws Excepti&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testSequenceFileInputFormat() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;.&quot;)+&quot;/seq-out&quot;);&lt;br/&gt;
-&lt;br/&gt;
-    output.getFileSystem(job).delete(output);&lt;br/&gt;
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());&lt;br/&gt;
+    outputPath.getFileSystem(job).delete(outputPath);&lt;br/&gt;
 &lt;br/&gt;
     // configure input for Avro from sequence file&lt;br/&gt;
     AvroJob.setInputSequenceFile(job);&lt;br/&gt;
-    FileInputFormat.setInputPaths(job, FILE.toURI().toString());&lt;br/&gt;
+    FileInputFormat.setInputPaths(job, file().toURI().toString());&lt;br/&gt;
     AvroJob.setInputSchema(job, SCHEMA);&lt;br/&gt;
 &lt;br/&gt;
     // mapper is default, identity&lt;br/&gt;
@@ -115,12 +125,12 @@ public void testSequenceFileInputFormat() throws Exception {
 
     // configure output for avro
     AvroJob.setOutputSchema(job, SCHEMA);
-    FileOutputFormat.setOutputPath(job, output);
+    FileOutputFormat.setOutputPath(job, outputPath);
 
     JobClient.runJob(job);
 
     checkFile(new DataFileReader&amp;lt;&amp;gt;
-              (new File(output.toString() + &quot;/part-00000.avro&quot;),
+              (new File(outputPath.toString() + &quot;/part-00000.avro&quot;),
                new SpecificDatumReader&amp;lt;&amp;gt;()));
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -139,13 +149,12 @@ public void map(LongWritable key, Text value,&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testNonAvroMapper() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;.&quot;)+&quot;/seq-out&quot;);&lt;br/&gt;
-&lt;br/&gt;
-    output.getFileSystem(job).delete(output);&lt;br/&gt;
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());&lt;br/&gt;
+    outputPath.getFileSystem(job).delete(outputPath);&lt;br/&gt;
 &lt;br/&gt;
     // configure input for non-Avro sequence file&lt;br/&gt;
     job.setInputFormat(SequenceFileInputFormat.class);&lt;br/&gt;
-    FileInputFormat.setInputPaths(job, FILE.toURI().toString());&lt;br/&gt;
+    FileInputFormat.setInputPaths(job, file().toURI().toString());&lt;br/&gt;
 &lt;br/&gt;
     // use a hadoop mapper that emits Avro output&lt;br/&gt;
     job.setMapperClass(NonAvroMapper.class);&lt;br/&gt;
@@ -153,13 +162,13 @@ public void testNonAvroMapper() throws Exception {
     // reducer is default, identity
 
     // configure output for avro
-    FileOutputFormat.setOutputPath(job, output);
+    FileOutputFormat.setOutputPath(job, outputPath);
     AvroJob.setOutputSchema(job, SCHEMA);
 
     JobClient.runJob(job);
 
     checkFile(new DataFileReader&amp;lt;&amp;gt;
-              (new File(output.toString() + &quot;/part-00000.avro&quot;),
+              (new File(outputPath.toString() + &quot;/part-00000.avro&quot;),
                new SpecificDatumReader&amp;lt;&amp;gt;()));
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -178,27 +187,25 @@ public void map(LongWritable key, Text value,&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testNonAvroMapOnly() throws Exception {
     JobConf job = new JobConf();
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;.&quot;)+&quot;/seq-out&quot;);
-
-    output.getFileSystem(job).delete(output);
-
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());
+    outputPath.getFileSystem(job).delete(outputPath);
 
     // configure input for non-Avro sequence file
     job.setInputFormat(SequenceFileInputFormat.class);
-    FileInputFormat.setInputPaths(job, FILE.toURI().toString());
+    FileInputFormat.setInputPaths(job, file().toURI().toString());
 
     // use a hadoop mapper that emits Avro output
     job.setMapperClass(NonAvroOnlyMapper.class);
 
     // configure output for avro
     job.setNumReduceTasks(0);                     // map-only
-    FileOutputFormat.setOutputPath(job, output);
+    FileOutputFormat.setOutputPath(job, outputPath);
     AvroJob.setOutputSchema(job, SCHEMA);
 
     JobClient.runJob(job);
 
     checkFile(new DataFileReader&amp;lt;&amp;gt;
-              (new File(output.toString() + &quot;/part-00000.avro&quot;),
+              (new File(outputPath.toString() + &quot;/part-00000.avro&quot;),
                new SpecificDatumReader&amp;lt;&amp;gt;()));
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -220,14 +227,13 @@ public void reduce(AvroKey&amp;lt;Long&amp;gt; key, Iterator&amp;lt;AvroValue&amp;lt;Utf8&amp;gt;&amp;gt; values,&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testNonAvroReducer() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;.&quot;)+&quot;/seq-out&quot;);&lt;br/&gt;
-&lt;br/&gt;
-    output.getFileSystem(job).delete(output);&lt;br/&gt;
+    Path outputPath = new Path(OUTPUT_DIR.getRoot().getPath());&lt;br/&gt;
+    outputPath.getFileSystem(job).delete(outputPath);&lt;br/&gt;
 &lt;br/&gt;
     // configure input for Avro from sequence file&lt;br/&gt;
     AvroJob.setInputSequenceFile(job);&lt;br/&gt;
     AvroJob.setInputSchema(job, SCHEMA);&lt;br/&gt;
-    FileInputFormat.setInputPaths(job, FILE.toURI().toString());&lt;br/&gt;
+    FileInputFormat.setInputPaths(job, file().toURI().toString());&lt;br/&gt;
 &lt;br/&gt;
     // mapper is default, identity&lt;br/&gt;
 &lt;br/&gt;
@@ -235,16 +241,16 @@ public void testNonAvroReducer() throws Exception {
     AvroJob.setMapOutputSchema(job, SCHEMA);
     job.setReducerClass(NonAvroReducer.class);
 
-    // configure output for non-Avro SequenceFile
+    // configure outputPath for non-Avro SequenceFile
     job.setOutputFormat(SequenceFileOutputFormat.class);
-    FileOutputFormat.setOutputPath(job, output);
+    FileOutputFormat.setOutputPath(job, outputPath);
 
     // output key/value classes are default, LongWritable/Text
 
     JobClient.runJob(job);
 
     checkFile(new SequenceFileReader&amp;lt;&amp;gt;
-              (new File(output.toString() + &quot;/part-00000&quot;)));
+              (new File(outputPath.toString() + &quot;/part-00000&quot;)));
   }&lt;br/&gt;
 &lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWeather.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWeather.java&lt;br/&gt;
index 0140c763d..eb1c06f54 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWeather.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWeather.java&lt;br/&gt;
@@ -66,7 +66,7 @@ public void testMapOnly() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
     String inDir = System.getProperty(&quot;share.dir&quot;,&quot;../../../share&quot;)+&quot;/test/data&quot;;&lt;br/&gt;
     Path input = new Path(inDir+&quot;/weather.avro&quot;);&lt;br/&gt;
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;target/test&quot;)+&quot;/weather-ident&quot;);&lt;br/&gt;
+    Path output = new Path(&quot;target/test/weather-ident&quot;);&lt;br/&gt;
 &lt;br/&gt;
     output.getFileSystem(job).delete(output);&lt;br/&gt;
 &lt;br/&gt;
@@ -141,9 +141,9 @@ public void configure(JobConf jobConf) {&lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
   public void testSort() throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
-    String inDir = System.getProperty(&quot;share.dir&quot;,&quot;../../../share&quot;)+&quot;/test/data&quot;;&lt;br/&gt;
+    String inDir = &quot;../../../share/test/data&quot;;&lt;br/&gt;
     Path input = new Path(inDir+&quot;/weather.avro&quot;);&lt;br/&gt;
-    Path output = new Path(System.getProperty(&quot;test.dir&quot;,&quot;target/test&quot;)+&quot;/weather-sort&quot;);&lt;br/&gt;
+    Path output = new Path(&quot;target/test/weather-sort&quot;);&lt;br/&gt;
 &lt;br/&gt;
     output.getFileSystem(job).delete(output);&lt;br/&gt;
 &lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWordCount.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWordCount.java&lt;br/&gt;
index f25a9c889..f3128ec64 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWordCount.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/TestWordCount.java&lt;br/&gt;
@@ -18,32 +18,34 @@&lt;br/&gt;
 &lt;br/&gt;
 package org.apache.avro.mapred;&lt;br/&gt;
 &lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.util.StringTokenizer;&lt;br/&gt;
-&lt;br/&gt;
 import junit.framework.Assert;&lt;br/&gt;
-&lt;br/&gt;
+import org.apache.avro.Schema;&lt;br/&gt;
+import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.apache.hadoop.fs.FileStatus;&lt;br/&gt;
 import org.apache.hadoop.fs.FileSystem;&lt;br/&gt;
 import org.apache.hadoop.fs.Path;&lt;br/&gt;
 import org.apache.hadoop.io.NullWritable;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileSplit;&lt;br/&gt;
-import org.apache.hadoop.mapred.JobClient;&lt;br/&gt;
-import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileInputFormat;&lt;br/&gt;
-import org.apache.hadoop.mapred.FileOutputFormat;&lt;br/&gt;
-import org.apache.hadoop.mapred.Reporter;&lt;br/&gt;
-&lt;br/&gt;
-import org.apache.avro.Schema;&lt;br/&gt;
-import org.apache.avro.util.Utf8;&lt;br/&gt;
+import org.apache.hadoop.mapred.*;&lt;br/&gt;
+import org.junit.ClassRule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
+import java.io.IOException;&lt;br/&gt;
+import java.util.StringTokenizer;&lt;br/&gt;
 &lt;br/&gt;
 public class TestWordCount {&lt;br/&gt;
 &lt;br/&gt;
-  public static class MapImpl extends AvroMapper&amp;lt;Utf8, Pair&amp;lt;Utf8, Long&amp;gt; &amp;gt; {&lt;br/&gt;
+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  public static class MapImpl extends AvroMapper&amp;lt;Utf8, Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; {&lt;br/&gt;
     @Override&lt;br/&gt;
-      public void map(Utf8 text, AvroCollector&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
-                      Reporter reporter) throws IOException {&lt;br/&gt;
+    public void map(Utf8 text, AvroCollector&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
+                    Reporter reporter) throws IOException {
       StringTokenizer tokens = new StringTokenizer(text.toString());
       while (tokens.hasMoreTokens())
         collector.collect(new Pair&amp;lt;&amp;gt;(new Utf8(tokens.nextToken()), 1L));
@@ -51,10 +53,10 @@ public void map(Utf8 text, AvroCollector&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; collector,
   }&lt;br/&gt;
 &lt;br/&gt;
   public static class ReduceImpl&lt;br/&gt;
-    extends AvroReducer&amp;lt;Utf8, Long, Pair&amp;lt;Utf8, Long&amp;gt; &amp;gt; {&lt;br/&gt;
+          extends AvroReducer&amp;lt;Utf8, Long, Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; {&lt;br/&gt;
     @Override&lt;br/&gt;
     public void reduce(Utf8 word, Iterable&amp;lt;Long&amp;gt; counts,&lt;br/&gt;
-                       AvroCollector&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
+                       AvroCollector&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; collector,&lt;br/&gt;
                        Reporter reporter) throws IOException {
       long sum = 0;
       for (long count : counts)
@@ -63,61 +65,62 @@ public void reduce(Utf8 word, Iterable&amp;lt;Long&amp;gt; counts,
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
-  @Test public void runTestsInOrder() throws Exception {&lt;br/&gt;
-    testJob();&lt;br/&gt;
-    testProjection();&lt;br/&gt;
+  @Test&lt;br/&gt;
+  public void runTestsInOrder() throws Exception {
+    String pathOut = OUTPUT_DIR.getRoot().getPath();
+    testJob(pathOut);
+    testProjection(pathOut);
   }&lt;br/&gt;
 &lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
-  public void testJob() throws Exception {&lt;br/&gt;
+  public void testJob(String pathOut) throws Exception {
     JobConf job = new JobConf();
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;
-    Path outputPath = new Path(dir + &quot;/out&quot;);
+    String pathIn = INPUT_DIR.getRoot().getPath();
+
+    WordCountUtil.writeLinesFile(pathIn + &quot;/lines.avro&quot;);
 
+    Path outputPath = new Path(pathOut);
     outputPath.getFileSystem(job).delete(outputPath);
-    WordCountUtil.writeLinesFile();
 
     job.setJobName(&quot;wordcount&quot;);
 
     AvroJob.setInputSchema(job, Schema.create(Schema.Type.STRING));
-    AvroJob.setOutputSchema(job,
-                            new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
+    AvroJob.setOutputSchema(job, new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema());
 
     AvroJob.setMapperClass(job, MapImpl.class);
     AvroJob.setCombinerClass(job, ReduceImpl.class);
     AvroJob.setReducerClass(job, ReduceImpl.class);
 
-    FileInputFormat.setInputPaths(job, new Path(dir + &quot;/in&quot;));
-    FileOutputFormat.setOutputPath(job, outputPath);
+    FileInputFormat.setInputPaths(job, new Path(pathIn));
+    FileOutputFormat.setOutputPath(job, new Path(pathOut));
     FileOutputFormat.setCompressOutput(job, true);
 
     WordCountUtil.setMeta(job);
 
     JobClient.runJob(job);
 
-    WordCountUtil.validateCountsFile();
+    WordCountUtil.validateCountsFile(new File(pathOut, &quot;part-00000.avro&quot;));
   }&lt;br/&gt;
 &lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
-  public void testProjection() throws Exception {&lt;br/&gt;
+  public void testProjection(String inputPathString) throws Exception {&lt;br/&gt;
     JobConf job = new JobConf();&lt;br/&gt;
 &lt;br/&gt;
-    Integer defaultRank = new Integer(-1);&lt;br/&gt;
+    Integer defaultRank = -1;&lt;br/&gt;
 &lt;br/&gt;
     String jsonSchema =&lt;br/&gt;
-      &quot;{\&quot;type\&quot;:\&quot;record\&quot;,&quot; +&lt;br/&gt;
-      &quot;\&quot;name\&quot;:\&quot;org.apache.avro.mapred.Pair\&quot;,&quot;+&lt;br/&gt;
-      &quot;\&quot;fields\&quot;: [ &quot; +&lt;br/&gt;
-        &quot;{\&quot;name\&quot;:\&quot;rank\&quot;, \&quot;type\&quot;:\&quot;int\&quot;, \&quot;default\&quot;: -1},&quot; +&lt;br/&gt;
-        &quot;{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:\&quot;long\&quot;}&quot; +&lt;br/&gt;
-      &quot;]}&quot;;&lt;br/&gt;
+            &quot;{\&quot;type\&quot;:\&quot;record\&quot;,&quot; +&lt;br/&gt;
+                    &quot;\&quot;name\&quot;:\&quot;org.apache.avro.mapred.Pair\&quot;,&quot; +&lt;br/&gt;
+                    &quot;\&quot;fields\&quot;: [ &quot; +&lt;br/&gt;
+                    &quot;{\&quot;name\&quot;:\&quot;rank\&quot;, \&quot;type\&quot;:\&quot;int\&quot;, \&quot;default\&quot;: -1},&quot; +&lt;br/&gt;
+                    &quot;{\&quot;name\&quot;:\&quot;value\&quot;, \&quot;type\&quot;:\&quot;long\&quot;}&quot; +&lt;br/&gt;
+                    &quot;]}&quot;;&lt;br/&gt;
 &lt;br/&gt;
     Schema readerSchema = Schema.parse(jsonSchema);&lt;br/&gt;
 &lt;br/&gt;
     AvroJob.setInputSchema(job, readerSchema);&lt;br/&gt;
 &lt;br/&gt;
-    String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;br/&gt;
-    Path inputPath = new Path(dir + &quot;/out&quot; + &quot;/part-00000&quot; + AvroOutputFormat.EXT);&lt;br/&gt;
+    Path inputPath = new Path(inputPathString + &quot;/part-00000.avro&quot;);&lt;br/&gt;
     FileStatus fileStatus = FileSystem.get(job).getFileStatus(inputPath);&lt;br/&gt;
     FileSplit fileSplit = new FileSplit(inputPath, 0, fileStatus.getLen(), job);&lt;br/&gt;
 &lt;br/&gt;
@@ -128,8 +131,8 @@ public void testProjection() throws Exception {&lt;br/&gt;
 &lt;br/&gt;
     long sumOfCounts = 0;&lt;br/&gt;
     long numOfCounts = 0;&lt;br/&gt;
-    while(recordReader.next(inputPair, ignore)) {&lt;br/&gt;
-      Assert.assertEquals((Integer)inputPair.datum().get(0), defaultRank);&lt;br/&gt;
+    while (recordReader.next(inputPair, ignore)) {
+      Assert.assertEquals(inputPair.datum().get(0), defaultRank);
       sumOfCounts += (Long) inputPair.datum().get(1);
       numOfCounts++;
     }&lt;br/&gt;
@@ -137,7 +140,7 @@ public void testProjection() throws Exception {&lt;br/&gt;
     Assert.assertEquals(numOfCounts, WordCountUtil.COUNTS.size());&lt;br/&gt;
 &lt;br/&gt;
     long actualSumOfCounts = 0;&lt;br/&gt;
-    for(Long count : WordCountUtil.COUNTS.values()) {&lt;br/&gt;
+    for (Long count : WordCountUtil.COUNTS.values()) {       actualSumOfCounts += count;     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/WordCountUtil.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/WordCountUtil.java&lt;br/&gt;
index a47675eab..a881f9816 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/WordCountUtil.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/WordCountUtil.java&lt;br/&gt;
@@ -27,6 +27,7 @@&lt;br/&gt;
 import java.io.BufferedInputStream;&lt;br/&gt;
 import java.io.PrintStream;&lt;br/&gt;
 import java.nio.ByteBuffer;&lt;br/&gt;
+import java.nio.charset.StandardCharsets;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
@@ -50,103 +51,104 @@&lt;/p&gt;

&lt;p&gt; public class WordCountUtil {&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;);&lt;/li&gt;
	&lt;li&gt;public static final File LINES_FILE&lt;/li&gt;
	&lt;li&gt;= new File(new File(DIR, &quot;in&quot;), &quot;lines.avro&quot;);&lt;/li&gt;
	&lt;li&gt;private static final File LINES_TEXT_FILE&lt;/li&gt;
	&lt;li&gt;= new File(new File(DIR, &quot;in&quot;), &quot;lines.txt&quot;);&lt;/li&gt;
	&lt;li&gt;public static final File COUNTS_FILE&lt;/li&gt;
	&lt;li&gt;= new File(new File(DIR, &quot;out&quot;), &quot;part-00000.avro&quot;);&lt;/li&gt;
	&lt;li&gt;private static final File SORTED_FILE&lt;/li&gt;
	&lt;li&gt;= new File(new File(DIR, &quot;out&quot;), &quot;part-00000.avro&quot;);&lt;br/&gt;
-&lt;br/&gt;
   public static final String[] LINES = new String[] 
{
     &quot;the quick brown fox jumps over the lazy dog&quot;,
     &quot;the cow jumps over the moon&quot;,
     &quot;the rain in spain falls mainly on the plains&quot;
   }
&lt;p&gt;;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static final Map&amp;lt;String,Long&amp;gt; COUNTS =&lt;/li&gt;
	&lt;li&gt;new TreeMap&amp;lt;&amp;gt;();&lt;br/&gt;
+  public static final Map&amp;lt;String,Long&amp;gt; COUNTS = new TreeMap&amp;lt;&amp;gt;();&lt;br/&gt;
   static {&lt;br/&gt;
     for (String line : LINES) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {       StringTokenizer tokens = new StringTokenizer(line);       while (tokens.hasMoreTokens()) {
         String word = tokens.nextToken();
-        long count = COUNTS.containsKey(word) ? COUNTS.get(word) : 0L;
+        long count = COUNTS.getOrDefault(word, 0L);
         count++;
         COUNTS.put(word, count);
       }     }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void writeLinesFile() throws IOException {&lt;/li&gt;
	&lt;li&gt;FileUtil.fullyDelete(DIR);&lt;br/&gt;
+  public static void writeLinesFile(String dir) throws IOException 
{
+    writeLinesFile(new File(dir));
+  }
&lt;p&gt;+&lt;br/&gt;
+  public static void writeLinesFile(File dir) throws IOException {&lt;br/&gt;
     DatumWriter&amp;lt;Utf8&amp;gt; writer = new GenericDatumWriter&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Utf8&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer);&lt;/li&gt;
	&lt;li&gt;LINES_FILE.getParentFile().mkdirs();&lt;/li&gt;
	&lt;li&gt;out.create(Schema.create(Schema.Type.STRING), LINES_FILE);&lt;/li&gt;
	&lt;li&gt;for (String line : LINES)&lt;/li&gt;
	&lt;li&gt;out.append(new Utf8(line));&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+    try(DataFileWriter&amp;lt;Utf8&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      out.create(Schema.create(Schema.Type.STRING), dir);+      for (String line }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void writeLinesBytesFile() throws IOException {&lt;/li&gt;
	&lt;li&gt;FileUtil.fullyDelete(DIR);&lt;br/&gt;
+  public static void writeLinesBytesFile(String dir) throws IOException 
{
+    writeLinesBytesFile(new File(dir));
+  }
&lt;p&gt;+&lt;br/&gt;
+  public static void writeLinesBytesFile(File dir) throws IOException {&lt;br/&gt;
+    FileUtil.fullyDelete(dir);&lt;br/&gt;
+    File fileLines = new File(dir + &quot;/lines.avro&quot;);&lt;br/&gt;
+    fileLines.getParentFile().mkdirs();&lt;br/&gt;
+&lt;br/&gt;
     DatumWriter&amp;lt;ByteBuffer&amp;gt; writer = new GenericDatumWriter&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;ByteBuffer&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer);&lt;/li&gt;
	&lt;li&gt;LINES_FILE.getParentFile().mkdirs();&lt;/li&gt;
	&lt;li&gt;out.create(Schema.create(Schema.Type.BYTES), LINES_FILE);&lt;/li&gt;
	&lt;li&gt;for (String line : LINES)&lt;/li&gt;
	&lt;li&gt;out.append(ByteBuffer.wrap(line.getBytes(&quot;UTF-8&quot;)));&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+    try(DataFileWriter&amp;lt;ByteBuffer&amp;gt; out = new DataFileWriter&amp;lt;&amp;gt;(writer)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      out.create(Schema.create(Schema.Type.BYTES), fileLines);+      for (String line }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void writeLinesTextFile() throws IOException {&lt;/li&gt;
	&lt;li&gt;FileUtil.fullyDelete(DIR);&lt;/li&gt;
	&lt;li&gt;LINES_FILE.getParentFile().mkdirs();&lt;/li&gt;
	&lt;li&gt;PrintStream out = new PrintStream(LINES_TEXT_FILE);&lt;/li&gt;
	&lt;li&gt;for (String line : LINES)&lt;/li&gt;
	&lt;li&gt;out.println(line);&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+  public static void writeLinesTextFile(File dir) throws IOException {&lt;br/&gt;
+    FileUtil.fullyDelete(dir);&lt;br/&gt;
+    File fileLines = new File(dir, &quot;lines.avro&quot;);&lt;br/&gt;
+    fileLines.getParentFile().mkdirs();&lt;br/&gt;
+    try(PrintStream out = new PrintStream(fileLines)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (String line }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void validateCountsFile() throws Exception {&lt;/li&gt;
	&lt;li&gt;DatumReader&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; reader&lt;/li&gt;
	&lt;li&gt;= new SpecificDatumReader&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;InputStream in = new BufferedInputStream(new FileInputStream(COUNTS_FILE));&lt;/li&gt;
	&lt;li&gt;DataFileStream&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; counts&lt;/li&gt;
	&lt;li&gt;= new DataFileStream&amp;lt;&amp;gt;(in, reader);&lt;br/&gt;
+  public static void validateCountsFile(File file) throws Exception {&lt;br/&gt;
     int numWords = 0;&lt;/li&gt;
	&lt;li&gt;for (Pair&amp;lt;Utf8,Long&amp;gt; wc : counts) {&lt;/li&gt;
	&lt;li&gt;assertEquals(wc.key().toString(),&lt;/li&gt;
	&lt;li&gt;COUNTS.get(wc.key().toString()), wc.value());&lt;/li&gt;
	&lt;li&gt;numWords++;&lt;br/&gt;
+&lt;br/&gt;
+    DatumReader&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; reader = new SpecificDatumReader&amp;lt;&amp;gt;();&lt;br/&gt;
+    try(InputStream in = new BufferedInputStream(new FileInputStream(file))) {&lt;br/&gt;
+      try (DataFileStream&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; counts = new DataFileStream&amp;lt;&amp;gt;(in, reader)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        for (Pair&amp;lt;Utf8, Long&amp;gt; wc }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;checkMeta(counts);&lt;/li&gt;
	&lt;li&gt;in.close();&lt;br/&gt;
+&lt;br/&gt;
     assertEquals(COUNTS.size(), numWords);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public static void validateSortedFile() throws Exception {&lt;br/&gt;
+  public static void validateSortedFile(String file) throws Exception 
{
+    validateSortedFile(new File(file));
+  }
&lt;p&gt;+&lt;br/&gt;
+  public static void validateSortedFile(File file) throws Exception {&lt;br/&gt;
     DatumReader&amp;lt;ByteBuffer&amp;gt; reader = new GenericDatumReader&amp;lt;&amp;gt;();&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;InputStream in = new BufferedInputStream(&lt;/li&gt;
	&lt;li&gt;new FileInputStream(SORTED_FILE));&lt;/li&gt;
	&lt;li&gt;DataFileStream&amp;lt;ByteBuffer&amp;gt; lines =&lt;/li&gt;
	&lt;li&gt;new DataFileStream&amp;lt;&amp;gt;(in, reader);&lt;/li&gt;
	&lt;li&gt;List&amp;lt;String&amp;gt; sortedLines = new ArrayList&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (String line : LINES) 
{
-      sortedLines.add(line);
-    }&lt;/li&gt;
	&lt;li&gt;Collections.sort(sortedLines);&lt;/li&gt;
	&lt;li&gt;for (String expectedLine : sortedLines) {&lt;/li&gt;
	&lt;li&gt;ByteBuffer buf = lines.next();&lt;/li&gt;
	&lt;li&gt;byte[] b = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;buf.remaining()&amp;#93;&lt;/span&gt;;&lt;/li&gt;
	&lt;li&gt;buf.get(b);&lt;/li&gt;
	&lt;li&gt;assertEquals(expectedLine, new String(b, &quot;UTF-8&quot;).trim());&lt;br/&gt;
+    try(InputStream in = new BufferedInputStream(new FileInputStream(file))) {&lt;br/&gt;
+     try(DataFileStream&amp;lt;ByteBuffer&amp;gt; lines = new DataFileStream&amp;lt;&amp;gt;(in, reader)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+       List&amp;lt;String&amp;gt; sortedLines = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(LINES));+       Collections.sort(sortedLines);+       for (String expectedLine }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;assertFalse(lines.hasNext());&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   // metadata tests&lt;br/&gt;
@@ -156,8 +158,7 @@ public static void validateSortedFile() throws Exception {&lt;/p&gt;

&lt;p&gt;   private static final String STRING_META_VALUE = &quot;value&quot;;&lt;br/&gt;
   private static final long LONG_META_VALUE = 666;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final byte[] BYTES_META_VALUE&lt;/li&gt;
	&lt;li&gt;= new byte[] 
{(byte)0x00, (byte)0x80, (byte)0xff};&lt;br/&gt;
+  private static final byte[] BYTES_META_VALUE = new byte[] {(byte)0x00, (byte)0x80, (byte)0xff}
&lt;p&gt;;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   public static void setMeta(JobConf job) {&lt;br/&gt;
     AvroJob.setOutputMeta(job, STRING_KEY, STRING_META_VALUE);&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapred/tether/TestWordCountTether.java b/lang/java/mapred/src/test/java/org/apache/avro/mapred/tether/TestWordCountTether.java&lt;br/&gt;
index b4007d73d..2bf2bdba1 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapred/tether/TestWordCountTether.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapred/tether/TestWordCountTether.java&lt;br/&gt;
@@ -24,6 +24,7 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.FileInputStream;&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.List;&lt;/p&gt;

&lt;p&gt;@@ -32,6 +33,7 @@&lt;br/&gt;
 import org.apache.hadoop.mapred.FileInputFormat;&lt;br/&gt;
 import org.apache.hadoop.mapred.FileOutputFormat;&lt;/p&gt;

&lt;p&gt;+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;/p&gt;

&lt;p&gt; import org.apache.avro.file.DataFileStream;&lt;br/&gt;
@@ -42,35 +44,37 @@&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.apache.avro.specific.SpecificDatumReader;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;See also TestTetherTool for an example of how to submit jobs using the thether tool.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*&lt;br/&gt;
  */&lt;br/&gt;
 public class TestWordCountTether {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;/p&gt;

&lt;p&gt;   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Run a job using the given transport protocol&lt;br/&gt;
+   *&lt;/li&gt;
	&lt;li&gt;@param proto&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private void _runjob(String proto)throws Exception {&lt;/li&gt;
	&lt;li&gt;// System.out.println(System.getProperty(&quot;java.class.path&quot;).replace(&quot;:&quot;, &quot;\n&quot;));&lt;/li&gt;
	&lt;li&gt;System.out.println(System.getProperty(&quot;java.class.path&quot;));&lt;br/&gt;
+  private void _runjob(String proto) throws Exception {&lt;br/&gt;
+    String outputPathStr = OUTPUT_DIR.getRoot().getPath();&lt;br/&gt;
+    File inputPath = new File(INPUT_DIR.getRoot(), &quot;lines.avro&quot;);&lt;br/&gt;
+&lt;br/&gt;
     JobConf job = new JobConf();&lt;/li&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+    Path outputPath = new Path(outputPathStr);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     outputPath.getFileSystem(job).delete(outputPath);&lt;/p&gt;

&lt;p&gt;     // create the input file&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;WordCountUtil.writeLinesFile();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;File exec =&lt;/li&gt;
	&lt;li&gt;new File(System.getProperty(&quot;java.home&quot;)+&quot;/bin/java&quot;);&lt;br/&gt;
+    WordCountUtil.writeLinesFile(inputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;//input path&lt;/li&gt;
	&lt;li&gt;String in=dir+&quot;/in&quot;;&lt;br/&gt;
+    File exec = new File(System.getProperty(&quot;java.home&quot;) + &quot;/bin/java&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     //create a string of the arguments&lt;br/&gt;
     List&amp;lt;String&amp;gt; execargs = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
@@ -78,11 +82,11 @@ private void _runjob(String proto)throws Exception {&lt;br/&gt;
     execargs.add(System.getProperty(&quot;java.class.path&quot;));&lt;br/&gt;
     execargs.add(&quot;org.apache.avro.mapred.tether.WordCountTask&quot;);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FileInputFormat.addInputPaths(job, in);&lt;br/&gt;
+    FileInputFormat.addInputPaths(job, inputPath.toString());&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;br/&gt;
     TetherJob.setExecutable(job, exec, execargs, false);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Schema outscheme= new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema();&lt;br/&gt;
+    Schema outscheme = new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema();&lt;br/&gt;
     AvroJob.setInputSchema(job, Schema.create(Schema.Type.STRING));&lt;br/&gt;
     job.set(AvroJob.OUTPUT_SCHEMA, outscheme.toString());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -90,15 +94,12 @@ private void _runjob(String proto)throws Exception {&lt;br/&gt;
     TetherJob.runJob(job);&lt;/p&gt;

&lt;p&gt;     // validate the output&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumReader&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; reader&lt;/li&gt;
	&lt;li&gt;= new SpecificDatumReader&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;InputStream cin = new BufferedInputStream(new FileInputStream(WordCountUtil.COUNTS_FILE));&lt;/li&gt;
	&lt;li&gt;DataFileStream&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; counts&lt;/li&gt;
	&lt;li&gt;= new DataFileStream&amp;lt;&amp;gt;(cin, reader);&lt;br/&gt;
+    DatumReader&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; reader = new SpecificDatumReader&amp;lt;&amp;gt;();&lt;br/&gt;
+    InputStream cin = new BufferedInputStream(new FileInputStream(outputPath + &quot;/part-00000.avro&quot;));&lt;br/&gt;
+    DataFileStream&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; counts = new DataFileStream&amp;lt;&amp;gt;(cin, reader);&lt;br/&gt;
     int numWords = 0;&lt;/li&gt;
	&lt;li&gt;for (Pair&amp;lt;Utf8,Long&amp;gt; wc : counts) {&lt;/li&gt;
	&lt;li&gt;assertEquals(wc.key().toString(),&lt;/li&gt;
	&lt;li&gt;WordCountUtil.COUNTS.get(wc.key().toString()), wc.value());&lt;br/&gt;
+    for (Pair&amp;lt;Utf8, Long&amp;gt; wc : counts) 
{
+      assertEquals(wc.key().toString(), WordCountUtil.COUNTS.get(wc.key().toString()), wc.value());
       numWords++;
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -109,16 +110,18 @@ private void _runjob(String proto)throws Exception {&lt;/p&gt;

&lt;p&gt;   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test the job using the sasl protocol&lt;br/&gt;
+   *&lt;/li&gt;
	&lt;li&gt;@throws Exception&lt;br/&gt;
    */&lt;br/&gt;
   @Test&lt;br/&gt;
   @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
   public void testJob() throws Exception 
{
-      _runjob(&quot;sasl&quot;);
+    _runjob(&quot;sasl&quot;);
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test the job using the http protocol&lt;br/&gt;
+   *&lt;/li&gt;
	&lt;li&gt;@throws Exception&lt;br/&gt;
    */&lt;br/&gt;
   @Test&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&lt;br/&gt;
index f4df991ff..5e66ecce8 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputs.java&lt;br/&gt;
@@ -20,6 +20,7 @@&lt;br/&gt;
 package org.apache.avro.mapreduce;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import java.io.IOException;&lt;br/&gt;
+import java.nio.file.Files;&lt;br/&gt;
 import java.util.HashMap;&lt;br/&gt;
 import java.util.Map;&lt;/p&gt;

&lt;p&gt;@@ -52,15 +53,16 @@&lt;/p&gt;

&lt;p&gt; public class TestAvroMultipleOutputs {&lt;br/&gt;
   @Rule&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;public TemporaryFolder tmpFolder = new TemporaryFolder();&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   public static final Schema STATS_SCHEMA =&lt;/li&gt;
	&lt;li&gt;Schema.parse(&quot;{\&quot;name\&quot;:\&quot;stats\&quot;,\&quot;type\&quot;:\&quot;record\&quot;,&quot;&lt;/li&gt;
	&lt;li&gt;+ &quot;\&quot;fields\&quot;:[
{\&quot;name\&quot;:\&quot;count\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;,&quot;&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;+ &quot;
{\&quot;name\&quot;:\&quot;name\&quot;,\&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;]}&quot;);&lt;br/&gt;
+          Schema.parse(&quot;&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;name&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;);&lt;br/&gt;
   public static final Schema STATS_SCHEMA_2 =&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;Schema.parse(&quot;{\&quot;name\&quot;:\&quot;stats\&quot;,\&quot;type\&quot;:\&quot;record\&quot;,&quot;&lt;/li&gt;
	&lt;li&gt;+ &quot;\&quot;fields\&quot;:[
{\&quot;name\&quot;:\&quot;count1\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;,&quot;&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;+ &quot;
{\&quot;name\&quot;:\&quot;name1\&quot;,\&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;]}&quot;);&lt;br/&gt;
+          Schema.parse(&quot;&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {&amp;quot;name&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;);&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static class LineCountMapper extends Mapper&amp;lt;LongWritable, Text, Text, IntWritable&amp;gt; {&lt;br/&gt;
     private IntWritable mOne;&lt;br/&gt;
@@ -72,13 +74,13 @@ protected void setup(Context context) {&lt;/p&gt;

&lt;p&gt;     @Override&lt;br/&gt;
     protected void map(LongWritable fileByteOffset, Text line, Context context)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throws IOException, InterruptedException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+            throws IOException, InterruptedException {
       context.write(line, mOne);
     }   }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static class StatCountMapper&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends Mapper&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, Text, IntWritable&amp;gt; {&lt;br/&gt;
+          extends Mapper&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, Text, IntWritable&amp;gt; {&lt;br/&gt;
     private IntWritable mCount;&lt;br/&gt;
     private Text mText;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -90,7 +92,7 @@ protected void setup(Context context) {&lt;/p&gt;

&lt;p&gt;     @Override&lt;br/&gt;
     protected void map(AvroKey&amp;lt;TextStats&amp;gt; record, NullWritable ignore, Context context)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throws IOException, InterruptedException {&lt;br/&gt;
+            throws IOException, InterruptedException 
{
       mCount.set(record.datum().count);
       mText.set(record.datum().name.toString());
       context.write(mText, mCount);
@@ -98,7 +100,7 @@ protected void map(AvroKey&amp;lt;TextStats&amp;gt; record, NullWritable ignore, Context conte
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static class GenericStatsReducer&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends Reducer&amp;lt;Text, IntWritable, AvroKey&amp;lt;GenericData.Record&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
+          extends Reducer&amp;lt;Text, IntWritable, AvroKey&amp;lt;GenericData.Record&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
     private AvroKey&amp;lt;GenericData.Record&amp;gt; mStats;&lt;br/&gt;
     private AvroMultipleOutputs amos;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -110,7 +112,7 @@ protected void setup(Context context) {&lt;/p&gt;

&lt;p&gt;     @Override&lt;br/&gt;
     protected void reduce(Text line, Iterable&amp;lt;IntWritable&amp;gt; counts, Context context)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;throws IOException, InterruptedException {&lt;br/&gt;
+            throws IOException, InterruptedException 
{
       GenericData.Record record = new GenericData.Record(STATS_SCHEMA);
       GenericData.Record record2 = new GenericData.Record(STATS_SCHEMA_2);
       int sum = 0;
@@ -121,27 +123,27 @@ protected void reduce(Text line, Iterable&amp;lt;IntWritable&amp;gt; counts, Context context)
       record.put(&quot;count&quot;, new Integer(sum));
       mStats.datum(record);
       context.write(mStats, NullWritable.get());
-      amos.write(&quot;myavro&quot;,mStats,NullWritable.get());
+      amos.write(&quot;myavro&quot;, mStats, NullWritable.get());
       record2.put(&quot;name1&quot;, new Utf8(line.toString()));
       record2.put(&quot;count1&quot;, new Integer(sum));
       mStats.datum(record2);
       amos.write(mStats, NullWritable.get(), STATS_SCHEMA_2, null, &quot;testnewwrite2&quot;);
-      amos.write(&quot;myavro1&quot;,mStats);
+      amos.write(&quot;myavro1&quot;, mStats);
       amos.write(mStats, NullWritable.get(), STATS_SCHEMA, null, &quot;testnewwrite&quot;);
       amos.write(mStats, NullWritable.get(), &quot;testwritenonschema&quot;);
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     @Override&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;protected void cleanup(Context context) throws IOException,InterruptedException&lt;/li&gt;
	&lt;li&gt;&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+    protected void cleanup(Context context) throws IOException, InterruptedException {
       amos.close();
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
   private static class SpecificStatsReducer&lt;br/&gt;
-      extends Reducer&amp;lt;Text, IntWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
+          extends Reducer&amp;lt;Text, IntWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
     private AvroKey&amp;lt;TextStats&amp;gt; mStats;&lt;br/&gt;
     private AvroMultipleOutputs amos;&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;br/&gt;
     protected void setup(Context context) {&lt;br/&gt;
       mStats = new AvroKey&amp;lt;&amp;gt;(null);&lt;br/&gt;
@@ -150,7 +152,7 @@ protected void setup(Context context) {&lt;br/&gt;
 &lt;br/&gt;
     @Override&lt;br/&gt;
     protected void reduce(Text line, Iterable&amp;lt;IntWritable&amp;gt; counts, Context context)&lt;br/&gt;
-        throws IOException, InterruptedException {&lt;br/&gt;
+            throws IOException, InterruptedException {&lt;br/&gt;
       TextStats record = new TextStats();&lt;br/&gt;
       record.count = 0;&lt;br/&gt;
       for (IntWritable count : counts) {
@@ -159,29 +161,29 @@ protected void reduce(Text line, Iterable&amp;lt;IntWritable&amp;gt; counts, Context context)
       record.name = line.toString();
       mStats.datum(record);
       context.write(mStats, NullWritable.get());
-      amos.write(&quot;myavro3&quot;,mStats,NullWritable.get());
+      amos.write(&quot;myavro3&quot;, mStats, NullWritable.get());
     }&lt;br/&gt;
+&lt;br/&gt;
     @Override&lt;br/&gt;
-    protected void cleanup(Context context) throws IOException,InterruptedException&lt;br/&gt;
-    {&lt;br/&gt;
+    protected void cleanup(Context context) throws IOException, InterruptedException {       amos.close();     }   }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static class SortMapper&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends Mapper&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
+          extends Mapper&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
     @Override&lt;br/&gt;
     protected void map(AvroKey&amp;lt;TextStats&amp;gt; key, NullWritable value, Context context)&lt;/li&gt;
	&lt;li&gt;throws IOException, InterruptedException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+            throws IOException, InterruptedException {
       context.write(key, value);
     }   }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private static class SortReducer&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;extends Reducer&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
+          extends Reducer&amp;lt;AvroKey&amp;lt;TextStats&amp;gt;, NullWritable, AvroKey&amp;lt;TextStats&amp;gt;, NullWritable&amp;gt; {&lt;br/&gt;
     @Override&lt;br/&gt;
     protected void reduce(AvroKey&amp;lt;TextStats&amp;gt; key, Iterable&amp;lt;NullWritable&amp;gt; ignore, Context context)&lt;/li&gt;
	&lt;li&gt;throws IOException, InterruptedException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+            throws IOException, InterruptedException {
       context.write(key, NullWritable.get());
     }   }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;@@ -201,11 +203,11 @@ public void testAvroGenericOutput() throws Exception {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     job.setReducerClass(GenericStatsReducer.class);&lt;br/&gt;
     AvroJob.setOutputKeySchema(job, STATS_SCHEMA);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;AvroMultipleOutputs.addNamedOutput(job,&quot;myavro&quot;,AvroKeyOutputFormat.class,STATS_SCHEMA,null);&lt;/li&gt;
	&lt;li&gt;AvroMultipleOutputs.addNamedOutput(job,&quot;myavro1&quot;, AvroKeyOutputFormat.class, STATS_SCHEMA_2);&lt;br/&gt;
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro&quot;, AvroKeyOutputFormat.class, STATS_SCHEMA, null);&lt;br/&gt;
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro1&quot;, AvroKeyOutputFormat.class, STATS_SCHEMA_2);&lt;br/&gt;
     job.setOutputFormatClass(AvroKeyOutputFormat.class);&lt;/li&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+&lt;br/&gt;
+    Path outputPath = new Path(DIR.getRoot().getPath() + &quot;/testAvroGenericOutput&quot;);&lt;br/&gt;
     outputPath.getFileSystem(job.getConfiguration()).delete(outputPath);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -215,14 +217,16 @@ public void testAvroGenericOutput() throws Exception {&lt;br/&gt;
     FileSystem fileSystem = FileSystem.get(job.getConfiguration());&lt;br/&gt;
     FileStatus[] outputFiles = fileSystem.globStatus(outputPath.suffix(&quot;/myavro-r-00000.avro&quot;));&lt;br/&gt;
     Assert.assertEquals(1, outputFiles.length);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;GenericData.Record&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;/li&gt;
	&lt;li&gt;new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA));&lt;br/&gt;
+&lt;br/&gt;
     Map&amp;lt;String, Integer&amp;gt; counts = new HashMap&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (GenericData.Record record : reader) {&lt;/li&gt;
	&lt;li&gt;counts.put(((Utf8) record.get(&quot;name&quot;)).toString(), (Integer) record.get(&quot;count&quot;));&lt;br/&gt;
+&lt;br/&gt;
+    try (DataFileReader&amp;lt;GenericData.Record&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;br/&gt;
+            new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (GenericData.Record record }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Assert.assertEquals(3, counts.get(&quot;apple&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(2, counts.get(&quot;banana&quot;).intValue());&lt;br/&gt;
@@ -260,34 +264,32 @@ public void testAvroGenericOutput() throws Exception {&lt;/p&gt;

&lt;p&gt;     outputFiles = fileSystem.globStatus(outputPath.suffix(&quot;/testnewwrite2-r-00000.avro&quot;));&lt;br/&gt;
     Assert.assertEquals(1, outputFiles.length);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reader = new DataFileReader&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;/li&gt;
	&lt;li&gt;new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA_2));&lt;/li&gt;
	&lt;li&gt;counts = new HashMap&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (GenericData.Record record : reader) {&lt;/li&gt;
	&lt;li&gt;counts.put(((Utf8) record.get(&quot;name1&quot;)).toString(), (Integer) record.get(&quot;count1&quot;));&lt;br/&gt;
+    counts.clear();&lt;br/&gt;
+    try (DataFileReader&amp;lt;GenericData.Record&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;br/&gt;
+            new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA_2))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (GenericData.Record record }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
     Assert.assertEquals(3, counts.get(&quot;apple&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(2, counts.get(&quot;banana&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(1, counts.get(&quot;carrot&quot;).intValue());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     outputFiles = fileSystem.globStatus(outputPath.suffix(&quot;/testwritenonschema-r-00000.avro&quot;));&lt;br/&gt;
     Assert.assertEquals(1, outputFiles.length);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reader = new DataFileReader&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;/li&gt;
	&lt;li&gt;new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA));&lt;/li&gt;
	&lt;li&gt;counts = new HashMap&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (GenericData.Record record : reader) {&lt;/li&gt;
	&lt;li&gt;counts.put(((Utf8) record.get(&quot;name&quot;)).toString(), (Integer) record.get(&quot;count&quot;));&lt;br/&gt;
+    counts.clear();&lt;br/&gt;
+    try (DataFileReader&amp;lt;GenericData.Record&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;br/&gt;
+            new GenericDatumReader&amp;lt;&amp;gt;(STATS_SCHEMA))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (GenericData.Record record }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Assert.assertEquals(3, counts.get(&quot;apple&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(2, counts.get(&quot;banana&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(1, counts.get(&quot;carrot&quot;).intValue());&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
@@ -302,14 +304,13 @@ public void testAvroSpecificOutput() throws Exception {&lt;br/&gt;
     job.setMapperClass(LineCountMapper.class);&lt;br/&gt;
     job.setMapOutputKeyClass(Text.class);&lt;br/&gt;
     job.setMapOutputValueClass(IntWritable.class);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;AvroMultipleOutputs.addNamedOutput(job,&quot;myavro3&quot;,AvroKeyOutputFormat.class,TextStats.SCHEMA$,null);&lt;br/&gt;
+    AvroMultipleOutputs.addNamedOutput(job, &quot;myavro3&quot;, AvroKeyOutputFormat.class, TextStats.SCHEMA$, null);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     job.setReducerClass(SpecificStatsReducer.class);&lt;br/&gt;
     AvroJob.setOutputKeySchema(job, TextStats.SCHEMA$);&lt;/p&gt;

&lt;p&gt;     job.setOutputFormatClass(AvroKeyOutputFormat.class);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out-specific&quot;);&lt;br/&gt;
+    Path outputPath = new Path(DIR.getRoot().getPath() + &quot;/testAvroSpecificOutput&quot;);&lt;br/&gt;
     outputPath.getFileSystem(job.getConfiguration()).delete(outputPath);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -317,14 +318,14 @@ public void testAvroSpecificOutput() throws Exception {&lt;br/&gt;
     FileSystem fileSystem = FileSystem.get(job.getConfiguration());&lt;br/&gt;
     FileStatus[] outputFiles = fileSystem.globStatus(outputPath.suffix(&quot;/myavro3-*&quot;));&lt;br/&gt;
     Assert.assertEquals(1, outputFiles.length);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;TextStats&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;/li&gt;
	&lt;li&gt;new SpecificDatumReader&amp;lt;&amp;gt;());&lt;br/&gt;
     Map&amp;lt;String, Integer&amp;gt; counts = new HashMap&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (TextStats record : reader) {&lt;/li&gt;
	&lt;li&gt;counts.put(record.name.toString(), record.count);&lt;br/&gt;
+    try (DataFileReader&amp;lt;TextStats&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;br/&gt;
+            new SpecificDatumReader&amp;lt;&amp;gt;())) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (TextStats record }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Assert.assertEquals(3, counts.get(&quot;apple&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(2, counts.get(&quot;banana&quot;).intValue());&lt;br/&gt;
@@ -391,7 +392,7 @@ public void testAvroMapOutput() throws Exception {&lt;br/&gt;
     AvroJob.setOutputKeySchema(job, TextStats.SCHEMA$);&lt;/p&gt;

&lt;p&gt;     job.setOutputFormatClass(AvroKeyOutputFormat.class);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Path outputPath = new Path(tmpFolder.getRoot().getPath() + &quot;/out-specific-input&quot;);&lt;br/&gt;
+    Path outputPath = new Path(DIR.getRoot().getPath() + &quot;/testAvroMapOutput&quot;);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Assert.assertTrue(job.waitForCompletion(true));&lt;br/&gt;
@@ -400,14 +401,14 @@ public void testAvroMapOutput() throws Exception {&lt;br/&gt;
     FileSystem fileSystem = FileSystem.get(job.getConfiguration());&lt;br/&gt;
     FileStatus[] outputFiles = fileSystem.globStatus(outputPath.suffix(&quot;/part-*&quot;));&lt;br/&gt;
     Assert.assertEquals(1, outputFiles.length);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;TextStats&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;/li&gt;
	&lt;li&gt;new SpecificDatumReader&amp;lt;&amp;gt;());&lt;br/&gt;
     Map&amp;lt;String, Integer&amp;gt; counts = new HashMap&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (TextStats record : reader) {&lt;/li&gt;
	&lt;li&gt;counts.put(record.name.toString(), record.count);&lt;br/&gt;
+    try (DataFileReader&amp;lt;TextStats&amp;gt; reader = new DataFileReader&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FsInput(outputFiles&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;.getPath(), job.getConfiguration()),&lt;br/&gt;
+            new SpecificDatumReader&amp;lt;&amp;gt;())) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (TextStats record }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Assert.assertEquals(3, counts.get(&quot;apple&quot;).intValue());&lt;br/&gt;
     Assert.assertEquals(2, counts.get(&quot;banana&quot;).intValue());&lt;br/&gt;
diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputsSyncable.java b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputsSyncable.java&lt;br/&gt;
index b438ab6e1..e713f9aba 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputsSyncable.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestAvroMultipleOutputsSyncable.java&lt;br/&gt;
@@ -52,6 +52,7 @@&lt;br/&gt;
 public class TestAvroMultipleOutputsSyncable {&lt;br/&gt;
   @Rule&lt;br/&gt;
   public TemporaryFolder tmpFolder = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   public static final Schema STATS_SCHEMA =&lt;br/&gt;
       Schema.parse(&quot;{\&quot;name\&quot;:\&quot;stats\&quot;,\&quot;type\&quot;:\&quot;record\&quot;,&quot;&lt;br/&gt;
           + &quot;\&quot;fields\&quot;:[&lt;/p&gt;
{\&quot;name\&quot;:\&quot;count\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}
&lt;p&gt;,&quot;&lt;br/&gt;
@@ -117,13 +118,13 @@ protected void reduce(Text line, Iterable&amp;lt;IntWritable&amp;gt; counts, Context context)&lt;br/&gt;
         sum += count.get();&lt;br/&gt;
       }&lt;br/&gt;
       record.put(&quot;name&quot;, new Utf8(line.toString()));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;record.put(&quot;count&quot;, new Integer(sum));&lt;br/&gt;
+      record.put(&quot;count&quot;, sum);&lt;br/&gt;
       mStats.datum(record);&lt;br/&gt;
       context.write(mStats, NullWritable.get());&lt;br/&gt;
       amos.sync(&quot;myavro&quot;,&quot;myavro&quot;);&lt;br/&gt;
       amos.write(&quot;myavro&quot;,mStats,NullWritable.get());&lt;br/&gt;
       record2.put(&quot;name1&quot;, new Utf8(line.toString()));&lt;/li&gt;
	&lt;li&gt;record2.put(&quot;count1&quot;, new Integer(sum));&lt;br/&gt;
+      record2.put(&quot;count1&quot;, sum);&lt;br/&gt;
       mStats.datum(record2);&lt;br/&gt;
       amos.write(mStats, NullWritable.get(), STATS_SCHEMA_2, null, &quot;testnewwrite2&quot;);&lt;br/&gt;
       amos.sync(&quot;myavro1&quot;,&quot;myavro1&quot;);&lt;br/&gt;
@@ -206,8 +207,7 @@ public void testAvroGenericOutput() throws Exception {&lt;br/&gt;
     AvroMultipleOutputs.addNamedOutput(job,&quot;myavro&quot;,AvroKeyOutputFormat.class,STATS_SCHEMA,null);&lt;br/&gt;
     AvroMultipleOutputs.addNamedOutput(job,&quot;myavro1&quot;, AvroKeyOutputFormat.class, STATS_SCHEMA_2);&lt;br/&gt;
     job.setOutputFormatClass(AvroKeyOutputFormat.class);&lt;/li&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+    Path outputPath = new Path(tmpFolder.getRoot().getPath() + &quot;/out&quot;);&lt;br/&gt;
     outputPath.getFileSystem(job.getConfiguration()).delete(outputPath);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -310,8 +310,7 @@ public void testAvroSpecificOutput() throws Exception {&lt;br/&gt;
     AvroJob.setOutputKeySchema(job, TextStats.SCHEMA$);&lt;/p&gt;

&lt;p&gt;     job.setOutputFormatClass(AvroKeyOutputFormat.class);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out-specific&quot;);&lt;br/&gt;
+    Path outputPath = new Path(tmpFolder.getRoot().getPath() + &quot;/out-specific&quot;);&lt;br/&gt;
     outputPath.getFileSystem(job.getConfiguration()).delete(outputPath);&lt;br/&gt;
     FileOutputFormat.setOutputPath(job, outputPath);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestFsInput.java b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestFsInput.java&lt;br/&gt;
index 33adc6c8d..3d4f9c60f 100644&lt;br/&gt;
&amp;#8212; a/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestFsInput.java&lt;br/&gt;
+++ b/lang/java/mapred/src/test/java/org/apache/avro/mapreduce/TestFsInput.java&lt;br/&gt;
@@ -29,15 +29,12 @@&lt;br/&gt;
 import java.io.PrintWriter;&lt;br/&gt;
 import java.nio.charset.Charset;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.mapred.FsInput;&lt;br/&gt;
 import org.apache.hadoop.conf.Configuration;&lt;br/&gt;
 import org.apache.hadoop.fs.FileSystem;&lt;br/&gt;
 import org.apache.hadoop.fs.Path;&lt;br/&gt;
-import org.junit.After;&lt;br/&gt;
-import org.junit.Before;&lt;br/&gt;
-import org.junit.BeforeClass;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.junit.*;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestFsInput {&lt;br/&gt;
   private static File file;&lt;br/&gt;
@@ -45,22 +42,18 @@&lt;br/&gt;
   private Configuration conf;&lt;br/&gt;
   private FsInput fsInput;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@BeforeClass&lt;/li&gt;
	&lt;li&gt;public static void setUpBeforeClass() throws Exception {&lt;/li&gt;
	&lt;li&gt;File directory = AvroTestUtil.tempDirectory(TestFsInput.class, &quot;file&quot;);&lt;/li&gt;
	&lt;li&gt;file = new File(directory, &quot;file.txt&quot;);&lt;/li&gt;
	&lt;li&gt;PrintWriter out = new PrintWriter(new OutputStreamWriter(new FileOutputStream(file), Charset.forName(&quot;UTF-8&quot;)));&lt;/li&gt;
	&lt;li&gt;try 
{
-      out.print(FILE_CONTENTS);
-    }
&lt;p&gt; finally &lt;/p&gt;
{
-      out.close();
-    }&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Before&lt;br/&gt;
   public void setUp() throws Exception {&lt;br/&gt;
     conf = new Configuration();&lt;br/&gt;
     conf.set(&quot;fs.default.name&quot;, &quot;file:///&quot;);&lt;br/&gt;
+    file = new File(DIR.getRoot(), &quot;file.txt&quot;);&lt;br/&gt;
+&lt;br/&gt;
+    try (PrintWriter out = new PrintWriter(new OutputStreamWriter(new FileOutputStream(file), Charset.forName(&quot;UTF-8&quot;)))) &lt;/p&gt;
{
+      out.print(FILE_CONTENTS);
+    }
&lt;p&gt;     fsInput = new FsInput(new Path(file.getPath()), conf);&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;@@ -73,14 +66,11 @@ public void tearDown() throws Exception {&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
   public void testConfigurationConstructor() throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FsInput in = new FsInput(new Path(file.getPath()), conf);&lt;/li&gt;
	&lt;li&gt;try 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+    try (FsInput in = new FsInput(new Path(file.getPath()), conf)) {
       int expectedByteCount = 1;
       byte[] readBytes = new byte[expectedByteCount];
       int actualByteCount = fsInput.read(readBytes, 0, expectedByteCount);
       assertThat(actualByteCount, is(equalTo(expectedByteCount)));
-    } finally {
-      in.close();
     }&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -88,14 +78,11 @@ public void testConfigurationConstructor() throws Exception {&lt;br/&gt;
   public void testFileSystemConstructor() throws Exception {&lt;br/&gt;
     Path path = new Path(file.getPath());&lt;br/&gt;
     FileSystem fs = path.getFileSystem(conf);&lt;br/&gt;
-    FsInput in = new FsInput(path, fs);&lt;br/&gt;
-    try {&lt;br/&gt;
+    try (FsInput in = new FsInput(path, fs)) {       int expectedByteCount = 1;       byte[] readBytes = new byte[expectedByteCount];       int actualByteCount = fsInput.read(readBytes, 0, expectedByteCount);       assertThat(actualByteCount, is(equalTo(expectedByteCount)));-    } finally {
-      in.close();
     }   }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;diff --git a/lang/java/pom.xml b/lang/java/pom.xml&lt;br/&gt;
index 0abf3c090..eae6899de 100644&lt;br/&gt;
&amp;#8212; a/lang/java/pom.xml&lt;br/&gt;
+++ b/lang/java/pom.xml&lt;br/&gt;
@@ -204,7 +204,6 @@&lt;br/&gt;
               &amp;lt;configuration&amp;gt;&lt;br/&gt;
                 &amp;lt;systemPropertyVariables&amp;gt;&lt;br/&gt;
                   &amp;lt;org.apache.avro.specific.use_custom_coders&amp;gt;true&amp;lt;/org.apache.avro.specific.use_custom_coders&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;test.dir&amp;gt;${project.basedir}/target/&amp;lt;/test.dir&amp;gt;&lt;br/&gt;
                 &amp;lt;/systemPropertyVariables&amp;gt;&lt;br/&gt;
               &amp;lt;/configuration&amp;gt;&lt;br/&gt;
             &amp;lt;/execution&amp;gt;&lt;br/&gt;
@@ -236,9 +235,6 @@&lt;br/&gt;
             &amp;lt;redirectTestOutputToFile&amp;gt;true&amp;lt;/redirectTestOutputToFile&amp;gt;&lt;br/&gt;
             &amp;lt;failIfNoTests&amp;gt;false&amp;lt;/failIfNoTests&amp;gt;&lt;br/&gt;
             &amp;lt;argLine&amp;gt;-Xmx1000m&amp;lt;/argLine&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;systemPropertyVariables&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;test.dir&amp;gt;${project.basedir}/target/&amp;lt;/test.dir&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;/systemPropertyVariables&amp;gt;&lt;br/&gt;
           &amp;lt;/configuration&amp;gt;&lt;br/&gt;
         &amp;lt;/plugin&amp;gt;&lt;br/&gt;
         &amp;lt;plugin&amp;gt;&lt;br/&gt;
@@ -393,7 +389,6 @@&lt;br/&gt;
             &amp;lt;artifactId&amp;gt;maven-surefire-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
             &amp;lt;configuration&amp;gt;&lt;br/&gt;
               &amp;lt;systemPropertyVariables&amp;gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;test.dir&amp;gt;${project.basedir}/target/&amp;lt;/test.dir&amp;gt;&lt;br/&gt;
                 &amp;lt;!-- avro-mapred will fail in tests on mac without this --&amp;gt;&lt;br/&gt;
                 &amp;lt;java.security.krb5.realm&amp;gt;OX.AC.UK&amp;lt;/java.security.krb5.realm&amp;gt;&lt;br/&gt;
                 &amp;lt;java.security.krb5.kdc&amp;gt;kdc0.ox.ac.uk:kdc1.ox.ac.uk&amp;lt;/java.security.krb5.kdc&amp;gt;&lt;br/&gt;
diff --git a/lang/java/tools/src/test/compiler/output-string/avro/examples/baseball/Player.java b/lang/java/tools/src/test/compiler/output-string/avro/examples/baseball/Player.java&lt;br/&gt;
index 26cc31fc0..c972235ed 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/compiler/output-string/avro/examples/baseball/Player.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/compiler/output-string/avro/examples/baseball/Player.java&lt;br/&gt;
@@ -541,13 +541,3 @@ public Player build() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
diff --git a/lang/java/tools/src/test/compiler/output/Player.java b/lang/java/tools/src/test/compiler/output/Player.java&lt;br/&gt;
index 8eaf5d7ad..af4e8f783 100644&lt;/li&gt;
			&lt;li&gt;a/lang/java/tools/src/test/compiler/output/Player.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/compiler/output/Player.java&lt;br/&gt;
@@ -541,13 +541,3 @@ public Player build() {&lt;br/&gt;
     }&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
-&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestCatTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestCatTool.java&lt;br/&gt;
index cfc38c990..4b2312547 100644&lt;/li&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestCatTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestCatTool.java&lt;br/&gt;
@@ -33,7 +33,6 @@&lt;br/&gt;
 import java.util.Map;&lt;br/&gt;
 import java.util.Map.Entry;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.CodecFactory;&lt;br/&gt;
@@ -43,9 +42,19 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;/p&gt;

&lt;p&gt; public class TestCatTool {&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TestName name = new TestName();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   private static final int ROWS_IN_INPUT_FILES = 100000;&lt;br/&gt;
   private static final int OFFSET = 1000;&lt;br/&gt;
   private static final int LIMIT_WITHIN_INPUT_BOUNDS = 100;&lt;br/&gt;
@@ -69,7 +78,7 @@&lt;/p&gt;


&lt;p&gt;   private GenericRecord aDatum(Type ofType, int forRow) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;GenericRecord record = null;&lt;br/&gt;
+    GenericRecord record;&lt;br/&gt;
     switch (ofType) {&lt;br/&gt;
       case STRING:&lt;br/&gt;
         record = new GenericData.Record(STRINGSCHEMA);&lt;br/&gt;
@@ -85,7 +94,7 @@ private GenericRecord aDatum(Type ofType, int forRow) {&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private File generateData(String file, Type type, Map&amp;lt;String, String&amp;gt; metadata, CodecFactory codec) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File inputFile = AvroTestUtil.tempFile(getClass(), file);&lt;br/&gt;
+    File inputFile = new File(DIR.getRoot(), file);&lt;br/&gt;
     inputFile.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Schema schema = null;&lt;br/&gt;
@@ -146,7 +155,7 @@ public void testCat() throws Exception {&lt;br/&gt;
     File input2 = generateData(&quot;input2.avro&quot;, Type.INT, metadata, SNAPPY);&lt;br/&gt;
     File input3 = generateData(&quot;input3.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; //    file input&lt;br/&gt;
@@ -203,7 +212,7 @@ public void testLimitOutOfBounds() throws Exception {&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;p&gt;     File input1 = generateData(&quot;input1.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
@@ -226,7 +235,7 @@ public void testSamplerateAccuracy() throws Exception {&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;p&gt;     File input1 = generateData(&quot;input1.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt;args = asList(&lt;br/&gt;
@@ -252,7 +261,7 @@ public void testOffSetAccuracy() throws Exception {&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;p&gt;     File input1 = generateData(&quot;input1.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
@@ -277,7 +286,7 @@ public void testOffsetBiggerThanInput() throws Exception{&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;p&gt;     File input1 = generateData(&quot;input1.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
@@ -300,14 +309,14 @@ public void testSamplerateSmallerThanInput() throws Exception{&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;p&gt;     File input1 = generateData(&quot;input1.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
       input1.getAbsolutePath(),&lt;br/&gt;
       output.getAbsolutePath(),&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;--offset=&quot; +  new Integer(OFFSET).toString(),&lt;/li&gt;
	&lt;li&gt;&quot;--samplerate=&quot; + new Double(SAMPLERATE_TOO_SMALL).toString());&lt;br/&gt;
+      &quot;--offset=&quot; + Integer.toString(OFFSET),&lt;br/&gt;
+      &quot;--samplerate=&quot; + Double.toString(SAMPLERATE_TOO_SMALL));&lt;br/&gt;
     int returnCode = new CatTool().run(&lt;br/&gt;
       System.in,&lt;br/&gt;
       System.out,&lt;br/&gt;
@@ -328,7 +337,7 @@ public void testDifferentSchemasFail() throws Exception {&lt;br/&gt;
     File input1 = generateData(&quot;input1.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;br/&gt;
     File input2 = generateData(&quot;input2.avro&quot;, Type.INT, metadata, DEFLATE);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;out/default-output.avro&quot;);&lt;br/&gt;
+    File output = new File(DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
     output.deleteOnExit();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
@@ -345,13 +354,14 @@ public void testDifferentSchemasFail() throws Exception {&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testHelpfulMessageWhenNoArgsGiven() throws Exception {&lt;br/&gt;
     ByteArrayOutputStream buffer = new ByteArrayOutputStream(1024);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PrintStream out = new PrintStream(buffer);&lt;/li&gt;
	&lt;li&gt;int returnCode = new CatTool().run(&lt;/li&gt;
	&lt;li&gt;System.in,&lt;/li&gt;
	&lt;li&gt;out,&lt;/li&gt;
	&lt;li&gt;System.err,&lt;/li&gt;
	&lt;li&gt;Collections.emptyList());&lt;/li&gt;
	&lt;li&gt;out.close(); // flushes too&lt;br/&gt;
+    int returnCode;&lt;br/&gt;
+    try(PrintStream out = new PrintStream(buffer)) 
{
+      returnCode = new CatTool().run(
+              System.in,
+              out,
+              System.err,
+              Collections.emptyList());
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     assertEquals(0, returnCode);&lt;br/&gt;
     assertTrue(&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestConcatTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestConcatTool.java&lt;br/&gt;
index 777d83ed7..4c0c57147 100644&lt;br/&gt;
&amp;#8212; a/lang/java/tools/src/test/java/org/apache/avro/tool/TestConcatTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestConcatTool.java&lt;br/&gt;
@@ -27,14 +27,9 @@&lt;br/&gt;
 import java.io.FileInputStream;&lt;br/&gt;
 import java.io.FileNotFoundException;&lt;br/&gt;
 import java.io.PrintStream;&lt;br/&gt;
-import java.util.Collections;&lt;br/&gt;
-import java.util.HashMap;&lt;br/&gt;
-import java.util.Iterator;&lt;br/&gt;
-import java.util.List;&lt;br/&gt;
-import java.util.Map;&lt;br/&gt;
+import java.util.*;&lt;br/&gt;
 import java.util.Map.Entry;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.CodecFactory;&lt;br/&gt;
@@ -44,12 +39,25 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.generic.GenericRecord;&lt;br/&gt;
+import org.apache.avro.util.Utf8;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;/p&gt;

&lt;p&gt; public class TestConcatTool {&lt;br/&gt;
   private static final int ROWS_IN_INPUT_FILES = 100000;&lt;br/&gt;
   private static final CodecFactory DEFLATE = CodecFactory.deflateCodec(9);&lt;/p&gt;

&lt;p&gt;+  @Rule&lt;br/&gt;
+  public TestName name = new TestName();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   private Object aDatum(Type ofType, int forRow) {&lt;br/&gt;
     switch (ofType) {&lt;br/&gt;
       case STRING:&lt;br/&gt;
@@ -57,54 +65,44 @@ private Object aDatum(Type ofType, int forRow) &lt;/p&gt;
{
       case INT:
         return forRow;
       default:
-       throw new AssertionError(&quot;I can&apos;t generate data for this type&quot;);
+        throw new AssertionError(&quot;I can&apos;t generate data for this type&quot;);
     }
&lt;p&gt;   }&lt;/p&gt;

&lt;p&gt;   private File generateData(String file, Type type, Map&amp;lt;String, String&amp;gt; metadata, CodecFactory codec) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File inputFile = AvroTestUtil.tempFile(getClass(), file);&lt;/li&gt;
	&lt;li&gt;inputFile.deleteOnExit();&lt;br/&gt;
-&lt;br/&gt;
+    File inputFile = new File(INPUT_DIR.getRoot(), file);&lt;br/&gt;
     Schema schema = Schema.create(type);&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Object&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new GenericDatumWriter&amp;lt;&amp;gt;(schema));&lt;/li&gt;
	&lt;li&gt;for(Entry&amp;lt;String, String&amp;gt; metadatum : metadata.entrySet()) {&lt;br/&gt;
+    try (DataFileWriter&amp;lt;Object&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;(schema))) {&lt;br/&gt;
+      for (Entry&amp;lt;String, String&amp;gt; metadatum : metadata.entrySet()) 
{
         writer.setMeta(metadatum.getKey(), metadatum.getValue());
-    }&lt;/li&gt;
	&lt;li&gt;writer.setCodec(codec);&lt;/li&gt;
	&lt;li&gt;writer.create(schema, inputFile);&lt;br/&gt;
+      }&lt;br/&gt;
+      writer.setCodec(codec);&lt;br/&gt;
+      writer.create(schema, inputFile);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; ROWS_IN_INPUT_FILES; i++) {&lt;/li&gt;
	&lt;li&gt;writer.append(aDatum(type, i));&lt;br/&gt;
+      for (int i = 0; i &amp;lt; ROWS_IN_INPUT_FILES; i++) 
{
+        writer.append(aDatum(type, i));
+      }
&lt;p&gt;     }&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
-&lt;br/&gt;
     return inputFile;&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private CodecFactory getCodec(File output) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileStream&amp;lt;GenericRecord&amp;gt; reader = new DataFileStream&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FileInputStream(output),&lt;/li&gt;
	&lt;li&gt;new GenericDatumReader&amp;lt;&amp;gt;());&lt;br/&gt;
+    try (DataFileStream&amp;lt;GenericRecord&amp;gt; reader = new DataFileStream&amp;lt;&amp;gt;(&lt;br/&gt;
+            new FileInputStream(output),&lt;br/&gt;
+            new GenericDatumReader&amp;lt;&amp;gt;())) {&lt;br/&gt;
       String codec = reader.getMetaString(DataFileConstants.CODEC);&lt;/li&gt;
	&lt;li&gt;try 
{
-        return codec == null ? CodecFactory.nullCodec() : CodecFactory.fromString(codec);
-      }
&lt;p&gt;finally&lt;/p&gt;
{
-        reader.close();
-      }
&lt;p&gt;+&lt;br/&gt;
+      return codec == null ? CodecFactory.nullCodec() : CodecFactory.fromString(codec);&lt;br/&gt;
+    }&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private int numRowsInFile(File output) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileStream&amp;lt;GenericRecord&amp;gt; reader = new DataFileStream&amp;lt;&amp;gt;(&lt;/li&gt;
	&lt;li&gt;new FileInputStream(output),&lt;/li&gt;
	&lt;li&gt;new GenericDatumReader&amp;lt;&amp;gt;());&lt;/li&gt;
	&lt;li&gt;Iterator&amp;lt;GenericRecord&amp;gt; rows = reader.iterator();&lt;br/&gt;
     int rowcount = 0;&lt;/li&gt;
	&lt;li&gt;while(rows.hasNext()) {&lt;/li&gt;
	&lt;li&gt;++rowcount;&lt;/li&gt;
	&lt;li&gt;rows.next();&lt;br/&gt;
+    try (DataFileStream&amp;lt;Utf8&amp;gt; reader = new DataFileStream&amp;lt;&amp;gt;(new FileInputStream(output), new GenericDatumReader&amp;lt;&amp;gt;())) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      for (Utf8 ignored }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;reader.close();&lt;br/&gt;
     return rowcount;&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -112,28 +110,23 @@ private int numRowsInFile(File output) throws Exception {&lt;br/&gt;
   public void testDirConcat() throws Exception {&lt;br/&gt;
     Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File dir = AvroTestUtil.tempDirectory(getClass(), &quot;input&quot;);&lt;br/&gt;
-&lt;br/&gt;
     for (int i = 0; i &amp;lt; 3; i++) 
{
-      String filename = &quot;input&quot; + i + &quot;.avro&quot;;
-      File input = generateData(filename, Type.STRING, metadata, DEFLATE);
-      boolean ok = input.renameTo(new File(dir, input.getName()));
-      assertTrue(ok);
+      generateData(name.getMethodName() + &quot;-&quot; + i + &quot;.avro&quot;, Type.STRING, metadata, DEFLATE);
     }&lt;br/&gt;
 &lt;br/&gt;
-    File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);&lt;br/&gt;
-    output.deleteOnExit();&lt;br/&gt;
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;br/&gt;
 &lt;br/&gt;
     List&amp;lt;String&amp;gt; args = asList(&lt;br/&gt;
-      dir.getAbsolutePath(),&lt;br/&gt;
-      output.getAbsolutePath());&lt;br/&gt;
+            INPUT_DIR.getRoot().getAbsolutePath(),&lt;br/&gt;
+            output.getAbsolutePath()&lt;br/&gt;
+    );&lt;br/&gt;
     int returnCode = new ConcatTool().run(&lt;br/&gt;
-      System.in,&lt;br/&gt;
-      System.out,&lt;br/&gt;
-      System.err,&lt;br/&gt;
-      args);&lt;br/&gt;
-    assertEquals(0, returnCode);&lt;br/&gt;
+            System.in,&lt;br/&gt;
+            System.out,&lt;br/&gt;
+            System.err,&lt;br/&gt;
+            args);&lt;br/&gt;
 &lt;br/&gt;
+    assertEquals(0, returnCode);&lt;br/&gt;
     assertEquals(ROWS_IN_INPUT_FILES * 3, numRowsInFile(output));&lt;br/&gt;
   }&lt;br/&gt;
 &lt;br/&gt;
@@ -141,48 +134,37 @@ public void testDirConcat() throws Exception {&lt;br/&gt;
   public void testGlobPatternConcat() throws Exception {&lt;br/&gt;
     Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
 &lt;br/&gt;
-    File dir = AvroTestUtil.tempDirectory(getClass(), &quot;input&quot;);&lt;br/&gt;
-&lt;br/&gt;
     for (int i = 0; i &amp;lt; 3; i++) {-      String filename = &quot;input&quot; + i + &quot;.avro&quot;;-      File input = generateData(filename, Type.STRING, metadata, DEFLATE);-      boolean ok = input.renameTo(new File(dir, input.getName()));-      assertTrue(ok);+      generateData(name.getMethodName() + &quot;-&quot; + i + &quot;.avro&quot;, Type.STRING, metadata, DEFLATE);     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;output.deleteOnExit();&lt;br/&gt;
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new File(dir, &quot;/*&quot;).getAbsolutePath(),&lt;/li&gt;
	&lt;li&gt;output.getAbsolutePath());&lt;br/&gt;
+            new File(INPUT_DIR.getRoot(), &quot;/*&quot;).getAbsolutePath(),&lt;br/&gt;
+            output.getAbsolutePath());&lt;br/&gt;
     int returnCode = new ConcatTool().run(&lt;/li&gt;
	&lt;li&gt;System.in,&lt;/li&gt;
	&lt;li&gt;System.out,&lt;/li&gt;
	&lt;li&gt;System.err,&lt;/li&gt;
	&lt;li&gt;args);&lt;/li&gt;
	&lt;li&gt;assertEquals(0, returnCode);&lt;br/&gt;
+            System.in,&lt;br/&gt;
+            System.out,&lt;br/&gt;
+            System.err,&lt;br/&gt;
+            args);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    assertEquals(0, returnCode);&lt;br/&gt;
     assertEquals(ROWS_IN_INPUT_FILES * 3, numRowsInFile(output));&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   @Test(expected = FileNotFoundException.class)&lt;br/&gt;
   public void testFileDoesNotExist() throws Exception &lt;/p&gt;
{
-    Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();
-
-    File dir = AvroTestUtil.tempDirectory(getClass(), &quot;input&quot;);
-
-    File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);
-    output.deleteOnExit();
+    File output = new File(INPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);
 
     List&amp;lt;String&amp;gt; args = asList(
-      new File(dir, &quot;/doNotExist&quot;).getAbsolutePath(),
-      output.getAbsolutePath());
+            new File(INPUT_DIR.getRoot(), &quot;/doNotExist&quot;).getAbsolutePath(),
+            output.getAbsolutePath());
     new ConcatTool().run(
-      System.in,
-      System.out,
-      System.err,
-      args);
+            System.in,
+            System.out,
+            System.err,
+            args);
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -190,23 +172,22 @@ public void testConcat() throws Exception {&lt;br/&gt;
     Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();&lt;br/&gt;
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File input1 = generateData(&quot;input1.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;/li&gt;
	&lt;li&gt;File input2 = generateData(&quot;input2.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;/li&gt;
	&lt;li&gt;File input3 = generateData(&quot;input3.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;br/&gt;
+    File input1 = generateData(name.getMethodName() + &quot;-1.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;br/&gt;
+    File input2 = generateData(name.getMethodName() + &quot;-2.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;br/&gt;
+    File input3 = generateData(name.getMethodName() + &quot;-3.avro&quot;, Type.STRING, metadata, DEFLATE);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;output.deleteOnExit();&lt;br/&gt;
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     List&amp;lt;String&amp;gt; args = asList(&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;input1.getAbsolutePath(),&lt;/li&gt;
	&lt;li&gt;input2.getAbsolutePath(),&lt;/li&gt;
	&lt;li&gt;input3.getAbsolutePath(),&lt;/li&gt;
	&lt;li&gt;output.getAbsolutePath());&lt;br/&gt;
+            input1.getAbsolutePath(),&lt;br/&gt;
+            input2.getAbsolutePath(),&lt;br/&gt;
+            input3.getAbsolutePath(),&lt;br/&gt;
+            output.getAbsolutePath());&lt;br/&gt;
     int returnCode = new ConcatTool().run(&lt;/li&gt;
	&lt;li&gt;System.in,&lt;/li&gt;
	&lt;li&gt;System.out,&lt;/li&gt;
	&lt;li&gt;System.err,&lt;/li&gt;
	&lt;li&gt;args);&lt;br/&gt;
+            System.in,&lt;br/&gt;
+            System.out,&lt;br/&gt;
+            System.err,&lt;br/&gt;
+            args);&lt;br/&gt;
     assertEquals(0, returnCode);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     assertEquals(ROWS_IN_INPUT_FILES * 3, numRowsInFile(output));&lt;br/&gt;
@@ -218,21 +199,20 @@ public void testDifferentSchemasFail() throws Exception &lt;/p&gt;
{
     Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);
 
-    File input1 = generateData(&quot;input1.avro&quot;, Type.STRING, metadata, DEFLATE);
-    File input2 = generateData(&quot;input2.avro&quot;, Type.INT, metadata, DEFLATE);
+    File input1 = generateData(name.getMethodName() + &quot;-1.avro&quot;, Type.STRING, metadata, DEFLATE);
+    File input2 = generateData(name.getMethodName() + &quot;-2.avro&quot;, Type.INT, metadata, DEFLATE);
 
-    File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);
-    output.deleteOnExit();
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);
 
     List&amp;lt;String&amp;gt; args = asList(
-      input1.getAbsolutePath(),
-      input2.getAbsolutePath(),
-      output.getAbsolutePath());
+            input1.getAbsolutePath(),
+            input2.getAbsolutePath(),
+            output.getAbsolutePath());
     int returnCode = new ConcatTool().run(
-      System.in,
-      System.out,
-      System.err,
-      args);
+            System.in,
+            System.out,
+            System.err,
+            args);
     assertEquals(1, returnCode);
   }

&lt;p&gt;@@ -243,21 +223,20 @@ public void testDifferentMetadataFail() throws Exception &lt;/p&gt;
{
     Map&amp;lt;String, String&amp;gt; metadata2 = new HashMap&amp;lt;&amp;gt;();
     metadata2.put(&quot;myOtherMetaKey&quot;, &quot;myOtherMetaValue&quot;);
 
-    File input1 = generateData(&quot;input1.avro&quot;, Type.STRING, metadata1, DEFLATE);
-    File input2 = generateData(&quot;input2.avro&quot;, Type.STRING, metadata2, DEFLATE);
+    File input1 = generateData(name.getMethodName() + &quot;-1.avro&quot;, Type.STRING, metadata1, DEFLATE);
+    File input2 = generateData(name.getMethodName() + &quot;-2.avro&quot;, Type.STRING, metadata2, DEFLATE);
 
-    File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);
-    output.deleteOnExit();
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);
 
     List&amp;lt;String&amp;gt; args = asList(
-      input1.getAbsolutePath(),
-      input2.getAbsolutePath(),
-      output.getAbsolutePath());
+            input1.getAbsolutePath(),
+            input2.getAbsolutePath(),
+            output.getAbsolutePath());
     int returnCode = new ConcatTool().run(
-      System.in,
-      System.out,
-      System.err,
-      args);
+            System.in,
+            System.out,
+            System.err,
+            args);
     assertEquals(2, returnCode);
   }

&lt;p&gt;@@ -266,38 +245,38 @@ public void testDifferentCodecFail() throws Exception &lt;/p&gt;
{
     Map&amp;lt;String, String&amp;gt; metadata = new HashMap&amp;lt;&amp;gt;();
     metadata.put(&quot;myMetaKey&quot;, &quot;myMetaValue&quot;);
 
-    File input1 = generateData(&quot;input1.avro&quot;, Type.STRING, metadata, DEFLATE);
-    File input2 = generateData(&quot;input2.avro&quot;, Type.STRING, metadata, CodecFactory.nullCodec());
+    File input1 = generateData(name.getMethodName() + &quot;-1.avro&quot;, Type.STRING, metadata, DEFLATE);
+    File input2 = generateData(name.getMethodName() + &quot;-2.avro&quot;, Type.STRING, metadata, CodecFactory.nullCodec());
 
-    File output = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);
-    output.deleteOnExit();
+    File output = new File(OUTPUT_DIR.getRoot(), name.getMethodName() + &quot;.avro&quot;);
 
     List&amp;lt;String&amp;gt; args = asList(
-      input1.getAbsolutePath(),
-      input2.getAbsolutePath(),
-      output.getAbsolutePath());
+            input1.getAbsolutePath(),
+            input2.getAbsolutePath(),
+            output.getAbsolutePath());
     int returnCode = new ConcatTool().run(
-      System.in,
-      System.out,
-      System.err,
-      args);
+            System.in,
+            System.out,
+            System.err,
+            args);
     assertEquals(3, returnCode);
   }

&lt;p&gt;   @Test&lt;br/&gt;
   public void testHelpfulMessageWhenNoArgsGiven() throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ByteArrayOutputStream buffer = new ByteArrayOutputStream(1024);&lt;/li&gt;
	&lt;li&gt;PrintStream out = new PrintStream(buffer);&lt;/li&gt;
	&lt;li&gt;int returnCode = new ConcatTool().run(&lt;/li&gt;
	&lt;li&gt;System.in,&lt;/li&gt;
	&lt;li&gt;out,&lt;/li&gt;
	&lt;li&gt;System.err,&lt;/li&gt;
	&lt;li&gt;Collections.emptyList());&lt;/li&gt;
	&lt;li&gt;out.close(); // flushes too&lt;br/&gt;
-&lt;br/&gt;
+    int returnCode;&lt;br/&gt;
+    try (ByteArrayOutputStream buffer = new ByteArrayOutputStream(1024)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      try (PrintStream out = new PrintStream(buffer)) {
+        returnCode = new ConcatTool().run(
+                System.in,
+                out,
+                System.err,
+                Collections.emptyList());
+      }+      assertTrue(+              &amp;quot;should have lots of help&amp;quot;,+              buffer.toString().trim().length() &amp;gt; 200);+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     assertEquals(0, returnCode);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;assertTrue(&lt;/li&gt;
	&lt;li&gt;&quot;should have lots of help&quot;,&lt;/li&gt;
	&lt;li&gt;buffer.toString().trim().length() &amp;gt; 200);&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestCreateRandomFileTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestCreateRandomFileTool.java&lt;br/&gt;
index d47eedd84..62d6e9af0 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestCreateRandomFileTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestCreateRandomFileTool.java&lt;br/&gt;
@@ -41,8 +41,7 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; public class TestCreateRandomFileTool {&lt;br/&gt;
   private static final String COUNT = System.getProperty(&quot;test.count&quot;, &quot;200&quot;);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+  private static final File DIR = new File(&quot;/tmp&quot;);&lt;br/&gt;
   private static final File OUT_FILE = new File(DIR, &quot;random.avro&quot;);&lt;br/&gt;
   private static final File SCHEMA_FILE =&lt;br/&gt;
     new File(&quot;../../../share/test/schemas/weather.avsc&quot;);&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileRepairTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileRepairTool.java&lt;br/&gt;
index 2a4ed492f..191b7bed1 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileRepairTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileRepairTool.java&lt;br/&gt;
@@ -24,7 +24,7 @@&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
 import java.io.PrintStream;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
+&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.file.DataFileConstants;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
@@ -33,10 +33,9 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.apache.avro.io.BinaryData;&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
-import org.junit.After;&lt;br/&gt;
-import org.junit.Before;&lt;br/&gt;
-import org.junit.BeforeClass;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.junit.*;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;br/&gt;
+import org.junit.rules.TestName;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import static org.junit.Assert.assertEquals;&lt;br/&gt;
 import static org.junit.Assert.assertFalse;&lt;br/&gt;
@@ -44,6 +43,9 @@&lt;/p&gt;

&lt;p&gt; public class TestDataFileRepairTool {&lt;/p&gt;

&lt;p&gt;+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   private static final Schema SCHEMA = Schema.create(Schema.Type.STRING);&lt;br/&gt;
   private static File corruptBlockFile;&lt;br/&gt;
   private static File corruptRecordFile;&lt;br/&gt;
@@ -52,21 +54,22 @@&lt;/p&gt;

&lt;p&gt;   @BeforeClass&lt;br/&gt;
   public static void writeCorruptFile() throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;// Write a data file&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Utf8&amp;gt; w = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;(SCHEMA));&lt;br/&gt;
     ByteArrayOutputStream baos = new ByteArrayOutputStream();&lt;/li&gt;
	&lt;li&gt;w.create(SCHEMA, baos);&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;apple&quot;));&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;banana&quot;));&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;celery&quot;));&lt;/li&gt;
	&lt;li&gt;w.sync();&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;date&quot;));&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;endive&quot;));&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;fig&quot;));&lt;/li&gt;
	&lt;li&gt;long pos = w.sync();&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;guava&quot;));&lt;/li&gt;
	&lt;li&gt;w.append(new Utf8(&quot;hazelnut&quot;));&lt;/li&gt;
	&lt;li&gt;w.close();&lt;br/&gt;
+    long pos;&lt;br/&gt;
+    // Write a data file&lt;br/&gt;
+    try(DataFileWriter&amp;lt;Utf8&amp;gt; w = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;(SCHEMA))) 
{
+      w.create(SCHEMA, baos);
+      w.append(new Utf8(&quot;apple&quot;));
+      w.append(new Utf8(&quot;banana&quot;));
+      w.append(new Utf8(&quot;celery&quot;));
+      w.sync();
+      w.append(new Utf8(&quot;date&quot;));
+      w.append(new Utf8(&quot;endive&quot;));
+      w.append(new Utf8(&quot;fig&quot;));
+      pos = w.sync();
+      w.append(new Utf8(&quot;guava&quot;));
+      w.append(new Utf8(&quot;hazelnut&quot;));
+    }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     byte[] original = baos.toByteArray();&lt;/p&gt;

&lt;p&gt;@@ -78,36 +81,28 @@ public static void writeCorruptFile() throws IOException {&lt;br/&gt;
     System.arraycopy(original, corruptPosition,&lt;br/&gt;
         corrupted, corruptPosition + corruptedBytes, original.length - corruptPosition);&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;corruptBlockFile = AvroTestUtil.tempFile(TestDataFileRepairTool.class,&lt;/li&gt;
	&lt;li&gt;&quot;corruptBlock.avro&quot;);&lt;br/&gt;
+    corruptBlockFile = new File(DIR.getRoot(), &quot;corruptBlock.avro&quot;);&lt;br/&gt;
     corruptBlockFile.deleteOnExit();&lt;/li&gt;
	&lt;li&gt;FileOutputStream out = new FileOutputStream(corruptBlockFile);&lt;/li&gt;
	&lt;li&gt;out.write(corrupted);&lt;/li&gt;
	&lt;li&gt;out.close();&lt;br/&gt;
+    try(FileOutputStream out = new FileOutputStream(corruptBlockFile)) 
{
+      out.write(corrupted);
+    }&lt;br/&gt;
 &lt;br/&gt;
     // Corrupt the &quot;endive&quot; record by changing the length of the string to be negative&lt;br/&gt;
-    corruptPosition = (int) pos - DataFileConstants.SYNC_SIZE -&lt;br/&gt;
-        (1 + &quot;fig&quot;.length() + 1 + &quot;endive&quot;.length());&lt;br/&gt;
+    corruptPosition = (int) pos - DataFileConstants.SYNC_SIZE - (1 + &quot;fig&quot;.length() + 1 + &quot;endive&quot;.length());&lt;br/&gt;
     corrupted = new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;original.length&amp;#93;&lt;/span&gt;;&lt;br/&gt;
     System.arraycopy(original, 0, corrupted, 0, original.length);&lt;br/&gt;
     BinaryData.encodeLong(-1, corrupted, corruptPosition);&lt;br/&gt;
 &lt;br/&gt;
-    corruptRecordFile = AvroTestUtil.tempFile(TestDataFileRepairTool.class,&lt;br/&gt;
-        &quot;corruptRecord.avro&quot;);&lt;br/&gt;
+    corruptRecordFile = new File(DIR.getRoot(), &quot;corruptRecord.avro&quot;);&lt;br/&gt;
     corruptRecordFile.deleteOnExit();&lt;br/&gt;
-    out = new FileOutputStream(corruptRecordFile);&lt;br/&gt;
-    out.write(corrupted);&lt;br/&gt;
-    out.close();&lt;br/&gt;
+    try(FileOutputStream out = new FileOutputStream(corruptRecordFile) ) {+      out.write(corrupted);+    }
&lt;p&gt;   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Before&lt;br/&gt;
   public void setUp() &lt;/p&gt;
{
-    repairedFile = AvroTestUtil.tempFile(TestDataFileRepairTool.class, &quot;repaired.avro&quot;);
-  }
&lt;p&gt;-&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@After&lt;/li&gt;
	&lt;li&gt;public void tearDown() 
{
-    repairedFile.delete();
+    repairedFile = new File(DIR.getRoot(), &quot;repaired.avro&quot;);
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   private String run(Tool tool, String... args) throws Exception {&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileTools.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileTools.java&lt;br/&gt;
index cab28d42c..341b6af4c 100644&lt;br/&gt;
&amp;#8212; a/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileTools.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestDataFileTools.java&lt;br/&gt;
@@ -35,7 +35,6 @@&lt;br/&gt;
 import java.util.Collections;&lt;br/&gt;
 import java.util.List;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
@@ -43,7 +42,9 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.junit.BeforeClass;&lt;br/&gt;
+import org.junit.ClassRule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
 public class TestDataFileTools {&lt;br/&gt;
@@ -56,30 +57,29 @@&lt;br/&gt;
   private static final String KEY_NEEDING_ESCAPES = &quot;trn\\\r\t\n&quot;;&lt;br/&gt;
   private static final String ESCAPED_KEY = &quot;trn\\\\\\r\\t&lt;br class=&quot;atl-forced-newline&quot; /&gt;n&quot;;&lt;/p&gt;

&lt;p&gt;+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   @BeforeClass&lt;br/&gt;
   public static void writeSampleFile() throws IOException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;sampleFile = AvroTestUtil.tempFile(TestDataFileTools.class,&lt;/li&gt;
	&lt;li&gt;TestDataFileTools.class.getName() + &quot;.avro&quot;);&lt;br/&gt;
+    sampleFile = new File(DIR.getRoot(), TestDataFileTools.class.getName() + &quot;.avro&quot;);&lt;br/&gt;
     schema = Schema.create(Type.INT);&lt;/li&gt;
	&lt;li&gt;schemaFile = AvroTestUtil.tempFile(TestDataFileTools.class, &quot;schema-temp.schema&quot;);&lt;/li&gt;
	&lt;li&gt;FileWriter fw = new FileWriter(schemaFile);&lt;/li&gt;
	&lt;li&gt;fw.append(schema.toString());&lt;/li&gt;
	&lt;li&gt;fw.close();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;DataFileWriter&amp;lt;Object&amp;gt; writer&lt;/li&gt;
	&lt;li&gt;= new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;(schema))&lt;/li&gt;
	&lt;li&gt;.setMeta(KEY_NEEDING_ESCAPES, &quot;&quot;)&lt;/li&gt;
	&lt;li&gt;.create(schema, sampleFile);&lt;/li&gt;
	&lt;li&gt;StringBuilder builder = new StringBuilder();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;for (int i = 0; i &amp;lt; COUNT; ++i) {&lt;/li&gt;
	&lt;li&gt;builder.append(Integer.toString&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;);&lt;/li&gt;
	&lt;li&gt;builder.append(&quot;\n&quot;);&lt;/li&gt;
	&lt;li&gt;writer.append&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
+    schemaFile = new File(DIR.getRoot(), &quot;schema-temp.schema&quot;);&lt;br/&gt;
+    try(FileWriter fw = new FileWriter(schemaFile)) 
{
+      fw.append(schema.toString());
     }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;writer.flush();&lt;/li&gt;
	&lt;li&gt;writer.close();&lt;br/&gt;
+    StringBuilder builder = new StringBuilder();&lt;br/&gt;
+    try(DataFileWriter&amp;lt;Object&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(new GenericDatumWriter&amp;lt;&amp;gt;(schema))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      writer.setMeta(KEY_NEEDING_ESCAPES, &amp;quot;&amp;quot;);+      writer.create(schema, sampleFile);++      for (int i = 0; i &amp;lt; COUNT; ++i) {
+        builder.append(Integer.toString(i));
+        builder.append(&quot;\n&quot;);
+        writer.append(i);
+      }+    }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     jsonData = builder.toString();&lt;br/&gt;
   }&lt;br/&gt;
@@ -127,8 +127,7 @@ public void testGetMeta() throws Exception {&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testGetMetaForSingleKey() throws Exception &lt;/p&gt;
{
     assertEquals(schema.toString() + &quot;\n&quot;,
-        run(new DataFileGetMetaTool(), sampleFile.getPath(), &quot;--key&quot;,
-            &quot;avro.schema&quot;));
+        run(new DataFileGetMetaTool(), sampleFile.getPath(), &quot;--key&quot;, &quot;avro.schema&quot;));
   }

&lt;p&gt;   @Test&lt;br/&gt;
@@ -152,59 +151,53 @@ public void testWrite(String name, List&amp;lt;String&amp;gt; extra, String expectedCodec)&lt;br/&gt;
       testWrite(name, extra, expectedCodec, &quot;-schema&quot;, schema.toString());&lt;br/&gt;
       testWrite(name, extra, expectedCodec, &quot;-schema-file&quot;, schemaFile.toString());&lt;br/&gt;
   }&lt;br/&gt;
+&lt;br/&gt;
   public void testWrite(String name, List&amp;lt;String&amp;gt; extra, String expectedCodec, String... extraArgs)&lt;br/&gt;
   throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File outFile = AvroTestUtil.tempFile(getClass(),&lt;/li&gt;
	&lt;li&gt;TestDataFileTools.class + &quot;.testWrite.&quot; + name + &quot;.avro&quot;);&lt;/li&gt;
	&lt;li&gt;FileOutputStream fout = new FileOutputStream(outFile);&lt;/li&gt;
	&lt;li&gt;PrintStream out = new PrintStream(fout);&lt;/li&gt;
	&lt;li&gt;List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;for (String arg : extraArgs) {&lt;/li&gt;
	&lt;li&gt;args.add(arg);&lt;br/&gt;
+    File outFile = new File(DIR.getRoot(), TestDataFileTools.class + &quot;.testWrite.&quot; + name + &quot;.avro&quot;);&lt;br/&gt;
+    try(FileOutputStream fout = new FileOutputStream(outFile)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      try(PrintStream out = new PrintStream(fout)) {
+        List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;();
+        Collections.addAll(args, extraArgs);
+        args.add(&quot;-&quot;);
+        args.addAll(extra);
+        new DataFileWriteTool().run(
+                new StringBufferInputStream(jsonData),
+                new PrintStream(out), // stdout
+                null, // stderr
+                args);
+      }     }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;args.add(&quot;-&quot;);&lt;/li&gt;
	&lt;li&gt;args.addAll(extra);&lt;/li&gt;
	&lt;li&gt;new DataFileWriteTool().run(&lt;/li&gt;
	&lt;li&gt;new StringBufferInputStream(jsonData),&lt;/li&gt;
	&lt;li&gt;new PrintStream(out), // stdout&lt;/li&gt;
	&lt;li&gt;null, // stderr&lt;/li&gt;
	&lt;li&gt;args);&lt;/li&gt;
	&lt;li&gt;out.close();&lt;/li&gt;
	&lt;li&gt;fout.close();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // Read it back, and make sure it&apos;s valid.&lt;br/&gt;
     GenericDatumReader&amp;lt;Object&amp;gt; reader = new GenericDatumReader&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;Object&amp;gt; fileReader = new DataFileReader&amp;lt;&amp;gt;(outFile, reader);&lt;/li&gt;
	&lt;li&gt;int i = 0;&lt;/li&gt;
	&lt;li&gt;for (Object datum : fileReader) 
{
-      assertEquals(i, datum);
-      i++;
-    }&lt;/li&gt;
	&lt;li&gt;assertEquals(COUNT, i);&lt;/li&gt;
	&lt;li&gt;assertEquals(schema, fileReader.getSchema());&lt;/li&gt;
	&lt;li&gt;String codecStr = fileReader.getMetaString(&quot;avro.codec&quot;);&lt;/li&gt;
	&lt;li&gt;if (null == codecStr) {&lt;/li&gt;
	&lt;li&gt;codecStr = &quot;null&quot;;&lt;br/&gt;
+    try (DataFileReader&amp;lt;Object&amp;gt; fileReader = new DataFileReader&amp;lt;&amp;gt;(outFile, reader)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      int i = 0;+      for (Object datum }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;assertEquals(expectedCodec, codecStr);&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@Test&lt;br/&gt;
+  @Test(expected=IOException.class)&lt;br/&gt;
   public void testFailureOnWritingPartialJSONValues() throws Exception {&lt;br/&gt;
     ByteArrayOutputStream baos = new ByteArrayOutputStream();&lt;br/&gt;
     PrintStream out = new PrintStream(baos);&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;new DataFileWriteTool().run(&lt;/li&gt;
	&lt;li&gt;new StringBufferInputStream(&quot;{&quot;),&lt;/li&gt;
	&lt;li&gt;new PrintStream(out), // stdout&lt;/li&gt;
	&lt;li&gt;null, // stderr&lt;/li&gt;
	&lt;li&gt;Arrays.asList(&quot;-schema&quot;, &quot;{ \&quot;type\&quot;:\&quot;record\&quot;, \&quot;fields\&quot;:&quot; +&lt;/li&gt;
	&lt;li&gt;&quot;[
{\&quot;name\&quot;:\&quot;foo\&quot;, \&quot;type\&quot;:\&quot;string\&quot;}
&lt;p&gt;], &quot; +&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;&quot;\&quot;name\&quot;:\&quot;boring\&quot; }&quot;, &quot;-&quot;));&lt;/li&gt;
	&lt;li&gt;fail(&quot;Expected exception.&quot;);&lt;/li&gt;
	&lt;li&gt;} catch (IOException expected) 
{
-      // expected
-    }
&lt;p&gt;+    new DataFileWriteTool().run(&lt;br/&gt;
+        new StringBufferInputStream(&quot;{&quot;),&lt;br/&gt;
+        new PrintStream(out), // stdout&lt;br/&gt;
+        null, // stderr&lt;br/&gt;
+        Arrays.asList(&quot;-schema&quot;, &quot;&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { &amp;quot;type&amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;&quot;, &quot;-&quot;));&lt;br/&gt;
   }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -217,13 +210,13 @@ public void testWritingZeroJsonValues() throws Exception {&lt;/p&gt;

&lt;p&gt;   private int countRecords(File outFile) throws IOException {&lt;br/&gt;
     GenericDatumReader&amp;lt;Object&amp;gt; reader = new GenericDatumReader&amp;lt;&amp;gt;();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DataFileReader&amp;lt;Object&amp;gt; fileReader =&lt;/li&gt;
	&lt;li&gt;new DataFileReader&amp;lt;&amp;gt;(outFile, reader);&lt;/li&gt;
	&lt;li&gt;int i = 0;&lt;/li&gt;
	&lt;li&gt;for (@SuppressWarnings(&quot;unused&quot;) Object datum : fileReader) {&lt;/li&gt;
	&lt;li&gt;i++;&lt;br/&gt;
+    try(DataFileReader&amp;lt;Object&amp;gt; fileReader = new DataFileReader&amp;lt;&amp;gt;(outFile, reader)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      int i = 0;+      for (@SuppressWarnings(&amp;quot;unused&amp;quot;) Object datum }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;return i;&lt;br/&gt;
   }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
@@ -236,18 +229,16 @@ public void testDifferentSeparatorsBetweenJsonRecords() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   public File writeToAvroFile(String testName, String schema, String json) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File outFile = AvroTestUtil.tempFile(getClass(),&lt;/li&gt;
	&lt;li&gt;TestDataFileTools.class + &quot;.&quot; + testName + &quot;.avro&quot;);&lt;/li&gt;
	&lt;li&gt;FileOutputStream fout = new FileOutputStream(outFile);&lt;/li&gt;
	&lt;li&gt;PrintStream out = new PrintStream(fout);&lt;/li&gt;
	&lt;li&gt;new DataFileWriteTool().run(&lt;/li&gt;
	&lt;li&gt;new StringBufferInputStream(json),&lt;/li&gt;
	&lt;li&gt;new PrintStream(out), // stdout&lt;/li&gt;
	&lt;li&gt;null, // stderr&lt;/li&gt;
	&lt;li&gt;Arrays.asList(&quot;&lt;del&gt;schema&quot;, schema, &quot;&lt;/del&gt;&quot;));&lt;/li&gt;
	&lt;li&gt;out.close();&lt;/li&gt;
	&lt;li&gt;fout.close();&lt;br/&gt;
+    File outFile = new File(DIR.getRoot(), TestDataFileTools.class + &quot;.&quot; + testName + &quot;.avro&quot;);&lt;br/&gt;
+    try(FileOutputStream fout = new FileOutputStream(outFile)) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      try(PrintStream out = new PrintStream(fout)) {
+        new DataFileWriteTool().run(
+                new StringBufferInputStream(json),
+                new PrintStream(out), // stdout
+                null, // stderr
+                Arrays.asList(&quot;-schema&quot;, schema, &quot;-&quot;));
+      }+    }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;     return outFile;&lt;br/&gt;
   }&lt;br/&gt;
-&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestJsonToFromBinaryFragmentTools.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestJsonToFromBinaryFragmentTools.java&lt;br/&gt;
index 849968788..7e25a3bd4 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestJsonToFromBinaryFragmentTools.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestJsonToFromBinaryFragmentTools.java&lt;br/&gt;
@@ -19,21 +19,17 @@&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; import static org.junit.Assert.assertEquals;&lt;/p&gt;

&lt;p&gt;-import java.io.ByteArrayInputStream;&lt;br/&gt;
-import java.io.ByteArrayOutputStream;&lt;br/&gt;
-import java.io.BufferedOutputStream;&lt;br/&gt;
-import java.io.File;&lt;br/&gt;
-import java.io.FileWriter;&lt;br/&gt;
-import java.io.IOException;&lt;br/&gt;
-import java.io.PrintStream;&lt;br/&gt;
+import java.io.*;&lt;br/&gt;
+import java.nio.charset.StandardCharsets;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.List;&lt;/p&gt;

&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Tests both 
{@link JsonToBinaryFragmentTool}
&lt;p&gt;@@ -42,10 +38,11 @@&lt;br/&gt;
 public class TestJsonToFromBinaryFragmentTools {&lt;br/&gt;
   private static final String STRING_SCHEMA = Schema.create(Type.STRING).toString();&lt;br/&gt;
   private static final String UTF8 = &quot;utf-8&quot;;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static final String AVRO =&lt;/li&gt;
	&lt;li&gt;&quot;ZLong string implies readable length encoding.&quot;;&lt;/li&gt;
	&lt;li&gt;private static final String JSON =&lt;/li&gt;
	&lt;li&gt;&quot;\&quot;Long string implies readable length encoding.\&quot;\n&quot;;&lt;br/&gt;
+  private static final String AVRO = &quot;ZLong string implies readable length encoding.&quot;;&lt;br/&gt;
+  private static final String JSON = &quot;\&quot;Long string implies readable length encoding.\&quot;\n&quot;;&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @Test&lt;br/&gt;
   public void testBinaryToJson() throws Exception {&lt;br/&gt;
@@ -79,23 +76,22 @@ public void testMultiBinaryToNoPrettyJson() throws Exception {&lt;/p&gt;

&lt;p&gt;   @Test&lt;br/&gt;
   public void testBinaryToJsonSchemaFile() throws Exception &lt;/p&gt;
{
-    binaryToJson(AVRO, JSON, &quot;--schema-file&quot;, schemaFile());
+    binaryToJson(AVRO, JSON, &quot;--schema-file&quot;, schemaFile(DIR.getRoot()));
   }

&lt;p&gt;   @Test&lt;br/&gt;
     public void testJsonToBinarySchemaFile() throws Exception &lt;/p&gt;
{
-    jsonToBinary(JSON, AVRO, &quot;--schema-file&quot;, schemaFile());
+    jsonToBinary(JSON, AVRO, &quot;--schema-file&quot;, schemaFile(DIR.getRoot()));
   }

&lt;p&gt;   private void binaryToJson(String avro, String json, String... options) throws Exception &lt;/p&gt;
{
     ByteArrayOutputStream baos = new ByteArrayOutputStream();
     PrintStream p = new PrintStream(new BufferedOutputStream(baos));
 
-    List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;();
-    args.addAll(Arrays.asList(options));
+    List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(options));
     args.add(&quot;-&quot;);
     new BinaryFragmentToJsonTool().run(
-        new ByteArrayInputStream(avro.getBytes(UTF8)), // stdin
+        new ByteArrayInputStream(avro.getBytes(StandardCharsets.UTF_8)), // stdin
         p, // stdout
         null, // stderr
         args);
@@ -107,22 +103,21 @@ private void jsonToBinary(String json, String avro, String... options) throws Ex
     ByteArrayOutputStream baos = new ByteArrayOutputStream();
     PrintStream p = new PrintStream(new BufferedOutputStream(baos));
 
-    List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;();
-    args.addAll(Arrays.asList(options));
+    List&amp;lt;String&amp;gt; args = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(options));
     args.add(&quot;-&quot;);
     new JsonToBinaryFragmentTool().run(
-        new ByteArrayInputStream(json.getBytes(UTF8)), // stdin
+        new ByteArrayInputStream(json.getBytes(StandardCharsets.UTF_8)), // stdin
         p, // stdout
         null, // stderr
         args);
     assertEquals(avro, baos.toString(UTF8));
   }

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static String schemaFile() throws IOException {&lt;/li&gt;
	&lt;li&gt;File schemaFile = AvroTestUtil.tempFile(TestJsonToFromBinaryFragmentTools.class, &quot;String.avsc&quot;);&lt;/li&gt;
	&lt;li&gt;FileWriter fw = new FileWriter(schemaFile);&lt;/li&gt;
	&lt;li&gt;fw.append(STRING_SCHEMA);&lt;/li&gt;
	&lt;li&gt;fw.close();&lt;br/&gt;
+  private static String schemaFile(File dir) throws IOException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+    File schemaFile = new File(dir, &amp;quot;String.avsc&amp;quot;);+    try(FileWriter fw = new FileWriter(schemaFile)) {
+      fw.append(STRING_SCHEMA);
+    }     return schemaFile.toString();   }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; }&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestRecodecTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestRecodecTool.java&lt;br/&gt;
index 894bc206e..c2134f750 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestRecodecTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestRecodecTool.java&lt;br/&gt;
@@ -24,7 +24,6 @@&lt;br/&gt;
 import java.io.PrintStream;&lt;br/&gt;
 import java.util.ArrayList;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
@@ -32,15 +31,20 @@&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumWriter;&lt;br/&gt;
 import org.junit.Assert;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestRecodecTool {&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   @Test&lt;br/&gt;
   public void testRecodec() throws Exception {&lt;br/&gt;
     String metaKey = &quot;myMetaKey&quot;;&lt;br/&gt;
     String metaValue = &quot;myMetaValue&quot;;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File inputFile = AvroTestUtil.tempFile(getClass(), &quot;input.avro&quot;);&lt;br/&gt;
+    File inputFile = new File(DIR.getRoot(), &quot;input.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     Schema schema = Schema.create(Type.STRING);&lt;br/&gt;
     DataFileWriter&amp;lt;String&amp;gt; writer = new DataFileWriter&amp;lt;&amp;gt;(&lt;br/&gt;
@@ -56,11 +60,11 @@ public void testRecodec() throws Exception {&lt;br/&gt;
     }&lt;br/&gt;
     writer.close();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File defaultOutputFile = AvroTestUtil.tempFile(getClass(), &quot;default-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;File nullOutputFile = AvroTestUtil.tempFile(getClass(), &quot;null-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;File deflateDefaultOutputFile = AvroTestUtil.tempFile(getClass(), &quot;deflate-default-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;File deflate1OutputFile = AvroTestUtil.tempFile(getClass(), &quot;deflate-1-output.avro&quot;);&lt;/li&gt;
	&lt;li&gt;File deflate9OutputFile = AvroTestUtil.tempFile(getClass(), &quot;deflate-9-output.avro&quot;);&lt;br/&gt;
+    File defaultOutputFile = new File(DIR.getRoot(), &quot;default-output.avro&quot;);&lt;br/&gt;
+    File nullOutputFile = new File(DIR.getRoot(),  &quot;null-output.avro&quot;);&lt;br/&gt;
+    File deflateDefaultOutputFile = new File(DIR.getRoot(),  &quot;deflate-default-output.avro&quot;);&lt;br/&gt;
+    File deflate1OutputFile = new File(DIR.getRoot(),  &quot;deflate-1-output.avro&quot;);&lt;br/&gt;
+    File deflate9OutputFile = new File(DIR.getRoot(),  &quot;deflate-9-output.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     new RecodecTool().run(new FileInputStream(inputFile), new PrintStream(defaultOutputFile), null, new ArrayList&amp;lt;&amp;gt;());&lt;br/&gt;
     new RecodecTool().run(new FileInputStream(inputFile), new PrintStream(nullOutputFile), null, asList(&quot;--codec=null&quot;));&lt;br/&gt;
@@ -85,20 +89,6 @@ public void testRecodec() throws Exception &lt;/p&gt;
{
 
     // The &quot;level 9&quot; file should be smaller than the &quot;level 1&quot; file.
     assertLessThan(deflate9OutputFile.length(), deflate1OutputFile.length());
-
-//    System.err.println(inputFile.length());
-//    System.err.println(defaultOutputFile.length());
-//    System.err.println(nullOutputFile.length());
-//    System.err.println(deflateDefaultOutputFile.length());
-//    System.err.println(deflate1OutputFile.length());
-//    System.err.println(deflate9OutputFile.length());
-
-    inputFile.delete();
-    defaultOutputFile.delete();
-    nullOutputFile.delete();
-    deflateDefaultOutputFile.delete();
-    deflate1OutputFile.delete();
-    deflate9OutputFile.delete();
   }

&lt;p&gt;   private static void assertLessThan(long less, long more) {&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestTetherTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestTetherTool.java&lt;br/&gt;
index 118ccf772..0a8db4872 100644&lt;br/&gt;
&amp;#8212; a/lang/java/tools/src/test/java/org/apache/avro/tool/TestTetherTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestTetherTool.java&lt;br/&gt;
@@ -26,9 +26,9 @@&lt;br/&gt;
 import java.io.FileInputStream;&lt;br/&gt;
 import java.io.InputStream;&lt;br/&gt;
 import java.io.FileWriter;&lt;br/&gt;
+import java.nio.file.Files;&lt;/p&gt;


&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.file.DataFileStream;&lt;br/&gt;
 import org.apache.avro.io.DatumReader;&lt;br/&gt;
@@ -38,13 +38,21 @@&lt;br/&gt;
 import org.apache.avro.util.Utf8;&lt;br/&gt;
 import org.apache.hadoop.fs.Path;&lt;br/&gt;
 import org.apache.hadoop.mapred.JobConf;&lt;br/&gt;
+import org.junit.Rule;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; public class TestTetherTool {&lt;/p&gt;

&lt;p&gt;+  @Rule&lt;br/&gt;
+  public TemporaryFolder INPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
+  @Rule&lt;br/&gt;
+  public TemporaryFolder OUTPUT_DIR = new TemporaryFolder();&lt;br/&gt;
+&lt;br/&gt;
   /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test that the tether tool works with the mapreduce example&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;*&lt;br/&gt;
+   * &amp;lt;p&amp;gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;TODO: How can we ensure that when we run, the WordCountTether example has&lt;/li&gt;
	&lt;li&gt;been properly compiled?&lt;br/&gt;
    */&lt;br/&gt;
@@ -52,39 +60,23 @@&lt;br/&gt;
   public void test() throws Exception {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // Create the schema files.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Schema outscheme = new Pair&amp;lt;Utf8,Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema();&lt;br/&gt;
+    Schema outscheme = new Pair&amp;lt;Utf8, Long&amp;gt;(new Utf8(&quot;&quot;), 0L).getSchema();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // we need to write the schemas to a file&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File midscfile = AvroTestUtil.tempFile(getClass(), &quot;midschema.avpr&quot;);&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;FileWriter hf = null;&lt;/li&gt;
	&lt;li&gt;try {&lt;/li&gt;
	&lt;li&gt;hf =new FileWriter(midscfile);&lt;br/&gt;
+    File midscfile = new File(INPUT_DIR.getRoot().getPath(), &quot;midschema.avpr&quot;);&lt;br/&gt;
+    try (FileWriter hf = new FileWriter(midscfile)) 
{
       hf.write(outscheme.toString());
     }&lt;/li&gt;
	&lt;li&gt;finally {&lt;/li&gt;
	&lt;li&gt;if (hf != null) 
{
-        hf.close();
-      }&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;// Get the classpath to use as an argument.&lt;/li&gt;
	&lt;li&gt;String cp = System.getProperty(&quot;java.class.path&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     JobConf job = new JobConf();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;String dir = System.getProperty(&quot;test.dir&quot;, &quot;.&quot;) + &quot;/mapred&quot;;&lt;/li&gt;
	&lt;li&gt;Path outputPath = new Path(dir + &quot;/out&quot;);&lt;br/&gt;
+    String inputPathStr = INPUT_DIR.getRoot().getPath();&lt;br/&gt;
+    String outputPathStr = OUTPUT_DIR.getRoot().getPath();&lt;br/&gt;
+    Path outputPath = new Path(outputPathStr);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     outputPath.getFileSystem(job).delete(outputPath);&lt;/p&gt;

&lt;p&gt;     // create the input file&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;WordCountUtil.writeLinesFile();&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;// Executable is java? Argument will be WordCountTask.java - Is the classpath&lt;/li&gt;
	&lt;li&gt;// set appropriately automatically?&lt;/li&gt;
	&lt;li&gt;java.net.URI exec = new java.net.URI(&quot;java&quot;);&lt;/li&gt;
	&lt;li&gt;//input path&lt;/li&gt;
	&lt;li&gt;String in = dir + &quot;/in&quot;;&lt;br/&gt;
+    WordCountUtil.writeLinesFile(inputPathStr + &quot;/lines.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     // create a string of the arguments&lt;br/&gt;
     String execargs = &quot;-classpath &quot; + System.getProperty(&quot;java.class.path&quot;);&lt;br/&gt;
@@ -95,9 +87,9 @@ public void test() throws Exception {&lt;/p&gt;


&lt;p&gt;     runargs.addAll(java.util.Arrays.asList(&quot;--program&quot;, &quot;java&quot;));&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;runargs.addAll(asList(&quot;--exec_args&quot;, &apos;&quot;&apos;&lt;ins&gt;execargs&lt;/ins&gt;&apos;&quot;&apos;));&lt;br/&gt;
+    runargs.addAll(asList(&quot;--exec_args&quot;, &apos;&quot;&apos; + execargs + &apos;&quot;&apos;));&lt;br/&gt;
     runargs.addAll(asList(&quot;--exec_cached&quot;, &quot;false&quot;));&lt;/li&gt;
	&lt;li&gt;runargs.addAll(asList(&quot;--in&quot;, in));&lt;br/&gt;
+    runargs.addAll(asList(&quot;--in&quot;, inputPathStr));&lt;br/&gt;
     runargs.addAll(asList(&quot;--out&quot;, outputPath.toString()));&lt;br/&gt;
     runargs.addAll(asList(&quot;--outschema&quot;, midscfile.toString()));&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -107,16 +99,16 @@ public void test() throws Exception {&lt;/p&gt;

&lt;p&gt;     // TODO:: We should probably do some validation&lt;br/&gt;
     // validate the output&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatumReader&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; reader = new SpecificDatumReader&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;InputStream cin = new BufferedInputStream(new FileInputStream(WordCountUtil.COUNTS_FILE));&lt;/li&gt;
	&lt;li&gt;DataFileStream&amp;lt;Pair&amp;lt;Utf8,Long&amp;gt;&amp;gt; counts = new DataFileStream&amp;lt;&amp;gt;(cin, reader);&lt;br/&gt;
     int numWords = 0;&lt;/li&gt;
	&lt;li&gt;for (Pair&amp;lt;Utf8,Long&amp;gt; wc : counts) {&lt;/li&gt;
	&lt;li&gt;assertEquals(wc.key().toString(),&lt;/li&gt;
	&lt;li&gt;WordCountUtil.COUNTS.get(wc.key().toString()), wc.value());&lt;/li&gt;
	&lt;li&gt;numWords++;&lt;br/&gt;
+    DatumReader&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; reader = new SpecificDatumReader&amp;lt;&amp;gt;();&lt;br/&gt;
+    try(InputStream cin&lt;br/&gt;
+                = new BufferedInputStream(new FileInputStream(outputPathStr + &quot;/part-00000.avro&quot;))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+      DataFileStream&amp;lt;Pair&amp;lt;Utf8, Long&amp;gt;&amp;gt; counts = new DataFileStream&amp;lt;&amp;gt;(cin, reader);+      for (Pair&amp;lt;Utf8, Long&amp;gt; wc }&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;cin.close();&lt;br/&gt;
     assertEquals(WordCountUtil.COUNTS.size(), numWords);&lt;br/&gt;
   }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestTextFileTools.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestTextFileTools.java&lt;br/&gt;
index 9d1615cab..b33330135 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestTextFileTools.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestTextFileTools.java&lt;br/&gt;
@@ -32,14 +32,12 @@&lt;br/&gt;
 import java.util.Arrays;&lt;br/&gt;
 import java.util.Random;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-import org.apache.avro.AvroTestUtil;&lt;br/&gt;
 import org.apache.avro.Schema;&lt;br/&gt;
 import org.apache.avro.Schema.Type;&lt;br/&gt;
 import org.apache.avro.file.DataFileReader;&lt;br/&gt;
 import org.apache.avro.generic.GenericDatumReader;&lt;br/&gt;
-import org.junit.BeforeClass;&lt;br/&gt;
-import org.junit.AfterClass;&lt;br/&gt;
-import org.junit.Test;&lt;br/&gt;
+import org.junit.*;&lt;br/&gt;
+import org.junit.rules.TemporaryFolder;&lt;/p&gt;

&lt;p&gt; @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
 public class TestTextFileTools {&lt;br/&gt;
@@ -47,16 +45,18 @@&lt;br/&gt;
     Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;10&quot;));&lt;/p&gt;

&lt;p&gt;   private static final byte[] LINE_SEP = System.getProperty(&quot;line.separator&quot;).getBytes();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;static File linesFile;&lt;/li&gt;
	&lt;li&gt;static ByteBuffer[] lines;&lt;br/&gt;
+  private static File linesFile;&lt;br/&gt;
+  private static ByteBuffer[] lines;&lt;br/&gt;
   static Schema schema;&lt;/li&gt;
	&lt;li&gt;static File schemaFile;&lt;br/&gt;
+&lt;br/&gt;
+  @ClassRule&lt;br/&gt;
+  public static TemporaryFolder DIR = new TemporaryFolder();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   @BeforeClass&lt;br/&gt;
   public static void writeRandomFile() throws IOException {&lt;br/&gt;
     schema = Schema.create(Type.BYTES);&lt;br/&gt;
     lines = new ByteBuffer&lt;span class=&quot;error&quot;&gt;&amp;#91;COUNT&amp;#93;&lt;/span&gt;;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;linesFile = AvroTestUtil.tempFile(TestTextFileTools.class, &quot;random.lines&quot;);&lt;br/&gt;
+    linesFile = new File(DIR.getRoot(), &quot;random.lines&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     OutputStream out =&lt;br/&gt;
       new BufferedOutputStream(new FileOutputStream(linesFile));&lt;br/&gt;
@@ -78,10 +78,9 @@ public static void writeRandomFile() throws IOException {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   private void fromText(String name, String... args) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File avroFile = AvroTestUtil.tempFile(getClass(), name + &quot;.avro&quot;);&lt;br/&gt;
+    File avroFile = new File(DIR.getRoot(), name + &quot;.avro&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ArrayList&amp;lt;String&amp;gt; arglist = new ArrayList&amp;lt;&amp;gt;();&lt;/li&gt;
	&lt;li&gt;arglist.addAll(Arrays.asList(args));&lt;br/&gt;
+    ArrayList&amp;lt;String&amp;gt; arglist = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(args));&lt;br/&gt;
     arglist.add(linesFile.toString());&lt;br/&gt;
     arglist.add(avroFile.toString());&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;@@ -114,8 +113,8 @@ public static void testToText() throws Exception {&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   private static void toText(String name) throws Exception {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File avroFile = AvroTestUtil.tempFile(TestTextFileTools.class, name + &quot;.avro&quot;);&lt;/li&gt;
	&lt;li&gt;File outFile = AvroTestUtil.tempFile(TestTextFileTools.class, name + &quot;.lines&quot;);&lt;br/&gt;
+    File avroFile = new File(DIR.getRoot(), name + &quot;.avro&quot;);&lt;br/&gt;
+    File outFile = new File(DIR.getRoot(), name + &quot;.lines&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     ArrayList&amp;lt;String&amp;gt; arglist = new ArrayList&amp;lt;&amp;gt;();&lt;br/&gt;
     arglist.add(avroFile.toString());&lt;br/&gt;
@@ -124,16 +123,14 @@ private static void toText(String name) throws Exception {&lt;br/&gt;
     new ToTextTool().run(null, null, null, arglist);&lt;/p&gt;

&lt;p&gt;     // Read it back, and make sure it&apos;s valid.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;InputStream orig = new BufferedInputStream(new FileInputStream(linesFile));&lt;/li&gt;
	&lt;li&gt;InputStream after = new BufferedInputStream(new FileInputStream(outFile));&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;int b;&lt;/li&gt;
	&lt;li&gt;while ((b = orig.read()) != -1)&lt;/li&gt;
	&lt;li&gt;assertEquals(b, after.read());&lt;/li&gt;
	&lt;li&gt;assertEquals(-1, after.read());&lt;br/&gt;
-&lt;/li&gt;
	&lt;li&gt;orig.close();&lt;/li&gt;
	&lt;li&gt;after.close();&lt;br/&gt;
+    try(InputStream orig = new BufferedInputStream(new FileInputStream(linesFile))) {&lt;br/&gt;
+      try (InputStream after = new BufferedInputStream(new FileInputStream(outFile))) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {+        int b;+        while ((b = orig.read()) != -1) {
+          assertEquals(b, after.read());
+        }+        assertEquals(-1, after.read());+      }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;+    }&lt;br/&gt;
   }&lt;br/&gt;
-&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/lang/java/tools/src/test/java/org/apache/avro/tool/TestToTrevniTool.java b/lang/java/tools/src/test/java/org/apache/avro/tool/TestToTrevniTool.java&lt;br/&gt;
index 663c6c819..980885f12 100644&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/lang/java/tools/src/test/java/org/apache/avro/tool/TestToTrevniTool.java&lt;br/&gt;
+++ b/lang/java/tools/src/test/java/org/apache/avro/tool/TestToTrevniTool.java&lt;br/&gt;
@@ -35,8 +35,7 @@&lt;br/&gt;
 public class TestToTrevniTool {&lt;br/&gt;
   private static final int COUNT =&lt;br/&gt;
     Integer.parseInt(System.getProperty(&quot;test.count&quot;, &quot;200&quot;));&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;private static final File DIR&lt;/li&gt;
	&lt;li&gt;= new File(System.getProperty(&quot;test.dir&quot;, &quot;/tmp&quot;));&lt;br/&gt;
+  private static final File DIR = new File(&quot;/tmp&quot;);&lt;br/&gt;
   private static final File AVRO_FILE = new File(DIR, &quot;random.avro&quot;);&lt;br/&gt;
   private static final File TREVNI_FILE = new File(DIR, &quot;random.trv&quot;);&lt;br/&gt;
   private static final File SCHEMA_FILE =&lt;br/&gt;
diff --git a/pom.xml b/pom.xml&lt;br/&gt;
index e3f48442c..0dfecbd5b 100644
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;a/pom.xml&lt;br/&gt;
+++ b/pom.xml&lt;br/&gt;
@@ -280,7 +280,10 @@&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;*&lt;b&gt;/&lt;/b&gt;.iml&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;lang/csharp/Avro.sln&amp;lt;/exclude&amp;gt; &amp;lt;!-- visual studio --&amp;gt;&lt;br/&gt;
                 &amp;lt;!-- build-related files --&amp;gt;&lt;br/&gt;
+                &amp;lt;exclude&amp;gt;README.md&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;BUILD.md&amp;lt;/exclude&amp;gt;&lt;br/&gt;
+                &amp;lt;exclude&amp;gt;.travis.yml&amp;lt;/exclude&amp;gt;&lt;br/&gt;
+                &amp;lt;exclude&amp;gt;share/precommit/README.md&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;**/VERSION.txt&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;**/dependency-reduced-pom.xml&amp;lt;/exclude&amp;gt;&lt;br/&gt;
                 &amp;lt;exclude&amp;gt;lang/perl/.shipit&amp;lt;/exclude&amp;gt;&lt;br/&gt;
diff --git a/share/docker/Dockerfile b/share/docker/Dockerfile&lt;br/&gt;
index de09220a1..ec8ac34f4 100644&lt;/li&gt;
			&lt;li&gt;a/share/docker/Dockerfile&lt;br/&gt;
+++ b/share/docker/Dockerfile&lt;br/&gt;
@@ -27,8 +27,8 @@ SHELL &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;/bin/bash&amp;quot;, &amp;quot;-o&amp;quot;, &amp;quot;pipefail&amp;quot;, &amp;quot;-c&amp;quot;&amp;#93;&lt;/span&gt;&lt;br/&gt;
 RUN curl -sL &lt;a href=&quot;https://deb.nodesource.com/setup_4.x&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://deb.nodesource.com/setup_4.x&lt;/a&gt; | bash -&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;Install dependencies from packages&lt;br/&gt;
-RUN apt-get update &amp;amp;&amp;amp; \&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;apt-get install --no-install-recommends -y \&lt;br/&gt;
+RUN apt-get -qq update &amp;amp;&amp;amp; \&lt;br/&gt;
+  apt-get -qq install --no-install-recommends -y \&lt;br/&gt;
     ant \&lt;br/&gt;
     asciidoc \&lt;br/&gt;
     bison \&lt;br/&gt;
@@ -64,7 +64,7 @@ RUN apt-get update &amp;amp;&amp;amp; \&lt;br/&gt;
     ruby-dev \&lt;br/&gt;
     source-highlight \&lt;br/&gt;
     subversion &amp;amp;&amp;amp; \&lt;/li&gt;
	&lt;li&gt;apt-get clean &amp;amp;&amp;amp; \&lt;br/&gt;
+  apt-get -qq clean &amp;amp;&amp;amp; \&lt;br/&gt;
   rm -rf /var/lib/apt/lists/*&lt;/li&gt;
&lt;/ul&gt;


&lt;ol&gt;
	&lt;li&gt;Install Forrest in /usr/local/apache-forrest&lt;br/&gt;
diff --git a/share/precommit/README.md b/share/precommit/README.md&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..0e19b8b2a
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;/dev/null&lt;br/&gt;
+++ b/share/precommit/README.md&lt;br/&gt;
@@ -0,0 +1,9 @@&lt;br/&gt;
+# Apache Yetus integration&lt;br/&gt;
+&lt;br/&gt;
+The plugin under `buildtest.sh` will provide the plugin to run the base `build.sh test` which will trigger the tests of the main Avro projects, and the sections below `lang/*/build.sh`. To run this, use:&lt;br/&gt;
+&lt;br/&gt;
+```bash&lt;br/&gt;
+test-patch --plugins=buildtest --user-plugins=share/precommit/ --run-tests --empty-patch --docker --dockerfile=share/docker/Dockerfile --dirty-workspace --verbose=true&lt;br/&gt;
+```&lt;br/&gt;
+&lt;br/&gt;
+Note, that this is still a very crude implementation of Apache Yetus, and in the future we would like to refine this to provide plugins for the different languages.&lt;br/&gt;
diff --git a/share/precommit/buildtest.sh b/share/precommit/buildtest.sh&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..e9fd01b65&lt;/li&gt;
			&lt;li&gt;/dev/null&lt;br/&gt;
+++ b/share/precommit/buildtest.sh&lt;br/&gt;
@@ -0,0 +1,62 @@&lt;br/&gt;
+#!/usr/bin/env bash&lt;br/&gt;
+# Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+# contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+# this work for additional information regarding copyright ownership.&lt;br/&gt;
+# The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+# (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+# the License.  You may obtain a copy of the License at&lt;br/&gt;
+#&lt;br/&gt;
+#     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+#&lt;br/&gt;
+# Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+# WITHOUT WARRCMAKEIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+# See the License for the specific language governing permissions and&lt;br/&gt;
+# limitations under the License.&lt;br/&gt;
+&lt;br/&gt;
+add_test_type buildtest&lt;br/&gt;
+&lt;br/&gt;
+VERBOSE=false&lt;br/&gt;
+&lt;br/&gt;
+# files that we want to kick off&lt;br/&gt;
+BUILD_FILES=( build.sh )&lt;br/&gt;
+&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_usage 
{
+  yetus_add_option &quot;--verbose=&amp;lt;true|false&amp;gt;&quot; &quot;print output to console (default: false)&quot;
+}
&lt;p&gt;+&lt;br/&gt;
+# For now we only kick off the root build.sh&lt;br/&gt;
+# buildtest_filefilter {&lt;br/&gt;
+#   local filename=$1&lt;br/&gt;
+#&lt;br/&gt;
+#   if [[ ${filename} =~ build\.sh$ ]]; then&lt;br/&gt;
+#     yetus_debug &quot;Buildtest: run the tests for ${filename}&quot;&lt;br/&gt;
+#     add_test buildtest&lt;br/&gt;
+#     yetus_add_array_element BUILD_FILES &quot;${filename}&quot;&lt;br/&gt;
+#   fi&lt;br/&gt;
+# }&lt;br/&gt;
+&lt;br/&gt;
+function buildtest_postcompile {&lt;br/&gt;
+  for file in &quot;${BUILD_FILES&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;; do&lt;br/&gt;
+&lt;br/&gt;
+    big_console_header &quot;Running ${file}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    #shellcheck disable=SC2001&lt;br/&gt;
+    sanitized_filename=$(echo &quot;${file}&quot; | sed &lt;del&gt;e &apos;s,&lt;span class=&quot;error&quot;&gt;&amp;#91;/\.&amp;#93;&lt;/span&gt;,&lt;/del&gt;,g&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    # Write both to stdout and the file using tee&lt;br/&gt;
+    (cd ${BASEDIR} &amp;amp;&amp;amp; ./${file} test) | tee &lt;del&gt;a ${PATCH_DIR}/build&lt;/del&gt;${sanitized_filename}.txt&lt;br/&gt;
+    result=${PIPESTATUS&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;}&lt;br/&gt;
+&lt;br/&gt;
+    yetus_debug &quot;Process exited with ${result}&quot;&lt;br/&gt;
+&lt;br/&gt;
+    if  (( result != 0 )); then&lt;br/&gt;
+      add_vote_table -1 buildtest &quot;The testsuite failed, please check the output&quot;&lt;br/&gt;
+      add_footer_table buildtest &quot;@@BASE@@/build-${sanitized_filename}.txt&quot;&lt;br/&gt;
+      return 1&lt;br/&gt;
+    fi&lt;br/&gt;
+&lt;br/&gt;
+    add_vote_table +1 buildtest &quot;The build has passed&quot;&lt;br/&gt;
+  done&lt;br/&gt;
+}&lt;br/&gt;
diff --git a/share/test/interop/bin/test_rpc_interop.sh b/share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
index 20ee77f76..f8ef7f5e8 100755&lt;/p&gt;&lt;/li&gt;
			&lt;li&gt;a/share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
+++ b/share/test/interop/bin/test_rpc_interop.sh&lt;br/&gt;
@@ -21,7 +21,7 @@ cd `dirname &quot;$0&quot;`/../../../..   # connect to root&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt; VERSION=`cat share/VERSION.txt`&lt;/p&gt;

&lt;p&gt;-#set -x                          # echo commands&lt;br/&gt;
+set -x                          # echo commands&lt;/p&gt;

&lt;p&gt; java_client=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcsend&quot;&lt;br/&gt;
 java_server=&quot;java &lt;del&gt;jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcreceive&quot;&lt;br/&gt;
@@ &lt;del&gt;29,21 +29,25 @@ java_server=&quot;java -jar lang/java/tools/target/avro-tools&lt;/del&gt;$VERSION.jar rpcreceive&lt;br/&gt;
 py_client=&quot;python lang/py/build/src/avro/tool.py rpcsend&quot;&lt;br/&gt;
 py_server=&quot;python lang/py/build/src/avro/tool.py rpcreceive&quot;&lt;/p&gt;

&lt;p&gt;-ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
-ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;br/&gt;
+#ruby_client=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcsend&quot;&lt;br/&gt;
+#ruby_server=&quot;ruby -rubygems -Ilang/ruby/lib lang/ruby/test/tool.rb rpcreceive&quot;&lt;/p&gt;

&lt;p&gt; export PYTHONPATH=lang/py/build/src      # path to avro Python module&lt;/p&gt;

&lt;p&gt;-clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
-servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+#clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
+#servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+clients=(&quot;$java_client&quot; &quot;$py_client&quot;)&lt;br/&gt;
+servers=(&quot;$java_server&quot; &quot;$py_server&quot;)&lt;/p&gt;

&lt;p&gt; proto=share/test/schemas/simple.avpr&lt;/p&gt;

&lt;p&gt; portfile=/tmp/interop_$$&lt;/p&gt;

&lt;p&gt; function cleanup() &lt;/p&gt;
{
-  rm -rf $portfile
-  for job in `jobs -p` ; do kill $job; done
+  rm -rf &quot;$portfile&quot;
+  for job in `jobs -p` ; do
+    kill $(jobs -p) 2&amp;gt;/dev/null || true;
+  done
 }

&lt;p&gt; trap &apos;cleanup&apos; EXIT&lt;br/&gt;
@@ -58,9 +62,8 @@ do&lt;br/&gt;
       echo TEST: $c&lt;br/&gt;
       for client in &quot;${clients&lt;span class=&quot;error&quot;&gt;&amp;#91;@&amp;#93;&lt;/span&gt;}&quot;&lt;br/&gt;
       do&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;rm -rf $portfile&lt;/li&gt;
	&lt;li&gt;$server &lt;a href=&quot;http://127.0.0.1:0/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:0/&lt;/a&gt; $proto $msg -file $c/response.avro \&lt;/li&gt;
	&lt;li&gt;&amp;gt; $portfile &amp;amp;&lt;br/&gt;
+        rm -rf &quot;$portfile&quot;&lt;br/&gt;
+        $server &lt;a href=&quot;http://127.0.0.1:0/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:0/&lt;/a&gt; $proto $msg -file $c/response.avro &amp;gt; $portfile &amp;amp;&lt;br/&gt;
         count=0&lt;br/&gt;
         while [ ! -s $portfile ]&lt;br/&gt;
         do&lt;br/&gt;
@@ -79,5 +82,3 @@ do&lt;br/&gt;
     done&lt;br/&gt;
     done&lt;br/&gt;
 done&lt;br/&gt;
-&lt;br/&gt;
-echo RPC INTEROP TESTS PASS&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16678185" author="jira-bot" created="Wed, 7 Nov 2018 12:52:31 +0000"  >&lt;p&gt;Commit 25032e10a86851bdabfa29b99885ccfc03c6667e in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Fokko&quot; class=&quot;user-hover&quot; rel=&quot;Fokko&quot;&gt;Fokko Driesprong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests (#353)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Setup precommit checks via Apache Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Signed-off-by: sacharya &amp;lt;suraj.spa@gmail.com&amp;gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Add a precommit hook using Apache Yetus that will invoke the test&lt;br/&gt;
suite of the different languages&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Disable Ruby integration tests tests&lt;/li&gt;
	&lt;li&gt;Fix Flaky Java Datetime test&lt;br/&gt;
  When the milsecons would have trailing zero, it would get trimmed&lt;/li&gt;
	&lt;li&gt;Align the order of imports&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16678186" author="jira-bot" created="Wed, 7 Nov 2018 12:52:32 +0000"  >&lt;p&gt;Commit 25032e10a86851bdabfa29b99885ccfc03c6667e in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Fokko&quot; class=&quot;user-hover&quot; rel=&quot;Fokko&quot;&gt;Fokko Driesprong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests (#353)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Setup precommit checks via Apache Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Signed-off-by: sacharya &amp;lt;suraj.spa@gmail.com&amp;gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Add a precommit hook using Apache Yetus that will invoke the test&lt;br/&gt;
suite of the different languages&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Disable Ruby integration tests tests&lt;/li&gt;
	&lt;li&gt;Fix Flaky Java Datetime test&lt;br/&gt;
  When the milsecons would have trailing zero, it would get trimmed&lt;/li&gt;
	&lt;li&gt;Align the order of imports&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16678187" author="jira-bot" created="Wed, 7 Nov 2018 12:52:34 +0000"  >&lt;p&gt;Commit 25032e10a86851bdabfa29b99885ccfc03c6667e in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Fokko&quot; class=&quot;user-hover&quot; rel=&quot;Fokko&quot;&gt;Fokko Driesprong&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=25032e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests (#353)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Setup precommit checks via Apache Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Signed-off-by: sacharya &amp;lt;suraj.spa@gmail.com&amp;gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Add a precommit hook using Apache Yetus that will invoke the test&lt;br/&gt;
suite of the different languages&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Disable Ruby integration tests tests&lt;/li&gt;
	&lt;li&gt;Fix Flaky Java Datetime test&lt;br/&gt;
  When the milsecons would have trailing zero, it would get trimmed&lt;/li&gt;
	&lt;li&gt;Align the order of imports&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16678243" author="githubbot" created="Wed, 7 Nov 2018 13:55:44 +0000"  >&lt;p&gt;kojiromike commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-436630307&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-436630307&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @Fokko Congratulations/Thanks for getting this merged. I&apos;ll take a look at those shell scripts. Am I correct that now we can rely on automated checks to validate a lot of our PRs? Is there a way to trigger the tests on all the open PRs?&lt;/p&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16678299" author="githubbot" created="Wed, 7 Nov 2018 14:33:38 +0000"  >&lt;p&gt;Fokko commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-436642301&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-436642301&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @kojiromike with pleasure. They need to rebase onto master, then Travis will run automatically. I&apos;m going through a couple of the PR&apos;s that are still open.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16678321" author="githubbot" created="Wed, 7 Nov 2018 14:45:16 +0000"  >&lt;p&gt;aw-was-here commented on issue #353: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1887&quot; title=&quot;set up precommit checks via Apache Yetus&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1887&quot;&gt;&lt;del&gt;AVRO-1887&lt;/del&gt;&lt;/a&gt; Integrate Yetus and fix tests&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/avro/pull/353#issuecomment-436646341&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/353#issuecomment-436646341&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   FWIW, very specific support for Travis (and other CI systems) is something that will hopefully be coming to Yetus soon.   I&apos;ve got it in a fork already: &lt;a href=&quot;https://github.com/aw-was-here/buretoolbox/commit/f055aa3c78ffdd9bf42e11b457b1283bc3582960&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/aw-was-here/buretoolbox/commit/f055aa3c78ffdd9bf42e11b457b1283bc3582960&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13005593">AVRO-1919</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12998776">AVRO-1900</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12832556" name="AVRO-1887-0.patch" size="4133" author="sacharya" created="Mon, 10 Oct 2016 22:06:22 +0000"/>
                            <attachment id="12832989" name="AVRO-1887-1.patch" size="3799" author="sacharya" created="Wed, 12 Oct 2016 22:29:59 +0000"/>
                            <attachment id="12836412" name="AVRO-1887-2.patch" size="3823" author="sacharya" created="Tue, 1 Nov 2016 18:21:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 10 Oct 2016 22:05:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31bsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1888] Java: Single-record encoding marker bytes check is incorrect</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1888</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;It looks like the check for correct marker bytes is incorrect.&lt;/p&gt;

&lt;p&gt;The check should validate both marker/version bytes match what is expected, but is instead this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (! (BinaryMessageEncoder.V1_HEADER[0] == header[0])
    &amp;amp;&amp;amp; BinaryMessageEncoder.V1_HEADER[1] == header[1]) { . . . }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12992118">AVRO-1888</key>
            <summary>Java: Single-record encoding marker bytes check is incorrect</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rdblue">Ryan Blue</assignee>
                                    <reporter username="rdblue">Ryan Blue</reporter>
                        <labels>
                    </labels>
                <created>Sun, 24 Jul 2016 23:09:25 +0000</created>
                <updated>Sun, 4 Sep 2016 00:27:01 +0000</updated>
                            <resolved>Sun, 4 Sep 2016 00:27:01 +0000</resolved>
                                                    <fixVersion>1.8.2</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15391198" author="rdblue" created="Sun, 24 Jul 2016 23:11:00 +0000"  >&lt;p&gt;Attaching the fix.&lt;/p&gt;</comment>
                            <comment id="15394173" author="busbey" created="Tue, 26 Jul 2016 17:42:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15461943" author="jira-bot" created="Sun, 4 Sep 2016 00:26:22 +0000"  >&lt;p&gt;Commit 17cfe99d72121fad1ead76e8bf80729c5c7f7e6b in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rdblue&quot; class=&quot;user-hover&quot; rel=&quot;rdblue&quot;&gt;Ryan Blue&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=17cfe99&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=17cfe99&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1888&quot; title=&quot;Java: Single-record encoding marker bytes check is incorrect&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1888&quot;&gt;&lt;del&gt;AVRO-1888&lt;/del&gt;&lt;/a&gt;: Java: Fix single-record encoding marker check.&lt;/p&gt;</comment>
                            <comment id="15461945" author="rdblue" created="Sun, 4 Sep 2016 00:27:01 +0000"  >&lt;p&gt;I committed this. Thanks for reviewing, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12990761">AVRO-1885</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12845517">AVRO-1704</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12819839" name="AVRO-1888.1.patch" size="3252" author="rdblue" created="Sun, 24 Jul 2016 23:11:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Jul 2016 17:42:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31fkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1889] Upgrade maven-shade plugin</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1889</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Latest version of maven-shade plugin is 2.4.3 while Avro is using 1.7.1&lt;br/&gt;
This should be upgraded as it fails to build with Java 1.8, mvn=3.3.9 on some Macs&lt;/p&gt;</description>
                <environment></environment>
        <key id="12992416">AVRO-1889</key>
            <summary>Upgrade maven-shade plugin</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sachingoyal">Sachin Goyal</assignee>
                                    <reporter username="sachingoyal">Sachin Goyal</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Jul 2016 22:05:13 +0000</created>
                <updated>Wed, 9 May 2018 09:11:34 +0000</updated>
                            <resolved>Wed, 9 May 2018 09:11:34 +0000</resolved>
                                                    <fixVersion>1.9.0</fixVersion>
                    <fixVersion>1.8.2</fixVersion>
                                    <component>build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="15392747" author="githubbot" created="Mon, 25 Jul 2016 22:15:36 +0000"  >&lt;p&gt;GitHub user sachingsachin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/114&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/114&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1889&quot; title=&quot;Upgrade maven-shade plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1889&quot;&gt;&lt;del&gt;AVRO-1889&lt;/del&gt;&lt;/a&gt;: Upgrade maven-shade plugin&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/sachingsachin/avro&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/sachingsachin/avro&lt;/a&gt; AVRO_1889&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/114.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/114.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #114&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c10e6af948d9407ef544a469fa3d73d0facf3a88&lt;br/&gt;
Author: Sachin Goyal &amp;lt;sgoyal6@l-sb8m1heg8w-m.local&amp;gt;&lt;br/&gt;
Date:   2016-07-25T22:15:10Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1889&quot; title=&quot;Upgrade maven-shade plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1889&quot;&gt;&lt;del&gt;AVRO-1889&lt;/del&gt;&lt;/a&gt;: Upgrade maven-shade plugin&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15436233" author="sacharya" created="Thu, 25 Aug 2016 03:51:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sachingoyal&quot; class=&quot;user-hover&quot; rel=&quot;sachingoyal&quot;&gt;Sachin Goyal&lt;/a&gt; can you please rebase this change on trunk? Looks like this is based out of another pull request (113) which is making this a non clean pull and merge.&lt;/p&gt;</comment>
                            <comment id="15444265" author="jira-bot" created="Sun, 28 Aug 2016 22:56:36 +0000"  >&lt;p&gt;Commit f01f61b96dce5b402939fd81f9247313b4b8da0c in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sachingoyal&quot; class=&quot;user-hover&quot; rel=&quot;sachingoyal&quot;&gt;Sachin Goyal&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=f01f61b&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=avro.git;h=f01f61b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1889&quot; title=&quot;Upgrade maven-shade plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1889&quot;&gt;&lt;del&gt;AVRO-1889&lt;/del&gt;&lt;/a&gt;: Upgrade maven-shade plugin&lt;/p&gt;</comment>
                            <comment id="15444769" author="githubbot" created="Mon, 29 Aug 2016 04:20:15 +0000"  >&lt;p&gt;Github user sachingsachin closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/114&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/114&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16468006" author="nkollar" created="Tue, 8 May 2018 21:48:33 +0000"  >&lt;p&gt;It looks like when merging&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1882&quot; title=&quot;ConcurrentHashMap with non-string keys fails in Java 1.8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1882&quot;&gt;&lt;del&gt;AVRO-1882&lt;/del&gt;&lt;/a&gt; this change was unintentionally overwritten, the order of the two&#160;commits&#160;should be the opposit.&lt;/p&gt;</comment>
                            <comment id="16468580" author="jira-bot" created="Wed, 9 May 2018 09:09:35 +0000"  >&lt;p&gt;Commit b71dcf24f252da5858bd95bfd4bd56402e3a458c in avro&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sachingoyal&quot; class=&quot;user-hover&quot; rel=&quot;sachingoyal&quot;&gt;Sachin Goyal&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=avro.git;h=b71dcf2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gitbox.apache.org/repos/asf?p=avro.git;h=b71dcf2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1889&quot; title=&quot;Upgrade maven-shade plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1889&quot;&gt;&lt;del&gt;AVRO-1889&lt;/del&gt;&lt;/a&gt;: Upgrade maven-shade plugin&lt;/p&gt;

&lt;p&gt;cherry-picked f01f61b96dce5b402939fd81f9247313b4b8da0c again,&lt;br/&gt;
because commit was accidentally overwritten by&lt;br/&gt;
420824c13381c4014d102c8e51e231c694ddacf2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 25 Jul 2016 22:15:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31hen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
