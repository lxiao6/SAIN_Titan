<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:21:44 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2015-4-8+AND+created+%3C%3D+2015-4-15+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="2" total="2"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1661] Schema Evolution not working </title>
                <link>https://issues.apache.org/jira/browse/AVRO-1661</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This is the Avro Schema (OLD) I was using to write Avro binary data before:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{
    &quot;namespace&quot;: &quot;com.hello.world&quot;,
    &quot;type&quot;: &quot;record&quot;,
    &quot;name&quot;: &quot;Toto&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;a&quot;,
            &quot;type&quot;: [
                &quot;string&quot;,
                &quot;null&quot;
            ]
        },
        {
            &quot;name&quot;: &quot;b&quot;,
            &quot;type&quot;: &quot;string&quot;
        }
    ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;This is the Avro Schema (NEW) I&apos;m using to read the Avro binary data :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{
    &quot;namespace&quot;: &quot;com.hello.world&quot;,
    &quot;type&quot;: &quot;record&quot;,
    &quot;name&quot;: &quot;Toto&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;a&quot;,
            &quot;type&quot;: [
                &quot;string&quot;,
                &quot;null&quot;
            ]
        },
        {
            &quot;name&quot;: &quot;b&quot;,
            &quot;type&quot;: &quot;string&quot;
        },
        {
            &quot;name&quot;: &quot;c&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;default&quot;: &quot;na&quot;
        }
    ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, I can&apos;t read the old data with the new Schema. I&apos;ve got the following errors :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;15/04/08 17:32:22 ERROR executor.Executor: Exception in task 0.0 in stage 3.0 (TID 3)
java.io.EOFException
	at org.apache.avro.io.BinaryDecoder.ensureBounds(BinaryDecoder.java:473)
	at org.apache.avro.io.BinaryDecoder.readInt(BinaryDecoder.java:128)
	at org.apache.avro.io.BinaryDecoder.readString(BinaryDecoder.java:259)
	at org.apache.avro.io.BinaryDecoder.readString(BinaryDecoder.java:272)
	at org.apache.avro.io.ValidatingDecoder.readString(ValidatingDecoder.java:113)
	at org.apache.avro.generic.GenericDatumReader.readString(GenericDatumReader.java:353)
	at org.apache.avro.generic.GenericDatumReader.read(GenericDatumReader.java:157)
	at org.apache.avro.generic.GenericDatumReader.readField(GenericDatumReader.java:193)
	at org.apache.avro.generic.GenericDatumReader.readRecord(GenericDatumReader.java:183)
	at org.apache.avro.generic.GenericDatumReader.read(GenericDatumReader.java:151)
	at org.apache.avro.generic.GenericDatumReader.read(GenericDatumReader.java:142)
	at com.miguno.kafka.avro.AvroDecoder.fromBytes(AvroDecoder.scala:31)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From my understanding, I should be able to read the old data with the new schema that contains a new field with a default value. But it doesn&apos;t seem to work. Am I doing something wrong ?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 14.10&lt;/p&gt;</environment>
        <key id="12819361">AVRO-1661</key>
            <summary>Schema Evolution not working </summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nphung">Nicolas PHUNG</reporter>
                        <labels>
                            <label>avsc</label>
                            <label>evolution</label>
                            <label>schema</label>
                    </labels>
                <created>Wed, 8 Apr 2015 15:50:35 +0000</created>
                <updated>Fri, 10 Apr 2015 14:51:57 +0000</updated>
                            <resolved>Thu, 9 Apr 2015 13:45:41 +0000</resolved>
                                    <version>1.7.6</version>
                    <version>1.7.7</version>
                                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14485583" author="rdblue" created="Wed, 8 Apr 2015 17:23:54 +0000"  >&lt;p&gt;Those schemas look compatible to me, but there could still be a problem with either the data file or how you&apos;re reading it. To check a file, can you use &lt;tt&gt;avro-tools&lt;/tt&gt; to cat its contents, but it looks like you&apos;re embedding an Avro record in a Kafka message so that might not be an option and makes it more likely that you have another problem: not setting the writer schema.&lt;/p&gt;

&lt;p&gt;If the data is valid and not truncated, you need to set the new schema as the read schema and the old schema as the write schema so that Avro will resolve the two. Avro can&apos;t read bytes written with the old schema as though they were written with the new. Instead, Avro plans how to read the data: read string field a, read string field b, fill in default &quot;na&quot; on field c. If you were using just the new schema, then the plan would be: read string field a, read string field b, read string field c. That last string field would be expected and would cause the EOF you see.&lt;/p&gt;</comment>
                            <comment id="14485597" author="rdblue" created="Wed, 8 Apr 2015 17:28:59 +0000"  >&lt;p&gt;Here&apos;s a bit of code that demonstrates how you should be reading those events:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Schema eventSchema = schema(event);
Decoder decoder = DecoderFactory.get().binaryDecoder(event.getBody(), decoder);
DatumReader&amp;lt;GenericRecord&amp;gt; reader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericDatumReader&amp;lt;GenericRecord&amp;gt;(eventSchema, newSchema);
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; reader.read(reuse, decoder);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is from the &lt;a href=&quot;https://github.com/apache/flume/blob/trunk/flume-ng-sinks/flume-dataset-sink/src/main/java/org/apache/flume/sink/kite/parser/AvroParser.java#L156&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Flume DatasetSink&lt;/a&gt;, which has the same problem of coordinating schema versions. Flume uses an event header to store a URL to where the schema is stored in HDFS and keeps a cache of readers for each incoming schema. Hopefully that class is helpful.&lt;/p&gt;</comment>
                            <comment id="14486993" author="nphung" created="Thu, 9 Apr 2015 08:56:11 +0000"  >&lt;p&gt;Hello Ryan Blue,&lt;/p&gt;

&lt;p&gt;Indeed, I&apos;m wrapping Avro Record inside Kafka message. If I&apos;m using :&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;DatumReader&amp;lt;GenericRecord&amp;gt; reader = new GenericDatumReader&amp;lt;GenericRecord&amp;gt;(eventSchema, newSchema);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This works fine. However, unlike Flume event, I don&apos;t have a header that contains the Avro Schema for the data. I don&apos;t know if it&apos;s possible to get the schema from a binary avro input.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Schema eventSchema = schema(event);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t know if it&apos;s the right way to do this, but I&apos;m writing these Avro Record in a Kafka topic based from a initial schema. Later on, this based schema evolve with additional fields or other modification. I&apos;d like to be able to read old Avro Record from this Kafka topic as well as the new Avro Record with the new schema. This indeed works once if I have the based schema and a new one but If I plan on iterating several evolution of the Schema it won&apos;t be possible. Is there an Avro&apos;s/proper way to do this ?&lt;/p&gt;

&lt;p&gt;Thanks for your help.&lt;/p&gt;</comment>
                            <comment id="14487359" author="busbey" created="Thu, 9 Apr 2015 13:45:41 +0000"  >&lt;p&gt;There&apos;s an explanation of how to achieve what you&apos;d like on the user@ mailing list: &lt;a href=&quot;http://s.apache.org/2IM&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;1&lt;/a&gt;, &lt;a href=&quot;http://s.apache.org/aq5&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;2&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you have questions or would like additional guidance, please follow up on the mailing list.&lt;/p&gt;</comment>
                            <comment id="14487711" author="gwenshap" created="Thu, 9 Apr 2015 17:31:49 +0000"  >&lt;p&gt;The usual solution is to store the schema in a location everyone can access, and then include an identifier with the message - either in the key or the message body.&lt;/p&gt;

&lt;p&gt;For example, you can store the schema in Schema-Repo (&lt;a href=&quot;https://github.com/schema-repo/schema-repo&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/schema-repo/schema-repo&lt;/a&gt;) and change the key to include the schema identifier.&lt;br/&gt;
Or, store the schema on HDFS and include a URI in the message key.&lt;/p&gt;</comment>
                            <comment id="14488033" author="rdblue" created="Thu, 9 Apr 2015 19:14:20 +0000"  >&lt;p&gt;If you decide to store the schema in the message body, please don&apos;t create a one-off format to do it! Use a set Avro schema for the payload-and-headers like Flume does. Something like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;{ &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;KafkaMessage&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;record&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;fields&quot;&lt;/span&gt;: [
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;headers&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;map&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;values&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; },
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;payload&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;bytes&quot;&lt;/span&gt; }
  ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14489723" author="nphung" created="Fri, 10 Apr 2015 14:50:27 +0000"  >&lt;p&gt;Thanks for your answer Sean Busbey,  Gwen Shapira and Ryan Blue. I&apos;m taking a look too at the Confluent Platform which seems to fit the bill for my use case. I&apos;ll check on Schema-Repo (&lt;a href=&quot;https://github.com/schema-repo/schema-repo&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/schema-repo/schema-repo&lt;/a&gt;) too afterwards, I didn&apos;t know about it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12598315">AVRO-1124</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Apr 2015 17:23:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2czb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1662] Protocol Handshake vs Message Framing</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1662</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The 1.7.7 specification explains the structure of framing but is ambiguous as to  whether and how this applies to the handshake.&lt;/p&gt;

&lt;p&gt;As the handshake request and responses are Avro values, they don&apos;t require framing per-se.&lt;/p&gt;

&lt;p&gt;However, testing with the Java SaslSocketTransceiver has shown that, after SASL completion, a 4-byte header is sent by the client, which isn&apos;t specified in the handshake section of the specification, and the following n bytes includes the subsequent protocol-specific call.&lt;/p&gt;

&lt;p&gt;If the handshake requests and responses are legitimately framed messages, then it seems there should be a terminating frame of 0 bytes between the handshake request and subsequent protocol request.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12820367">AVRO-1662</key>
            <summary>Protocol Handshake vs Message Framing</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="inbuninbu">Jeff Douglas</reporter>
                        <labels>
                    </labels>
                <created>Sun, 12 Apr 2015 06:26:50 +0000</created>
                <updated>Sun, 12 Apr 2015 06:26:50 +0000</updated>
                                            <version>1.7.7</version>
                                                    <component>java</component>
                    <component>spec</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 41 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d5hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
