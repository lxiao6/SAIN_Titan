<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:17:25 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2012-7-11+AND+created+%3C%3D+2012-7-18+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="5" total="5"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1124] RESTful service for holding schemas</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1124</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>
&lt;p&gt;Motivation: It is nice to be able to pass around data in serialized form but still know the exact schema that was used to serialize it. The overhead of storing the schema with each record is too high unless the individual records are very large. There are workarounds for some common cases: in the case of files a schema can be stored once with a file of many records amortizing the per-record cost, and in the case of RPC the schema can be negotiated ahead of time and used for many requests. For other uses, though it is nice to be able to pass a reference to a given schema using a small id and allow this to be looked up. Since only a small number of schemas are likely to be active for a given data source, these can easily be cached, so the number of remote lookups is very small (one per active schema version).&lt;/p&gt;

&lt;p&gt;Basically this would consist of two things:&lt;br/&gt;
1. A simple REST service that stores and retrieves schemas&lt;br/&gt;
2. Some helper java code for fetching and caching schemas for people using the registry&lt;/p&gt;

&lt;p&gt;We have used something like this at LinkedIn for a few years now, and it would be nice to standardize this facility to be able to build up common tooling around it. This proposal will be based on what we have, but we can change it as ideas come up.&lt;/p&gt;

&lt;p&gt;The facilities this provides are super simple, basically you can register a schema which gives back a unique id for it or you can query for a schema. There is almost no code, and nothing very complex. The contract is that before emitting/storing a record you must first publish its schema to the registry or know that it has already been published (by checking your cache of published schemas). When reading you check your cache and if you don&apos;t find the id/schema pair there you query the registry to look it up. I will explain some of the nuances in more detail below. &lt;/p&gt;

&lt;p&gt;An added benefit of such a repository is that it makes a few other things possible:&lt;br/&gt;
1. A graphical browser of the various data types that are currently used and all their previous forms.&lt;br/&gt;
2. Automatic enforcement of compatibility rules. Data is always compatible in the sense that the reader will always deserialize it (since they are using the same schema as the writer) but this does not mean it is compatible with the expectations of the reader. For example if an int field is changed to a string that will almost certainly break anyone relying on that field. This definition of compatibility can differ for different use cases and should likely be pluggable.&lt;/p&gt;

&lt;p&gt;Here is a description of one of our uses of this facility at LinkedIn. We use this to retain a schema with &quot;log&quot; data end-to-end from the producing app to various real-time consumers as well as a set of resulting AvroFile in Hadoop. This schema metadata can then be used to auto-create hive tables (or add new fields to existing tables), or inferring pig fields, all without manual intervention. One important definition of compatibility that is nice to enforce is compatibility with historical data for a given &quot;table&quot;. Log data is usually loaded in an append-only manner, so if someone changes an int field in a particular data set to be a string, tools like pig or hive that expect static columns will be unusable. Even using plain-vanilla map/reduce processing data where columns and types change willy nilly is painful. However the person emitting this kind of data may not know all the details of compatible schema evolution. We use the schema repository to validate that any change made to a schema don&apos;t violate the compatibility model, and reject the update if it does. We do this check both at run time, and also as part of the ant task that generates specific record code (as an early warning). &lt;/p&gt;

&lt;p&gt;Some details to consider:&lt;/p&gt;

&lt;p&gt;Deployment&lt;br/&gt;
This can just be programmed against the servlet API and deploy as a standard war. You have lots of instances and load balance traffic over them.&lt;/p&gt;

&lt;p&gt;Persistence&lt;br/&gt;
The storage needs are not very heavy. The clients are expected to cache the id=&amp;gt;schema mapping, and the server can cache as well. Even after several years of heavy use we have &amp;lt;50k schemas, each of which is pretty small. I think this part can be made pluggable and we can provide a jdbc- and file-based implementation as these don&apos;t require outlandish dependencies. People can easily plug in their favorite key-value store thingy if they like by implementing the right plugin interface. Actual reads will virtually always be cached in memory so this is not too important.&lt;/p&gt;

&lt;p&gt;Group&lt;br/&gt;
In order to get the &quot;latest&quot; schema or handle compatibility enforcement on changes there has to be some way to group a set of schemas together and reason about the ordering of changes over these. I am going to call the grouping the &quot;group&quot;. In our usage it is always the table or topic to which the schema is associated. For most of our usage the group name also happens to be the Record name as all of our schemas are records and our default is to have these match. There are use cases, though, where a single schema is used for multiple topics, each which is modeled independently. The proposal is not to enforce a particular convention but just to expose the group designator in the API. It would be possible to make the concept of group optional, but I can&apos;t come up with an example where that would be useful.&lt;/p&gt;

&lt;p&gt;Compatibility&lt;br/&gt;
There are really different requirements for different use cases on what is considered an allowable change. Likewise it is useful to be able to extend this to have other kinds of checks (for example, in retrospect, I really wish we had required doc fields to be present so we could require documentation of fields as well as naming conventions). There can be some kind of general pluggable interface for this like &lt;br/&gt;
   SchemaChangeValidator.isValidChange(currentLatest, proposedNew)&lt;br/&gt;
A reasonable implementation can be provided that does checks based on the rules in &lt;a href=&quot;http://avro.apache.org/docs/current/spec.html#Schema+Resolution&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/current/spec.html#Schema+Resolution&lt;/a&gt;. Be default no checks need to be done. Ideally you should be able to have more than one policy (say one treatment for database schemas, one for logging event schemas, and one which does no checks at all). I can&apos;t imagine a need for more than a handful of these which would be statically configured (db_policy=com.mycompany.DBSchemaChangePolicy, noop=org.apache.avro.NoOpPolicy,...). Each group can configure the policy it wants to be used going forward with the default being none.&lt;/p&gt;

&lt;p&gt;Security and Authentication&lt;br/&gt;
There isn&apos;t any of this. The assumption is that this service is not publicly available and those accessing it are honest (though perhaps accident prone). These are just schemas, after all.&lt;/p&gt;

&lt;p&gt;Ids&lt;br/&gt;
There are a couple of questions about ids how we make ids to represent the schemas:&lt;br/&gt;
1. Are they sequential (1,2,3..) or hash based? If hash based, what is sufficient collision probability? &lt;br/&gt;
2. Are they global or per-group? That is, if I know the id do I also need to know the group to look up the schema?&lt;br/&gt;
3. What kind of change triggers a new id? E.g. if I update a doc field does that give a new id? If not then that doc field will not be stored.&lt;/p&gt;

&lt;p&gt;For the id generation there are various options:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A sequential integer&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1006&quot; title=&quot;Fingerprints for Avro Schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1006&quot;&gt;&lt;del&gt;AVRO-1006&lt;/del&gt;&lt;/a&gt; creates a schema-specific 64-bit hash.&lt;/li&gt;
	&lt;li&gt;Our current implementation at LinkedIn uses the MD5 of the schema as the id.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Our current implementation at LinkedIn uses the MD5 of the schema text after removing whitespace. The additional attributes like doc fields (and a few we made up) are actually important to us and we want them maintained (we add metadata fields of our own). This does mean we have some updates that generate a new schema id but don&apos;t cause a very meaningful semantic change to the schema (say because someone tweaked their doc string), but this doesn&apos;t hurt anything and it is nice to have the exact schema text represented. An example of uses these metadata fields is using the schema doc fields as the hive column doc fields.&lt;/p&gt;

&lt;p&gt;The id is actually just a unique identifier, and the id generation algorithm can be made pluggable if there is a real trade-off. In retrospect I don&apos;t think using the md5 is good because it is 16 bytes, which for a small message is bulkier than needed. Since the id is retained with each message, size is a concern.&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1006&quot; title=&quot;Fingerprints for Avro Schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1006&quot;&gt;&lt;del&gt;AVRO-1006&lt;/del&gt;&lt;/a&gt; fingerprint is super cool, but I have a couple concerns (possibly just due to misunderstanding):&lt;br/&gt;
1. Seems to produce a 64-bit id. For a large number of schemas, 64 bits makes collisions unlikely but not unthinkable. Whether or not this matters depends on whether schemas are versioned per group or globally. If they are per group it may be okay, since most groups should only have a few hundred schema versions at most. If they are global I think it will be a problem. Probabilities for collision are given here under the assumption of perfect uniformity of the hash (it may be worse, but can&apos;t be better) &lt;a href=&quot;http://en.wikipedia.org/wiki/Birthday_attack&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/Birthday_attack&lt;/a&gt;. If we did have a collision we would be dead in the water, since our data would be unreadable. If this becomes a standard mechanism for storing schemas people will run into this problem.&lt;br/&gt;
2. Even 64-bits is a bit bulky. Since this id needs to be stored with every row size is a concern, though a minor one.&lt;br/&gt;
3. The notion of equivalence seems to throw away many things in the schema (doc, attributes, etc). This is unfortunate. One nice thing about avro is you can add your own made-up attributes to the schema since it is just JSON. This acts as a kind of poor-mans metadata repository. It would be nice to have these maintained rather than discarded.&lt;/p&gt;

&lt;p&gt;It is possible that I am misunderstanding the fingerprint scheme, though, so please correct me.&lt;/p&gt;

&lt;p&gt;My personal preference would be to use a sequential id per group. The main reason I like this is because the id doubles as the version number, i.e. my_schema/4 is the 4th version of the my_schema record/group. Persisted data then only needs to store the varint encoding of the version number, which is generally going to be 1 byte for a few hundred schema updates. The string my_schema/4 acts as a global id for this. This does allow per-group sharding for id generation, but sharding seems unlikely to be needed here. A 50GB database would store 52 million schemas. 52 million schemas &quot;should be enough for anyone&quot;. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Probably the easiest thing would be to just make the id generation scheme pluggable. That would kind of satisfy everyone, and, as a side-benefit give us at linkedin a gradual migration path off our md5-based ids. In this case ids would basically be opaque url-safe strings from the point of view of the repository and users could munge this id and encode it as they like.&lt;/p&gt;

&lt;p&gt;APIs&lt;br/&gt;
Here are the proposed APIs. This tacitly assumes ids are per-group, but the change if pretty minor if not:&lt;/p&gt;

&lt;p&gt;Get a schema by id&lt;br/&gt;
GET /schemas/&amp;lt;group&amp;gt;/&amp;lt;id&amp;gt;&lt;br/&gt;
If the schema exists the response code will be 200 and the response body will be the schema text.&lt;br/&gt;
If it doesn&apos;t exist the response will be 404.&lt;/p&gt;

&lt;p&gt;GET /schemas&lt;br/&gt;
Produces a list of group names, one per line.&lt;/p&gt;

&lt;p&gt;GET /schemas/group&lt;br/&gt;
Produces a list of versions for the given group, one per line.&lt;/p&gt;

&lt;p&gt;GET /schemas/group/latest&lt;br/&gt;
If the group exists the response code will be 200 and the response body will be the schema text of the last registered schema.&lt;br/&gt;
If the group doesn&apos;t exist the response code will be 404.&lt;/p&gt;

&lt;p&gt;Register a schema&lt;br/&gt;
POST /schemas/groups/&amp;lt;group_name&amp;gt;&lt;br/&gt;
Parameters:&lt;br/&gt;
schema=&amp;lt;text of schema&amp;gt;&lt;br/&gt;
compatibility_model=XYZ&lt;br/&gt;
force_override=(true|false)&lt;/p&gt;

&lt;p&gt;There are a few cases:&lt;br/&gt;
If the group exists and the change is incompatible with the current latest, the server response code will be 403 (forbidden) UNLESS the force_override flag is set in which case not check will be made.&lt;br/&gt;
If the server doesn&apos;t have an implementation corresponding to the given compatibility model key it will give a response code 400&lt;br/&gt;
If the group does not exist it will be created with the given schema (and compatibility model)&lt;br/&gt;
If the group exists and this schema has already been registered the server returns response code 200 and the id already assigned to that schema&lt;br/&gt;
If the group exists, but this schema hasn&apos;t been registered, and the compatibility checks pass, then the response code will be 200 and it will store the schema and return the id of the schema&lt;/p&gt;

&lt;p&gt;The force_override flag allows registering an incompatible schema. We have found that sometimes you know &quot;for sure&quot; that your change is okay and just want to damn the torpedoes and charge ahead. This would be intended for manual rather than programmatic usage.&lt;/p&gt;

&lt;p&gt;Intended Usage&lt;br/&gt;
Let&apos;s assume we are implementing a put and get API as a database would have using this registry, there is no substantial difference for a messaging style api. Here are the details of how this works:&lt;/p&gt;

&lt;p&gt;Say you have two methods &lt;br/&gt;
  void put(table, key, record)&lt;br/&gt;
  Record get(table, key)&lt;/p&gt;

&lt;p&gt;Put is expected to do the following under the covers:&lt;br/&gt;
1. Check the record&apos;s schema against a local cache of schema=&amp;gt;id to get the schema id&lt;br/&gt;
3. If it is not found then register it with the schema registry and get back a schema id and add this pair to the cache&lt;br/&gt;
4. Store the serialized record bytes and schema id&lt;/p&gt;

&lt;p&gt;Get is expected to do the following:&lt;br/&gt;
1. Retrieve the serialized record bytes and schema id from the store&lt;br/&gt;
2. Check a local cache to see if this schema is known for this schema id&lt;br/&gt;
3. If not, fetch the schema by id from the schema registry&lt;br/&gt;
4. Deserialize the record using the schema and return it&lt;/p&gt;

&lt;p&gt;Code Layout&lt;br/&gt;
Where to put this code? Contrib package? Elsewhere? Someone should tell me...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12598315">AVRO-1124</key>
            <summary>RESTful service for holding schemas</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21141&amp;avatarType=issuetype">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="jkreps">Jay Kreps</assignee>
                                    <reporter username="jkreps">Jay Kreps</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Jul 2012 03:46:41 +0000</created>
                <updated>Sun, 30 Dec 2018 05:43:33 +0000</updated>
                                                                            <component>java</component>
                        <due></due>
                            <votes>35</votes>
                                    <watches>72</watches>
                                                                <comments>
                            <comment id="13411274" author="scott_carey" created="Wed, 11 Jul 2012 06:27:55 +0000"  >&lt;p&gt;This looks great!&lt;/p&gt;

&lt;p&gt;Re: Fingerprints&lt;br/&gt;
These are not ideal identifiers for a schema registry for the reasons you cite.  These serve a variety of purposes however, one of which is that they can be used to make equivalence checks significantly faster by comparing the (cached) fingerprint before all of the schema elements.&lt;/p&gt;

&lt;p&gt;I agree that an incrementing integer is an ideal identifier.  Even with 1M schemas, that would take only 3 bytes as an Avro encoded integer.  If per group, the first 63 versions take one byte and up to 8191 take 2 bytes.  It makes sense to allow this id generation to be pluggable and support other types for those that want to use UUIDs, hashes, or strings.&lt;/p&gt;

&lt;p&gt;Re: code layout &amp;#8211; I propose we make set of new maven modules for this (e.g. avro-registry, avro-registry-persist-jdbc, avro-registry-persist-zookeeper, etc).  If you have code, I can do the maven part quickly.  Adding modules is easy as long as the code already has clean separation of packages and dependencies.&lt;/p&gt;


</comment>
                            <comment id="13411826" author="cutting" created="Wed, 11 Jul 2012 18:33:29 +0000"  >&lt;p&gt;This sounds great.  Getting something committed to Apache SVN sooner might make it easier for folks to collaborate on extension points, layout, etc.  We might commit the first version of this to a development branch named &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;.  Then we can collaboratively make incompatible changes to APIs, packaging, etc., and merge it to trunk once we think things are stable enough to include in the next release.&lt;/p&gt;</comment>
                            <comment id="13411857" author="jkreps" created="Wed, 11 Jul 2012 18:57:04 +0000"  >&lt;p&gt;Cool, I will try to get a patch against trunk ready. We can apply that on a branch or wherever makes sense. I should have something ready by early next week.&lt;/p&gt;</comment>
                            <comment id="13411967" author="scott_carey" created="Wed, 11 Jul 2012 20:36:58 +0000"  >&lt;p&gt;Is the branch necessary?  This service should not require changing existing avro modules and will only depend on them.  As long as it is in its own directory (e.g. lang/java/registry) and was not referenced by the aggregator lang/java/pom.xml then it will not be built, packaged, or published by the main build.  While under development it can be built by executing its build scripts within that location with no side effects outside of that.&lt;/p&gt;


&lt;p&gt;I look forward to seeing it!&lt;/p&gt;</comment>
                            <comment id="13411984" author="cutting" created="Wed, 11 Jul 2012 20:56:38 +0000"  >&lt;p&gt;It&apos;s too soon to tell whether a branch would be useful.  I wanted to mention it as an option, to remove obstacles to committing something early.&lt;/p&gt;</comment>
                            <comment id="13430794" author="scott_carey" created="Wed, 8 Aug 2012 01:13:09 +0000"  >&lt;p&gt;Is this still in progress?&lt;/p&gt;

&lt;p&gt;I am willing to contribute resources to help push this through.  If it is partially complete, I would be happy to see a patch of the work in progress as myself or others may have time to take the next steps.&lt;/p&gt;</comment>
                            <comment id="13431968" author="jkreps" created="Thu, 9 Aug 2012 16:43:56 +0000"  >&lt;p&gt;Yeah, got distracted for a few weeks, I will come back to it early next week.&lt;/p&gt;</comment>
                            <comment id="13446185" author="scott_carey" created="Fri, 31 Aug 2012 18:02:50 +0000"  >&lt;p&gt;Any status update?  I will begin building the core of this next week as I need this ASAP.   I would start with the core REST service and schema management with a stubbed out API for pluggable storage, id generation, and schema compatability checks.  My assessment is that with the tools I know well for a standalone REST service (Jersey + Jetty + Guice + Maven), I can get this done fairly rapidly.  A separate maven module in Avro can have a Java Client API, and later others can contribute implementations of the pluggable parts &amp;#8211;  perhaps a Zookeeper id generator and an HBase storage back-end.&lt;/p&gt;
</comment>
                            <comment id="13446507" author="jkreps" created="Sat, 1 Sep 2012 00:00:31 +0000"  >&lt;p&gt;Here is a patch that has basic functionality:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Storage in mysql (probably good up to your first 20 million schemas)&lt;/li&gt;
	&lt;li&gt;Just a basic servlet for the service&lt;/li&gt;
	&lt;li&gt;Simple LRU caching that works on both the client and server side&lt;/li&gt;
	&lt;li&gt;Schemas are just strings which makes testing easy. The avro validation can be done with the pluggable validator.&lt;/li&gt;
	&lt;li&gt;An integration/stress test that registers a bunch of schemas and checks the answer&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Current patch works with jetty from command line. Theoretically it should be possible to package for any servlet container (added a context listener for that), but I haven&apos;t tried it.&lt;/p&gt;</comment>
                            <comment id="13446508" author="jkreps" created="Sat, 1 Sep 2012 00:02:22 +0000"  >&lt;p&gt;Hey Scott, I uploaded what I have, take a look and let&apos;s discuss.&lt;/p&gt;</comment>
                            <comment id="13448360" author="scott_carey" created="Wed, 5 Sep 2012 01:00:27 +0000"  >&lt;p&gt;Looks like a good start, thanks!&lt;/p&gt;

&lt;p&gt;A couple thoughts so far:&lt;/p&gt;

&lt;p&gt;I&apos;ll split this up into a family of maven modules:&lt;/p&gt;


&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; path from lang/java/ &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; description &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; schema-repo/common &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; common libraries and abstractions.  Ideally doesn&apos;t even depend on avro, only strings, etc. &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; schema-repo/client &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; for the client, so that a client app can have minimal dependencies &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; schema-repo/server &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; standalone server instance, can have dependencies that clients would not want &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; schema-repo/mysql &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; perhaps jdbc, but there might not be much to share with a postgres implementation I&apos;d make. &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;h3&gt;&lt;a name=&quot;IDGeneration&quot;&gt;&lt;/a&gt;ID Generation&lt;/h3&gt;
&lt;p&gt;I think the API should be closer to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getNextId(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; source);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The SchemaIdGenerator should be able to look up the latest id for a source if required.  I can think of a few cases that could generate a series of ids &amp;#8211; Zookeeper, with an atomic int kept per source, Postgres, with a sequence kept per source, and HBase atomic increment, and all of those store the latest in order to generate the next.  For an md5 generator it does not need the last id, but may need to validate that there is no collision per source.&lt;/p&gt;

&lt;p&gt;I am also thinking about how to make the ID optionally be a long instead of a string, so that we can use Avro to encode it before the datum in places like HBase or Kafka.&lt;/p&gt;


&lt;h3&gt;&lt;a name=&quot;Schemachangevalidator&quot;&gt;&lt;/a&gt;Schema change validator&lt;/h3&gt;
&lt;p&gt;For this interface, I also believe that it may be simpler to simply provide the source and the new schema, that is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;void validate(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; source, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; newSchema);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;instead of &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;void validate(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; oldSchema, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; newSchema)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Assuming the validator has access to all schemas in the source.  Some validators may only be interested in the delta between the new one and the latest, others may need to check against every schema.&lt;/p&gt;


&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="13448436" author="jkreps" created="Wed, 5 Sep 2012 03:44:57 +0000"  >&lt;p&gt;Yeah it definitely makes sense to split the packages up to help with dependencies, your proposal sounds good.&lt;/p&gt;

&lt;p&gt;For the id generation, I think you can use a long even if it is stored as a string. I think in this case String is just a stand-in for &quot;some bytes&quot;. The id generator i gave uses sequential integers. It just isn&apos;t captured in the type signature.&lt;/p&gt;

&lt;p&gt;WRT to the API question I think you are proposing adding the source to the API, which is definitely needed in both interfaces for the reasons you give.&lt;/p&gt;

&lt;p&gt;I would actually argue for giving the current schema as well, so that it doesn&apos;t need to be looked up twice:&lt;/p&gt;

&lt;p&gt;void validate(String source, String oldSchema, String newSchema);&lt;br/&gt;
void nextId(String source, String schema, String currentId); &lt;/p&gt;

&lt;p&gt;Alternately we could substitute in a reference to the SchemaRepository from which you could lookup the latest schema/id, the only downside is you would need to do it twice (once in the validator and once in the id generator if you needed both).&lt;/p&gt;

&lt;p&gt;Of course if the user provides a custom implementation, all of these can be done in inline in any custom way as part of the register() call.&lt;/p&gt;</comment>
                            <comment id="13449287" author="scott_carey" created="Thu, 6 Sep 2012 00:07:28 +0000"  >&lt;p&gt;Rather than supplying a SchemaRepository in the API for a generator or validator to use, the repository can be provided when the generator is constructed if it needs it. This however creates a circular dependency &amp;#8211; a repository requires a generator which requires a repository.  To decouple this, we can build it up by layers.  For example, a ValidatingRepository is created by combining a Validator and Respository.  A CachingRepository is created by combining a Cache and a Repository, etc.  This further decouples the system, allowing for any combination of features to be configuration driven and each layer to be tested in isolation.&lt;/p&gt;

&lt;p&gt;For the ID generator, neither a postgres id generator, HBase id generator, zookeeper generator, nor hash generator needs to know the prior id.  MySQL might (does it not have sequences? Its been a while since I used it).  Anything that does can look it up &amp;#8211; it is likely cached or very fast to retrieve, and id generation will be infrequent.&lt;/p&gt;

&lt;p&gt;For the validator, do we assume that we are only validating the new versus the current?  What if a validator needs to compare the new schema to all previous to ensure forwards compatibility?  The simplest API would appear to be:&lt;/p&gt;

&lt;p&gt;validate(String source, String newSchema);&lt;/p&gt;

&lt;p&gt;All other context, such as checking against the latest version, can be encapsulated in the validator instance and passed in its constructor.  We could have an abstract validator that implements the above, gets the latest, and then has an abstract&lt;/p&gt;

&lt;p&gt;validate(String source, Sring newSchema, String latestSchema);&lt;/p&gt;

&lt;p&gt;resulting in the more limited API you list above.  Doing the reverse however, would create a wasted lookup for validators that do not require it.&lt;/p&gt;</comment>
                            <comment id="13503967" author="scott_carey" created="Mon, 26 Nov 2012 18:30:25 +0000"  >&lt;p&gt;I am nearing completion on the first patch attempt for this ticket.&lt;/p&gt;

&lt;p&gt;The implementation differs from Jay&apos;s first pass in several ways, but has the same core concept.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The &quot;group&quot; or &quot;source&quot; concept has been renamed &quot;Subject&quot; &amp;#8211; this is a collection of mutually compatible schemas, evolved over time according to a specific notion of compatibility.  I am happy to pick another name if that makes sense.  &quot;Group&quot; is too broad, &quot;Topic&quot; is taken by pub-sub systems and does not map 1:1 to that (though often does), and our engineers found &quot;source&quot; confusing.&lt;/li&gt;
	&lt;li&gt;The client API attains a &lt;em&gt;Subject&lt;/em&gt; from a &lt;em&gt;Repository&lt;/em&gt; and does Schema/Id lookups on this &lt;em&gt;Subject&lt;/em&gt; object, not the repository.  Since many common use cases of the repository map to one &lt;em&gt;Subject&lt;/em&gt; (e.g. a collection of Avro files, a column in HBase, or a Topic in Kafka all map to one Subject), it was cleaner as a client to bind the Subject to the object in the client in code (perhaps as a final member variable) than to hold on to the Repository object and &lt;em&gt;always&lt;/em&gt; pass in the same constant subject name.&lt;/li&gt;
	&lt;li&gt;The client API is the same as the server implementation API.  To implement a JDBC or HBase persistent store, implement Repository and Subject.   This allows composition of layers and proxy implementations.  For example, a a persistent Repository implementation can be wrapped in a CachingRepository, much like an InputStream can be wrapped in a BufferedInputStream.  One of our critical use cases leverages this &amp;#8211; a repository proxy is constructed as a REST server that uses the REST client as a backing store, with a cache layer in the middle.&lt;/li&gt;
	&lt;li&gt;Validation is not yet implemented (working on it, some parts are stubbed out).  There are at least 5 basic notions of &apos;compatibility&apos; that I believe should be built-in, see the Javadoc.  Validation and  compatibility need to be configurable on a per-Subject basis.&lt;/li&gt;
	&lt;li&gt;Caches are pluggable and composible with storage implementations.&lt;/li&gt;
	&lt;li&gt;I did not implement a MySQL or JDBC storage layer (we use Postgres, if we build that we will contribute).  Instead I wrote a simple file based repository as one of two reference implementations.  The other reference implementation is an in memory repository.&lt;/li&gt;
	&lt;li&gt;I modified the REST semantics a bit, which required a &quot;register_if_latest&quot; variant of register to avoid race conditions when two registrations occur at the same time and validation would fail if it is order dependent.&lt;/li&gt;
	&lt;li&gt;The eventual implementation needs to support both integer and string IDs.  The current implementation leaves this up to the persistence layer, but we need to expose on a per-subject basis whether a key can be interpreted as an Integer or not.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Open questions:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;What should the restrictions be on Subject names?  I propose that subject names are required to be valid Avro identifiers: &lt;a href=&quot;http://avro.apache.org/docs/current/spec.html#Names&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/current/spec.html#Names&lt;/a&gt; (e.g. com.richrelevance.Stuff_Number-2 is valid, but 34;&apos;xyz is not) this should mean that the names are valid file/directory names but that some escaping may be needed to map to a table or column name in an RDBMS due to &apos;.&apos;&lt;/li&gt;
	&lt;li&gt;Is there a cleaner way to deal with validation race conditions in the API?&lt;/li&gt;
	&lt;li&gt;This model has been proven to work and tested at RichRelevance internally when paired with Kafka and/or collections of Avro files.  I have not deeply considered HBase/Cassandra/Hive/Pig etc yet.  I believe the concept works broadly for any case where you want to encode a short ID prefix instead of full schema before a record.&lt;/li&gt;
	&lt;li&gt;Rather than have named parameters in the API (REST and Java) specifically for the type of validation, I think it is wiser to have an arbitrary Map&amp;lt;String, String&amp;gt; for each subject for extensible configuration.  We can reserve the &quot;avro.&quot; prefix namespace for internal use.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Other tidbits:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The entire repository core does not depend on Avro at all &amp;#8211; it is a system for mapping a namespace of (subject_name + id) to a schema string.  The only requirement is that the string not be empty.   Avro (or other interpretations of the schema) is a separate concern handled in a different layer.&lt;/li&gt;
	&lt;li&gt;I have added JSR-330 annotations for some constructor Injection, and use Guice in the server component to wire it all up and launch flexibly &amp;#8211; the persistence implementation and cache can be configured in a properties file and a server launched.  Guice does &lt;em&gt;not&lt;/em&gt; leak to any client libraries, it is only for the stand-alone server.  Clients can optionally include a jsr-330 jar for use with Spring/Guice or ignore them.&lt;/li&gt;
	&lt;li&gt;Client libraries for reading/writing (id:avro_bytes) pairs with Avro and caching the avro machinery appropriately are additional things I would like to later contribute.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;We have started using the implementation internally and will migrate to the eventual version submitted to Apache Avro.  I am targeting end of year to wrap this up.&lt;/p&gt;

&lt;p&gt;I will post the work in progress to this ticket.&lt;/p&gt;</comment>
                            <comment id="13503970" author="scott_carey" created="Mon, 26 Nov 2012 18:35:37 +0000"  >&lt;p&gt;To be clear, I am targeting today or tomorrow for the first patch and work in progress, and later this year to finish review and get community consensus for commit with all open questions addressed and no missing features.&lt;/p&gt;</comment>
                            <comment id="13504295" author="scott_carey" created="Tue, 27 Nov 2012 01:32:54 +0000"  >&lt;p&gt;Work in progress for Schema Repo attached as &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;.patch&lt;/p&gt;</comment>
                            <comment id="13563775" author="felixgv" created="Sun, 27 Jan 2013 10:20:06 +0000"  >&lt;p&gt;I have a question, mainly for the LinkedIn folks, but anyone&apos;s welcome to give their opinion of course &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;How do you deal with nested schemas? In particular, how do you deal with nested schemas that are defined externally and imported into the containing schema?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://avro.apache.org/docs/current/idl.html#imports&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/current/idl.html#imports&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Do you version them somehow? If so, how? Do you tag them with a custom metadata field containing the version/ID of the nested schema? Do you instead always flatten the nested schemas into the containing schema instead of importing them from the outside?&lt;/p&gt;

&lt;p&gt;If there is no current support for versioning externally defined imported schemas, then is it something that&apos;s worth supporting? or should it instead be enforced to only have flattened schemas and not use imported ones?&lt;/p&gt;

&lt;p&gt;(By flattening, I do not mean to remove the nesting, but rather to include the definition of the nested schema directly in the containing schema&apos;s definition, rather than importing it.)&lt;/p&gt;

&lt;p&gt;Also, if a metadata field is defined which contains the version of a nested externally defined schema, then should the value of this metadata field be included in the schema fingerprinting algorithm?&lt;/p&gt;

&lt;p&gt;Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13564387" author="jkreps" created="Mon, 28 Jan 2013 16:32:04 +0000"  >&lt;p&gt;Our setup works as follows:&lt;br/&gt;
1. We have a giant directory of version controlled schemas for the whole company. We have another directory called &quot;includes&quot; which includes any shared record type that is included in multiple schemas.&lt;br/&gt;
2. We always fully expand referenced types in the schemas. So if you have a type Header defined in your record and it is not found in that same file, we look in the includes directory and try to get it from there.&lt;br/&gt;
3. We don&apos;t use the idl since our setup predates that.&lt;br/&gt;
4. We send each message with a schema id which is the checksum of the fully expanded schema.&lt;br/&gt;
5. This means that any change to either the record or any includes effectively changes the version, but this is fine, since version changes are automatically handle when the md5 of the fully expanded schema changes.&lt;/p&gt;

&lt;p&gt;This approach has worked really well for us. The way to think about includes is just as a concise notation for the fully expanded schema.&lt;/p&gt;</comment>
                            <comment id="13564479" author="scott_carey" created="Mon, 28 Jan 2013 18:18:22 +0000"  >&lt;p&gt;Here at RichRelevance we do something extremely similar to LinkedIn, but use incrementing integer IDs rather than md5s.&lt;br/&gt;
The number of total schemas is not likely to be so high that holding references to nested versioned bits is worth the added complexity.  It has been claimed that Google&apos;s internal schema repository for protobuf is on the order of 10K schemas including all versions.  &lt;/p&gt;</comment>
                            <comment id="13564599" author="spullara" created="Mon, 28 Jan 2013 19:44:55 +0000"  >&lt;p&gt;With HAvroBase I started out using SHAs but ultimately switched to a monotonically increasing number and look them up with their text value. As long as you have a central repository either one will work with similar performance characteristics but having a single integer is just simpler.&lt;/p&gt;</comment>
                            <comment id="13606709" author="hodgesz" created="Tue, 19 Mar 2013 19:47:08 +0000"  >&lt;p&gt;Have there been any more talks on a potential release for the schema repository?  We are definitely interested in this feature and are considering implementing a JDBC based repository.  Before doing so we wanted to check on the status as I see that Postgres and MySQL implementations have already been mentioned.&lt;/p&gt;</comment>
                            <comment id="13607122" author="scott_carey" created="Wed, 20 Mar 2013 00:50:02 +0000"  >&lt;p&gt;After some time off working on other priorities, I have returned to work on this.  We have been running a version of this internally for ~4 months (not too different than the November patch).  It is missing a few key features I am adding now to make subject configuration flexible and allow for configuration of custom or built-in validation rules.&lt;/p&gt;

&lt;p&gt;I will be updating this ticket with my latest work this week, and plan to push it to completion/contribution this month.&lt;/p&gt;</comment>
                            <comment id="13607126" author="hodgesz" created="Wed, 20 Mar 2013 00:53:35 +0000"  >&lt;p&gt;Wow that&apos;s service!  Thanks for the very welcomed contribution!&lt;/p&gt;</comment>
                            <comment id="13617384" author="hodgesz" created="Fri, 29 Mar 2013 14:40:43 +0000"  >&lt;p&gt;@Scott, I wanted to follow up on your patch.  I am still new to this process, will it be applied under &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt; or another one?  I don&apos;t mean to rush you at all.  I just want to make sure I am looking in the right place.&lt;/p&gt;</comment>
                            <comment id="13617484" author="scott_carey" created="Fri, 29 Mar 2013 16:26:33 +0000"  >&lt;p&gt;You are looking in the right place.  I&apos;ll post the patch here and it will be against trunk at the time.&lt;/p&gt;</comment>
                            <comment id="13617489" author="scott_carey" created="Fri, 29 Mar 2013 16:30:22 +0000"  >&lt;p&gt;Current progress &amp;#8211; I have added a generic way to set / store configurations per subject, and reserved configuration keys starting with &quot;repo.&quot;.   I&apos;m in progress of wiring up the process of identifying validators based on the configuration.&lt;/p&gt;
</comment>
                            <comment id="13617937" author="hodgesz" created="Sat, 30 Mar 2013 01:10:00 +0000"  >&lt;p&gt;That&apos;s great! Thanks for the update. Will this patch include a Postgres Repository implementation as well?&lt;/p&gt;</comment>
                            <comment id="13618657" author="scott_carey" created="Mon, 1 Apr 2013 06:42:03 +0000"  >&lt;p&gt;No, we are currently using a boring (and not horizontally scalable) file based repository that will be included since it depends on nothing outside of the Java 6 JDK.  An HBase one may follow that.  I am also including generic unit testing tools for testing any repository implementation in a unit test maven artifact.&lt;/p&gt;

&lt;p&gt;Database implementations should be easy.  I suspect that Postgres and MySQL will probably end up with differing implementations sharing some common code, due to differing feature sets underneath.&lt;/p&gt;</comment>
                            <comment id="13619272" author="scott_carey" created="Mon, 1 Apr 2013 22:52:06 +0000"  >&lt;p&gt;Most recent patch for the schema repository.  &lt;/p&gt;

&lt;p&gt;This is very close, and supports configurable validators, repository implementations, and caching.&lt;/p&gt;

&lt;p&gt;What is missing:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;One more maven module for Avro specific components and validators.  None of the core code here depends on Avro specifically.&lt;/li&gt;
	&lt;li&gt;We need to decide what is allowed in a schema, currently a schema containing a newline will break the schema listing.&lt;/li&gt;
	&lt;li&gt;Another pass through the javadoc.  I have not reviewed changes to the documentation needed due to my recent changes.&lt;/li&gt;
	&lt;li&gt;Wiki or other external documentation.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13619339" author="scott_carey" created="Mon, 1 Apr 2013 23:46:45 +0000"  >&lt;p&gt;Some changes in the last patch:&lt;/p&gt;

&lt;p&gt;There is now a SubjectConfig class paired with a Builder.  This is serialized as a Map&amp;lt;String,String&amp;gt; in the format of java.util.Properties.  Keys that start with &quot;repo.&quot; are reserved.  &quot;repo.validators&quot; stores a comma separated list of validator names.  Validator names can be anything that does not contain a comma or have leading or trailing whitespace.&lt;/p&gt;

&lt;p&gt;A repository REST server can be started up with a configuration property file that contains the HTTP configuration, implementation of the repository to use, the cache to use, and validator mappings.  All properties in the property file are bound using Google Guice, so additional mappings or configurations can be used by any other repository implementation or cache implementation.  For example, the FileRepository and RESTRepositoryClient repository implementations so far use Guice to inject the repository instance and pass configuration information to their constructor.&lt;br/&gt;
Therefore, it should be possible for alternate repository implementations to back the RESTRespository server provided by setting the implementation classes and their configuration needs in the property file, and placing the required classes in the classpath.&lt;/p&gt;

&lt;p&gt;Validator mappings are configured in the property file by prefixing the validator name with &quot;validator.&quot; in the property key.&lt;br/&gt;
For example, a line in the property file:&lt;br/&gt;
&quot;validator.avro.disallowUnions=org.apache.avro.repo.validators.DisallowUnionValidator&quot; would bind the name &quot;avro.disallowUnions&quot; to the implementation class &quot;org.apache.avro.repo.validators.DisallowUnionValidator&quot;, and any Subjects configured with that validator name would use that class to validate schemas.&lt;/p&gt;

&lt;p&gt;Subject configuration is currently set once at subject creation time, and if there is a race condition when creating subjects, the first one wins.  I have not added the ability to set validation configuration via the Repository/Subject API yet, or built the REST API for that.  At this time, if one wants to modify the subject configuration they will need to do so through a back-door such as modifying the files on disk for the file repo, or a database record in another store.&lt;/p&gt;


&lt;p&gt;Lastly, I added a method to a Subject: &quot;boolean integralKeys()&quot; to indicate whether the keys generated by this subject can be expected to parse as an integer.  This delegates all the way through to the backing store and is not configurable through the Repository/Subject API, since implementations of the backing store are what determines how keys are generated; the contract otherwise is merely that they are Strings and unique per subject.&lt;/p&gt;</comment>
                            <comment id="13619346" author="scott_carey" created="Mon, 1 Apr 2013 23:53:01 +0000"  >&lt;p&gt;To help disambiguate where Properties are used more clearly:&lt;/p&gt;

&lt;p&gt;There is a set of properties used by o.a.a.repo.server.ConfigModule that is application scope, and required for the o.a.a.repo.server.RepoServer.main() to run.  This contains the Jetty, repo, cache, and validator configuration information that is related to the Guice-based application initialization and configuration.&lt;/p&gt;

&lt;p&gt;Properties is also used as a mechanism to serialize data in a SubjectConfig in the FileRepository implementation, but conceptually SubjectConfig contains a Map&amp;lt;String,String&amp;gt; that implementations of persistent stores must maintain per Subject.&lt;/p&gt;</comment>
                            <comment id="13619564" author="scott_carey" created="Tue, 2 Apr 2013 06:47:20 +0000"  >&lt;p&gt;A little wrinkle.  I&apos;ve built Avro validators for the before mentioned backwards and forwards compatibility modes.  However, there is no facility in core Avro to ask &quot;can I read schema X with schema Y&quot;?  I thought that ResolvingGrammarGenerator.generate(writer, reader) would do so, but it is lazy and only breaks when one attempts to read data (at least for missing fields without defaults.&lt;/p&gt;

&lt;p&gt;I&apos;ve written a method on Symbol that seems to work to check the result of ResolvingGrammarGenerator.generate(writer, reader) to see if it contains errors, and will include this shortly, but it is poorly tested at the moment.&lt;/p&gt;</comment>
                            <comment id="13623889" author="scott_carey" created="Fri, 5 Apr 2013 18:18:05 +0000"  >&lt;p&gt;An in-progress patch of the avro validators and some tagged writing facilities.&lt;/p&gt;</comment>
                            <comment id="13623896" author="scott_carey" created="Fri, 5 Apr 2013 18:21:35 +0000"  >&lt;p&gt;My current approach to the validators is in the most recent patch (plus in progress work on writing avro messages tagged with an id prefix to a byte[]).&lt;/p&gt;

&lt;p&gt;On the validators, I am relativelly happy with them, but I have modified other code to do the &quot;Can I read Schema X with Schema Y&quot; work, and that is not well tested and based on an assumption of how the ResolvingGrammarGenerator works.&lt;/p&gt;

&lt;p&gt;We may want to move that portion of the work into another ticket and commit it first.  I&apos;ll attach one more patch with the work I did to support this.&lt;/p&gt;</comment>
                            <comment id="13623900" author="scott_carey" created="Fri, 5 Apr 2013 18:26:20 +0000"  >&lt;p&gt;This patch adds &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasErrors(Symbol symbol) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to Symbol.java.  This seems to work but this may not be the best place for this code.  It re-uses the ResolvingGrammarGenerator but perhaps instead we could make a version of that that fails fast rather than inserting error symbols.  Lazy errors are nice in case your data doesn&apos;t trigger them, but in this case we want to know if there are any errors possible.&lt;/p&gt;</comment>
                            <comment id="13637642" author="kryzthov" created="Sun, 21 Apr 2013 20:40:32 +0000"  >&lt;p&gt;Hey Scott,&lt;/p&gt;

&lt;p&gt;This patch is very promising. I believe I can fairly quickly provide an HBase storage, based on what we already have in Kiji.&lt;br/&gt;
I have a few questions below.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It seems to me that validators should not be tied to the repository server.&lt;br/&gt;
   I may want to use validators in a different context.&lt;br/&gt;
   Could they be introduced independently in a separate change?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Can I add metadata to the schema entries?&lt;br/&gt;
   I&apos;d need this to add a custom ID for a schema (I assume the existing schema entry ID is opaque and not to be interpreted).&lt;br/&gt;
   I might want to keep track of when the schema was added and by who, etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A Subject is currently a monotonically increasing ordered list of schemas.&lt;br/&gt;
   In some circumstances, I may want to remove a schema from a subject.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Can I change the validator of a subject (eg. to relax/tighten the constraints on a subject)?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13638447" author="scott_carey" created="Mon, 22 Apr 2013 21:27:16 +0000"  >&lt;ul&gt;
	&lt;li&gt;Validators outside of the repository.  I agree, I&apos;ll look at how we can separate them out.  There are a few parts to them &amp;#8211; the pure string validators that are tied to the repository and the Avro logic for representing various forms of validation.  I&apos;ll think about how to separate the avro logic to be more consumable outside the repository.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Schema entry metadata &amp;#8211; I had not thought of this.  It poses some challenges and questions.  Is it immutable?  Is the metadata essentially another Map&amp;lt;String, String&amp;gt; or more complicated?  Immutable data can be cached, but must be set when the schema is registered.  That opens up other issues related to race conditions on registration or modification.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Removing a Schema &amp;#8211; this introduces major issues with caching.  How would one signal to all clients that a schema has been removed?  Or is it ok if clients have an old mapping?  If these are expected to be very rare, I suggest that they are handled not by the Repository API but by an individual implementation (e.g. Postgres, HBase, File) and require a restart of clients.    If it is OK that clients cache old entries, then it may work out OK in the API as long as the back-end repositories &apos;tombstone&apos; the ID to prevent it from getting reassigned to a new schema.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Changing the validator of a subject is something we should support.  Only the back-end &apos;physical&apos; implementations of the repository actually validate, the others delegate.  As long as there is not an attempt to apply validation at an intermediate level this should be safe.  One question related to this:  do we want to attempt to run the new validator on the existing schemas (in order) or only apply it to future attempts to add schemas to a subject?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13646008" author="kryzthov" created="Tue, 30 Apr 2013 21:31:12 +0000"  >&lt;ul&gt;
	&lt;li&gt;schema entry metadata: what you suggest seems appropriate, I believe an immutable Map&amp;lt;String,String&amp;gt; is good enough; mutable data associated with a schema should probably be handled externally.&lt;/li&gt;
	&lt;li&gt;removing a schema: subjects are mutable, as monotonically growing lists of schemas. Does the caching layer already handle such subject updates?&lt;/li&gt;
	&lt;li&gt;updating the validator: it feels to me that the validator should always successfully run on the existing list of schemas in a subject. If the validator is &quot;last 3 schemas must be backward and forward compatible&quot;, as a user of the subject, I may assume the currently existing last 3 schemas are backward and forward compatible.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13646203" author="scott_carey" created="Wed, 1 May 2013 00:22:03 +0000"  >&lt;ul&gt;
	&lt;li&gt;schema metadata:  There is one race condition to consider &amp;#8211; currently subject.register(foo) is idempotent and also never fails unless there is a schema validation failure. Two users simultaneously registering the same schema end up with the same schema/id pair &amp;#8211; both fail or both succeed and get the same result.  If we tag metadata along with it, then two concurrent registrations with the same schema but different metadata might occur.  The actions are still idempotent and the two users get the same result, but only one will have the metadata expected set.  I will still have register() never fail outside of validation, but the schema metadata is not guaranteed to be what the user requested when there is a race condition &amp;#8211; the same thing happens with subject creation now.  If metadata is immutable, it can be cached and part of the SchemaEntry.  If it is not, it will need to be uncached or have a TTL, the latter I would like to avoid due to complexity.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;In a subject, schema/id pairs are only added.   The caching layer is free to assume that once an id/schema relation exists, it will forever, there is no propagation of updates.  This is the sane thing to do &amp;#8211; once a datum has been written with an id, the schema tied to that key should be kept forever.  If a schema could be removed, we would need to check the repository for every record or have a TTL in the cache.   It would be easier to support &apos;deactivating&apos; a schema/id pair so that it is not returned when scanning all the active schemas in a subject, or with validation, but can still be found by looking it up.   Can you describe the use case for deleting a schema?  Under what conditions would you want to do so?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1315&lt;/a&gt; to cover the avro schema validation components that live outside of the repo projects.  Please provide feedback, Thanks!&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13647176" author="kryzthov" created="Thu, 2 May 2013 01:42:37 +0000"  >&lt;ul&gt;
	&lt;li&gt;schema metadata: I believe the race condition is avoidable if I use registerIfLatest(). Am I correct here?&lt;/li&gt;
	&lt;li&gt;deleting a schema from a subject: the use-case is, I want to enforce some level of compatibility on all the schemas in a subject; at some point I realize one schema in the subject prevents me from moving forward in a sane way; I don&apos;t want to relax the compatibility constraint, but I am willing to actively deprecated this one schema (eg. by rewriting the records according to another schema from the subject), so that I can exclude this schema from the validation. The schema does not necessarily need to disappear from the subject, it may stay there, but I want to exclude it from the validation check. Does this make sense?&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt;: awesome, I&apos;ll check this tonight or tomorrow!&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13742372" author="davelatham" created="Fri, 16 Aug 2013 16:38:59 +0000"  >&lt;p&gt;Is anyone still pushing on this one?&lt;/p&gt;

&lt;p&gt;One question for those using incremental IDs.  Do you ever move serialized data from one environment to another, and if so do those environments each have their own schema registry or is there a shared one?  It seems if each environment has its own schema registry then data may not be portable if the assigned ID sequence was not identical in each environment.&lt;/p&gt;</comment>
                            <comment id="13742596" author="scott_carey" created="Fri, 16 Aug 2013 20:57:00 +0000"  >&lt;p&gt;Yes.  I have quite a bit of work outstanding on this to finish and submit for review.  But I&apos;ll be on vacation for 2 weeks.&lt;/p&gt;

&lt;p&gt;Re: Incremental ids:&lt;/p&gt;

&lt;p&gt;The ids don&apos;t have to be incremental, that is an option that is up to the repository implementation.  They can also be an arbitrary string.&lt;/p&gt;

&lt;p&gt;Your repositories probably will not map directly to environments, but to the data.  If you are sharing data across environments, you will share repositories (or clone them) with the data.&lt;/p&gt;</comment>
                            <comment id="13742619" author="davelatham" created="Fri, 16 Aug 2013 21:33:29 +0000"  >&lt;p&gt;Thanks for the update, Scott.  I&apos;m excited to see this work get in, it looks great.&lt;/p&gt;

&lt;p&gt;I realize the IDs are pluggable, but I would love to avoid 8 byte+ overhead, especially for small records, so I was considering the incrementing IDs.  However, this portability issue occurred to me so I was curious to hear if those already using an incremental ID had dealt with it.&lt;/p&gt;

&lt;p&gt;We envision having a schema registry running in each environment alongside the other services we provide there.  I.e. one in production, one in staging, one in each development or integration environment.  Then the applications could talk to the registry in their environment.  I&apos;d be nervous having a shared service that production, staging, integration and development environments are all using.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt; If you are sharing data across environments, you will share repositories (or clone them) with the data.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That sounds reasonable, unless you&apos;re adding data to an environment that has already mapped the same IDs to different versions of the schema.&lt;/p&gt;

&lt;p&gt;What about another possibility of having a schema ID directly as a metadata entry in the schema?  Then perhaps the build system could be increment it whenever the schema is revved.  &lt;/p&gt;</comment>
                            <comment id="13742628" author="scott_carey" created="Fri, 16 Aug 2013 21:42:25 +0000"  >&lt;p&gt;Schema id generation pluggable, so there are many options.  The &lt;em&gt;only&lt;/em&gt; requirement is that within a subject ids are unique and correspond to unique schemas.&lt;/p&gt;

&lt;p&gt;We also have staging/prod/qa/dev environments.  There is a repo for each, but when qa gets its data snapshot from prod, we also clone the repo.  &lt;/p&gt;

&lt;p&gt;For dev/staging, we have a kafka mirror that is exactly the production data.  Both of these environments access the prod repo read-only.  In fact, even in production, most subjects are read-only to all applications.  Operations has to add a new schemas for a release.  This is akin to operations executing SQL scripts to do DDL prior to a code push.  Having applicaitons &apos;automagically&apos; update sql schemas or push avro schemas can lead to accidents, unless the security model is implemented properly.&lt;/p&gt;
</comment>
                            <comment id="13779650" author="felixgv" created="Fri, 27 Sep 2013 04:29:01 +0000"  >&lt;p&gt;Hi Scott,&lt;/p&gt;

&lt;p&gt;A little bump for this ticket &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve been able to apply the April 1st 2013 patch on top of the 1.7.5 avro release after doing some minor tweaks. I&apos;ve then been able to get the shaded jar located at bundle/target/avro-repo-bundle-1.7.5-withdeps.jar running.&lt;/p&gt;

&lt;p&gt;I&apos;m wondering if I should also apply the two April 5th patches, and possibly the &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt; patch as well, on top of all that? It&apos;d be nice to get this committed into trunk (or into a development branch) sooner than later, like Doug initially suggested, so we don&apos;t have to mess around with several patch files which end up breaking on the tip of the trunk as avro releases move forward.&lt;/p&gt;

&lt;p&gt;I&apos;ll be looking into integrating the usage of the schema repo into our various Kafka publishers and consumers over the next little while. I&apos;d be curious to know how stable you think the current API is?&lt;/p&gt;

&lt;p&gt;Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; !&lt;/p&gt;</comment>
                            <comment id="13802379" author="davelatham" created="Tue, 22 Oct 2013 22:48:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; Mind sharing your tweaks or updates?  I&apos;m also looking to get this available, even if it doesn&apos;t have the automatic validation yet.&lt;/p&gt;</comment>
                            <comment id="13827415" author="scott_carey" created="Wed, 20 Nov 2013 07:49:26 +0000"  >&lt;p&gt;All:&lt;br/&gt;
I apologize for the long delay.  &lt;/p&gt;

&lt;p&gt;What we have used in production for about a year is very close to what has been in this ticket the whole time.  I have never considered it complete for a few reasons.&lt;/p&gt;

&lt;p&gt;I have been &quot;close&quot; to done with this for some time now but swamped by other responsibilities and what is currently in use has been good enough for now, but it won&apos;t be for long.   &lt;br/&gt;
The latest changes however, would significantly impact some of the API with respect to how the schema repo manages validation and compatibility.  This would be significantly more flexible for interfacing with other systems.&lt;/p&gt;

&lt;p&gt;It boils down to the following observation:&lt;/p&gt;

&lt;p&gt;It appears that all notions of schema compatibility share a common form.  The previously discussed &quot;forwards compatible&quot; or &quot;N + 1&quot; compatibility are all flavors of the same set of constraints. &lt;/p&gt;

&lt;p&gt;In any set of schemas you wish to consider for compatibility (a &quot;Subject&quot; here), at any given time you have a subset of these schemas that you wish to be able to read with, a subset you must be able to read from.  You may have some that you neither wish to read from or write to but must keep the mapping of the id.&lt;/p&gt;

&lt;p&gt;The way to represent this is to have a &quot;read&quot; state  and a &quot;write&quot; state per schema in the subject.&lt;br/&gt;
The read state has two possible values, naming help needed:   &quot;reader&quot;, &quot;not_readable&quot; &lt;br/&gt;
The write state has three possible values, naming help needed:,  &quot;writer&quot;, &quot;written&quot;, &quot;not_writable&quot;&lt;/p&gt;

&lt;p&gt;The constraint of the system is that all &quot;reader&quot; schemas can read all &quot;writer&quot; and &quot;written&quot; schemas, per subject.  A schema can transition either state, one at a time, leading to pair-wise testing of &quot;schema X can read Y&quot;:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;A schema transition from &quot;not_readable&quot; to &quot;reader&quot; succeeds only if it can read all schemas that are currently &quot;writer&quot; and &quot;written&quot;.&lt;/li&gt;
	&lt;li&gt;A schema transition from &quot;reader&quot; to &quot;not_readable&quot; requires no pairwise schema validation, but some other pluggable validation may apply.&lt;/li&gt;
	&lt;li&gt;A schema transition from &quot;not_writable&quot; to &quot;writer&quot; or &quot;written&quot; requires pairwise validation that that schema can be ready by all current &quot;reader&quot; schemas.&lt;/li&gt;
	&lt;li&gt;A all other schema write state transitions do not require pair-wise schema validation, but other pluggable validation may apply.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The write state has three possibilities because it is important to differentiate between the case where you allow new records of this type to be written (&quot;writer&quot;) from one where you wish no new records to be written, but the data store still has values with the schema present (&quot;written&quot;). &lt;/p&gt;

&lt;p&gt;Every compatibility scheme can fit in the above.  Single-reader, multiple writer.   Single writer, multiple reader.    N+-1 compatibility.  Full cross-compatibility.   The above is significantly more flexible than the early proposals on this topic, but will require changes to the REST interface.   Loading data from the old, into the new, will be fairly simple however &amp;#8211; some curl commands and bash scripts will do it.&lt;/p&gt;


&lt;p&gt;, and enforce the constraint that all schemas that have their &quot;can read with&quot; state set must be able to read all schemas that have their write state in &quot;can write with&quot; or &quot;must be able to read&quot;&lt;/p&gt;</comment>
                            <comment id="13868292" author="herriojr" created="Fri, 10 Jan 2014 21:00:42 +0000"  >&lt;p&gt;Maybe I am missing something, but stated in the original ticket it read that the RepositoryServer should be load balanced.  The thing that appears to be an issue for me, but maybe I have a misunderstanding, is that each Producer must register the schemas it is using with the SchemaRepository.  If this is true, and the RepositoryServer is load balanced, it means schema IDs will slowly diverge between RepositoryServers if an increment count is used for IDs.  This issue is solved with MD5s, which is what you stated as being done at LinkedIn.&lt;/p&gt;

&lt;p&gt;Another issue I foresee is if load balanced, and that particular schema only got registered with one instance of the RepositoryServer but not with another instance, and the Consumer asks the server it hasn&apos;t been registered with, then it will fail.  How do you guys manage or mitigate these risks?  Do you first run something to register schemas with all RepositoryServers?  Does the job just get processed again and &lt;b&gt;hope&lt;/b&gt; that it doesn&apos;t hit the same RepositoryServer again?&lt;/p&gt;</comment>
                            <comment id="13868379" author="herriojr" created="Fri, 10 Jan 2014 22:07:32 +0000"  >&lt;p&gt;Ah, I missed the part about the pluggable key value store, so the onus is put on another technology to handle the consistency and the Repository just needs to handle the distribution.&lt;/p&gt;</comment>
                            <comment id="13887542" author="felixgv" created="Fri, 31 Jan 2014 07:19:29 +0000"  >&lt;p&gt;Getting back into this after getting pulled into other projects for a while...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davelatham&quot; class=&quot;user-hover&quot; rel=&quot;davelatham&quot;&gt;Dave Latham&lt;/a&gt;, I imagine you probably figured this out on your own by now (sorry for not replying earlier), but in case it can help you or anyone else, here&apos;s a GitHub repo containing the release of Avro 1.7.5 with the 01/Apr/13 patch applied onto it and small tweaks so that the build works: &lt;a href=&quot;https://github.com/mate1/avro/tree/release-1.7.5-with-AVRO-1124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/mate1/avro/tree/release-1.7.5-with-AVRO-1124&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To everyone else, I&apos;d like to get your thoughts on something.&lt;/p&gt;

&lt;p&gt;There are certain avro schemas that we use across many Kafka topics (1:M relationship between schema and topics). I would like to benefit from the facilitated evolution capabilities of the schema repo, but I&apos;m not 100% sure of the best way to proceed. I would like to avoid:&lt;/p&gt;

&lt;p&gt;1. Having to register the same schema (and each further schema evolutions) into many subjects.&lt;br/&gt;
2. Having to externally manage a mapping of &quot;Kafka topic&quot; =&amp;gt; &quot;subject registered into the repo&quot;.&lt;/p&gt;

&lt;p&gt;I have considered prefixing each of my Kafka message payloads with not just the writer&apos;s schema ID, but also a subject ID, but I have though of many caveats to this approach, which are probably not worth enumerating here, for the sake of brevity.&lt;/p&gt;

&lt;p&gt;Another possibility would be to introduce the concept of a SubjectAlias. The way it would work is that you would register a SubjectAlias with an aliasName and a targetName. If the aliasName already exists, or if the targetName does not exist, the operation would fail. Afterwards, any lookup for the aliasName would return a DelegatingSubject containing the Subject referenced by the targetName of the alias that was looked up.&lt;/p&gt;

&lt;p&gt;This change seems clean and not too intrusive, and also wouldn&apos;t require encoding both subject ID and schema ID in my message payloads. But perhaps there are problems to this approach that I haven&apos;t thought of.&lt;/p&gt;

&lt;p&gt;Do you think this approach makes sense? And would it be worth contributing back into the main schema repo code?&lt;/p&gt;

&lt;p&gt;Is this (multiple topics sharing a single set of compatible schemas) something that other organizations have had to deal with?&lt;/p&gt;

&lt;p&gt;Hopefully I&apos;ve properly explained what I&apos;m trying to achieve. All feedback would be appreciated! Thanks (:&lt;/p&gt;</comment>
                            <comment id="13931061" author="felixgv" created="Tue, 11 Mar 2014 22:24:47 +0000"  >&lt;p&gt;Hi everyone,&lt;/p&gt;

&lt;p&gt;Integrating this schema repo in our stack has been a back-burner project of mine for a while now, so I haven&apos;t been able to make progress as fast as I wanted. Anyway, I finally found some time to get back into it again.&lt;/p&gt;

&lt;p&gt;I have a question: Why is this project completely serialization-agnostic? I understand that there is value in having a general solution, but it seems like it would be useful to have a standard Avro-specific implementation, at least on the client-side. Basically, something like what Camus is doing here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/linkedin/camus/blob/master/camus-schema-registry-avro/src/main/java/com/linkedin/camus/schemaregistry/AvroRestSchemaRegistry.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/linkedin/camus/blob/master/camus-schema-registry-avro/src/main/java/com/linkedin/camus/schemaregistry/AvroRestSchemaRegistry.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/linkedin/camus/blob/master/camus-api/src/main/java/com/linkedin/camus/schemaregistry/SchemaRegistry.java?source=c&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/linkedin/camus/blob/master/camus-api/src/main/java/com/linkedin/camus/schemaregistry/SchemaRegistry.java?source=c&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It&apos;s very simple, but it seems like the type of stuff that every project would need to re-implement on their own. Of course, you could use the schema repo code provided here as is if you&apos;re okay with re-parsing the Avro Schema on every invocation of the repository, but that seems pretty wasteful, especially in high-throughput environments...&lt;/p&gt;

&lt;p&gt;Would there be any desire to integrate this kind of Avro-specific wrapper for the caching client implementation?&lt;/p&gt;</comment>
                            <comment id="14025652" author="flangelier" created="Mon, 9 Jun 2014 19:54:17 +0000"  >&lt;p&gt;Hi guys!&lt;/p&gt;

&lt;p&gt;If I want to use the repository, what patches are useful?&lt;br/&gt;
1--&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;.patch 01/Apr/13 18:52 &lt;br/&gt;
2--&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;.patch 26/Nov/12 20:32&lt;br/&gt;
3--&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;-can-read-with.patch 05/Apr/13 14:26&lt;br/&gt;
4--&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;-draft.patch 31/Aug/12 20:00&lt;br/&gt;
5--&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;-validators-preliminary.patch 05/Apr/13 14:18&lt;/p&gt;

&lt;p&gt;From what I understand, &lt;br/&gt;
    1 is the newest version of 2, so 2 is useless/deprecated? &lt;br/&gt;
    3 is also in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt; so useless too since I&apos;m using &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
    4 is a draft&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; so deprecated too?&lt;br/&gt;
    5 is some validators so that one is useful?&lt;/p&gt;

&lt;p&gt;So I should need 1, 5 and &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt;??&lt;/p&gt;

&lt;p&gt;Thank for your help!&lt;/p&gt;
</comment>
                            <comment id="14043745" author="thunderstumpges" created="Wed, 25 Jun 2014 17:00:04 +0000"  >&lt;p&gt;Hi Francois, I noticed you applied these patches, and the code tweaks from Felix in mate1/release-1.7.5-with-&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;. I was able to pull and build it perfectly. Thanks a lot!&lt;/p&gt;

&lt;p&gt;For others, here&apos;s the branch from trunk with patches for both &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt; applied:&lt;br/&gt;
&lt;a href=&quot;https://github.com/mate1/avro/tree/from-98ec5f2a172391cb5dfa7b4d85f39065bae22754-with-AVRO-1315-and-AVRO-1124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/mate1/avro/tree/from-98ec5f2a172391cb5dfa7b4d85f39065bae22754-with-AVRO-1315-and-AVRO-1124&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BTW, are we expecting &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt; to end up in an &apos;official&apos; AVRO release or will this constantly be an open issue with a set of patches? I don&apos;t necessarily mind this way; we have figured it out and gotten it working. I&apos;m just curious what the end plan is for it. I&apos;d be glad to help out in whatever way I can.&lt;/p&gt;

&lt;p&gt;Thanks again everyone.&lt;br/&gt;
Thunder&lt;/p&gt;</comment>
                            <comment id="14043777" author="thunderstumpges" created="Wed, 25 Jun 2014 17:21:38 +0000"  >&lt;p&gt;Hi Felix, was just reading through comments, and saw this from you. We are going through the exact same thing right now as well.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are certain avro schemas that we use across many Kafka topics (1:M relationship between schema and topics). I would like to benefit from the facilitated evolution capabilities of the schema repo, but I&apos;m not 100% sure of the best way to proceed. I would like to avoid:&lt;br/&gt;
1. Having to register the same schema (and each further schema evolutions) into many subjects.&lt;br/&gt;
2. Having to externally manage a mapping of &quot;Kafka topic&quot; =&amp;gt; &quot;subject registered into the repo&quot;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We also are trying to avoid this. We are currently planning to take a topic naming convention approach where we combine the subject name (avro class FQN) with a &quot;topic suffix&quot; when naming our topic. So a topic would be named: &apos;&amp;lt;subject_name&amp;gt;--&amp;lt;topic_suffix&amp;gt;&apos; where we don&apos;t use the &amp;#8211; delimeter in either subject name or suffix. I think this avoids both of the above issues, as well as not requiring each message to have a subject ID. It does however add complexity to all consumers on how to &quot;parse&quot; topic names.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Another possibility would be to introduce the concept of a SubjectAlias. The way it would work is that you would register a SubjectAlias with an aliasName and a targetName. If the aliasName already exists, or if the targetName does not exist, the operation would fail. Afterwards, any lookup for the aliasName would return a DelegatingSubject containing the Subject referenced by the targetName of the alias that was looked up.&lt;br/&gt;
This change seems clean and not too intrusive, and also wouldn&apos;t require encoding both subject ID and schema ID in my message payloads. But perhaps there are problems to this approach that I haven&apos;t thought of.&lt;br/&gt;
Do you think this approach makes sense? And would it be worth contributing back into the main schema repo code?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this would be a fine approach, and that would simplify our kafka consumers to not need to &quot;understand&quot; the convention we came up with. It would also free you to use any convenient topic name for any subject schema without having to adhere to that convention on naming. &lt;br/&gt;
Have you had any progress or other thoughts on this issue since January? I realize I&apos;m a little late to the party &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Thunder&lt;/p&gt;
</comment>
                            <comment id="14043801" author="felixgv" created="Wed, 25 Jun 2014 17:40:28 +0000"  >&lt;p&gt;Hi Thunder,&lt;/p&gt;

&lt;p&gt;Disclaimer: I don&apos;t work for Mate1 anymore, so what I&apos;m going to say might be out of date by now. The Mate1 guys will need to chime in for the latest state of their work on this...&lt;/p&gt;

&lt;p&gt;I did not end up coding SubjectAliases into Avro proper because there didn&apos;t seem to be any interest from the OSS community and I had limited time to build this completely generically.&lt;/p&gt;

&lt;p&gt;Mate1 had a strategy that is kind of similar to the one you&apos;re describing. We had arbitrary topic names, which could be dynamically appended with certain suffixes (like &quot;_&lt;em&gt;PROCESSING_FAILURE&quot;, &quot;&lt;/em&gt;_DECODING_FAILURE&quot; or whatever). Those dynamically created topics could then be re-processed later on, as convenient, and would contain the same schema as the topic they derived from.&lt;/p&gt;

&lt;p&gt;In our Camus decoders, we hard-coded some topic alias resolution right there in the code (since the amount of suffixes was limited in our case). There were talks of porting that topic alias resolution logic to our schema-repo-client implementation ( &lt;a href=&quot;https://github.com/mate1/schema-repo-client/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/mate1/schema-repo-client/&lt;/a&gt; ), so that it is more conveniently available to all Kafka consumers (not just Camus), but that didn&apos;t end up happening before I left. So essentially, we went for option 2, above. For an organization that has more numerous/diverse suffixes, that strategy would probably not be ideal, but for small amounts of suffixes (or prefixes), it was deemed acceptable.&lt;/p&gt;

&lt;p&gt;Hopefully, that sheds some light (:&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14044190" author="cutting" created="Wed, 25 Jun 2014 23:47:53 +0000"  >&lt;p&gt;&amp;gt; BTW, are we expecting &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt; to end up in an &apos;official&apos; AVRO release or will this constantly be an open issue with a set of patches?&lt;/p&gt;

&lt;p&gt;I&apos;d love to see this in a release sooner rather than later.  Since it&apos;s new functionality there should be no compatibility issues.  All it takes is someone to declare a particular patch ready to be committed, and for one or more other folks to endorse that.  We also need to have some confidence that, even if it&apos;s incomplete, the public APIs it exposes can be supported compatibly as functionality is improved.&lt;/p&gt;</comment>
                            <comment id="14052143" author="gwenshap" created="Fri, 4 Jul 2014 03:59:32 +0000"  >&lt;p&gt;The patch from April 1st (I think its the latest) seems based on Avro 1.7.5, it will need a rebase on Trunk. I think its just a matter of merging pom.xml.&lt;/p&gt;
</comment>
                            <comment id="14052149" author="felixgv" created="Fri, 4 Jul 2014 04:21:24 +0000"  >&lt;p&gt;Watch out. The April 1st 2013 patch has a bug in the file-based repo where multi-line schemas get all lines dropped beyond the first one.&lt;/p&gt;

&lt;p&gt;This bug is fixed (and unit-tested) in the Mate1 GitHub repo posted above, so I&apos;d advise creating the next patch off of that. The pom files probably need to be modified either way.&lt;/p&gt;</comment>
                            <comment id="14052737" author="gwenshap" created="Sat, 5 Jul 2014 00:33:52 +0000"  >&lt;p&gt;Felix, thanks for the headsup.&lt;/p&gt;

&lt;p&gt;I&apos;m trying to pluck a patch out of the Mate1 repo, but it looks like there&apos;s no clean commit of just the Repo patch, its mixed with other stuff?&lt;/p&gt;

&lt;p&gt;If I&apos;m wrong, please tell me which Mate1 commit to use for the diffing. &lt;br/&gt;
Otherwise, I&apos;ll rebase the April 1 patch and try to selectively apply later Mate1 fixes on top.&lt;/p&gt;</comment>
                            <comment id="14052742" author="gwenshap" created="Sat, 5 Jul 2014 01:10:57 +0000"  >&lt;p&gt;Felix and others interested. More questions:&lt;/p&gt;

&lt;p&gt;1. There was a lot of discussion on the implementation of &quot;schema includes&quot; (i.e. imports) within the repo. It looks like it was never implemented. That is, there&apos;s nothing here that will support compilation of schemas where I refer to a repo+subject when importing another schema. Correct? am I missing anything?&lt;/p&gt;

&lt;p&gt;2. I&apos;d like to rebase and nag everyone for commit, but without the additional validator patch. There was a lot of discussion around validators, it doesn&apos;t look like it ever got resolved, and I don&apos;t see it as mandatory going forward. &lt;/p&gt;

&lt;p&gt;Does that make sense? Was validation issue actually resolved somewhere and I missed that? Is validation super essential?&lt;/p&gt;

&lt;p&gt;If we decide to go forward with no validation, I&apos;ll remove the promise of validation from the registration API. We can always add &quot;registerWithValidation&quot; later for those who like safety.&lt;/p&gt;

&lt;p&gt;3. Few Jiras will probably need to be opened immediately when committing. The first is to add a user-guide &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14052760" author="felixgv" created="Sat, 5 Jul 2014 02:19:48 +0000"  >&lt;p&gt;Hi Gwen,&lt;/p&gt;

&lt;p&gt;I don&apos;t think that there is a single commit in the Mate1 GH repo that atomically contains everything we need (if that is even what you&apos;re looking for... not 100% sure I understood your request correctly). If you want to rebuild the patched Avro repo yourself, then this is the (atomic) commit that contains the multi-line fix I was talking about: &lt;a href=&quot;https://github.com/mate1/avro/commit/a3960590177e08b3586584cf288b1d4ba9ca1572&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/mate1/avro/commit/a3960590177e08b3586584cf288b1d4ba9ca1572&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively, I&apos;ve put together a branch that contains the very latest trunk (as it was on the GH mirror, a few minutes ago), with the M1 fixes on top: &lt;a href=&quot;https://github.com/FelixGV/avro/tree/AVRO-1124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/FelixGV/avro/tree/AVRO-1124&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;From that branch, I can create a patch against trunk using `git diff trunk &amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;.patch` (which results in this: &lt;a href=&quot;https://gist.github.com/FelixGV/7f0978dfa90fe4430c24&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gist.github.com/FelixGV/7f0978dfa90fe4430c24&lt;/a&gt; ), but that&apos;s not the precise format Apache wants (Apache wants the svn diff...). I don&apos;t have time to fiddle with this right now, but maybe you know how to generate the patch properly?&lt;/p&gt;

&lt;p&gt;On to your other points:&lt;/p&gt;

&lt;p&gt;1. Imports are not supported. The recommended way of using the repo is to flatten schemas so that nested schemas are completely contained in their parent schemas.&lt;/p&gt;

&lt;p&gt;2. I think adding validators later on does not break the contract of the current register APIs. Validators should be pluggable and the register API should be allowed to fail for arbitrary reasons (i.e.: validators could be tied to custom in-house policies for schemas, not just backward/forward compatibility). Validation is important, but I think there is still value in releasing the repo without any built-in validators in the first release.&lt;/p&gt;

&lt;p&gt;3. Agreed.&lt;/p&gt;</comment>
                            <comment id="14052772" author="gwenshap" created="Sat, 5 Jul 2014 03:51:50 +0000"  >&lt;p&gt;Took Felix&apos;s gist, applied on clean checkout of Trunk (no conflicts).&lt;br/&gt;
Created an SVN patch and attaching it here.&lt;/p&gt;

&lt;p&gt;I haven&apos;t tested functionality yet, except making sure the project still builds and unit tests pass.&lt;/p&gt;

&lt;p&gt;However, considering that its:&lt;br/&gt;
1) All new code, therefore no risk of regression&lt;br/&gt;
2) There&apos;s wide agreement that the API is reasonable (evidenced by the fact that multiple organizations currently using it)&lt;br/&gt;
3) After 2 years of discussing and using the code we haven&apos;t found a single reason to make non-compatible API change&lt;/p&gt;

&lt;p&gt;I recommend committing it, and continuing the improvements in separate issues.&lt;/p&gt;

&lt;p&gt;Felix, please double check that I didn&apos;t drop anything on the floor by mistake and do another +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14053058" author="felixgv" created="Sun, 6 Jul 2014 07:21:39 +0000"  >&lt;p&gt;Hi Gwen,&lt;/p&gt;

&lt;p&gt;Your latest patch looks good to me. I suspect I might not be entitled to say +1, but if I am, then +1.&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14053169" author="kryzthov" created="Sun, 6 Jul 2014 18:05:15 +0000"  >&lt;p&gt;From a brief look, patch looks fine.&lt;br/&gt;
Should we get rid of:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;./server/src/main/java/org/apache/avro/repo/server/RepositoryServer.java:88: sleep(3000); &lt;span class=&quot;code-comment&quot;&gt;//TODO DELETE!!! FOR DEBUG ONLY&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Regarding new validators :&lt;br/&gt;
From what I understand, the interfaces in this patch provide a model where one can validate a sequence (timeline) of Avro schemas.&lt;br/&gt;
Do you think this could later be extended to support a model where a subject manages a set of reader schemas validated against a set of writer schemas instead (with no notion of backward/forward)?&lt;/p&gt;</comment>
                            <comment id="14053176" author="gwenshap" created="Sun, 6 Jul 2014 18:41:55 +0000"  >&lt;p&gt;LOL, good catch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kryzthov&quot; class=&quot;user-hover&quot; rel=&quot;kryzthov&quot;&gt;Christophe Taton&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There&apos;s a lot of discussion about different notions of compatibility, but the interface simply requires implementing:&lt;/p&gt;

&lt;p&gt;  void validate(String schemaToValidate, Iterable&amp;lt;SchemaEntry&amp;gt; schemasInOrder)&lt;br/&gt;
      throws SchemaValidationException;&lt;/p&gt;

&lt;p&gt;This will allow you to validate a single schema against a set. Validating a set against another set seems like a fairly trivial extension. &lt;br/&gt;
Note that the repository doesn&apos;t have a notion of reader schema vs. writer schema. Is this something you need for your use-case?&lt;/p&gt;

&lt;p&gt;Note for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; and others:&lt;br/&gt;
The original issue (from Jay Kreps) discusses not just a repository, but supporting the use of repository identifier inside Avro serialization, instead of embedding the entire schema. The goal, as I understood it, was to support smaller objects with less overhead for streaming applications.&lt;br/&gt;
This patch only provides the repository, but each Avro object will continue to contain the entire schema. &lt;br/&gt;
We&apos;ll probably need another follow up issue for that.&lt;/p&gt;
</comment>
                            <comment id="14053213" author="kryzthov" created="Sun, 6 Jul 2014 19:59:29 +0000"  >&lt;p&gt;Compatibility between readers and writers is something we would indeed benefit from.&lt;/p&gt;

&lt;p&gt;A &lt;tt&gt;Subject&lt;/tt&gt; is currently defined as an ordered collection of mutually compatible Schemas, which is fairly restrictive and does not allow for deprecation/removal of schemas.&lt;br/&gt;
Supporting the reader/writer use-case requires dropping the &quot;mutually&quot; : some schemas may only be used for reading purposes, while others are or were used for writing purposes. The reader/writer use-case would also allow the removal of a schema from a Subject.&lt;/p&gt;

&lt;p&gt;By the way, I uploaded the patch on &lt;a href=&quot;https://reviews.apache.org/r/23293/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/23293/&lt;/a&gt; if folks want to look at the diff and comment more easily.&lt;/p&gt;</comment>
                            <comment id="14053223" author="felixgv" created="Sun, 6 Jul 2014 20:26:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt;, this patch is not the whole story. It is only the repo server and a basic client to interact with it. What&apos;s missing (at least, in open source, as I suspect everyone has their own custom internal implementation of this) is the versioned Avro encoders and decoders that make use of the schema repo under the hood, and provide easy to use APIs for dealing with it properly. I believe this functionality definitely deserves to be open sourced as well, but it could be done as later tickets...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kryzthov&quot; class=&quot;user-hover&quot; rel=&quot;kryzthov&quot;&gt;Christophe Taton&lt;/a&gt;, I think you&apos;re right that the use case you describe doesn&apos;t seem well supported at the moment in the current APIs. There are arbitrary key/value pairs that can attached to Subjects via their SubjectConfig (but not to individual SchemaEntries). This MIGHT be usable to maintain a list of deprecated/read-only IDs for a given Subject, in which case the validate function might need to be passed a reference to its Subject/Config. Or perhaps we should add explicit support for it, by adding new (specific or arbitrary) fields in the SchemaEntry class... Do you have a proposal of how the API should be extended to support this use case?&lt;/p&gt;

&lt;p&gt;One thing to keep in mind is that whatever data we choose to add needs to be supported by all Repo implementations (right now there is only file-based and in-memory, but still, it would be good to keep the data structures somewhat simple, so that we can easily add new storage implementations).&lt;/p&gt;</comment>
                            <comment id="14053685" author="tomwhite" created="Mon, 7 Jul 2014 14:12:46 +0000"  >&lt;p&gt;&amp;gt; Was validation issue actually resolved somewhere and I missed that?&lt;/p&gt;

&lt;p&gt;Yes, it was committed in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1315&quot; title=&quot;Java: Schema Validation utilities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1315&quot;&gt;&lt;del&gt;AVRO-1315&lt;/del&gt;&lt;/a&gt;. It was split out since it is more general than the repo service. The patch for this issue should be refactored to use those interfaces (should just be a package change).&lt;/p&gt;

&lt;p&gt;Also, I noticed that Gwen&apos;s latest patch changes Snappy Java 1.0.5 to 1.0.5-M3, which looks like a mistake (remnant from an earlier patch?).&lt;/p&gt;</comment>
                            <comment id="14055344" author="gwenshap" created="Tue, 8 Jul 2014 19:19:41 +0000"  >&lt;p&gt;Part of the API implemented in Mate1 patch is &quot;get ID by subject + schema&quot;. Reverse lookup of sorts.&lt;/p&gt;

&lt;p&gt;I want to remove support for this API.&lt;/p&gt;

&lt;p&gt;Reasons:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Current implementation does not work&lt;/li&gt;
	&lt;li&gt;I can&apos;t figure out why we&apos;ll need it&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We can add it later if turns out its actually important.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="14055346" author="gwenshap" created="Tue, 8 Jul 2014 19:21:17 +0000"  >&lt;p&gt;Never mind my previous comment. I thought it doesn&apos;t work - didn&apos;t notice its a POST rather than GET.&lt;/p&gt;</comment>
                            <comment id="14055363" author="felixgv" created="Tue, 8 Jul 2014 19:30:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;Tom White&lt;/a&gt; : the milestone snappy version does seem like a mistake.&lt;/p&gt;

&lt;p&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt; : that API definitely does work, and it&apos;s essential when using auto-incremented IDs, rather than schema hashes. You need it to know what ID to encode along with your payload on the publishing side of your pipeline. Schema hashes can instead be inferred, but have other tradeoffs (i.e.: size, collision, obfuscated ordering semantics).&lt;/p&gt;</comment>
                            <comment id="14055589" author="gwenshap" created="Tue, 8 Jul 2014 22:00:10 +0000"  >&lt;p&gt;Question for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=scott_carey&quot; class=&quot;user-hover&quot; rel=&quot;scott_carey&quot;&gt;Scott Carey&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;One of the APIs implemented is GET &lt;/p&gt;
{subject}
&lt;p&gt;/integralKeys&lt;/p&gt;

&lt;p&gt;Can you explain what are the integralKeys? &lt;br/&gt;
I see the setters and getters, but no documentations on how we expect to use them. &lt;/p&gt;</comment>
                            <comment id="14056354" author="gwenshap" created="Wed, 9 Jul 2014 15:39:19 +0000"  >&lt;p&gt;Attaching patch with correction to issues found by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kryzthov&quot; class=&quot;user-hover&quot; rel=&quot;kryzthov&quot;&gt;Christophe Taton&lt;/a&gt; (sleep statement left from debugging) and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tomwhite&quot; class=&quot;user-hover&quot; rel=&quot;tomwhite&quot;&gt;Tom White&lt;/a&gt; (wrong snappy dependency).&lt;/p&gt;</comment>
                            <comment id="14056544" author="felixgv" created="Wed, 9 Jul 2014 18:07:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Regarding integralKeys, there is an earlier comment from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=scott_carey&quot; class=&quot;user-hover&quot; rel=&quot;scott_carey&quot;&gt;Scott Carey&lt;/a&gt; in this thread which explains it:&lt;/p&gt;

&lt;p&gt;&quot;Lastly, I added a method to a Subject: &quot;boolean integralKeys()&quot; to indicate whether the keys generated by this subject can be expected to parse as an integer. This delegates all the way through to the backing store and is not configurable through the Repository/Subject API, since implementations of the backing store are what determines how keys are generated; the contract otherwise is merely that they are Strings and unique per subject.&quot;&lt;/p&gt;

&lt;p&gt;It would be good to include this in the javadoc of the Subject abstract class, because there currently seems to be no way of figuring this out from the code.&lt;/p&gt;

&lt;p&gt;For now, all provided Repo implementations are hard-coded to always return true on that function, so it is a bit pointless at the moment, but I think the API makes sense to have (especially in the context of supporting hash schemas for IDs, not just auto-incremented integers). What do you think? Should it be documented and left there, or removed for now?&lt;/p&gt;</comment>
                            <comment id="14059681" author="busbey" created="Sat, 12 Jul 2014 06:25:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt;, there&apos;s an unused static import of java.lang.Thread.sleep in schema-repo/server/src/main/java/org/apache/avro/repo/server/RepositoryServer.java that causes the audit check to fail.&lt;/p&gt;</comment>
                            <comment id="14059984" author="busbey" created="Sun, 13 Jul 2014 03:38:23 +0000"  >&lt;p&gt;I noticed that all of the Named injection points related to repository implementations are prefixed with &quot;avro.&quot; except for REPO_CLASS and REPO_CACHE in server/ConfigModule, was this intentional? The example configuration properties file (bundle/config/config.properties) also refers to them as &quot;avro.repo.class&quot; and &quot;avro.repo.cache&quot;, which causes it to not work.&lt;/p&gt;</comment>
                            <comment id="14127643" author="zolyfarkas" created="Tue, 9 Sep 2014 22:09:22 +0000"  >&lt;p&gt;Has anyone though about using a maven repo as a avro schema repository?&lt;/p&gt;

&lt;p&gt;It would be nice if a java project that is using a particular schema can simply add it as a &amp;lt;dependency&amp;gt;&lt;br/&gt;
Schema dependencies could be maintained nicely as well.  &lt;br/&gt;
(Schemas would be developed in a schema maven project, taking advantage of versioning, dependencies...)&lt;/p&gt;

&lt;p&gt;What about exposing this Schema Service also as a Maven Repo transparently?&lt;/p&gt;</comment>
                            <comment id="14165558" author="felixgv" created="Thu, 9 Oct 2014 18:59:13 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;Little update on this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt;: I added the javadoc for integralKeys. Also fixed some more javadoc that was outdated or missing, but I haven&apos;t checked everything, so it might need some more javadoc improvements still.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;: I removed the unused import and fixed the inconsistent config names. Thanks (:&lt;/p&gt;

&lt;p&gt;Besides that, I&apos;ve also added a (very terse) README and run script for launching the schema repo server.&lt;/p&gt;

&lt;p&gt;Attached is a new patch based off of 1.8.0-SNAPSHOT. Do you guys think this is good enough for committing into 1.8.0 ?&lt;/p&gt;

&lt;p&gt;If anyone is interested in an already patched git branch, I got these:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/FelixGV/avro/tree/release-1.7.7-with-AVRO-1124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/FelixGV/avro/tree/release-1.7.7-with-AVRO-1124&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/FelixGV/avro/tree/1.8.0-SNAPSHOT-with-AVRO-1124&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/FelixGV/avro/tree/1.8.0-SNAPSHOT-with-AVRO-1124&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-F&lt;/p&gt;</comment>
                            <comment id="14165649" author="felixgv" created="Thu, 9 Oct 2014 20:05:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zolyfarkas&quot; class=&quot;user-hover&quot; rel=&quot;zolyfarkas&quot;&gt;Zoltan Farkas&lt;/a&gt;, I don&apos;t think anyone suggested that yet. Are you saying every Avro record would be a different Maven artifact? In any medium- or large-size project, that would result in a huge number of artifacts, which would then result in huge dependency/build files. While it could work, I&apos;m not convinced that it&apos;s a sensible use of Maven.&lt;/p&gt;

&lt;p&gt;Let me know if that&apos;s not what you meant or if I&apos;m missing something.&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14165824" author="zolyfarkas" created="Thu, 9 Oct 2014 21:55:36 +0000"  >&lt;p&gt;Hi Felix.&lt;/p&gt;

&lt;p&gt;I agree, that versioning every avro record separately would not be practical. (although doable)&lt;br/&gt;
Let me give an example of how I envision this with a example for a rest service:&lt;/p&gt;

&lt;p&gt;/demo-service&lt;br/&gt;
  /demo-service-schema (versioned and released independently, will contain all avro schemas for this sample rest service)&lt;br/&gt;
  /demo-service-server (depends on schema)&lt;br/&gt;
 ....&lt;br/&gt;
/other-app (depends on schema)&lt;/p&gt;

&lt;p&gt;All schemas will reside in the demo-service-schema project and will be built and versioned as a standard maven project. (together)&lt;br/&gt;
schemas in demo-service-schema can depend on other schemas in other &quot;schema projects&quot; and this will be described with the maven dependency mechanism.&lt;/p&gt;

&lt;p&gt;Part of this &quot;schema build&quot; the java, c# record classes are generated, and the schema files are packaged and everything uploaded to maven repository. &lt;/p&gt;

&lt;p&gt;I managed to get this running without creating any special maven plugin... But I can see handy having an specialized plugin to verify schema compatibilities, enforce doc fields to be present...&lt;/p&gt;

&lt;p&gt;I also wrote a schema retrieval client that will retrieve any version of schema from a maven repository. &lt;br/&gt;
(with local persistent caching on the file system)&lt;/p&gt;

&lt;p&gt;Some advantages to this approach:&lt;br/&gt;
1) dependencies are clear, and easy to trace. (schemas are in one place, no more emailing around)&lt;br/&gt;
2) classes are generated once and reused by all projects.&lt;br/&gt;
3) version names are really whatever the dev wants, but major.minor works well&lt;br/&gt;
4) no custom service needed, just a plain apache server will do.&lt;br/&gt;
5) For in development schemas the maven SNAPSHOT fits pretty well&lt;/p&gt;

&lt;p&gt;let me know what you think.&lt;/p&gt;</comment>
                            <comment id="14165871" author="felixgv" created="Thu, 9 Oct 2014 22:21:53 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zolyfarkas&quot; class=&quot;user-hover&quot; rel=&quot;zolyfarkas&quot;&gt;Zoltan Farkas&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;I believe what you describe is a good solution for build management. In fact, I think lots of companies/projects already operate like this (minus the automated schema compatibility check, which could be handy to have as a maven task, indeed).&lt;/p&gt;

&lt;p&gt;I&apos;m not sure how related this is to the effort described in the current ticket, however. It may be orthogonal. I think the main goal of the schema repo is to provide easy access to sets of ID=&amp;gt;schema pairs grouped per subject and to act as a gatekeeper for the creation of these pairs. Lumping all schemas in one versioned artifact makes sense from a build perspective but seems inconvenient from a programmatic standpoint when fine-grained look-ups might be desired. Say, if project A wants to use v1 of topic_x and v2 of topic_y, whereas project B wants the opposite (v2 of topic_x and v1 of topic_y), how does that translate to the single big artifact Maven model? Can things easily evolve independently like this?&lt;/p&gt;

&lt;p&gt;That being said, I may not be grasping the value right now, but nothing prevents someone from taking this code and exposing a Maven-like HTTP interface form it, and/or using a real Maven repo as its backing storage implementation.&lt;/p&gt;</comment>
                            <comment id="14173820" author="zolyfarkas" created="Thu, 16 Oct 2014 14:40:45 +0000"  >&lt;p&gt;Hi Felix, it relates to this ticket by addressing the same motivation:&lt;br/&gt;
&quot;It is nice to be able to pass around data in serialized form but still know the exact schema that was used to serialize it.&quot;&lt;/p&gt;

&lt;p&gt;What we implemented is to send the version of the schema(maven version) along with the avro messages. (HTTP header)&lt;br/&gt;
at deserialization time this version is used to retrieve the writer schema from maven repo, without the need of a custom service.&lt;/p&gt;</comment>
                            <comment id="14173844" author="spullara" created="Thu, 16 Oct 2014 15:09:40 +0000"  >&lt;p&gt;You need a &quot;custom service&quot; because the client may not have the schema.&lt;br/&gt;
Sending the version is great if your client happens to have copies of all&lt;br/&gt;
of them. Without a service to vend those schemas though you can&apos;t send a&lt;br/&gt;
message to another service that doesn&apos;t have the latest ones yet.&lt;/p&gt;

&lt;p&gt;On Thu, Oct 16, 2014 at 7:41 AM, Zoltan Farkas (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14173861" author="zolyfarkas" created="Thu, 16 Oct 2014 15:28:32 +0000"  >&lt;p&gt;Hi Sam, &lt;br/&gt;
Yes you need a service, but that is what the maven repository is. (you can use nexus, artifactory or plain old apache HTTP)&lt;br/&gt;
as I said: &quot;at deserialization time this version is used to retrieve the writer schema from maven repo&quot;&lt;/p&gt;

&lt;p&gt;The client we implemented caches the schemas locally(persistent+ram) , but when a message is received with a version that it does not have, it will go to the maven repo and retrieve that schema, cache it and use it. &lt;/p&gt;</comment>
                            <comment id="14173867" author="spullara@gmail.com" created="Thu, 16 Oct 2014 15:37:41 +0000"  >&lt;p&gt;I would never use the maven repo from production. YMMV.&#160;    &lt;/p&gt;

&lt;p&gt;---Sent from Boxer | &lt;a href=&quot;http://getboxer.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://getboxer.com&lt;/a&gt;&lt;/p&gt;



&lt;p&gt;    [ &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=14173861#comment-14173861&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1124?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=14173861#comment-14173861&lt;/a&gt; ]  &lt;/p&gt;


&lt;p&gt;Zoltan Farkas commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1124&quot; title=&quot;RESTful service for holding schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1124&quot;&gt;AVRO-1124&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;-------------------------------------&lt;/p&gt;



&lt;p&gt;Hi Sam,  &lt;br/&gt;
Yes you need a service, but that is what the maven repository is. (you can use nexus, artifactory or plain old apache HTTP)&lt;/p&gt;

&lt;p&gt;as I said: &quot;at deserialization time this version is used to retrieve the writer schema from maven repo&quot;&lt;/p&gt;



&lt;p&gt;The client we implemented caches the schemas locally(persistent+ram) , but when a message is received with a version that it does not have, it will go to the maven repo and retrieve that schema, cache it and use it.  &lt;/p&gt;


































































































&lt;p&gt;&amp;#8211;&lt;/p&gt;

&lt;p&gt;This message was sent by Atlassian JIRA&lt;/p&gt;

&lt;p&gt;(v6.3.4#6332)&lt;/p&gt;
</comment>
                            <comment id="14173989" author="zolyfarkas" created="Thu, 16 Oct 2014 17:22:24 +0000"  >&lt;p&gt;Sam, a maven repo is nothing special, and we have a separate instance for this purpose... I see no reason for not using it from production...&lt;br/&gt;
Instance is a plain apache server which I would argue is faster and more reliable than a java REST service...&lt;br/&gt;
By caching schemas and persisting locally, our services can weather outages on this instance pretty well....&lt;/p&gt;</comment>
                            <comment id="14174030" author="spullara" created="Thu, 16 Oct 2014 17:54:40 +0000"  >&lt;p&gt;Ok, so, if what you are suggesting is that your solution is that URLs map&lt;br/&gt;
to schemas based on the version, I think we are all in agreement. Let&apos;s&lt;br/&gt;
specify what those URLs look like and a way to add new schemas (PUT?) and&lt;br/&gt;
we have defined a REST service that does what we are looking for in this&lt;br/&gt;
issue. I suggest not using the SC version though and instead canonically&lt;br/&gt;
hashing the schema and using that hash in the URL.&lt;/p&gt;

&lt;p&gt;On Thu, Oct 16, 2014 at 10:22 AM, Zoltan Farkas (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="14177812" author="felixgv" created="Tue, 21 Oct 2014 01:44:45 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I talked with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gwenshap&quot; class=&quot;user-hover&quot; rel=&quot;gwenshap&quot;&gt;Gwen Shapira&lt;/a&gt; last week during Hadoop World and she made me see another point of view.&lt;/p&gt;

&lt;p&gt;I now think this project belongs outside of Avro. It has been built as a serialization-agnostic repository, so it is not tied to Avro at all. Furthermore, there&apos;s only a filesystem based storage backend at the moment, but I&apos;m working on a Zookeeper backend (for HA) and other people have expressed interest in building RDBMS and HBase backends. It seems wrong for the Avro project to start depending on all these extra things just because of the schema repo.&lt;/p&gt;

&lt;p&gt;Perhaps the schema repo belongs in another project like HCatalog. That being said, I think being accepted as part of a bigger project should not be an impediment to developing the schema repo. Developing as part of a patch in a JIRA ticket or even as a fork of another project on GitHub is not a viable solution long-term.&lt;/p&gt;

&lt;p&gt;I&apos;m going to pull the schema repo out of Avro and make it a standalone project so that it can be iterated on more quickly. If any bigger project wants to pull it into itself, they can do so whenever they want, as it&apos;s all Apache licensed (:&lt;/p&gt;

&lt;p&gt;I&apos;ll keep you posted. Please let me know if you have any comments or concerns.&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14177850" author="lewismc" created="Tue, 21 Oct 2014 02:28:42 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; and others, I&apos;ve been watching this thread for some time as over in Apache Gora (0) we are very interested in schema evolution... this ticket tickled my fancy and I really wish I had discovered it earlier.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Furthermore, there&apos;s only a filesystem based storage backend at the moment, but I&apos;m working on a Zookeeper backend (for HA) and other people have expressed interest in building RDBMS and HBase backends.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If anyone is interested in implementing a backend agnostic (as far as datastore support goes in Gora) implementation of this service, then please get in touch with me directly or alternatively over in dev@gora. I would be very willing to put time into this effort.&lt;br/&gt;
Thank you&lt;br/&gt;
(0) &lt;a href=&quot;http://gora.apache.org&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://gora.apache.org&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14177868" author="felixgv" created="Tue, 21 Oct 2014 03:03:45 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lewismc&quot; class=&quot;user-hover&quot; rel=&quot;lewismc&quot;&gt;Lewis John McGibbney&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;The code in this ticket is already backend agnostic. You configure it with a file and it dynamically injects the correct backend implementation at runtime. For now, the only provided implementation uses the local filesystem, but other backends should be easy to add.&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14177927" author="lewismc" created="Tue, 21 Oct 2014 04:26:45 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; thanks for clarification.. the patch is a beast so I missed the key value config file &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;lang/java/schema-repo/bundle/config/config.properties&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Thanks for the corrections here, I must say however that my suggestion still stands &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; if anyone is interested in implementing a Gora backend for this which would provide access to a number of underlying storage options then please get in touch. There could potentially be a much less investment in actual code writing if this were done in Gora instead of writing an HBase one, then a ZooKeeper one, etc. Thank you very much for the context &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14178542" author="neoword" created="Tue, 21 Oct 2014 15:46:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; I, too, implemented and deployed a version of this patch backed by ZooKeeper / Curator (The zookeeper protocol is not for mere mortals, at least not for me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ). I also massaged the actual transport layer into an AVRO-IPC implementation (vs pure Jersey REST), making it easier to generate low-level polyglot clients to bind to the avro-schema registry/service.  Granted, it is arguable how much Avro-IPC vs raw http will get me. Time will tell. &lt;/p&gt;

&lt;p&gt;I look forward to seeing this work be promoted to RESOLVED state whether it is here in AVRO or some other project where it might more closely align.&lt;/p&gt;
</comment>
                            <comment id="14180149" author="busbey" created="Wed, 22 Oct 2014 16:46:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=felixgv&quot; class=&quot;user-hover&quot; rel=&quot;felixgv&quot;&gt;Felix GV&lt;/a&gt; If you&apos;re pulling things out of Avro, consider moving the service implementation over to &lt;a href=&quot;http://kitesdk.org/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Kite&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14180294" author="felixgv" created="Wed, 22 Oct 2014 18:37:34 +0000"  >&lt;p&gt;Hi everyone,&lt;/p&gt;

&lt;p&gt;The standalone repo is here: &lt;a href=&quot;https://github.com/schema-repo/schema-repo&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/schema-repo/schema-repo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There is a stable 0.1.0 release here: &lt;a href=&quot;https://github.com/schema-repo/schema-repo/tree/0.1.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/schema-repo/schema-repo/tree/0.1.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There is a mailing list here: &lt;a href=&quot;https://groups.google.com/forum/#!forum/schema-repo&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://groups.google.com/forum/#!forum/schema-repo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Having it separate should make it easy to build and integrate into whatever other project needs it, be it Kite, HCat or something else.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lewismc&quot; class=&quot;user-hover&quot; rel=&quot;lewismc&quot;&gt;Lewis John McGibbney&lt;/a&gt;, if you want to take a stab at creating a Gora backend, please go ahead!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=neoword&quot; class=&quot;user-hover&quot; rel=&quot;neoword&quot;&gt;Ren&#233; X Parra&lt;/a&gt;, if you want to contribute your ZK/Curator backend, please go ahead!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, if you think Kite can benefit from the repo, please don&apos;t hesitate to integrate it.&lt;/p&gt;

&lt;p&gt;I&apos;ll handle pull requests for now, but it would be good if others helped with that in the future. I&apos;ll try to setup a GitHub-based maven repo to distribute the artifacts more easily ASAP.&lt;/p&gt;

&lt;p&gt;I suggest moving further discussions to the GG mailing list, since the single thread of this ticket is starting to be pretty chaotic with the half dozen discussions going on in parallel.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;-F&lt;/p&gt;</comment>
                            <comment id="14180299" author="lewismc" created="Wed, 22 Oct 2014 18:41:11 +0000"  >&lt;p&gt;Fantastic, Github repos, starred, forked and I will begin working on this once I get through my TODO list of TODO&apos;s &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15139161" author="alunarbeach" created="Tue, 9 Feb 2016 16:32:02 +0000"  >&lt;p&gt;Is there any update on this?&lt;/p&gt;</comment>
                            <comment id="15139185" author="neoword" created="Tue, 9 Feb 2016 16:45:09 +0000"  >&lt;p&gt;I for one, redact my previous note on contribution of a ZK/Curator backend, since &lt;a href=&quot;http://confluent.io&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Confluent&lt;/a&gt; now provides a perfectly good solution to an Avro-Based Schema Registry.&lt;br/&gt;
If you are looking for a good &quot;off-the-shelf&quot;, &quot;out of the box&quot; avro schema registry solution, check out &lt;a href=&quot;http://docs.confluent.io/current/schema-registry/docs/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Confluent&apos;s Schema Registry&lt;/a&gt; &amp;#8211; it &quot;just works&quot;. And the backend, well, its kafka itself!&lt;/p&gt;

&lt;p&gt;Full disclosure. I do not work for Confluent. Just a big fan of tech that &quot;works&quot;. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Given, that, I wonder what the life-cycle of this JIRA ticket is in 2016+ given that &lt;a href=&quot;https://github.com/confluentinc/schema-registry&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Confluent&apos;s Schema Registry&lt;/a&gt; exists.&lt;/p&gt;</comment>
                            <comment id="16686565" author="zolyfarkas" created="Wed, 14 Nov 2018 14:19:01 +0000"  >&lt;p&gt;I have recently published an example of what I described in earlier comment (using a maven repo as a schema repo REST service). With this approach, you get more than a schema repo, you get a validation/versioning/release system...&lt;/p&gt;

&lt;p&gt;Example is at:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/zolyfarkas/avro-schema-examples&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/zolyfarkas/avro-schema-examples&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;any comments welcome.&lt;/p&gt;


</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12645507">AVRO-1315</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12819361">AVRO-1661</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12577252" name="AVRO-1124-can-read-with.patch" size="1647" author="scott_carey" created="Fri, 5 Apr 2013 18:26:20 +0000"/>
                            <attachment id="12543376" name="AVRO-1124-draft.patch" size="66974" author="jkreps" created="Sat, 1 Sep 2012 00:00:31 +0000"/>
                            <attachment id="12577249" name="AVRO-1124-validators-preliminary.patch" size="32295" author="scott_carey" created="Fri, 5 Apr 2013 18:18:05 +0000"/>
                            <attachment id="12654165" name="AVRO-1124.2.patch" size="177623" author="gwenshap" created="Sat, 5 Jul 2014 03:51:50 +0000"/>
                            <attachment id="12654819" name="AVRO-1124.3.patch" size="181167" author="gwenshap" created="Wed, 9 Jul 2014 15:39:19 +0000"/>
                            <attachment id="12673962" name="AVRO-1124.4.patch" size="179262" author="felixgv" created="Thu, 9 Oct 2014 18:59:13 +0000"/>
                            <attachment id="12576448" name="AVRO-1124.patch" size="177047" author="scott_carey" created="Mon, 1 Apr 2013 22:52:06 +0000"/>
                            <attachment id="12554947" name="AVRO-1124.patch" size="144928" author="scott_carey" created="Tue, 27 Nov 2012 01:32:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Jul 2012 06:27:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253674</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1125] Java: reflect package documentation discourages use</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1125</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The package-level documentation for org.apache.avro.reflect says:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This API is not recommended except as a stepping stone for systems that currently uses Java interfaces to define RPC protocols.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That seems overly cautious.  Folks are productively using Avro&apos;s reflect API in lots of other ways.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12598595">AVRO-1125</key>
            <summary>Java: reflect package documentation discourages use</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jul 2012 18:38:23 +0000</created>
                <updated>Wed, 18 Jul 2012 21:54:25 +0000</updated>
                            <resolved>Thu, 12 Jul 2012 19:04:28 +0000</resolved>
                                                    <fixVersion>1.7.1</fixVersion>
                                    <component>doc</component>
                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13413076" author="cutting" created="Thu, 12 Jul 2012 19:00:35 +0000"  >&lt;p&gt;Here&apos;s a patch that removes this warning.  A few other clarifications are made to the documentation.&lt;/p&gt;</comment>
                            <comment id="13413082" author="cutting" created="Thu, 12 Jul 2012 19:04:28 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12536260" name="AVRO-1125.patch" size="1936" author="cutting" created="Thu, 12 Jul 2012 19:00:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253675</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80492</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1126] Upgrade to Jackson 2+</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1126</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Quite annoyingly with Jackson 2+ the base package name has changed from org.codehaus.jackson to com.fasterxml.jackson so in addition to changing the dependencies from:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; 
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.jackson&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jackson-core-asl&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${jackson.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.codehaus.jackson&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jackson-mapper-asl&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${jackson.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;to:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; 
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.fasterxml.jackson.core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jackson-core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${jackson.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.fasterxml.jackson.core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;jackson-databind&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${jackson.version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;the base package in the code needs to be updated. More info can be found &lt;a href=&quot;http://wiki.fasterxml.com/JacksonUpgradeFrom19To20&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;, I am happy to do the work just let me know what is preferable i.e. should I just attach a patch to this issue?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12598660">AVRO-1126</key>
            <summary>Upgrade to Jackson 2+</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21148&amp;avatarType=issuetype">Task</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chonton">Charles Honton</assignee>
                                    <reporter username="jtyrrell">James Tyrrell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jul 2012 04:11:46 +0000</created>
                <updated>Tue, 6 Nov 2018 17:21:56 +0000</updated>
                            <resolved>Tue, 6 Nov 2018 17:21:56 +0000</resolved>
                                                    <fixVersion>1.9.0</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>24</votes>
                                    <watches>34</watches>
                                                                                                            <comments>
                            <comment id="13413938" author="scott_carey" created="Fri, 13 Jul 2012 18:23:55 +0000"  >&lt;p&gt;Actually, since there are many cases where jackson in Avro collides with very old versions used by others, the package change will help us do this safely.  On the other hand, we leak a couple Jackson types in our API which means this would be an API compatibility breaking change and thus can only make it into a minor release (1.8.0 ?).  &lt;/p&gt;

&lt;p&gt; Perhaps we should figure out how to remove the exposure of Jackson in our API at the same time.&lt;/p&gt;</comment>
                            <comment id="13736068" author="beamerblvd" created="Sat, 10 Aug 2013 22:06:03 +0000"  >&lt;p&gt;The current version of Jackson is 2.2.2. There have been &lt;em&gt;many&lt;/em&gt; improvements, enhancements, and fixes since 1.8.8 that are not available in the 1.9 line, either. For example, 2.2.2 contains support for the JSR-310 Java 8 Date &amp;amp; Time API, which is not and will never be supported by 1.9. I think it is &lt;em&gt;very&lt;/em&gt; important that this upgrade happen in Avro 1.8.0.&lt;/p&gt;

&lt;p&gt;Furthermore, I&apos;m concerned that we leak a couple of Jackson types in our API. I think we should take this opportunity to address and correct that problem, since this will be an API-breaking change anyway.&lt;/p&gt;</comment>
                            <comment id="13737925" author="scott_carey" created="Tue, 13 Aug 2013 06:54:18 +0000"  >
&lt;p&gt;We should definitely clean up the exposure of Jackson in our API.  I propose deprecating the use of it in the 1.8.x in favor of a replacement and remove it in 1.9.x.&lt;/p&gt;

&lt;p&gt;Upgrading to 2.x from 1.x is a different issue.  I fail to see how upgrading to 2.2 is urgent at all.  What new features do you propose that Avro needs to use internally?  If Avro no longer exposes Jackson in its API, it is a purely internal matter to Avro and does not affect users who might want to use Jackson 2.x themselves, since Jackson 1.x and 2.x live in non-conflicting namespaces both in maven and java package names. &lt;/p&gt;</comment>
                            <comment id="13787342" author="chengas123" created="Sat, 5 Oct 2013 21:04:34 +0000"  >&lt;p&gt;I don&apos;t see why we shouldn&apos;t upgrade to Jackson 2 though. It&apos;s a very easy upgrade.&lt;/p&gt;</comment>
                            <comment id="13787606" author="beamerblvd" created="Sun, 6 Oct 2013 14:08:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;Upgrading to 2.x from 1.x is a different issue. I fail to see how upgrading to 2.2 is urgent at all. What new features do you propose that Avro needs to use internally? If Avro no longer exposes Jackson in its API, it is a purely internal matter to Avro and does not affect users who might want to use Jackson 2.x themselves, since Jackson 1.x and 2.x live in non-conflicting namespaces both in maven and java package names.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The point isn&apos;t what new features Avro can use directly. It&apos;s what new features Avro can use transiently. For example, Jackson 2.2 supports the new Date &amp;amp; Time API introduced in Java 8 (java.time.*). If an end user hands of some object to Avro that contains a &lt;tt&gt;java.time.Instant&lt;/tt&gt; and Avro is using Jackson 1.9, Jackson won&apos;t know what to do with it. If, however, Avro is using Jackson 2.2, Jackson &lt;em&gt;will&lt;/em&gt; know what to do with it.&lt;/p&gt;

&lt;p&gt;Jackson is always adding new data types that it natively supports, but they are not being added to the 1.9 branch. They are being added to 2.x. If Avro wants to support these new types as well, it must start using Jackson 2.2.&lt;/p&gt;</comment>
                            <comment id="13788306" author="cutting" created="Mon, 7 Oct 2013 17:06:00 +0000"  >&lt;p&gt;As Scott pointed out, a pre-requisite to upgrading is removing the exposure of Jackson 1.x APIs in Avro&apos;s public API.  In particular, Jackson&apos;s JsonNode is currently used to represent json-valued schema &amp;amp; field properties.  We should file a separate issue to replace JsonNode with JSR 353&apos;s JsonValue.  Jackson 2.0 already supports JSR 353, and is now the standard abstract API for Json in Java.&lt;/p&gt;</comment>
                            <comment id="13789298" author="scott_carey" created="Tue, 8 Oct 2013 15:32:53 +0000"  >&lt;p&gt;I would like to consider that in our API we don&apos;t use any JSON default values at all, but instead our own types for values.  Defaults are currently a performance issue in the decoder because we read the JSON value for every record.  &lt;/p&gt;

&lt;p&gt;The SchemaBuilder API does not expose the use of Jackson types in its API.&lt;/p&gt;</comment>
                            <comment id="13789492" author="cutting" created="Tue, 8 Oct 2013 18:32:04 +0000"  >&lt;p&gt;&amp;gt; I would like to consider that in our API we don&apos;t use any JSON default values at all [ ... ]&lt;/p&gt;

&lt;p&gt;This might combine two things that are currently orthogonal (schema representation &amp;amp; data representation).  My instinct is to keep schemas independent of data representations.  A given JSON default value may have different representations in different data representations (generic, specific, reflect, protobuf, thrift, etc.). These are connected through the Json encoding.  A json default value can be converted to a particular data representation by decoding with a JsonDecoder and a DatumReader for the desired data representation.&lt;/p&gt;

&lt;p&gt;Would you have this conversion done at Schema read time rather than at default-value access time, so that the same schema is represented differently for generic, specific &amp;amp; reflect?  Or do you have something else in mind?&lt;/p&gt;</comment>
                            <comment id="13789865" author="scott_carey" created="Wed, 9 Oct 2013 00:20:41 +0000"  >&lt;p&gt;I propose that we have a canonical representation of schema default values that has no external surface area of a third party library, as part of the Schema API.   Users should not be required to explicitly link to jackson to use our API, so that we can change implementation details such as which JSON library we use without breaking the API.   &lt;/p&gt;

&lt;p&gt;We could choose the Generic representations for this, or make new ones.  It is all easy until you get to arrays, maps, and records.&lt;/p&gt;

&lt;p&gt;Specific, reflect, generic, or future representations can all be different.  A new and improved schema resolution system would convert the default value to the target type once at schema resolution time instead of every record read.  This sort of re-use would require immutable data representation or copying.&lt;/p&gt;</comment>
                            <comment id="13790989" author="cutting" created="Wed, 9 Oct 2013 23:20:59 +0000"  >&lt;p&gt;&amp;gt; I propose that we have a canonical representation of schema default values that has no external surface area of a third party library, as part of the Schema API.&lt;/p&gt;

&lt;p&gt;I agree.  I proposed the javax.json API for this, the standard Java API for immutable JSON data.  We could use generic instead, although I slightly prefer something more standard and unchanging.  We might change the generic API and it would be better if that only affected applications that use generic data and didn&apos;t also force all code that touches default values to also change.&lt;/p&gt;

&lt;p&gt;Note that default values don&apos;t need to have distinct, named types at runtime.  For example, we could use Map&amp;lt;String,Object&amp;gt; for both records and maps, and String for both strings and enum symbols.  Something like this might be a better choice than generic.&lt;/p&gt;</comment>
                            <comment id="13805269" author="antwatkins" created="Fri, 25 Oct 2013 12:31:58 +0000"  >&lt;p&gt;It is great to see this direction. We have adopted Avro at Flurry to support our ad serving protocol using Avro-C for our iOS sdk and Avro Java for Android and on our server. It works great, but the 1 significant downside has been the reliance on the jackson lib. Nothing against Jackson, it&apos;s a great lib, however the size of the jackson-mapper classes were 700-800Kb, which increased our sdk size about 4x. In mobile, this becomes an issue particularly since we are a 3rd party lib. We had started some effort to refactor jackson out, but decided it was too woven into the code and we were concerned upgrading to future version of Avro would prove difficult because of this.&lt;/p&gt;

&lt;p&gt;An abstracted api would great, hopefully one in which we could even plug in the native Android json parser.&lt;/p&gt;</comment>
                            <comment id="13805774" author="cutting" created="Fri, 25 Oct 2013 22:41:37 +0000"  >&lt;p&gt;Android&apos;s json libraries do not implement a standard, abstract API.&lt;/p&gt;

&lt;p&gt;The javax.json glassfish implementation looks to be a considerably smaller than Jackson.  So switching to using the javax.json API for parsing &amp;amp; printing JSON should permit one to choose between Jackson and at least one smaller implementation, but not the implementation built into Android.&lt;/p&gt;

&lt;p&gt;Note that this is separate from the representation used for default values in Avro&apos;s public API.  For that, I&apos;m currently leaning towards something like Map&amp;lt;String,Object&amp;gt;, etc.&lt;/p&gt;</comment>
                            <comment id="14117437" author="sslavic" created="Mon, 1 Sep 2014 13:49:39 +0000"  >&lt;p&gt;Avro committers, please consider creating a branch-1.7 from existing trunk and increase version on trunk to 1.8.0-SNAPSHOT so a patch can be provided for 1.8 issues like this one, against trunk.&lt;/p&gt;</comment>
                            <comment id="14118844" author="cutting" created="Tue, 2 Sep 2014 22:25:02 +0000"  >&lt;p&gt;Done.&lt;/p&gt;</comment>
                            <comment id="14131599" author="busbey" created="Fri, 12 Sep 2014 14:27:37 +0000"  >&lt;p&gt;Is anyone currently working on this ticket?&lt;/p&gt;</comment>
                            <comment id="14131689" author="cutting" created="Fri, 12 Sep 2014 16:03:48 +0000"  >&lt;p&gt;Sean, I don&apos;t think anyone is working on this.  The first step is probably to file a separate issue to replace the use of Jackson&apos;s JsonNode in the public Schema API as the representation for default values.  That&apos;s the incompatible change and is mostly orthogonal to switching the Json parser used internally.&lt;/p&gt;</comment>
                            <comment id="15194391" author="cowtowncoder" created="Mon, 14 Mar 2016 23:36:42 +0000"  >&lt;p&gt;Probably not high priority in any way, but minor suggestions:&lt;/p&gt;

&lt;p&gt;1. For non-API-bound types, `Map&amp;lt;String,Object&amp;gt;` makes sense: jsr-353 has a slew of issues and may be problematic for Android as well (due to whitelisting issues wrt not-included jdk types), plus does not offer much additional value&lt;br/&gt;
2. Instead of full Jackson databind, could perhaps consider jackson-jr (&lt;a href=&quot;https://github.com/FasterXML/jackson-jr&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/FasterXML/jackson-jr&lt;/a&gt;) which uses `jackson-core` (streaming) but only adds about 80kB on top of that (and could be shaded if that makes sense)&lt;br/&gt;
3. For simplest usage, reading/content to/from Maps/Lists etc, could even just use `jackson-core` directly, avoid databinding/mapper. That sheds 80% of Jackson&apos;s code, reduces potential version conflicts, but still has benefits of a mature efficient library&lt;/p&gt;

&lt;p&gt;If anyone is interested in some of above perhaps I could help as well.&lt;/p&gt;</comment>
                            <comment id="15244430" author="rdblue" created="Sat, 16 Apr 2016 22:04:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cowtowncoder&quot; class=&quot;user-hover&quot; rel=&quot;cowtowncoder&quot;&gt;Tatu Saloranta&lt;/a&gt;, that sounds good to me. I&apos;d love to see someone work on this. If you&apos;re interested, please do and we&apos;ll get your changes in!&lt;/p&gt;</comment>
                            <comment id="15370017" author="charles_honton@intuit.com" created="Mon, 11 Jul 2016 00:14:32 +0000"  >&lt;p&gt;Is this still targeted against 1.8? Or 1.9? If 1.9, can someone with commit rights create branch-1.9? Or, do I work against master?&lt;/p&gt;</comment>
                            <comment id="15370944" author="rdblue" created="Mon, 11 Jul 2016 15:13:15 +0000"  >&lt;p&gt;For 1.9, you can work against master. We make the branches for the first release in the series and port changes from master when they are compatible.&lt;/p&gt;

&lt;p&gt;Thanks for working on this!&lt;/p&gt;</comment>
                            <comment id="16492461" author="marcoslg" created="Mon, 28 May 2018 09:48:47 +0000"  >&lt;p&gt;Can I ask what the status of this issue is? Is there any plan on upgrading to Jackson 2?&lt;/p&gt;</comment>
                            <comment id="16493638" author="busbey" created="Tue, 29 May 2018 14:49:58 +0000"  >&lt;p&gt;it looks blocked on &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1605&quot; title=&quot;Remove Jackson classes from public API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1605&quot;&gt;&lt;del&gt;AVRO-1605&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16672666" author="opwvhk" created="Fri, 2 Nov 2018 07:05:25 +0000"  >&lt;p&gt;Fixing this issue has become more important, due to &lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2018-7489&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;CVE-2018-7489&lt;/a&gt; (a remote code execution vulnerability in older Jackson versions).&lt;br/&gt;
From the CVE:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;FasterXML jackson-databind before 2.8.11.1 and 2.9.x before 2.9.5 allows unauthenticated remote code execution because of an incomplete fix for the CVE-2017-7525 deserialization flaw. This is exploitable by sending maliciously crafted JSON input to the readValue method of the ObjectMapper, bypassing a blacklist that is ineffective if the c3p0 libraries are available in the classpath.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="16673233" author="dkulp" created="Fri, 2 Nov 2018 15:17:09 +0000"  >&lt;p&gt;I&apos;m going to take Romain&apos;s work on flipping from Jackson to javax.json and hopefully finish it up and get it in for 1.9.  This will change a bunch of public API&apos;s, but moving from Jackson 1.9 to anything will break things and moving to the standard API&apos;s is probably a better option moving forward.   Which javax.json provider to default to can be decided later.&lt;/p&gt;</comment>
                            <comment id="16673544" author="dkulp" created="Fri, 2 Nov 2018 18:53:33 +0000"  >&lt;p&gt;Actually, flipping to javax.json will be a HUGE disruption to pretty much everyone.   Just updating to Jackson 2.9.7 is mostly a search/replace exercise for package names and &quot;getIntValue()&quot; -&amp;gt; &quot;intValue()&quot;.   Thus, I think just updating to 2.9.7 is likely a better option for users.   It&apos;s a significantly easier update.   &lt;/p&gt;</comment>
                            <comment id="16673641" author="cutting" created="Fri, 2 Nov 2018 20:37:05 +0000"  >&lt;p&gt;I wonder if this is the time to also remove the (deprecated) places&#160;where Avro&apos;s API leaks references to Jackson classes?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;JsonProperties has a number of such deprecated methods, and Json.Reader and Json.Writer are classes deprecated for this reason.&#160; Schema.addProp(String,JsonNode) should have been deprecated, since Schema.addProp(String,Object) is preferred.&#160; Schema.parse(JsonNode) was correctly deprecated.&lt;/p&gt;

&lt;p&gt;Code that uses these will need to be updated after this change, so we might as well have them update to using the Object representation of json data, no?&lt;/p&gt;

&lt;p&gt;In general, Avro&apos;s public APIs should&#160;no longer reference Jackson classes.&#160; Jackson should only be used internally.&lt;/p&gt;</comment>
                            <comment id="16673644" author="dkulp" created="Fri, 2 Nov 2018 20:39:16 +0000"  >&lt;p&gt;Yea.... I&apos;m working on getting the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1605&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-1605&lt;/a&gt; updated and applyable.  Hoping to have that committed on master shortly.  It&apos;s a start.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12741087">AVRO-1585</subtask>
                            <subtask id="12755408">AVRO-1605</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 13 Jul 2012 18:23:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253676</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4if:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1127] Make generateMethodName utility methods public and allow adding a suffix</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1127</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;generateMethodName should be visible and allow a suffix.&lt;/p&gt;

&lt;p&gt;The particular use case for this is that Gora will be generating it&apos;s own implementation of Avro classes that support marking fields with a dirty bit to reduce the overhead when writing back to a data store, so we need a utility to generate appropriate method names for checking the dirty state, ie. isFieldNameDirty()&lt;/p&gt;</description>
                <environment></environment>
        <key id="12598845">AVRO-1127</key>
            <summary>Make generateMethodName utility methods public and allow adding a suffix</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="ekohlwey">Ed Kohlwey</assignee>
                                    <reporter username="ekohlwey">Ed Kohlwey</reporter>
                        <labels>
                    </labels>
                <created>Sun, 15 Jul 2012 12:42:45 +0000</created>
                <updated>Thu, 21 Dec 2017 15:18:55 +0000</updated>
                                            <version>1.7.0</version>
                    <version>1.7.1</version>
                                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13416449" author="cutting" created="Tue, 17 Jul 2012 18:55:40 +0000"  >&lt;p&gt;The patch looks fine but I don&apos;t yet understand the need for it.  Couldn&apos;t Gora simply have its own method that adds a suffix?  Why does this need to be in Avro?&lt;/p&gt;</comment>
                            <comment id="13418636" author="ekohlwey" created="Thu, 19 Jul 2012 20:18:35 +0000"  >&lt;p&gt;The addition of the suffix version of the method is just to keep everything thats &quot;utility-ish&quot; in one spot.&lt;/p&gt;

&lt;p&gt;Gora could just as easily append the suffix using the non-suffix version of the method.&lt;/p&gt;</comment>
                            <comment id="14002722" author="lewismc" created="Tue, 20 May 2014 02:43:00 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekohlwey&quot; class=&quot;user-hover&quot; rel=&quot;ekohlwey&quot;&gt;Ed Kohlwey&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cutting&quot; class=&quot;user-hover&quot; rel=&quot;cutting&quot;&gt;Doug Cutting&lt;/a&gt;, I came across a TODO in GoraCompiler and was directed here&lt;/p&gt;

&lt;p&gt;&quot;This is dirty. We need to file a bug in avro to get them to open the API so other compilers can use their utility methods&quot;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://s.apache.org/aet&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://s.apache.org/aet&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;From what I see this issue was abandoned... it does not really affect Gora in any major fashion, but I just though I would follow it up anyway. Does anyone have comments on the proposed patch... which IMHO is not a bug fix but more like an improvement.&lt;/p&gt;</comment>
                            <comment id="16300157" author="lewismc" created="Thu, 21 Dec 2017 15:18:55 +0000"  >&lt;p&gt;Ping on this issue folks, anyone want to take a look at the patch and detail if this should be updated or closed? Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12536545" name="AVRO-1127.patch" size="3642" author="ekohlwey" created="Sun, 15 Jul 2012 12:44:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jul 2012 18:55:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80494</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1128] SpecificRecord doesn&apos;t check for equality correctly with respect to maps</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1128</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;In Java, map equality is based on the contents of a map rather than ordering, since order is undefined in the plain Java map implementation. The present implementation of SpecificRecord relies on SpecificData&apos;s public compare() method, which doesn&apos;t expose any method to relax the ordering requirement for maps (a protected-visibility implementation exists that does). Since specificRecord is based on map (and not some sort of ordered map) the current implementation with respect to the Java spec is fundamentally incompatible since Java doesn&apos;t require a notion of ordering for the Map interface and Avro can.&lt;/p&gt;

&lt;p&gt;There&apos;s a few ways this could be solved:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Require Avro Java to use the LinkedHashMap implementation of map (or similar) so that map ordering can be compared and not break the normal expectations of a java developer. This is problematic because it dramatically restricts the API and forces an implementation of Map that is undesirable under some circumstances. Unfortunately there is no concept of OrderedMap in Java, just SortedMap.&lt;/li&gt;
	&lt;li&gt;Change SpecificData to compare maps based on contents (set equals=true when recursively comparing maps)&lt;/li&gt;
	&lt;li&gt;Change the visibility of SpecificData.compare(SpecificRecord,SpecificRecord,boolean) to public and change SpecificRecord.equals(Object) to compare only on equality rather than order.&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="12599129">AVRO-1128</key>
            <summary>SpecificRecord doesn&apos;t check for equality correctly with respect to maps</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="ekohlwey">Ed Kohlwey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jul 2012 15:36:58 +0000</created>
                <updated>Tue, 25 Sep 2012 21:16:13 +0000</updated>
                            <resolved>Thu, 19 Jul 2012 21:25:22 +0000</resolved>
                                    <version>1.7.0</version>
                    <version>1.7.1</version>
                                    <fixVersion>1.7.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13416441" author="cutting" created="Tue, 17 Jul 2012 18:47:09 +0000"  >&lt;p&gt;Here&apos;s a patch that I believe addresses the issue you describe.&lt;/p&gt;</comment>
                            <comment id="13417790" author="cutting" created="Wed, 18 Jul 2012 22:47:54 +0000"  >&lt;p&gt;Ed, does this address your concern?  If so, I&apos;ll commit it.&lt;/p&gt;</comment>
                            <comment id="13418634" author="ekohlwey" created="Thu, 19 Jul 2012 20:15:54 +0000"  >&lt;p&gt;Yes, thats exactly what I was thinking of. Thanks Doug!&lt;/p&gt;</comment>
                            <comment id="13418679" author="cutting" created="Thu, 19 Jul 2012 21:25:22 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12536860" name="AVRO-1128.patch" size="1485" author="cutting" created="Tue, 17 Jul 2012 18:47:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jul 2012 18:47:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253678</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 27 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e4iv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80495</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
