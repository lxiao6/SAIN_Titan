<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:25:14 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2017-6-28+AND+created+%3C%3D+2017-7-5+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="1" total="1"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-2046] avro-python3: Very restricted set of data types which are allowed in AvroSchemaFromJSONData</title>
                <link>https://issues.apache.org/jira/browse/AVRO-2046</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Hey, I come from CWL project: &lt;a href=&quot;https://github.com/common-workflow-language/cwltool&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/common-workflow-language/cwltool&lt;/a&gt; and as a part of my GSoC project, I&apos;m working on adding Python 3 compatibility to &lt;b&gt;cwltool&lt;/b&gt; codebase. We&apos;ve been using avro-python2 for a long time now and it has worked great for us in our projects: schema_salad and cwltool.&lt;/p&gt;

&lt;p&gt;In the process of porting cwltool, I&apos;m facing issues with avro-python3 library. I&apos;ve found the following bug:&lt;/p&gt;

&lt;p&gt;Minimal reproducible example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-none&quot;&gt;from collections import OrderedDict
import avro.schema
AvroSchemaFromJSONData = avro.schema.SchemaFromJSONData

a = {
  &quot;fields&quot;: [
    {
      &quot;name&quot;: &quot;name&quot;,
      &quot;type&quot;: &quot;string&quot;
    },
    {
      &quot;name&quot;: &quot;favorite_number&quot;,
      &quot;type&quot;: [
        &quot;int&quot;,
        &quot;null&quot;
      ]
    },
    {
      &quot;name&quot;: &quot;favorite_color&quot;,
      &quot;type&quot;: [
        &quot;string&quot;,
        &quot;null&quot;
      ]
    }
  ],
  &quot;name&quot;: &quot;User&quot;,
  &quot;namespace&quot;: &quot;example.avro&quot;,
  &quot;type&quot;: &quot;record&quot;
}

b = OrderedDict(a)

AvroSchemaFromJSONData(a)
AvroSchemaFromJSONData(b)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ouput: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;~/Desktop/test/venv3/lib/python3.5/site-packages/avro/schema.py in SchemaFromJSONData(json_data, names)
   1252   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; parser is None:
   1253     raise SchemaParseException(
-&amp;gt; 1254         &lt;span class=&quot;code-quote&quot;&gt;&apos;Invalid JSON descriptor &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an Avro schema: %r.&apos;&lt;/span&gt; % json_data)
   1255   &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; parser(json_data, names=names)
   1256 

SchemaParseException: Invalid JSON descriptor &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an Avro schema: OrderedDict([(&lt;span class=&quot;code-quote&quot;&gt;&apos;namespace&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;example.avro&apos;&lt;/span&gt;), (&lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;record&apos;&lt;/span&gt;), (&lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;User&apos;&lt;/span&gt;), (&lt;span class=&quot;code-quote&quot;&gt;&apos;fields&apos;&lt;/span&gt;, [{&lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;favorite_number&apos;&lt;/span&gt;}, {&lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&apos;string&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&apos;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&apos;favorite_color&apos;&lt;/span&gt;}])]).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;h5&gt;&lt;a name=&quot;Thecurrentimplementationofthisfunctiondoesnotallowforanydictlikedatatype.It%2Chowever%2Cworksinavropython2.&quot;&gt;&lt;/a&gt;The current implementation of this function does not allow for &lt;b&gt;any dict like data type&lt;/b&gt;. It, however, works in avro-python2. &lt;/h5&gt;

&lt;p&gt;Relevant line of code: &lt;a href=&quot;https://github.com/apache/avro/blob/master/lang/py3/avro/schema.py#L1250&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/blob/master/lang/py3/avro/schema.py#L1250&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Apart from this, I&apos;ve tried using ``2to3`` tool on avro-python2 and testing our project with it and it works perfectly. Thus, through this issue, I also want to motivate the following PR: &lt;a href=&quot;https://github.com/apache/avro/pull/234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/234&lt;/a&gt;&lt;br/&gt;
I don&apos;t expect a unified codebase for avro python2 and python3 as of now or in near future. There has been a discussion on it before: &lt;a href=&quot;https://github.com/apache/avro/pull/133&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/133&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But having avro-python2 cross compatible for both py2 and py3 would be really helpful for our project and we will be able to complete our porting process. Thanks.  &lt;/p&gt;</description>
                <environment>&lt;p&gt;avro-python3 (1.8.2)&lt;/p&gt;</environment>
        <key id="13084488">AVRO-2046</key>
            <summary>avro-python3: Very restricted set of data types which are allowed in AvroSchemaFromJSONData</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="manu-chroma">Manvendra Singh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Jul 2017 10:10:14 +0000</created>
                <updated>Mon, 17 Jul 2017 08:53:52 +0000</updated>
                                            <version>1.8.2</version>
                                                    <component>python</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="16080206" author="manu-chroma" created="Mon, 10 Jul 2017 11:47:03 +0000"  >&lt;p&gt;Hey, as mentioned before we&apos;re really trying to wind up our Python 3 port and resolving this issue would really put things in place for us.&lt;/p&gt;

&lt;p&gt;I&apos;ve mentioned already, that there is a pending PR to python2 implementation which doesn&apos;t make any change to the API and really goes out to make that implementation compatible with Python 3. &lt;br/&gt;
I think it is useful not only for our project but for others as well who&apos;re interested in adopting a single package/API. Any communication from your side regarding this is highly appreciated! &lt;/p&gt;</comment>
                            <comment id="16089511" author="githubbot" created="Mon, 17 Jul 2017 08:53:52 +0000"  >&lt;p&gt;GitHub user manu-chroma opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/235&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/235&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    schema.py: No sys traceback in parse exception&lt;/p&gt;

&lt;p&gt;    In the ``SchemaParseException``, do not provide sys traceback. &lt;/p&gt;

&lt;p&gt;    For our project CWL Tool, we&apos;re using `avro/py` in our python 3 builds. More on this has been discussed here: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2046&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2046&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;    For doing this, we use `autotranslate` tool which converts `avro/py` code to python2and3 compatible code during runtime. &lt;br/&gt;
    The problem arises when it tries to convert this `raise Exception` command. There is no way to achieve this in a cross-compatible way without the use of external lib.&lt;/p&gt;

&lt;p&gt;    Thus, I&apos;ve created this PR. This is a very minimal change and really solves our problem for the time being. We really hope you&apos;ll consider this or at least give your feedback on the same.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/manu-chroma/avro&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/manu-chroma/avro&lt;/a&gt; patch-1&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/avro/pull/235.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/avro/pull/235.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #235&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 92525fda5cbae1ea7b9e5e255a52ad7e8f0ff71f&lt;br/&gt;
Author: Manvendra Singh &amp;lt;manvendra0310@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-07-17T08:53:28Z&lt;/p&gt;

&lt;p&gt;    schema.py: No sys traceback in parse exception&lt;/p&gt;

&lt;p&gt;    In the ``SchemaParseException``, do not provide sys traceback. &lt;/p&gt;

&lt;p&gt;    For our project CWL Tool, we&apos;re using `avro/py` in our python 3 builds. More on this has been discussed here: &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-2046&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-2046&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;    For doing this, we use `autotranslate` tool which converts `avro/py` code to python2and3 compatible code during runtime. &lt;br/&gt;
    The problem arises when it tries to convert this `raise Exception` command. There is no way to achieve this in a cross-compatible way without the use of external lib.&lt;/p&gt;

&lt;p&gt;    Thus, I&apos;ve created this PR. This is a very minimal change and really solves our problem for the time being. We really hope you&apos;ll consider this or at least give your feedback on the same.&lt;/p&gt;

&lt;hr /&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 17 Jul 2017 08:53:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h2jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>
