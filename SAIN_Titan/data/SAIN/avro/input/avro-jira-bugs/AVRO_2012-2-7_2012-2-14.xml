<!--
RSS generated by JIRA (7.6.3#76005-sha1:8a4e38d34af948780dbf52044e7aafb13a7cae58) at Mon Jan 21 19:16:45 UTC 2019

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<!-- If you wish to do custom client-side styling of RSS, uncomment this:
<?xml-stylesheet href="https://issues.apache.org/jira/styles/jiraxml2html.xsl" type="text/xsl"?>
-->
<rss version="0.92">
    <channel>
        <title>ASF JIRA</title>
        <link>https://issues.apache.org/jira/issues/?jql=project+%3D+AVRO+AND+created+%3E%3D+2012-2-7+AND+created+%3C%3D+2012-2-14+ORDER+BY+key+ASC</link>
        <description>An XML representation of a search request</description>
                <language>en-uk</language>
                        <issue start="0" end="12" total="12"/>
                <build-info>
            <version>7.6.3</version>
            <build-number>76005</build-number>
            <build-date>09-01-2018</build-date>
        </build-info>

<item>
            <title>[AVRO-1018] Java:  add eclipse generated files to svn ignore for protobuf, thrift, and archetype modules</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1018</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;svn:ignore is not set for eclipse project files on the projects introduced in 1.6.0&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541544">AVRO-1018</key>
            <summary>Java:  add eclipse generated files to svn ignore for protobuf, thrift, and archetype modules</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="scott_carey">Scott Carey</assignee>
                                    <reporter username="scott_carey">Scott Carey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Feb 2012 01:38:32 +0000</created>
                <updated>Wed, 15 Feb 2012 00:46:25 +0000</updated>
                            <resolved>Tue, 7 Feb 2012 23:37:39 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13202002" author="scott_carey" created="Tue, 7 Feb 2012 02:18:43 +0000"  >&lt;p&gt;a patch that adds svn:ignore for eclipse configuration folders. (.settings, .classpath, .project) for the modules introduced in avro 1.6.0&lt;/p&gt;</comment>
                            <comment id="13202004" author="scott_carey" created="Tue, 7 Feb 2012 02:19:02 +0000"  >&lt;p&gt;I will submit this patch soon if there are no objections.&lt;/p&gt;</comment>
                            <comment id="13202960" author="scott_carey" created="Tue, 7 Feb 2012 23:37:39 +0000"  >&lt;p&gt;Committed @ revision 1241700&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12513555" name="AVRO-1018.patch" size="777" author="scott_carey" created="Tue, 7 Feb 2012 02:18:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3v3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80388</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1019] Add unit test for Netty server concurrent execution</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1019</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Add a new unit test to verify that multiple RCPs associated with a single NettyTransceiver can be executing concurrently in the NettyServer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541564">AVRO-1019</key>
            <summary>Add unit test for Netty server concurrent execution</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbaldassari">James Baldassari</assignee>
                                    <reporter username="jbaldassari">James Baldassari</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Feb 2012 05:23:12 +0000</created>
                <updated>Wed, 15 Feb 2012 00:46:27 +0000</updated>
                            <resolved>Wed, 8 Feb 2012 03:25:07 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13202083" author="jbaldassari" created="Tue, 7 Feb 2012 05:26:11 +0000"  >&lt;p&gt;Attaching a patch with the new unit test.  This patch is identical to the test patch submitted in &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1001&quot; title=&quot;Adding thread pool to NettyServerAvroHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1001&quot;&gt;&lt;del&gt;AVRO-1001&lt;/del&gt;&lt;/a&gt;.  I&apos;m just submitting it here because &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1001&quot; title=&quot;Adding thread pool to NettyServerAvroHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1001&quot;&gt;&lt;del&gt;AVRO-1001&lt;/del&gt;&lt;/a&gt; is technically a duplicate issue.  This patch is a related improvement.&lt;/p&gt;</comment>
                            <comment id="13202665" author="cutting" created="Tue, 7 Feb 2012 19:33:07 +0000"  >&lt;p&gt;+1 This looks good to me.  Thanks!&lt;/p&gt;</comment>
                            <comment id="13203222" author="jbaldassari" created="Wed, 8 Feb 2012 03:25:07 +0000"  >&lt;p&gt;Committed&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12539184">AVRO-1001</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12534804">AVRO-976</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12513573" name="AVRO-1019.patch" size="7534" author="jbaldassari" created="Tue, 7 Feb 2012 05:26:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Feb 2012 19:33:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226851</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3vb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80389</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1020] Builder API fails to substitute default values for enum types</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1020</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;If a schema has an enum type with a default value, and the Builder API is used to automatically substitute the default value on build(), a ClassCastException is thrown.  The reason is that the default value resolves to a GenericData.EnumSymbol.  The specific builder then attempts to cast this value to the corresponding Java enum type, which fails.  Here is an example stack trace:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.avro.AvroRuntimeException: java.lang.ClassCastException: org.apache.avro.generic.GenericData$EnumSymbol cannot be cast to org.apache.avro.ipc.specific.PrivacyType
	at org.apache.avro.ipc.specific.Person$Builder.build(Person.java:410)
	at org.apache.avro.specific.TestSpecificRecordBuilder.testSpecificBuilder(TestSpecificRecordBuilder.java:51)
Caused by: java.lang.ClassCastException: org.apache.avro.generic.GenericData$EnumSymbol cannot be cast to org.apache.avro.ipc.specific.PrivacyType
	at org.apache.avro.ipc.specific.Person$Builder.build(Person.java:407)
	... 24 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12541568">AVRO-1020</key>
            <summary>Builder API fails to substitute default values for enum types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="jbaldassari">James Baldassari</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Feb 2012 06:50:46 +0000</created>
                <updated>Wed, 15 Feb 2012 00:46:27 +0000</updated>
                            <resolved>Tue, 7 Feb 2012 22:15:43 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13202117" author="jbaldassari" created="Tue, 7 Feb 2012 06:52:28 +0000"  >&lt;p&gt;Here&apos;s a patch that exercises the bug.  After applying this patch, TestSpecificRecordBuilder#testSpecificBuilder() fails.&lt;/p&gt;</comment>
                            <comment id="13202630" author="cutting" created="Tue, 7 Feb 2012 19:02:07 +0000"  >&lt;p&gt;The problem is that RecordBuilderBase is hardwired to use GenericDatumReader.&lt;/p&gt;

&lt;p&gt;Here&apos;s a patch that fixes this by adding a createDatumReader() method to GenericData and its subclasses that returns the appropriate datum reader.&lt;/p&gt;</comment>
                            <comment id="13202673" author="scott_carey" created="Tue, 7 Feb 2012 19:37:26 +0000"  >&lt;p&gt;+1  Looks good, tests pass.&lt;/p&gt;</comment>
                            <comment id="13202865" author="cutting" created="Tue, 7 Feb 2012 22:15:43 +0000"  >&lt;p&gt;I committed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12513577" name="AVRO-1020.bug.patch" size="623" author="jbaldassari" created="Tue, 7 Feb 2012 06:52:28 +0000"/>
                            <attachment id="12513656" name="AVRO-1020.patch" size="4557" author="cutting" created="Tue, 7 Feb 2012 19:02:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Feb 2012 19:02:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3vj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1021] Fix a few name-related imperfections in Avro spec</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1021</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Require names are defined before used; disallow multiple definitions of names; clarify that name-equality is case sensitive (for type names, field names, and enum symbols).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541753">AVRO-1021</key>
            <summary>Fix a few name-related imperfections in Avro spec</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="raymie">Raymie Stata</assignee>
                                    <reporter username="raymie">Raymie Stata</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Feb 2012 05:46:01 +0000</created>
                <updated>Thu, 2 May 2013 02:29:49 +0000</updated>
                            <resolved>Thu, 9 Feb 2012 21:38:45 +0000</resolved>
                                                    <fixVersion>1.6.2</fixVersion>
                                    <component>spec</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13203299" author="raymie" created="Wed, 8 Feb 2012 05:53:57 +0000"  >&lt;p&gt;Changes to spec.&lt;/p&gt;</comment>
                            <comment id="13203326" author="scott_carey" created="Wed, 8 Feb 2012 07:03:55 +0000"  >&lt;ul&gt;
	&lt;li&gt;There is a minor typo:  &quot;wdepth-first&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Implementations that previously allowed for the previously lax restrictions may need to continue to support that for some use cases.  For example, if there is an Avro Data File or old schema that used a name before defining it that currently works, there must be a way for future versions to continue to work.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If we decide to accept this change, we should first provide an integration test for all languages that checks conformance, for those languages that previously supported &apos;declare before use&apos; that there is still a mechanism that can parse such schemas. &lt;/p&gt;</comment>
                            <comment id="13203385" author="raymie" created="Wed, 8 Feb 2012 08:54:18 +0000"  >&lt;p&gt;Fixed typo&lt;/p&gt;</comment>
                            <comment id="13203788" author="cutting" created="Wed, 8 Feb 2012 18:06:15 +0000"  >&lt;p&gt;&amp;gt; if there is an Avro Data File or old schema that used a name before defining it that currently works&lt;/p&gt;

&lt;p&gt;I don&apos;t think any implementation currently supports use-before-define, does it?&lt;/p&gt;

&lt;p&gt;A &quot;left-to-right traversal&quot; of JSON only makes sense for array elements.  The only schemas that include multiple types and traversal order matters are unions and records, but these use JSON arrays, so left-to-right works.  The types array in a protocol definition could come textually after the messages, but the types must be processed before the messages and in-order.  Should we clarify that too?&lt;/p&gt;</comment>
                            <comment id="13203813" author="scott_carey" created="Wed, 8 Feb 2012 18:26:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t think any implementation currently supports use-before-define, does it?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It would sure be nice if there were a few shared folders that every language tested schemas and protocols against.  For example, if there was a &apos;valid schemas&apos; and &apos;invalid schemas&apos; folder that all languages were expected to pass / fail against, then someone could test every language by adding to this folder without having to have much knowledge about any language at all.  Then we could just add a use-before-define schema to the invalid schemas folder, and find out if any languages support it.&lt;/p&gt;</comment>
                            <comment id="13203999" author="raymie" created="Wed, 8 Feb 2012 21:17:55 +0000"  >&lt;blockquote&gt;&lt;p&gt; The types array in a protocol definition could come textually after the messages, but the types must be processed before the messages and in-order. Should we clarify that too? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good catch.  I looked at Schemas and verified that types appear in arrays, but not protocols.  What if I changed my older text to the following: &quot;A schema or protocol may not contain multiple definitions of a fullname.  Further, a name must be defined before it is used (&quot;before&quot; in the depth-first, left-to-right traversal of the JSON parse tree, where the &lt;tt&gt;types&lt;/tt&gt; attribute of a protocol is always deemed to come &quot;before&quot; the &lt;tt&gt;messages&lt;/tt&gt; attribute.)&quot;  A bit windy, but precise.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;It would sure be nice if there were a few shared folders that every language tested schemas and protocols against.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The test-suite I&apos;m writing for &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1006&quot; title=&quot;Fingerprints for Avro Schemas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1006&quot;&gt;&lt;del&gt;AVRO-1006&lt;/del&gt;&lt;/a&gt; will include a file of test cases in &lt;tt&gt;src/test/resources&lt;/tt&gt; that could be the basis of what you&apos;re talking about here.  I&apos;ll get that posted soon, you can look at it and see what more would need to be done.&lt;/p&gt;</comment>
                            <comment id="13204034" author="cutting" created="Wed, 8 Feb 2012 21:52:36 +0000"  >&lt;p&gt;&amp;gt; where the types attribute of a protocol is always deemed to come &quot;before&quot; the messages attribute&lt;/p&gt;

&lt;p&gt;Works for me.&lt;/p&gt;</comment>
                            <comment id="13204908" author="cutting" created="Thu, 9 Feb 2012 21:38:45 +0000"  >&lt;p&gt;I committed this.  Thanks, Raymie!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12539716">AVRO-1006</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12513889" name="AVRO-1021.patch" size="1497" author="raymie" created="Thu, 9 Feb 2012 01:00:57 +0000"/>
                            <attachment id="12513782" name="AVRO-1021.patch" size="1354" author="raymie" created="Wed, 8 Feb 2012 08:54:17 +0000"/>
                            <attachment id="12513766" name="AVRO-1021.patch" size="1355" author="raymie" created="Wed, 8 Feb 2012 05:53:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2012 07:03:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227040</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3vr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80391</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1022] Error in validate name</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1022</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Fix schema.validateName to allow only ASCII letters, not Unicode letters.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541755">AVRO-1022</key>
            <summary>Error in validate name</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="raymie">Raymie Stata</assignee>
                                    <reporter username="raymie">Raymie Stata</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Feb 2012 06:20:39 +0000</created>
                <updated>Mon, 29 Oct 2018 07:07:53 +0000</updated>
                                                                            <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13203328" author="scott_carey" created="Wed, 8 Feb 2012 07:09:29 +0000"  >&lt;p&gt;This looks correct.&lt;/p&gt;

&lt;p&gt;We should add a unit test that validates this and breaks without the change. It should hit each branch of the conditions.  It may also be useful to encapsulate these conditions in private helper methods to share some of the logic and make it more readable (the condition for subsequent letters is a superset of the first letter). &lt;/p&gt;</comment>
                            <comment id="13203818" author="cutting" created="Wed, 8 Feb 2012 18:30:50 +0000"  >&lt;p&gt;Every language that currently implements Avro supports unicode identifiers.  So I wonder if we should instead amend the specification to permit non-ASCII characters?&lt;/p&gt;</comment>
                            <comment id="13203831" author="scott_carey" created="Wed, 8 Feb 2012 18:41:27 +0000"  >&lt;p&gt;I am fine with making the spec match what we are currently doing if this is the case.  Do all languages have good tests around use of non-ASCII characters/numbers in names and Enum symbols?  In particular, I have seen some odd behavior that I did not track down when records with unicode were written in JSON encoding, so my impression is that this may not be well tested in all languages.&lt;/p&gt;</comment>
                            <comment id="13203876" author="cutting" created="Wed, 8 Feb 2012 19:26:38 +0000"  >&lt;p&gt;I doubt it&apos;s well tested in implementations so there are probably bugs there.&lt;/p&gt;</comment>
                            <comment id="13204168" author="raymie" created="Thu, 9 Feb 2012 00:59:56 +0000"  >&lt;p&gt;The current implementation uses Character.isLetter/OrDigit, rather than Character.isJavaIdentifierStart/Part.  Thus, even if you change the spec to agree with what Java allows in identifiers, you&apos;ll also have to change the implementation.  Also, it&apos;s not clear to me that the restrictions for non-ASCII Unicode letters is the same for all languages (e.g., will Character.isJavaIdentifierStart work for all languages?  If not, what&apos;s the plan?).&lt;/p&gt;

&lt;p&gt;And what if, some day in the future, we want to support a language that doesn&apos;t support Unicode?&lt;/p&gt;

&lt;p&gt;A fundamental problem that most programming languages don&apos;t address with Unicode is what to do about Unicode normalization.  Most are silent on the topic, and most implementations default to straight code-point comparison, which isn&apos;t really all that usable.&lt;/p&gt;

&lt;p&gt;So, again, changing Avro&apos;s current spec to allow (some) Unicode characters will not obviate the need to revisit the various implementations.  And doing Unicode right is a lot of work; doing it poorly will just create a nasty source of interop problems.&lt;/p&gt;

&lt;p&gt;I think the original intuition here was a good, pragmatic decision: we should restrict letters in identifiers to ASCII letters.  We should keep the spec as-is, and change the implementations to agree.&lt;/p&gt;</comment>
                            <comment id="13204844" author="cutting" created="Thu, 9 Feb 2012 20:50:00 +0000"  >&lt;p&gt;&amp;gt; And doing Unicode right is a lot of work; doing it poorly will just create a nasty source of interop problems.&lt;/p&gt;

&lt;p&gt;I don&apos;t see this.  Avro already requires that JSON parsers &quot;do Unicode right&quot;.  Permitting non-ASCII in identifiers only creates problems when generating code.  The potential interoperability problem could be that some implementations, when given a schema, would be unable to generate valid code in their programming language for that schema, rendering that schema unreadable by generated code (although it would still be readable by &quot;generic&quot; code).  That would be a bug in that implementation.&lt;/p&gt;

&lt;p&gt;Code generators already have to mangle names that are reserved words in the generated programming language.  If we permit non-ASCII characters in identifiers then implementations might also need to escape non-ASCII characters when generating code.  This doesn&apos;t seem a huge burden.&lt;/p&gt;

&lt;p&gt;It&apos;s important that the specification is clear about what characters implementations might expect to see in identifiers so that they know what characters need to be escaped.  A conservative implementation might simply escape anything that&apos;s not permitted in their programming language.&lt;/p&gt;

&lt;p&gt;If the spec is changed we should specify precisely what characters are permitted.  Unicode characters have properties.  We can use these properties to make the specification precise.  One property is &apos;letter&apos;, another is &apos;number&apos;.  Java&apos;s isLetterOrDigit() includes these two sets.&lt;/p&gt;

&lt;p&gt;Stepping back, it would be good if folks could use their own languages when writing Avro schemas.  It should be possible to use, e.g., column names that are in Japanese, Chinese, Hindi, etc.&lt;/p&gt;</comment>
                            <comment id="13205192" author="thiru_mg" created="Fri, 10 Feb 2012 03:23:34 +0000"  >&lt;p&gt;The basic trouble is that Unicode has multiple representations for the same text. For example, see&lt;br/&gt;
&lt;a href=&quot;http://weblogs.java.net/blog/joconner/archive/2006/06/strings_equals.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://weblogs.java.net/blog/joconner/archive/2006/06/strings_equals.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Java has invested a lot of effort in supporting international characters. In spite of that we have trouble. In many other languages it is worse.&lt;/p&gt;

&lt;p&gt;Restricting to Unicode to letters and digits almost wipes out the use of non-ASCII characters completely. In the example shown in the above article, accents and accented characters are not recognized as letters. As another example, in my native language Tamil, there are 247 &quot;letters&quot;. Unicode tries to model them not as individual alphabets but as symbols (about 60 of them). By combining the symbols it makes up the alphabets. When you represent in Unicode only about 30 or Tamil &quot;letters&quot; pass Java&apos;s isLetter() test. Almost no meaningful Tamil word will pass the isLetter() test. It is true with (at least some) other Indian Languages as well.&lt;/p&gt;

&lt;p&gt;Moreover it is better to keep the spec more restrictive to start with and open up later. I&apos;m not sure of the current level of support for non-ascii Avro names in the current implementations. It is not clear if the effort to make our implementations conformant brings commensurate benefits, at least for now. For example, in order to properly support this single feature, we may have to make C++ implementation use a large library like ICU. A vast majority of Avro C++ users just don&apos;t need it.&lt;/p&gt;
</comment>
                            <comment id="13205248" author="raymie" created="Fri, 10 Feb 2012 05:34:10 +0000"  >&lt;p&gt;I&apos;ve pulled together some documentation on how different languages handle non-ASCII characters in identifiers.  You&apos;ll see that language vary greatly in both what non-ASCII characters are allowed in identifiers, whether or not they are normalized, and &lt;em&gt;how&lt;/em&gt; they are normalized when they are normalized.&lt;/p&gt;

&lt;p&gt;One of the goals of Avro is to support specifications that interoperate well across languages.  Given all the variability in how different languages handle non-ASCII characters, I stand by what I said earlier: handling Unicode well In Avro is a lot of work, and doing it poorly (as we do now) just creates nasty interop problems.&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;The Unicode consortium has published a recommendation for defining Unicode identifiers:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.unicode.org/reports/tr31/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.unicode.org/reports/tr31/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;C# follows it almost exactly (but not exactly); Python follows it mostly; Java kind of follows it, but not really; C/C++ ignore it; and, as far as I can tell, neither Ruby nor PHP have given Unicode identifiers much thought at all.&lt;/p&gt;

&lt;p&gt;Regarding Python, Python 2.x only allowed ASCII characters in identifiers.  It wasn&apos;t until Python 3.x that Unicode characters were allowed.  Phython 3.x follows the Unicode TR31.  However, while Python calls for NRKC normalization, it does not use the &quot;modified&quot; NFKC normalization recommended in TR31.&lt;/p&gt;

&lt;p&gt;C# follows Unicode TR31 exactly (except that it allows identifiers to start with an underscore).  Thus, C#&apos;s handling of non-ASCII identifiers is similar to Python&apos;s, except that C# calls for NFC rather than NFKC.  Also, C# requires that its input arrives in normal form, and states that &quot;The behavior when encountering an identifier not in Normalization Form C is implementation-defined; however, a diagnostic is not required&quot; (presumably a diagnostic would be allowed).  Python, on the other hand, says that &quot;identifiers are converted into the normal form NFKC while parsing.&quot;&lt;/p&gt;

&lt;p&gt;Java makes no reference to TR31, but it does seem to have been inspired by it.  However, it&apos;s more restrictive than TR31 (and thus C# and Python).  For example, while Python (and TR31) allow non-spacing marks, Java does not.  Also, unlike TR31/C#/Python, the Java language does &lt;em&gt;not&lt;/em&gt; call for normalization, and is rather explicit about this: &quot;Unicode composite characters are different from the decomposed characters. For example, a LATIN CAPITAL LETTER A ACUTE (&#193;, \u00c1) could be considered to be the same as a LATIN CAPITAL LETTER A (A, \u0041) immediately followed by a NON-SPACING ACUTE (&#180;, \u0301) when sorting, but these are different in identifiers.&quot;&lt;/p&gt;

&lt;p&gt;C/C++ does not come close to TR31 and is very restrictive still.  The specification lists just a few sets of non-ASCII letters that can be in an identifier (&lt;a href=&quot;http://www.kuzbass.ru:8086/docs/isocpp/extendid.html#extendid&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.kuzbass.ru:8086/docs/isocpp/extendid.html#extendid&lt;/a&gt;).  These exclude many other Unicode letters that are allowed by C#, Python and Java, and excludes other non-letter characters (such as connecting punction) allowed in those languages.  Also, while TR31/C#/Java/Python allow non-Arabic digits in identifiers (e.g., Ethiopic digits), C/C++ does not.&lt;/p&gt;

&lt;p&gt;PHP defines a letter as follows: &quot;a letter is a-z, A-Z, and the bytes from 127 through 255 (0x7f-0xff).&quot;  It says nothing about Unicode, including anything about normalization.  Since much of the time input is presumably in UTF-8, the 0x7f-0xff range implicitly captures &lt;em&gt;everything&lt;/em&gt; in Unicode that isn&apos;t in the Basic Latin block &amp;#8211; this goes way beyond what&apos;s allowed by the languages discussed above.  In short, they just haven&apos;t thought about the problem.&lt;/p&gt;

&lt;p&gt;I can&apos;t find a language spec for Ruby or much discussion on Unicode variables in that language.  More generally, it looks like Ruby&apos;s support for Unicode was bad prior to 1.9 (Jan 2009).  Here&apos;s a discussion of how 1.9 makes it better: &lt;a href=&quot;http://yokolet.blogspot.com/2009/07/design-and-implementation-of-ruby-m17n.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://yokolet.blogspot.com/2009/07/design-and-implementation-of-ruby-m17n.html&lt;/a&gt;  But there isn&apos;t any discussion of variable names.&lt;/p&gt;

&lt;p&gt;Here&apos;s some summary info on support for Unicode variable-names in many different languages:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://rosettacode.org/wiki/Unicode_variable_names&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://rosettacode.org/wiki/Unicode_variable_names&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13205475" author="raymie" created="Fri, 10 Feb 2012 14:31:13 +0000"  >&lt;p&gt;I took a look at the non-Java implementations.  PHP validates names against the current spec (i.e., ASCII letters only).  The rest don&apos;t validate names at all.  If we declared the current spec correct, then &quot;fixing&quot; all of the implementations would consist of adding (or, for Java, changing) 2-3 lines of simple, name-validation code, and some more code to turn validation on and off.&lt;/p&gt;

&lt;p&gt;If we went the other way (chance the spec), we&apos;d have to answer a bunch of design questions (decide what is a &quot;letter,&quot; decide on normalization, figure out how to mangle names in various languages, etc.), and then implement validation in each language (which, as Thiru points out, would include adding an ICU dependency for C/C++, and maybe others (Ruby?  PHP?)), and then implementing mangling where needed (a lot more than a few-line change).&lt;/p&gt;

&lt;p&gt;As a practical matter, this wouldn&apos;t get done, and as the universe of Avro users becomes bigger and bigger, fixing this broken corner of the Avro universe will become harder and harder.&lt;/p&gt;</comment>
                            <comment id="13205616" author="cutting" created="Fri, 10 Feb 2012 18:38:58 +0000"  >&lt;p&gt;An implementation would be naive to trust that other implementations have validated all names in schemas it receives.  Java currently disables validation when reading a schema from a data file, since it&apos;s more important to be able to read the data.  With Generic APIs name validation isn&apos;t required and many applications use only generic APIs.&lt;/p&gt;

&lt;p&gt;This would not require support for unicode identifiers in programming languages.  A code generator should escape any character in a name that&apos;s not easy for it to represent in an identifier.  We&apos;d just be permitting code generators to take advantage of when a programming language does support Unicode in identifiers.&lt;/p&gt;

&lt;p&gt;&amp;gt; If we went the other way (chance the spec), we&apos;d have to answer a bunch of design questions &lt;br/&gt;
&amp;gt; (decide what is a &quot;letter,&quot; decide on normalization, figure out how to mangle names in various&lt;br/&gt;
&amp;gt; languages, etc.), and then implement validation in each language [ ... ]&lt;/p&gt;

&lt;p&gt;I disagree.  Even if we removed all restrictions on naming I don&apos;t think we&apos;d add much burden to implementations.  Most implementations don&apos;t do code generation.  Code generators already need to mangle names.  A code generator should already escape rather than die when it sees an unexpected character in a name.  (The alternative is an inability to generate code for schemas that someone else controls, a poor choice.)&lt;/p&gt;

&lt;p&gt;So I don&apos;t see a new interoperability problem this would create.  We already have schemas in the wild whose names are invalid.&lt;/p&gt;

&lt;p&gt;Perhaps we should change the spec to recommend that names be restricted to ASCII for ease of programming with generated APIs in all languages.  And we might check that in compiler, forcing folks to specify --escape-non-ASCII-names if they really want to generate code for a schema whose names contain non-ASCII characters, to discourage the use of non-ASCII in schemas that you do control.  In general we could encourage implementations to both not trust that identifiers are all-ASCII and to try to encourage all-ASCII identifiers.&lt;/p&gt;</comment>
                            <comment id="13205695" author="raymie" created="Fri, 10 Feb 2012 19:52:10 +0000"  >&lt;p&gt;Right now, a number of Avro implementations, including the Java one, is out of conformance with the spec &amp;#8211; ie, there are bugs.  Also, the implementations disagree significantly with each other, so there&apos;s no de facto spec either.&lt;/p&gt;

&lt;p&gt;I&apos;ve submitted a bug fix to bring the Java implementation into conformance with the spec.  I still think the spec is fine and we should just fix the implementations.&lt;/p&gt;

&lt;p&gt;If you think otherwise, then you should submit a patch to the spec that generalizes names to allow Unicode characters.  Such a patch should specify the characters to be allowed in identifiers, discuss normalization, perhaps address forward compatibility with Unicode changes (an issue discussed in TR31).  In my view, it should also give guidance to people writing implementations with code generators; while that advice wouldn&apos;t be normative, it would help ensure that the spec is implementable.  Indeed, it&apos;s generally good practice to develop reference implementations along with spec&apos;s, so ideally this patch would also include changes to the Java implementation to bring it in conformance with the proposed spec changes.&lt;/p&gt;</comment>
                            <comment id="13205836" author="cutting" created="Fri, 10 Feb 2012 23:01:26 +0000"  >&lt;p&gt;I guess I&apos;m okay leaving the spec alone.  But I question the wisdom of making implementations less tolerant of non-ASCII or other errors in names.  The Java feature that disables validation was added because there are schemas and data out there that do not conform to the spec but which Java should still be able to process.  Your patch here fails unit tests that depend on non-ASCII in names and is an incompatible change for users who do.&lt;/p&gt;

&lt;p&gt;For interoperability we might make Java more tolerant of schemas with invalid names rather than less.  For example, here&apos;s a patch that permits any name, but prints warnings for names that don&apos;t conform to the spec.  It also modifies the compiler to escape characters that are not valid in Java identifiers.  (This isn&apos;t quite ready to commit, since it comments out some tests of things that used to be parser errors but now we should test that they produce warnings.)&lt;/p&gt;

&lt;p&gt;Maybe warnings aren&apos;t right.  Maybe we should warn when validation is disabled and throw exceptions when validation is enabled then enable folks to disable validation in tools.&lt;/p&gt;

&lt;p&gt;Such changes would permit us to generate code and read data regardless of whether the implementation that created the schema and data validated names correctly.&lt;/p&gt;</comment>
                            <comment id="13205995" author="thiru_mg" created="Sat, 11 Feb 2012 02:53:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Maybe warnings aren&apos;t right. Maybe we should warn when validation is disabled and throw exceptions when validation is enabled then enable folks to disable validation in tools.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, I think we should, by default, conform to the spec. That is, it throw an exception stating the names are not valid. Since we so far implemented it loosely, in order to maintain compatibility, should allow non-ASCII names provided the user explicitly wants name validation relaxed. In such situations we should also generate warnings.&lt;/p&gt;

&lt;p&gt;This, while allowing the old schemas to be accepted, would encourage people to create conformant schemas. Now, how does the user express his desire for lenient name validation? The user may not have access to the source code that invokes the parser and so accepting a flag in the parse function may not work. I suggest we use Java system property to pass this information on.&lt;/p&gt;

&lt;p&gt;Having said that, do we know if anyone uses non-ASCII names. Do we know if they are unwilling or unable to fix their schemas? Are we solving a problem that doesn&apos;t really exist? Perhaps, it is simpler if we just fix the code to conform to the spec and release it. We can do the workaround described above if someone complains.&lt;/p&gt;</comment>
                            <comment id="13206546" author="scott_carey" created="Sun, 12 Feb 2012 22:48:49 +0000"  >&lt;p&gt;I see the wisdom in restricting names to be a simple set of ASCII characters.  Until just a few minutes ago the arguments above were convincing me that the &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;A-Za-z_&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;A-Za-z0-9_&amp;#93;&lt;/span&gt;+&lt;br/&gt;
name format was a very useful simplification.  &lt;/p&gt;

&lt;p&gt;But now I think names should be almost entirely open.  Defining &quot;isLetter() or isDigit()&quot; is problematic as pointed out above.  So don&apos;t even bother with that.  How about defining it only with respect to ASCII.  The naming rule in the spec would apply to ASCII only, all other code points are allowed.  Unlike some notion of isLetter(), this does not imply c or c++ needs a big library like ICU.  All implementations must already support UTF-8 in order to support JSON.  Languages can define internally how they map messy names to variables, types, or enum symbols. &lt;/p&gt;

&lt;p&gt;If AVRO restricts valid names, then it won&apos;t be able to convert schemas from other systems into avro schemas.&lt;/p&gt;

&lt;p&gt;For example, how does this relate to &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1339&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-1339&lt;/a&gt;&lt;br/&gt;
?&lt;/p&gt;

&lt;p&gt;If names are restricted, then consuming schemas from other systems will be difficult.  Fewer restrictions in Avro make it more compatible and capable.  &lt;/p&gt;

&lt;p&gt;If there are stringent naming rules in the spec, it would be wise to standardize name mangling from external sources into Avro in the spec.&lt;/p&gt;

&lt;p&gt;So I see two options that make sense:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Enforce the restriction in the current spec, add flexibility for reading schemas that do not comply (that may have already been persisted into permanent storage), and add to the spec standardized name mangling for translating schemas from other systems to Avro and back.&lt;/li&gt;
	&lt;li&gt;Open up the spec for naming to be significantly more flexible.  At minimum also allow all code points above 127. Consider opening up even more characters in ASCII as valid names.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There are two kinds of mangling to consider.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&quot;External system&quot; to and from Avro.  For example, a valid name in an external system might start with a number.  If translated into Avro and Avro does not allow this, it would be very useful if all languages could look at the resulting name and convert it back if required.  This should be standardized across Avro.  The fewer restrictions in Avro, the easier this translation process is.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Avro to and from language identifiers in an implementation.  This is a different issue that is language local.  Because it is language local and up to the Avro implementation, this is less of a concern to me than translation from external schema sources.  Most languages don&apos;t allow a newline in an identifier, but should Avro disallow that?  Language implementations need to be prepared to mangle disallowed characters and strings regardless of what Avro specifies.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13207029" author="cutting" created="Mon, 13 Feb 2012 18:13:24 +0000"  >&lt;p&gt;&amp;gt; If names are restricted, then consuming schemas from other systems will be difficult.&lt;/p&gt;

&lt;p&gt;Good point.  The question is where the escaping burden lies: either with adapter layers (e.g., in Pig or Hive) or in the code generation layer.  I&apos;d argue that code generation layer already has to handle reserved words so that adding character escaping is not a significant burden there.  It&apos;s also safer to not assume that other implementations have correctly escaped all names; to be tolerant.  Finally, escaping as late as possible maximizes legibility through the system.&lt;/p&gt;</comment>
                            <comment id="13207282" author="scott_carey" created="Mon, 13 Feb 2012 22:29:37 +0000"  >&lt;p&gt;As late as possible also makes transitive equivalence easier.  If Hive and Pig both escaped the same string differently when writing into an Avro file, then that Avro file will not be shareable between them as easily.  This is why I feel that the Avro spec should define how names are escaped.  I think the only code point that truly  needs escaping is the namespace separator and an escape character.&lt;/p&gt;

&lt;p&gt;A single source string recognized as equivalent in two different external systems, should become equivalent escaped strings if each of those systems uses different Avro language bindings to escape and store a schema.&lt;/p&gt;</comment>
                            <comment id="13221634" author="raymie" created="Sat, 3 Mar 2012 16:50:14 +0000"  >&lt;p&gt;Based on the dialog above, I propose that we turn this into a set of recommendations for Avro implementers and app developers.  I&apos;ve attached a draft of these recommendations, if folks like them, I can turn them into a patch for the spec.&lt;/p&gt;

&lt;p&gt;The basic idea is as follows.  We cast this as an &quot;interoperability&quot; problem.  On the one hand, the current spec for names facilitates language interoperability, and we shouldn&apos;t change it.  On the other hand, we should apply the Robustness principle: accept liberally, generate strictly.  (Looking closely at Scott&apos;s and Doug&apos;s comments, I think this is what they&apos;re really getting at.)&lt;/p&gt;

&lt;p&gt;In our context, Avro implementations accept schemas, Avro app developers generate them.  Thus, we recommend that Avro implementations, by default, accept schemas liberally.  This means accepting arbitrary Unicode strings for names (but with no normalization or other Unicode processing).  At the same time, Avro developers for who want language interoperability are exhorted to &quot;generate strictly,&quot; and in particular, use only names that follow the strict definition in the Avro spec, because those names are easily handled by almost any language out there.&lt;/p&gt;

&lt;p&gt;To help developers &quot;generate strictly,&quot; we recommend that Avro implementations provide optional mechanisms to perform schema validation, preferably as early in the dev process as possible (eg, unit-test or even compile time).  (For developers who don&apos;t care about language interop, they can ignore these mechanisms, and Avro implementations, being liberal by default, should happily consume their input.)&lt;/p&gt;

&lt;p&gt;The file I just posted says the above in a little more detail.&lt;/p&gt;</comment>
                            <comment id="13223419" author="cutting" created="Tue, 6 Mar 2012 16:56:14 +0000"  >&lt;p&gt;Raymie, this is a good approach.  The spec language that requires ASCII should be changed from MUST to SHOULD.&lt;/p&gt;

&lt;p&gt;One use case that Scott mentioned that your prose does not is transmitting schemas from other systems, e.g., Avro Schemas might often be generated automatically from Pig or SQL schemas.  In these cases accepting liberally permits schemas to pass through Avro losslessly.  Strict validation is really only useful when a developer is the schema author.  In many (most?) cases Avro might be an underlying tool, used indirectly through an application, and in these cases strict validation is probably not useful.&lt;/p&gt;</comment>
                            <comment id="13224717" author="scott_carey" created="Wed, 7 Mar 2012 21:20:04 +0000"  >&lt;p&gt;I agree with the principle of &apos;generate strictly, accept liberally&apos; with respect to schema names.  &lt;br/&gt;
Implementations should restrict names to simple ASCII characters that match the pattern in the spec in almost all cases.  Implementations should accept schemas as liberally as possible, up to any name that does not include a &apos;.&apos;.  Being able to pass through a schema from another system is a powerful use case.&lt;/p&gt;

&lt;p&gt;Later we can add to the specification how to encode &apos;.&apos; in a name for pass through encoding use cases if it ever comes up. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12539716">AVRO-1006</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12514176" name="AVRO-1022.patch" size="5947" author="cutting" created="Fri, 10 Feb 2012 23:01:26 +0000"/>
                            <attachment id="12513768" name="AVRO-1022.patch" size="996" author="raymie" created="Wed, 8 Feb 2012 06:22:06 +0000"/>
                            <attachment id="12516948" name="unicode-recommendation.html" size="4290" author="raymie" created="Sat, 3 Mar 2012 16:39:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2012 07:09:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227042</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80392</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1023] Saved state should be restored in finally clause</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1023</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Schema.parse(JsonParse) and Schema.parse(JsonNode,Names) save global state in a local variable; they should restore that state in a finally clause but they don&apos;t.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541756">AVRO-1023</key>
            <summary>Saved state should be restored in finally clause</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="raymie">Raymie Stata</assignee>
                                    <reporter username="raymie">Raymie Stata</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Feb 2012 06:31:02 +0000</created>
                <updated>Mon, 29 Oct 2018 06:59:06 +0000</updated>
                            <resolved>Mon, 29 Oct 2018 06:59:06 +0000</resolved>
                                                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13203312" author="raymie" created="Wed, 8 Feb 2012 06:33:25 +0000"  >&lt;p&gt;This patch looks big because I put fairly long stretches of code into a try/finally block, and had to re-indent it.  Except for the reindenting, none of the code moved inside the try/finally has been changed.&lt;/p&gt;</comment>
                            <comment id="13203330" author="scott_carey" created="Wed, 8 Feb 2012 07:11:54 +0000"  >&lt;p&gt;We should also add a unit test that fails if this is not applied.&lt;/p&gt;</comment>
                            <comment id="13214094" author="cutting" created="Wed, 22 Feb 2012 23:12:27 +0000"  >&lt;p&gt;The way this might be triggered is if a Schema.Parser is reused after a SchemaParseException is thrown.  Currently the default namespace is that of the preceding schema parsed.  If a SchemaParseException is thrown and the parser is reused then the default namespace could be that of a schema nested within the previous schema.&lt;/p&gt;</comment>
                            <comment id="16666803" author="raymie" created="Mon, 29 Oct 2018 06:59:06 +0000"  >&lt;p&gt;Closing this out because it&apos;s really old and is probably irrelevant at this point.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12513769" name="AVRO-1023.patch" size="11758" author="raymie" created="Wed, 8 Feb 2012 06:33:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2012 07:11:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3w7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80393</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1024] Allow users to subclass JsonEncoder</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1024</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;Users who want to use a different representation of json from the JsonEncoder are forced to re-implement all of it since JsonEncoder&apos;s internals are all private. For example I wanted to make the json not contain type hints for unions.  That required only overriding one method after this fix.&lt;/p&gt;

&lt;p&gt;To fix this making things protected will allow users to change just code that is needed. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12541886">AVRO-1024</key>
            <summary>Allow users to subclass JsonEncoder</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Feb 2012 22:16:27 +0000</created>
                <updated>Thu, 9 Feb 2012 02:13:48 +0000</updated>
                                            <version>1.5.4</version>
                                                    <component>java</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13204085" author="cutting" created="Wed, 8 Feb 2012 22:53:51 +0000"  >&lt;p&gt;This exposes more of the implementation.  It means we could not easily switch from using the Parser or from using Jackson to implement this without potentially breaking applications that use this API.  The Parser is already largely exposed, since the base class is ParsingEncoder, and we&apos;re unlikely to use a different JSON library than Jackson, so perhaps this is okay.  What do others think?&lt;/p&gt;

&lt;p&gt;On the patch itself, it would be better to access these via accessor methods rather than protected fields.  And once something&apos;s public or protected then it needs javadoc.  We should include a unit test for this.  Perhaps the example you provide above of changing the way unions are serialized would make a good test?&lt;/p&gt;</comment>
                            <comment id="13204099" author="scott_carey" created="Wed, 8 Feb 2012 23:15:43 +0000"  >&lt;p&gt;A different option from allowing modification by class extension is to consider opening JsonEncoder (or its components) up enough to extend via composition instead of inheritance.  This may expose less of the internals, or it may be difficult.&lt;/p&gt;

&lt;p&gt;I don&apos;t like exposing Parser any more than it currently is.  Exposing Jackson is not as big of a deal &amp;#8211; this is writing JSON after all.&lt;/p&gt;
</comment>
                            <comment id="13204193" author="eclark" created="Thu, 9 Feb 2012 02:10:36 +0000"  >&lt;p&gt;Here&apos;s another go at it with Doug&apos;s suggestions.&lt;/p&gt;

&lt;p&gt;I added getters, javadocs, and tests.  In adding tests I moved the JsonEncoder tests to their own file.&lt;/p&gt;</comment>
                            <comment id="13204195" author="eclark" created="Thu, 9 Feb 2012 02:13:48 +0000"  >&lt;p&gt;I also added a test for the default json encoder.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12513872" name="AVRO-1024-1.patch" size="1053" author="eclark" created="Wed, 8 Feb 2012 22:18:01 +0000"/>
                            <attachment id="12513894" name="AVRO-1024-2.patch" size="7196" author="eclark" created="Thu, 9 Feb 2012 02:10:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2012 22:53:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227173</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 50 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3wf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1025] migrate website &amp; dist to svnpubsub</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1025</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;ASF infrastructure has requested that all projects migrate to svnpubsub for their websites and release distributions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12541906">AVRO-1025</key>
            <summary>migrate website &amp; dist to svnpubsub</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="cutting">Doug Cutting</assignee>
                                    <reporter username="cutting">Doug Cutting</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Feb 2012 00:27:43 +0000</created>
                <updated>Sun, 30 Dec 2018 05:49:34 +0000</updated>
                                                                            <component>build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13204148" author="cutting" created="Thu, 9 Feb 2012 00:29:42 +0000"  >&lt;p&gt;The request may have been lost in moderation, so here it is again:&lt;/p&gt;


&lt;p&gt;---------- Forwarded message ----------&lt;br/&gt;
From: Joe Schaefer &amp;lt;joe_schaefer@yahoo.com&amp;gt;&lt;br/&gt;
To: Apache Infrastructure &amp;lt;infrastructure@apache.org&amp;gt;&lt;br/&gt;
Cc: &lt;br/&gt;
Date: Wed, 8 Feb 2012 04:26:48 -0800 (PST)&lt;br/&gt;
Subject: Mandatory svnpubsub migration by Jan 2013&lt;br/&gt;
[PLEASE DO NOT RESPOND TO THIS POST! DIRECT ALL FURTHER&lt;br/&gt;
INQUIRIES TO infrastructure@apache.org]&lt;/p&gt;

&lt;p&gt;FYI: infrastructure policy regarding website hosting has&lt;br/&gt;
changed as of November 2011: we are requiring all websites&lt;br/&gt;
and dist/ dirs to be svnpubsub or ASF CMS backed by the end of 2012.&lt;br/&gt;
If your PMC has already met this requirement congratulations,&lt;br/&gt;
you can ignore the remainder of this post.&lt;/p&gt;

&lt;p&gt;As stated on &lt;a href=&quot;http://www.apache.org/dev/project-site.html#svnpubsub&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/dev/project-site.html#svnpubsub&lt;/a&gt;&lt;br/&gt;
we are migrating our webserver infrastructure to 100% svnpubsub&lt;br/&gt;
over the course of 2012.  If your site does not currently make&lt;br/&gt;
use of this technology, it is time to consider a migration effort,&lt;br/&gt;
as rsync-based sites will be PERMANENTLY FROZEN in Jan 2013 due&lt;/p&gt;

&lt;p&gt;to infra disabling the hourly rsync jobs.  While we recommend&lt;br/&gt;
migrating to the ASF CMS &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; for Anakia based or Confluence based&lt;br/&gt;
sites, and have provided tooling &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; to help facilitate this,&lt;br/&gt;
we are only mandating svnpubsub (which the CMS uses itself).&lt;/p&gt;

&lt;p&gt;svnpubsub is a client-server system whereby a client watches an&lt;br/&gt;
svn working copy for relevant commit notifications from the svn&lt;br/&gt;
server.  It subsequently runs svn up on the working copy, bringing&lt;br/&gt;
in the relevant changes.  sites that use static build technologies&lt;br/&gt;
that commit the build results to svn are naturally compatible with&lt;br/&gt;
svnpubsub; simply file a JIRA ticket with INFRA to request a&lt;br/&gt;
migration: any commits to the resulting build tree will be&lt;/p&gt;

&lt;p&gt;instantly picked up on the live site.&lt;/p&gt;


&lt;p&gt;The CMS is a more elaborate system based on svnpubsub which&lt;br/&gt;
provides a webgui for convenient online editing.  Dozens of&lt;br/&gt;
sites have already successfully deployed using the CMS and&lt;br/&gt;
are quite happy with the results.  The system is sufficiently&lt;br/&gt;
flexible to accommodate a wide variety of choices regarding&lt;br/&gt;
templating systems and storage formats, but most sites have&lt;br/&gt;
standardized on the combination of Django and Markdown.  Talk&lt;br/&gt;
to infra if you would like to use the CMS in this or some other&lt;br/&gt;
fashion, we&apos;ll see what we can do.&lt;/p&gt;


&lt;p&gt;NOTE: the policy for dist/ dirs for managing project releases is&lt;br/&gt;
similar.  We have setup a dedicated svn server for handling this,&lt;br/&gt;
please contact infra when you are ready to start using it.&lt;/p&gt;


&lt;p&gt;HTH&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: &lt;a href=&quot;http://www.apache.org/dev/cms&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/dev/cms&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: &lt;a href=&quot;https://svn.apache.org/repos/infra/websites/cms/conversion-utilities/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/infra/websites/cms/conversion-utilities/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13204156" author="cutting" created="Thu, 9 Feb 2012 00:40:53 +0000"  >&lt;p&gt;We need to first make sure that all of our website is in &lt;a href=&quot;https://svn.apache.org/repos/asf/avro/site/publish/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/avro/site/publish/&lt;/a&gt;.  Currently the only thing that&apos;s not there is the docs/ directory containing documentation for all past releases.  So that needs to be added to svn and we need to update the release instructions to indicate that the documentation for new releases should be added to svn rather than copied to a directory on people.apache.org/www/avro.apache.org/docs/.  Once this is done then we can ask Infra to switch on svnpubsub and changes to &lt;a href=&quot;https://svn.apache.org/repos/asf/avro/site/publish/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/avro/site/publish/&lt;/a&gt; will automatically be propagated to the website rather than manually as they are today.&lt;/p&gt;

&lt;p&gt;For releases we need to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;create &lt;a href=&quot;https://dist.apache.org/repos/dist/release/avro/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://dist.apache.org/repos/dist/release/avro/&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;copy people.apache.org:/www/www.apache.org/dist/avro to this directory in svn&lt;/li&gt;
	&lt;li&gt;tell Infra to start using this svn directory as the master for Avro distribution&lt;/li&gt;
	&lt;li&gt;update release instructions to indicate that files should be placed in svn rather than on people.apache.org.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think that&apos;s it.&lt;/p&gt;</comment>
                            <comment id="13209735" author="cutting" created="Thu, 16 Feb 2012 21:01:38 +0000"  >&lt;p&gt;I committed the docs to subversion and asked Infrastructure to switch the website to automatically update from there in &lt;a href=&quot;https://issues.apache.org/jira/browse/INFRA-4443&quot; title=&quot;enable svnpubsub for Avro website&quot; class=&quot;issue-link&quot; data-issue-key=&quot;INFRA-4443&quot;&gt;&lt;del&gt;INFRA-4443&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12542929">INFRA-4443</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227193</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1026] Add namespace support to C++</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1026</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;This patch adds support for reading and resolving schemas that use namespaces for named types. Looking for a code review and application of the patch to codebase.&lt;/p&gt;

&lt;p&gt;Node is modified to take an additional NamespaceConcept attribute in the template parameters. An additional stack has been added to the compiler context to track when namespaces have been entered or left for resolving further types/symbols. Symbolic resolution is now done against the &quot;fullname&quot; of the type and not just by the name. Some string gymnastics were needed in other areas of codegen in order to handle the new symbols.&lt;/p&gt;

&lt;p&gt;Added very trivial tests to AvrogencppTests for schema generation by avrogencpp and added a test schema (tweet) that has namespaces, a record definition inside a namespace, and then a later symbolic reference by name within an outer namespace. Also patched to work with gen-cppcode.py output. Note that NodeImpl::printBasicInfo intentionally does not output the namespace since that caused downstream breakage of gen-cppcode.py expected format.&lt;/p&gt;

&lt;p&gt;github project was forked at &lt;a href=&quot;https://github.com/spindlelabs/avro&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spindlelabs/avro&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542188">AVRO-1026</key>
            <summary>Add namespace support to C++</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kehli">Keh-Li Sheng</assignee>
                                    <reporter username="kehli">Keh-Li Sheng</reporter>
                        <labels>
                            <label>patch</label>
                    </labels>
                <created>Fri, 10 Feb 2012 20:44:23 +0000</created>
                <updated>Mon, 8 Jul 2013 01:46:35 +0000</updated>
                            <resolved>Sun, 20 May 2012 16:53:54 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.7.0</fixVersion>
                                    <component>c++</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13205737" author="kehli" created="Fri, 10 Feb 2012 20:45:27 +0000"  >&lt;p&gt;Attaching patch&lt;/p&gt;</comment>
                            <comment id="13205738" author="kehli" created="Fri, 10 Feb 2012 20:46:22 +0000"  >&lt;p&gt;Parallels improvement to C implementation&lt;/p&gt;</comment>
                            <comment id="13207817" author="kehli" created="Tue, 14 Feb 2012 16:42:17 +0000"  >&lt;p&gt;Adding a patch for JsonCodec.cc to understand namespace/fullname symbolic references inside a union type (ie. the JSON field name is the type name). &lt;/p&gt;

&lt;p&gt;Contains within it a typo patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-954&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-954&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13207896" author="thiru_mg" created="Tue, 14 Feb 2012 18:48:43 +0000"  >&lt;p&gt;The patch does not apply cleanly on the current trunk. I think this patch was generated before &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-956&quot; title=&quot;Remove dependency on Flex/Bison&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-956&quot;&gt;&lt;del&gt;AVRO-956&lt;/del&gt;&lt;/a&gt;. We have made two important changes in the recent past to get rid of Flex/Bison dependency and to make it compile natively on Windows using Visual Studio.&lt;/p&gt;

&lt;p&gt;I&apos;ve not studied this patch deep. So my question may be naive.&lt;/p&gt;

&lt;p&gt;Is it possible to make the name attribute include the namespace as well instead of adding a new attribute? If the namespace is not given, the name will fall back to the simple name as it is now. If namespace is explicitly given or implied, it will have a fully qualified name. That way backward compatibility with existing schemas and code will be maintained.&lt;/p&gt;</comment>
                            <comment id="13207996" author="kehli" created="Tue, 14 Feb 2012 20:35:46 +0000"  >&lt;p&gt;I forked from github and didn&apos;t update to the latest trunk before creating the patch. I&apos;m resolving the merge now and will see if I can produce a clean patch.&lt;/p&gt;

&lt;p&gt;I debated this a bit when implementing it and I chose in favor of keeping name/namespace/fullname as separate concepts since there were a lot of downstream effects to pushing namespaces into the name field - primarily in avrogencpp and gen-cppcode.py where name is used quite frequently as a field name or class/struct specifier (in which case the &apos;.&apos; in namespaces would be an invalid character). That meant additional logic would be required to strip the name of its fully qualified path, whereas it is more straightforward to know how to compose the full path when needed.&lt;/p&gt;

&lt;p&gt;Additionally, if there was a future desire to &quot;nest&quot; declarations within C++ namespaces that tracked the schema namespace, having a separate namespace attribute would make that easier as well.&lt;/p&gt;

&lt;p&gt;I&apos;m not quite sure I understand what you mean by &quot;backward compatibility&quot; since this change does not &lt;b&gt;require&lt;/b&gt; namespace attributes from existing schemas (all the existing schemas in jsonschemas seem to parse and validate and tests run the same as before), it merely knows what to do with them when it encounters them.&lt;/p&gt;</comment>
                            <comment id="13208727" author="kehli" created="Wed, 15 Feb 2012 19:49:12 +0000"  >&lt;p&gt;@thiru_mg: I merged latest the latest upstream trunk and reapplied the changes from the last patch. Please try &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1026&quot; title=&quot;Add namespace support to C++&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1026&quot;&gt;&lt;del&gt;AVRO-1026&lt;/del&gt;&lt;/a&gt;&lt;em&gt;with&lt;/em&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-956&quot; title=&quot;Remove dependency on Flex/Bison&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-956&quot;&gt;&lt;del&gt;AVRO-956&lt;/del&gt;&lt;/a&gt;.patch on your trunk.&lt;/p&gt;

&lt;p&gt;I&apos;ve also thought a bit more about your suggestion to push name into namespace and I could go either way again. In some cases it&apos;s nice to know if there&apos;s a namespace but in others it is a burden to inspect for it.&lt;/p&gt;</comment>
                            <comment id="13215131" author="kehli" created="Thu, 23 Feb 2012 22:33:04 +0000"  >&lt;p&gt;Adding submit patch tag for more visibility. Previously commented on by @thiru_mg but nothing has happened since.&lt;/p&gt;</comment>
                            <comment id="13278958" author="thiru_mg" created="Fri, 18 May 2012 16:57:51 +0000"  >&lt;p&gt;Here is a modified version of Keh-Li Sheng&apos;s patch, where instead of introducing a new template parameter, I&apos;ve changed the NameConcept to use a new class Name instead of std::string.&lt;/p&gt;

&lt;p&gt;I think the namespace belongs to the NameConcept instead of its own concept. Hence this change.&lt;/p&gt;

&lt;p&gt;The original tests pass on Windows 7 and Cygwin.&lt;/p&gt;

&lt;p&gt;The code generator does not currently encode the namespace into the C++ types it generates. It should not be a problem in most cases; but if there is a name clash the generated code will not compile because of duplicate type definitions. I tried to encode the namespace into the names of the generated types (by replacing dot with underscore). It results in too many long names, which would be too tiresome for the users to use. We have to solve it in some other way.&lt;/p&gt;</comment>
                            <comment id="13279402" author="thiru_mg" created="Sat, 19 May 2012 02:25:57 +0000"  >&lt;p&gt;Verified that the new patch works on:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Windows 7 (Visual C++ Express 2010)&lt;/li&gt;
	&lt;li&gt;Cygwin on Windows 7&lt;/li&gt;
	&lt;li&gt;Ubuntu 12.04&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13279816" author="thiru_mg" created="Sun, 20 May 2012 16:53:54 +0000"  >&lt;p&gt;Committed revision 1340768.&lt;/p&gt;</comment>
                            <comment id="13282000" author="kehli" created="Wed, 23 May 2012 22:39:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thiru_mg&quot; class=&quot;user-hover&quot; rel=&quot;thiru_mg&quot;&gt;Thiruvalluvan M. G.&lt;/a&gt; - thanks for the patch! Looking forward to it landing in 1.7.0&lt;/p&gt;</comment>
                            <comment id="13701729" author="roehrss" created="Mon, 8 Jul 2013 01:46:35 +0000"  >&lt;p&gt;This change has introduced a bug in NodeImpl.cc that corrupts JSON schemas when writing them to disk or dumping to a stream.  This manifested when using DataFileWriter to generate a data file, and the schema stored in the header was corrupted from the original schema provided.&lt;br/&gt;
e.g &lt;/p&gt;

&lt;p&gt;This:&lt;br/&gt;
{&lt;br/&gt;
  &#8220;type&#8221;: &#8220;fixed&#8221;,&lt;br/&gt;
  &#8220;name&#8221;: &#8220;Unsigned16&#8221;,&lt;br/&gt;
  &#8220;size&#8221;: 2&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Becomes this when written out :&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &#8220;type&#8221;: &#8220;fixed&#8221;,&lt;br/&gt;
  &#8220;size&#8221;: 2,&lt;br/&gt;
  &#8220;name&#8221; : &#8220;Unsigned16&#8221;,&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Note the extraneous comma after the &#8216;name&#8217; attribute, which makes it invalid JSON, and results in the data file being unreadable by AVRO. &lt;/p&gt;

&lt;p&gt;Since this change appears closed, I will raise a new ticket for the bug.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12455715">AVRO-410</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12528101" name="AVRO-1026-2.patch" size="34298" author="thiru_mg" created="Fri, 18 May 2012 16:57:51 +0000"/>
                            <attachment id="12514153" name="AVRO-1026.patch" size="32260" author="kehli" created="Fri, 10 Feb 2012 20:45:27 +0000"/>
                            <attachment id="12514502" name="AVRO-1026_json.patch" size="1384" author="kehli" created="Tue, 14 Feb 2012 16:42:17 +0000"/>
                            <attachment id="12514693" name="AVRO-1026_with_AVRO-956.patch" size="39061" author="kehli" created="Wed, 15 Feb 2012 19:49:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 Feb 2012 18:48:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227475</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 29 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3wv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80396</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1027] NettyTransceiver will deadlock when attempting transceive/disconnect on the same thread</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1027</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;If an Exception is caught while trying to write to a Channel, Netty can deliver the Exception to a ChannelUpstreamHandler on the same thread that attempted to write to the Channel. If this occurs with the NettyClientAvroHandler implementation of ChannelUpstreamHandler then the thread will deadlock.&lt;/p&gt;

&lt;p&gt;Specifically, NettyClientAvroHandler overrides the ChannelUpstreamHandler.exceptionCaught() method to perform a disconnect, which requires the NettyTransceiver&apos;s write lock. However, in the above situation, the thread will already have locked the NettyTransceiver&apos;s read lock to write to the Channel. ReentrantReadWriteLock does not allow upgrading from a read to a write lock, hence the thread deadlocks.&lt;/p&gt;

&lt;p&gt;Example stack trace (simplified):&lt;/p&gt;

&lt;p&gt;&quot;SessionManager-TimeoutPoller&quot; prio=10 tid=0x7b689c00 nid=0x375d waiting on condition &lt;span class=&quot;error&quot;&gt;&amp;#91;0x7b0ad000..0x7b0ade70&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: WAITING (parking)&lt;br/&gt;
    at sun.misc.Unsafe.park(Native Method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;parking to wait for  &amp;lt;0xf2a944d8&amp;gt; (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)&lt;br/&gt;
    at java.util.concurrent.locks.LockSupport.park(LockSupport.java:158)&lt;br/&gt;
    at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:747)&lt;br/&gt;
    at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:778)&lt;br/&gt;
    at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1114)&lt;br/&gt;
    at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(ReentrantReadWriteLock.java:807)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Acquire write lock&amp;#93;&lt;/span&gt; at org.apache.avro.ipc.NettyTransceiver.disconnect(NettyTransceiver.java:285)&lt;br/&gt;
    at org.apache.avro.ipc.NettyTransceiver.access$2(NettyTransceiver.java:281)&lt;br/&gt;
    at org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.exceptionCaught(NettyTransceiver.java:499)&lt;br/&gt;
    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:122)&lt;br/&gt;
    at org.apache.avro.ipc.NettyTransceiver$NettyClientAvroHandler.handleUpstream(NettyTransceiver.java:473)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:783)&lt;br/&gt;
    at org.jboss.netty.handler.codec.frame.FrameDecoder.exceptionCaught(FrameDecoder.java:238)&lt;br/&gt;
    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:122)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)&lt;br/&gt;
    at org.jboss.netty.channel.Channels.fireExceptionCaught(Channels.java:432)&lt;br/&gt;
    at org.jboss.netty.channel.socket.nio.NioWorker.cleanUpWriteBuffer(NioWorker.java:661)&lt;br/&gt;
    at org.jboss.netty.channel.socket.nio.NioWorker.writeFromUserCode(NioWorker.java:372)&lt;br/&gt;
    at org.jboss.netty.channel.socket.nio.NioClientSocketPipelineSink.eventSunk(NioClientSocketPipelineSink.java:117)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendDownstream(DefaultChannelPipeline.java:771)&lt;br/&gt;
    at org.jboss.netty.channel.Channels.write(Channels.java:632)&lt;br/&gt;
    at org.jboss.netty.handler.codec.oneone.OneToOneEncoder.handleDownstream(OneToOneEncoder.java:70)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:591)&lt;br/&gt;
    at org.jboss.netty.channel.DefaultChannelPipeline.sendDownstream(DefaultChannelPipeline.java:582)&lt;br/&gt;
    at org.jboss.netty.channel.Channels.write(Channels.java:611)&lt;br/&gt;
    at org.jboss.netty.channel.Channels.write(Channels.java:578)&lt;br/&gt;
    at org.jboss.netty.channel.AbstractChannel.write(AbstractChannel.java:251)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Acquire read lock&amp;#93;&lt;/span&gt; at org.apache.avro.ipc.NettyTransceiver.writeDataPack(NettyTransceiver.java:413)&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Acquire read lock&amp;#93;&lt;/span&gt; at org.apache.avro.ipc.NettyTransceiver.transceive(NettyTransceiver.java:394)&lt;br/&gt;
    at org.apache.avro.ipc.Requestor.request(Requestor.java:147)&lt;br/&gt;
    at org.apache.avro.ipc.Requestor.request(Requestor.java:129)&lt;br/&gt;
    at org.apache.avro.ipc.specific.SpecificRequestor.invoke(SpecificRequestor.java:68)&lt;br/&gt;
    &amp;lt;snip&amp;gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Note, in Avro 1.6.1 the read lock is acquired in both NettyTransceiver.transceive() and NettyTransceiver.writeDataPack(). &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1013&quot; title=&quot;NettyTransceiver can hang after server restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1013&quot;&gt;&lt;del&gt;AVRO-1013&lt;/del&gt;&lt;/a&gt; fixes this so that it is acquired only once in NettyTransceiver.transceive().&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a patch that demonstrates a potential fix for the deadlock; the patch assumes that &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1013&quot; title=&quot;NettyTransceiver can hang after server restart&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1013&quot;&gt;&lt;del&gt;AVRO-1013&lt;/del&gt;&lt;/a&gt; has also been applied.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542200">AVRO-1027</key>
            <summary>NettyTransceiver will deadlock when attempting transceive/disconnect on the same thread</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="swilkinson">Simon Wilkinson</assignee>
                                    <reporter username="swilkinson">Simon Wilkinson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Feb 2012 22:51:32 +0000</created>
                <updated>Mon, 19 Mar 2012 16:34:09 +0000</updated>
                            <resolved>Fri, 2 Mar 2012 22:09:53 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.3</fixVersion>
                                    <component>java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13206048" author="jbaldassari" created="Sat, 11 Feb 2012 07:47:01 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Thanks for the patch.  I&apos;m going to attach a different version with the same changes that applies cleanly from trunk with patch -p0.  It would be good to get this in for Avro 1.6.2.&lt;/p&gt;</comment>
                            <comment id="13216980" author="scott_carey" created="Mon, 27 Feb 2012 01:29:48 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Looks good.  Is there a test that could cover this?&lt;/p&gt;</comment>
                            <comment id="13218944" author="jbaldassari" created="Wed, 29 Feb 2012 06:45:15 +0000"  >&lt;p&gt;Simon, do you have a test for this?  If not, I&apos;ll try to make one.  Not sure when I&apos;ll have time to work on it, though.&lt;/p&gt;</comment>
                            <comment id="13219242" author="swilkinson" created="Wed, 29 Feb 2012 14:32:48 +0000"  >&lt;p&gt;I could trigger the bug as part of a larger test. I&apos;ll see if I can extract this into a specific unit test.&lt;/p&gt;</comment>
                            <comment id="13220296" author="cutting" created="Thu, 1 Mar 2012 19:50:07 +0000"  >&lt;p&gt;Simon, do you expect to supply a test today?&lt;/p&gt;

&lt;p&gt;It would be good to include this in 1.6.3, but I don&apos;t think it&apos;s a showstopper, since it&apos;s not a regression, is it?&lt;/p&gt;</comment>
                            <comment id="13220341" author="swilkinson" created="Thu, 1 Mar 2012 20:42:47 +0000"  >&lt;p&gt;Unfortunately I don&apos;t have any time to work on a test until Monday.&lt;/p&gt;</comment>
                            <comment id="13220363" author="cutting" created="Thu, 1 Mar 2012 21:08:32 +0000"  >&lt;p&gt;Should we:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;a. commit this without tests and roll a 1.6.3 RC today&lt;/li&gt;
	&lt;li&gt;b. hold off on 1.6.3 until this has tests next week&lt;/li&gt;
	&lt;li&gt;c. roll a 1.6.3 RC today without this&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I don&apos;t have a strong opinion.&lt;/p&gt;</comment>
                            <comment id="13220399" author="jbaldassari" created="Thu, 1 Mar 2012 21:49:03 +0000"  >&lt;p&gt;Creating a test that reliably triggers these types of deadlocks can be tricky.  I fixed a bug not too long ago that I could reproduce reliably with my own unit tests but couldn&apos;t seem to get it to happen in the Avro tests for whatever reason.  I think this is a fairly low-risk change, and it would be unfortunate if people hit this in production.  So I guess my vote would be a +0 on getting this in for 1.6.3 whether the RC gets rolled today or early next week.&lt;/p&gt;

&lt;p&gt;I could build a snapshot off trunk + &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1027&quot; title=&quot;NettyTransceiver will deadlock when attempting transceive/disconnect on the same thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1027&quot;&gt;&lt;del&gt;AVRO-1027&lt;/del&gt;&lt;/a&gt; and run it through my own suite of Avro Netty unit tests.  That might at least give us some additional confidence that this won&apos;t introduce any regressions.&lt;/p&gt;</comment>
                            <comment id="13221055" author="jbaldassari" created="Fri, 2 Mar 2012 17:04:41 +0000"  >&lt;p&gt;All my tests are passing with trunk + &lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-1027&quot; title=&quot;NettyTransceiver will deadlock when attempting transceive/disconnect on the same thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AVRO-1027&quot;&gt;&lt;del&gt;AVRO-1027&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13221291" author="cutting" created="Fri, 2 Mar 2012 21:51:38 +0000"  >&lt;p&gt;James, thanks for running your tests.&lt;/p&gt;

&lt;p&gt;I guess I&apos;ll go ahead and commit this now and roll a release candidate today.&lt;/p&gt;</comment>
                            <comment id="13221298" author="cutting" created="Fri, 2 Mar 2012 22:09:53 +0000"  >&lt;p&gt;I committed this.  Thanks, James!&lt;/p&gt;</comment>
                            <comment id="13221305" author="gffletch" created="Fri, 2 Mar 2012 22:19:59 +0000"  >&lt;p&gt;A release candidate today would be fantastic! Thanks!&lt;/p&gt;</comment>
                            <comment id="13221345" author="jbaldassari" created="Fri, 2 Mar 2012 23:18:41 +0000"  >&lt;p&gt;Doug, just a minor correction on the attribution for this patch.  The original patch was contributed by Simon Wilkinson.  I just updated it to apply cleanly with patch -p0, so I think Simon should probably be the contributor for this one.&lt;/p&gt;</comment>
                            <comment id="13221348" author="cutting" created="Fri, 2 Mar 2012 23:30:06 +0000"  >&lt;p&gt;Reassigning credit.  Thanks, Simon!&lt;/p&gt;</comment>
                            <comment id="13221380" author="swilkinson" created="Sat, 3 Mar 2012 00:23:27 +0000"  >&lt;p&gt;No problem.&lt;/p&gt;

&lt;p&gt;I&apos;ve been thinking about how to construct the unit test for this. As James has said, it will be tricky.&lt;br/&gt;
Specifically, to force the disconnect, the server has to be closed after a client thread has acquired a NettyTransceiver&apos;s read lock in transceive(), but before the request gets very far in the NettyTransceiver&apos;s Netty pipeline.&lt;/p&gt;

&lt;p&gt;There doesn&apos;t seem any way to make this happen consistently without adding some debug synchronization to NettyTransceiver.&lt;/p&gt;</comment>
                            <comment id="13221465" author="swilkinson" created="Sat, 3 Mar 2012 02:00:28 +0000"  >
&lt;p&gt;Correction, the server must close after the Netty Channel has been checked for &apos;readiness&apos; in NettyTransceiver.writeDataPack(NettyDataPack dataPack), but before the request gets very far in the NettyTransceiver&apos;s Netty pipeline.&lt;/p&gt;

&lt;p&gt;I.e.:&lt;/p&gt;

&lt;p&gt;private void writeDataPack(NettyDataPack dataPack) throws IOException {&lt;br/&gt;
  Channel channel = getChannel(); // Channel appears ready&lt;/p&gt;

&lt;p&gt;  // Server closes&lt;/p&gt;

&lt;p&gt;  channel.write(dataPack); // Netty will notice the disconnection and handle on the calling thread&lt;br/&gt;
}&lt;/p&gt;</comment>
                            <comment id="13221468" author="swilkinson" created="Sat, 3 Mar 2012 02:03:23 +0000"  >
&lt;p&gt;Formatted:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void writeDataPack(NettyDataPack dataPack) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
  Channel channel = getChannel(); &lt;span class=&quot;code-comment&quot;&gt;// Channel appears ready
&lt;/span&gt;
  &lt;span class=&quot;code-comment&quot;&gt;// Server closes
&lt;/span&gt;
  channel.write(dataPack); &lt;span class=&quot;code-comment&quot;&gt;// Netty will notice the disconnection and handle on the calling thread
&lt;/span&gt;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514204" name="AVRO-1027-v2.patch" size="1634" author="jbaldassari" created="Sat, 11 Feb 2012 07:47:26 +0000"/>
                            <attachment id="12514174" name="AVRO-1027.patch" size="1593" author="swilkinson" created="Fri, 10 Feb 2012 22:55:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 11 Feb 2012 07:47:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227487</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80397</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>


<item>
            <title>[AVRO-1028] IPC transceiver doesn&apos;t gracefully handle server connection resets.</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1028</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt;The current Python HTTPTransceiver class forces users to handle connection resets.&lt;/p&gt;

&lt;p&gt;I&apos;ve refactored the class using urllib3 and incorporated some features we get for free from said library into the transceiver.  Added a test case for test_ipc.py that uses the twisted server implementation.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542345">AVRO-1028</key>
            <summary>IPC transceiver doesn&apos;t gracefully handle server connection resets.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21140&amp;avatarType=issuetype">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="bshi">Bo Shi</assignee>
                                    <reporter username="bshi">Bo Shi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Feb 2012 01:49:12 +0000</created>
                <updated>Wed, 23 May 2012 22:01:47 +0000</updated>
                                            <version>1.6.2</version>
                                                    <component>python</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13206621" author="bshi" created="Mon, 13 Feb 2012 01:52:23 +0000"  >&lt;p&gt;Currently using multiprocessing.Process to start a test server.  I sleep 1 second to wait for the server to start allowing connections - anyone have a more robust solution offhand?&lt;/p&gt;</comment>
                            <comment id="13207161" author="bshi" created="Mon, 13 Feb 2012 20:18:46 +0000"  >&lt;p&gt;Also, note that this patch incorporates redirect functionality as originally requested in&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/AVRO-665&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/AVRO-665&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13207313" author="cutting" created="Mon, 13 Feb 2012 23:08:19 +0000"  >&lt;p&gt;Patch works for me, but with the addition of urllib3 requirement perhaps we should push this to 1.7.0?&lt;/p&gt;</comment>
                            <comment id="13207331" author="bshi" created="Mon, 13 Feb 2012 23:23:39 +0000"  >&lt;p&gt;You&apos;re the boss &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13279229" author="cutting" created="Fri, 18 May 2012 21:49:32 +0000"  >&lt;p&gt;I committed this.  Thanks, Bo!&lt;/p&gt;</comment>
                            <comment id="13280642" author="cutting" created="Tue, 22 May 2012 00:20:44 +0000"  >&lt;p&gt;Turns out this breaks the RPC interop testing.&lt;/p&gt;

&lt;p&gt;To see this most easily, edit share/test/interop/bin/test_rpc_interop.sh to just test python against python:&lt;/p&gt;

&lt;p&gt;-clients=(&quot;$java_client&quot; &quot;$py_client&quot; &quot;$ruby_client&quot;)&lt;br/&gt;
-servers=(&quot;$java_server&quot; &quot;$py_server&quot; &quot;$ruby_server&quot;)&lt;br/&gt;
+clients=(&quot;$py_client&quot;)&lt;br/&gt;
+servers=(&quot;$py_server&quot;)&lt;/p&gt;

&lt;p&gt;Then run:&lt;/p&gt;

&lt;p&gt;(cd lang/py; ant)&lt;br/&gt;
bash share/test/interop/bin/test_rpc_interop.sh&lt;/p&gt;

&lt;p&gt;This should print RPC INTEROP TESTS PASS and does if you revert this patch but not with this patch.&lt;/p&gt;

&lt;p&gt;I&apos;d like to get 1.7.0 out soon, so if someone doesn&apos;t provide a fix for this I&apos;ll revert this and we can get it into 1.7.1.&lt;/p&gt;</comment>
                            <comment id="13280644" author="cutting" created="Tue, 22 May 2012 00:21:56 +0000"  >&lt;p&gt;The failure is:&lt;/p&gt;


&lt;p&gt;TEST: share/test/interop/rpc/add/onePlusOne&lt;br/&gt;
Traceback (most recent call last):&lt;br/&gt;
  File &quot;lang/py/build/src/avro/tool.py&quot;, line 28, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from avro import ipc&lt;br/&gt;
  File &quot;/home/cutting/src/avro/trunk/lang/py/build/src/avro/ipc.py&quot;, line 20, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from urllib3.connectionpool import HTTPConnectionPool&lt;br/&gt;
  File &quot;/usr/local/lib/python2.7/dist-packages/urllib3/_&lt;em&gt;init&lt;/em&gt;_.py&quot;, line 16, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from .connectionpool import (&lt;br/&gt;
  File &quot;/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py&quot;, line 42, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from .request import RequestMethods&lt;br/&gt;
  File &quot;/usr/local/lib/python2.7/dist-packages/urllib3/request.py&quot;, line 12, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from .filepost import encode_multipart_formdata&lt;br/&gt;
  File &quot;/usr/local/lib/python2.7/dist-packages/urllib3/filepost.py&quot;, line 15, in &amp;lt;module&amp;gt;&lt;br/&gt;
    from io import BytesIO&lt;br/&gt;
ImportError: cannot import name BytesIO&lt;/p&gt;</comment>
                            <comment id="13280660" author="tebeka" created="Tue, 22 May 2012 00:53:23 +0000"  >&lt;p&gt;This imports the local io instead of the build in io module.&lt;br/&gt;
IMO revert the fix and we&apos;ll address that after 1.7.&lt;/p&gt;</comment>
                            <comment id="13281893" author="cutting" created="Wed, 23 May 2012 20:42:44 +0000"  >&lt;p&gt;I reverted this.&lt;/p&gt;</comment>
                            <comment id="13281970" author="bshi" created="Wed, 23 May 2012 22:01:47 +0000"  >&lt;p&gt;I am out of the country right now but will take a look tomorrow/Friday when I get back!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514314" name="AVRO-1028.patch" size="6380" author="bshi" created="Mon, 13 Feb 2012 01:52:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Feb 2012 23:08:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227632</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80398</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>


<item>
            <title>[AVRO-1029] I want to transfer files beetwin server and client by Avro-c.</title>
                <link>https://issues.apache.org/jira/browse/AVRO-1029</link>
                <project id="12310911" key="AVRO">Apache Avro</project>
                    <description>&lt;p&gt; I want to transfer files beetwin server and client by Avro-c. I know that there must be two parts in this model, the server and the client. My question is how to make the connection? Please forgive me as this maybe a simle question, But I&apos;m fresh in Avro, your simple worlds maybe helpful for me. If only there is an example for it.&lt;/p&gt;</description>
                <environment>&lt;p&gt;avro in C, linux in vmware.&lt;/p&gt;</environment>
        <key id="12542352">AVRO-1029</key>
            <summary>I want to transfer files beetwin server and client by Avro-c.</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="menghaocheng">menghaocheng</reporter>
                        <labels>
                            <label>test</label>
                    </labels>
                <created>Mon, 13 Feb 2012 04:39:46 +0000</created>
                <updated>Tue, 15 Dec 2015 11:27:27 +0000</updated>
                            <resolved>Tue, 15 Dec 2015 11:27:27 +0000</resolved>
                                    <version>1.5.4</version>
                                                    <component>c</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                    <timeoriginalestimate seconds="604800">168h</timeoriginalestimate>
                            <timeestimate seconds="604800">168h</timeestimate>
                                        <comments>
                            <comment id="13210257" author="dcreager" created="Fri, 17 Feb 2012 13:29:53 +0000"  >&lt;p&gt;Hi there.  It sounds like you&apos;re trying to use the RPC mechanism defined in the Avro spec, is that right?  Unfortunately, the Avro C bindings don&apos;t support the RPC mechanism yet.  The C bindings will let you create instances of an Avro schema, and you can create the binary encoding of those instances.  But then you&apos;d be responsible for transmitting the binary encoding using some other library, like ZeroMQ or raw TCP sockets.&lt;/p&gt;

&lt;p&gt;I hope this helps, please let me know if you have any further questions.&lt;/p&gt;</comment>
                            <comment id="13215334" author="menghaocheng" created="Fri, 24 Feb 2012 03:06:24 +0000"  >&lt;p&gt;Thanks Dounglas. &lt;/p&gt;

&lt;p&gt;I think you have got exactly what I meant. I know the step to do it.&lt;br/&gt;
    1)got the binary encoding.&lt;br/&gt;
    2)transmit them by TCP socket.&lt;br/&gt;
The 2nd step is easy. But there is a question to the 1st step. I didn&apos;t know how to get the binary encoding. The C API in the Documentation doesn&apos;t mention at all &lt;a href=&quot;http://avro.apache.org/docs/1.5.4/api/c/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://avro.apache.org/docs/1.5.4/api/c/index.html&lt;/a&gt;. So I have to read the rsc files. I find a function in the file src/avro/consumer.h:&lt;br/&gt;
    avro_consume_binary(avro_reader_t reader,avro_consumer_t *consumer, void *ud);&lt;br/&gt;
I&apos;m not sure if it is the right function that I need.&lt;/p&gt;</comment>
                            <comment id="13215353" author="menghaocheng" created="Fri, 24 Feb 2012 03:51:06 +0000"  >&lt;p&gt;In the function &quot;add_person()&quot; in example/quicstop.c, after executing the following code:&lt;/p&gt;

&lt;p&gt;if (avro_record_set(person, &quot;ID&quot;, id_datum)&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; avro_record_set(person, &quot;First&quot;, first_datum)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; avro_record_set(person, &quot;Last&quot;, last_datum)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; avro_record_set(person, &quot;Age&quot;, age_datum)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; avro_record_set(person, &quot;Phone&quot;, phone_datum)) 
{
                fprintf(stderr, &quot;Unable to create Person datum structure\n&quot;);
                exit(EXIT_FAILURE);
        }&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;there is a record in &quot;person&quot;. Now, I want to transmit this &quot;person&quot; by TCP socket. How to got the bytes stream of &quot;person&quot; from a schema?&lt;/p&gt;</comment>
                            <comment id="15057892" author="martinkl" created="Tue, 15 Dec 2015 11:27:27 +0000"  >&lt;p&gt;Closing as this is a support request, not an issue. Please ask on the &lt;a href=&quot;http://avro.apache.org/mailing_lists.html#Users&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Avro user mailing list&lt;/a&gt; if you need help using the Avro APIs.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Feb 2012 13:29:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227639</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 5 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0e3xj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>80399</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Client by avro-c </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>
